\input{../../style.tex}

\title{Number Theory}
\author{Jacob Denson}

\begin{document}

\pagenumbering{gobble}

\maketitle

\tableofcontents

\pagenumbering{arabic}

\chapter{Generating Functions}

\begin{example}
    Suppose we are working in a country with only a one, a two, and a three penny coin. Given an integer $n$, let $r(n)$ denote the number of ways that a person can be paid $n$ pennies using these three coins. Since this is a question about the additivity of numbers, we can likely understand it using generating functions. Formally,
    %
    \[ r(n) = \# \{ (a,b,c): a + 2b + 3c = n \} \]
    %
    We note
    %
    \[ \left( \sum_{a = 0}^\infty z^a \right) \left( \sum_{b = 0}^\infty z^{2b} \right) \left( \sum_{c = 0}^\infty z^{3c} \right) = \sum_{a,b,c} z^{a + 2b + 3c} = \sum_{n = 0}^\infty r(n) z^n \]
    %
    Thus, for $|z| < 1$,
    %
    \[ \sum_{n = 0}^\infty r(n) z^n = \frac{1}{(1 - z)(1 - z^2)(1 - z^3)} \]
    %
    We can now perform a partial fraction decomposition, writing
    %
    \[ \frac{1}{(1-z)(1 - z^2)(1 - z^3)} = \frac{1}{(1-z)^3(1+z)(\omega - z)(\omega + z)} \]
    %
    where $\omega = e(1/3)$ is a primitive third root of unity. Some intense linear algebra shows this is equal to
    %
    \[ \frac{z + 2}{9(z^2 + z + 1)} + \frac{17 z^2 - 52 z + 47}{72 (1 - z)^3} + \frac{1}{8(1 + z)} \]
    %
    which can be further decomposed into
    %
    \begin{align*}
        - &\frac{\omega^2 + 3 \omega + 2}{9(1 - z/\omega)} + \frac{\omega^2 - \omega + 2}{9(1 - z/\omega^2)}\\
        &+ \frac{1}{6(1 - z)^3} + \frac{1}{4(1 - z)^2} + \frac{17}{72(1 - z)} + \frac{1}{8(1 + z)}
    \end{align*}
    %
    where $\omega = e(1/3)$. Taking power series and summing up, we find
    %
    \begin{align*}
        r(n) &= - \frac{\omega^2 + 3\omega + 2}{9 \omega^n} + \frac{\omega^2 - \omega + 2}{9 \omega^{2n}} + \frac{(n + 1)(n + 2)}{12} + \frac{n+1}{4} + \frac{17}{72} + \frac{(-1)^n}{8}\\
        &= \frac{6n^2 + 36n + 47 + 9(-1)^n}{72} + \begin{cases} 0 & n \equiv 0 (\text{mod}\ 3) \\ -2/9 & n \equiv 1\ \text{or}\ 2 (\text{mod}\ 3) \end{cases}\\
        &= \frac{(n + 3)^2}{12} + \frac{9 (-1)^n - 7}{72} + \begin{cases} 0 & n \equiv 0 (\text{mod}\ 3) \\ -16/72 & n \equiv 1\ \text{or}\ 2 (\text{mod}\ 3) \end{cases}    \end{align*}
        %
        We know $r(n)$ is an integer, and since
        %
        \[ \frac{9 + 7 + 16}{72} = \frac{32}{72} < \frac{1}{2} \]
        %
        So $r(n)$ is the closest integer to $(n + 3)^2/12$.
\end{example}

\end{document}