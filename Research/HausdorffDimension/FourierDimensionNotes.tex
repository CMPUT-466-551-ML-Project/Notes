\documentclass[12pt,reqno]{amsart}

\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}

\usepackage{comment}
\usepackage{mathtools}
\usepackage{MnSymbol}

\usepackage[margin=1.5in]{geometry}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{remark}[theorem]{Remark}

\DeclareMathOperator{\RR}{\mathbf{R}}
\DeclareMathOperator{\ZZ}{\mathbf{Z}}
\DeclareMathOperator{\EE}{\mathbf{E}}
\DeclareMathOperator{\PP}{\mathbf{P}}

\DeclareMathOperator{\DQ}{\mathcal{Q}}
\DeclareMathOperator{\DR}{\mathcal{R}}

\newcommand{\psitwo}[1]{\| {#1} \|_{\psi_2(L)}}
\newcommand{\TV}[2]{\| {#1} \|_{\text{TV}({#2})}}








\title{Salem Sets Avoiding Rough Configurations}
\author{Jacob Denson}

\begin{document}

\maketitle

Recall that a set $X \subset \RR^d$ is a \emph{Salem set} of dimension $s$ if it has Hausdorff dimension $s$, and for every $\varepsilon > 0$, there exists a probability measure $\mu_\varepsilon$ supported on $X$ such that for all $\xi \in \RR^d$,
%
\[ \sup_{\xi \in \RR^d} |\xi|^{s - \varepsilon} |\widehat{\mu_\varepsilon}(\xi)| < \infty. \]
%
Our goal in these notes is to obtain, for each set $Z \subset \RR^{dn}$ with Minkowski dimension $s$, a Salem set $X \subset \RR^d$ with dimension
%
\[ \frac{nd - s}{s}, \]
%
such that for each set of $n$ distinct elements $x_1, \dots, x_n \in X$, $(x_1, \dots, x_n) \not \in Z$. We hope that we can rely on the random selection approach of our paper on rough configurations to obtain such a result.

\section{Concentration Inequalities Using the Orlicz Norm}

Define a convex function $\psi_2: [0,\infty) \to [0,\infty)$ by $\psi_2(t) = e^{t^2} - 1$, and a corresponding Orlicz norm on the family of scalar valued random variables $X$ over a probability space by setting
%
\[ \psitwo{X} = \inf \left\{ A \in (0,\infty) : \EE(\psi_2(|X|/A)) \leq 1 \right\}. \]
%
The family of random variables $\psi_2(L)$ are known as \emph{subgaussian random variables}. Here are some important properties:
%
\begin{itemize}
	\item (Gaussian Tails): There exists a universal constant $c > 0$ such that for any random variable $X$, $\psitwo{X} \leq A$ if and only if for each $t \geq 0$,
	%
	\[ \PP \left( |X| \geq t \right) \leq 2 \exp \left( -ct^2/A^2 \right). \]

	\item (Bounded Variables are Subgaussian): For any random $X$,
	%
	\[ \psitwo{X} \lesssim \| X \|_{L^\infty}. \]

	\item (Centering) For any random variable $X$,
	%
	\[ \psitwo{X - \EE(X)} \lesssim \psitwo{X}. \]
	
	\item (Union Bound) If $X_1, \dots, X_N$ are random variables, then
	%
	\[ \psitwo{X_1 + \dots + X_N} \leq \psitwo{X_1} + \dots + \psitwo{X_N}. \]
	
	\item (Hoeffding's Inequality): If $X_1, \dots, X_N$ are \emph{independent} random variables, then
	%
	\[ \psitwo{X_1 + \dots + X_N} \lesssim \left( \psitwo{X_1}^2 + \dots + \psitwo{X_N}^2 \right)^{1/2}. \]
\end{itemize}
%
The Orlicz norm is a convenient notation to summarize calculations involving the principle of concentration of measure. Roughly speaking, we can think of a random variable $X$ with $\psitwo{X} \leq A$ as essentially always lying in the interval $[-A,A]$, very rarely deviating outside this interval.

\section{A Family of Cubes}

Fix sequences of integers $\{ N_m : m \geq 1 \}$ and $\{ M_m : m \geq 1 \}$. We then define two sequences of real numbers $\{ l_m : m \geq 0 \}$ and $\{ r_m : m \geq 0 \}$, by defining
%
\[ l_m = \frac{1}{M_1 N_1 \dots M_m N_m} \quad\text{and}\quad r_m = \frac{1}{M_1 N_1 \dots M_m}. \]
%
For each $m, d \geq 0$, we define two collections of strings
%
\[ \Sigma_m^d = \ZZ^d \times [M_1]^d \times \dots \times [N_1]^d \times \dots \times [M_m]^d \times [N_m]^d \]
%
and
%
\[ \Pi_m^d = \ZZ^d \times [M_1]^d \times [N_1]^d \times \dots \times [N_{m-1}]^d \times [M_m]^d. \]
%
For each string $i \in \Sigma_m^d$, we define a vector $a_i \in (l_m \ZZ)^d$ by setting
%
\[ a_i = i_0 + \sum_{k = 1}^m i_{2k-1} \cdot r_k + i_{2k} \cdot l_k \]
%
Then each string $i \in \Sigma_m^d$ can be identified with the sidelength $l_m$ cube
%
\[ Q_i = \prod_{j = 1}^d \left[ a_{ij}, a_{ij} + l_m \right]. \]
%
centered at $a_i$. Similarily, for each string $i \in \Pi_m^d$, we define a vector $a \in (r_m \ZZ)^d$ by setting, for each $1 \leq j \leq d$,
%
\[ a_i = i_0 + \left( \sum_{k = 1}^{m-1} i_{2k-1} \cdot r_k + i_{2k} \cdot l_k \right) + i_{2m-1} \cdot r_m, \]
%
and then define a sidelength $r_m$ cube
%
\[ R_i = \prod_{j = 1}^d \left[ a_{ij}, a_{ij} + r_m \right]. \]
%
We let $\DQ_m^d = \{ Q_i : i \in \Sigma_m^d \}$, and $\DR_m^d = \{ R_i : i \in \Pi_m^d \}$. Here are some important properties of this collection of cubes:
%
\begin{itemize}
	\item For each $m$, $\DQ_m^d$ and $\DR_m^d$ are covers of $\RR^d$.

	\item If $Q_1,Q_2 \in \bigcup_{m = 0}^\infty \DQ_m^d$, then either $Q_1$ and $Q_2$ have disjoint interiors, or one cube is contained in the other. Similarily, if $R_1,R_2 \in \bigcup_{m = 1}^\infty \DR_m^d$, then either $R_1$ and $R_2$ have disjoint interiors, or one cube is contained in the other.

	\item For each cube $Q \in \DQ_m$, there is a unique cube $Q^* \in \DR_m$ with $Q \subset Q^*$. We refer to $Q^*$ as the \emph{parent cube} of $Q$. Similarily, if $R \in \DR_m$, there is a unique cube in $R^* \in \DQ_{m-1}$ with $R \subset R^*$, and we refer to $R^*$ as the \emph{parent cube} of $R$.
\end{itemize}

We say a set $E \subset \RR^d$ is $\DQ_m$ discretized if it is a union of cubes in $\DQ_m^d$, and we then let $\DQ_m(E) = \{ Q \in \DQ_m^d : Q \subset E \}$. Similarily, we say a set $E \subset \RR^d$ is $\DR_m$ discretized if it is a union of cubes in $\DR_m^d$, and we then let $\DR_m(E) = \{ R \in \DR_m^d : R \subset E \}$. We set $\Sigma_m(E) = \{ i \in \Sigma_m^d : Q_i \in \DQ_m(E) \}$, and $\Pi_m(E) = \{ i \in \Pi_m^d : R_i \in \DR_m(E) \}$. We say a cube $Q_1 \times \dots \times Q_n \in \DQ_m^{dn}$ is \emph{strongly non diagonal} if there does not exist two distinct indices $i,j$, and a third index $k \in \Pi_m^d$, such that $R_k \cap Q_i, R_k \cap Q_j \neq \emptyset$.

\section{A Family of Mollifiers}

We now consider a family of mollifiers, which we will use to smooth out the Fourier transform of the measures we study. Begin by choosing a non-negative $C^\infty$ function $\psi$ supported on $[-1,1]^d$ such that
%
\begin{equation} \label{equation1249015901590190}
	\int_{\RR^d} \psi(x)\; dx = 1,
\end{equation}
%
and for each $x \in \RR^d$,
%
\begin{equation} \label{equation50914902149012}
	\sum_{n \in \ZZ^d} \psi(x + n) = 1.
\end{equation}
%
Since $\psi$ is $C^\infty$ and compactly supported, then for each $t \in [0,\infty)$, we conclude
%
\begin{equation} \label{equation682928418931289}
	\sup_{\xi \in \RR^d} |\xi|^t |\widehat{\psi}(\xi)| < \infty.
\end{equation}
%
Now we rescale the mollifier. For each $m > 0$, we let
%
\[ \psi_m(x) = l_m^{-d} \psi(l_m \cdot x). \]
%
Then $\psi_m$ is supported on $[-l_m,l_m]^d$. Equation \eqref{equation1249015901590190} implies that for each $x \in \RR^d$,
%
\begin{equation} \label{equation19204910490190190}
	\int_{\RR^d} \psi_m = 1.
\end{equation}
%
Equation \eqref{equation50914902149012} implies
%
\begin{equation} \label{equation990249012409129041290} \sum_{n \in \ZZ^d} \psi(x + l_m \cdot n) = l_m^{-d}. \end{equation}
%
An important property of the rescaling in the frequency domain is that for each $\xi \in \RR^d$,
%
\begin{equation} \label{equation12901902419209012}
    \widehat{\psi_m}(\xi) = \widehat{\psi}(l_m \xi),
\end{equation}
%
In particular, \eqref{equation12901902419209012} implies that for each $t \geq 0$,
%
\begin{equation}
    \sup_{|\xi| \in \RR^d} |\widehat{\psi_m}(\xi)| |\xi|^t = l_m^{-t} \sup_{|\xi| \in \RR^d} |\widehat{\psi}(\xi)| |\xi|^t.
\end{equation}
%
This implies that, uniformly in $m$, $\widehat{\psi_m}$ decays sharply outside of the box $[-l_m^{-1}, l_m^{-1}]^d$, a manifestation of the Heisenberg uncertainty principle.

\section{Discrete Lemma}

We now consider a discrete form of the Fourier bound argument, which we can apply iteratively to obtain a Salem set 

\begin{lemma}
	Fix $s \in [1,dn)$ and $\varepsilon \in [0,(n-s)/4)$. Let $T \subset [0,1]^d$ be a non-empty, $\DQ_m$ discretized set, and let $\mu_T$ be a smooth probability measure compactly supported on $T$, together with a constant $C > 0$ such that for each $m \in \ZZ^d$,
    %
    \[ |\widehat{\mu_T}(m)| \leq C |m|^{-s/2}. \]
    %
    Let $B \subset \RR^{dn}$ be a non-empty, $\DQ_{m+1}$ discretized set such that
	%
    \begin{equation} \label{equation1290419204912090120912}
	   \#(\DQ_{m+1}(B)) \leq (1/l_{m+1})^{s + \varepsilon}.
    \end{equation}
	%
	Then there exists constants $C_1(\mu_T,n,d,s)$ and $C_2(\mu_T,n,d,s)$ such that if
    %
    % Must depend on d and \mu
    \begin{equation} \label{equation1095121284102}
        N_{m+1} \geq C_1(T,\mu_T,n,d,s,\varepsilon),
    \end{equation}
    %
    and
    %
    % Must depend on l_m, d, n, and s
    \begin{equation} \label{equation5890129048128941891}
        \frac{N_{m+1}^{\frac{dn - s - 2\varepsilon}{s + \varepsilon}}}{C_2(T,\mu_T,n,d,s)} \leq M_{m+1} \leq \frac{N_{m+1}^{\frac{dn - s - 2\varepsilon}{s + \varepsilon}}}{C_2(T,\mu_T,n,d,s)} + 1,
    \end{equation}
    %
    then there exists a $\DQ_{m+1}$ discretized set $S \subset T$ together with a smooth probability measure supported on $S$ such that
    %
	\begin{itemize}
		\item For any strongly non-diagonal cube
		%
		\[ Q = Q_1 \times \dots \times Q_n \in \DQ_{m+1}(B), \]
		%
		There exists $i$ such that $Q_i \not \in \DQ_{m+1}(S)$.

		\item For any $m \in \ZZ^d$,
		%
		\[ |\widehat{\mu}(m)| \leq (C + l_{m+1}^{-1}) |m|^{-s/2}. \]
	\end{itemize}
\end{lemma}
\begin{proof}
	For each $i \in \Pi_{m+1}^d$, let $j_i$ be a random integer vector chosen from $[N_{m+1}]^d$, such that the family $\{ j_i : i \in \Pi_{m+1}^d \}$ is independent. We define a measure $\nu_S$ by setting, for each $x \in \RR^d$,
	%
	\[ d\nu_S(x) = r_{m+1}^d \sum_{i \in \Pi_{m+1}^d} \psi_{m+1}(x - a_{ij_i}) d\mu_T(x). \]
	%
	We then normalize, defining
	%
	\[ \mu_S = \frac{\nu_S}{\nu_S(\RR^d)}. \]
	%
	If we set
	%
	\[ S = \bigcup \{ Q \in \DQ_{m+1}^d : \mu_S(Q) > 0 \}, \]
	%
	then by definition, $S$ is a $\DQ_{m+1}$ discretized set, $\mu_S$ is supported on $S$, and $S \subset T$. It now suffices to show that with nonzero probability, $\DQ_m(S^n)$ is disjoint from the strongly non diagonal cubes in $\DQ_m(B)$, and $\mu_S$ has the required Fourier decay.

    In our calculations, it will be helpful to decompose the measure $\nu_S$. For each $i \in \Pi_{m+1}(T)$, define a random measure $\nu_i$ by setting
	%
	\[ d\nu_i(x) = r_{m+1}^d \psi_{m+1}(x - a_{ij_i}) d\mu_T(x). \]
	%
	Then $\nu_S = \sum_{i \in \Pi_{m+1}(T)} \nu_i$.

    First, let's show that $\nu_S$ only needs to be slightly perturbed to become a probability measure. Note that if $j_0,j_1 \in [N_{m+1}]^d$, then
	%
	\[ |a_{ij_0} - a_{ij_1}| = |j_0 - j_1| \cdot l_{m+1} \lesssim_d N_{m+1} l_{m+1} = r_{m+1}, \]
	%
	which, together with \eqref{equation19204910490190190}, implies
	%
	\begin{equation} \label{equation92941294129412919}
	\begin{split}
		&\left| r_{m+1}^d \int_{\RR^d} \psi_{m+1}(x - a_{ij_0}) \mu_T(x) - r_{m+1}^d \int_{\RR^d} \psi_{m+1}(x - a_{ij_1}) \mu_T(x) \right|\\
		&\ \ \ \ \ \ \ \ \leq r_{m+1}^d \int_{\RR^d} \psi_{m+1}(x) \left| \mu_T(x + a_{ij_0}) - \mu_T(x + a_{ij_1}) \right|\\
		&\ \ \ \ \ \ \ \ \lesssim_d r_{m+1}^{d+1} \int_{\RR^d} \psi_{m+1}(x) \| \nabla \mu_T \|_{L^\infty(\RR^d)} = r_{m+1}^{d+1} \| \nabla \mu \|_{L^\infty(\RR^d)}.
	\end{split}
	\end{equation}
	%
	%For each $i \in \Sigma_{m+1}^d$, if we set
	%
	%\[ A_i = \EE(\nu_i(\RR^d)) = \frac{1}{N_{n+1}^d} \sum_{j \in [N_{n+1}]^d} \int_{\RR^d} \psi_{m+1}(x - a_{ij}) \mu_T(x)\; dx, \]
	%
	Thus $\eqref{equation92941294129412919}$ implies that for each $i$,
	%
	\begin{equation} \label{equation491040912491}
		\| \nu_i(\RR^d) - \EE(\nu_i(\RR^d)) \|_{L^\infty} \lesssim_d r_{m+1}^{d+1} \| \nabla \mu \|_{L^\infty(\RR^d)}.
	\end{equation}
	%
	Furthermore, \eqref{equation990249012409129041290} implies
	%
	\begin{equation} \label{9921490124912}
	\begin{split}
		\sum_{i \in \Pi_{m+1}^d} \EE(\nu_i(\RR^d)) &= r_{m+1}^d \sum\nolimits_{(i,j) \in \Sigma_{m+1}^d} \PP(j_i = j) \int_{\RR^d} \psi_{m+1}(x - a_{ij}) \mu_T(x)\; dx\\
		&= \frac{r_{m+1}^d}{N_{m+1}^d} \int_{\RR^d} \left( \sum\nolimits_{(i,j) \in \Sigma_{m+1}^d} \psi_{m+1}(x - a_{ij}) \right) \mu_T(x)\; dx\\
		&= \frac{r_{m+1}^d l_{m+1}^{-d}}{N_{m+1}^d} = 1.
	\end{split}
	\end{equation}
	%
	For all but $O_d(r_{m+1}^{-d})$ indices $i$, $\nu_i = 0$ almost surely. Thus we can apply the triangle inequality together with \eqref{equation491040912491} and \eqref{9921490124912} to conclude that
	%
	\begin{equation} \label{equation42214124124102412}
	\begin{split}
		\| \nu_S(\RR^d) - 1 \|_{L^\infty} &= \| \sum\nolimits_{i \in \Pi_{m+1}^d} \left[ \nu_i(\RR^d) - \EE(\nu_i(\RR^d)) \right] \|_{L^\infty} \\
		&\leq \sum\nolimits_{i \in \Pi_{m+1}^d} \| \nu_i(\RR^d) - \EE(\nu_i(\RR^d)) \|_{L^\infty}\\
		&\lesssim_d r_{m+1}^{-d} r_{m+1}^{d+1} \| \nabla \mu \|_{L^\infty(\RR^d)}\\
		&= r_{m+1} \| \nabla \mu \|_{L^\infty(\RR^d)}.
	\end{split}
	\end{equation}	
	%
    Thus if \eqref{equation1095121284102} and \eqref{equation5890129048128941891} hold for appropriately chosen constants, we can apply \eqref{equation42214124124102412} to conclude $\| \nu_S(\RR^d) - 1 \|_{L^\infty} \leq 1/2$, or, in other words, that it is almost surely true that
    %
    \begin{equation} \label{equation86912904129041290}
        1/2 \leq \nu_S(\RR^d) \leq 3/2.
    \end{equation}
    %
    This means normalizing this measure to a probability measure is neglible to the asymptotics we consider.

	For each $i \in \Pi_{m+1}^d$, let
	%
	\[ S_i = \bigcup \{ Q \in \DQ_{m+1}^d: \nu_i(Q) > 0 \}. \]
	%
	Then $S = \bigcup_{i \in \Pi_{m+1}^d} S_i$. Because $j_i$ is selected uniformly from $[N_{m+1}]^d$ for each $i$, for any $j \in [N_{m+1}]^d$,
    %
    \begin{equation} \label{equation129412904912090}
        \PP(j_i = j) = N_{m+1}^{-d}.
    \end{equation}
    %
    Since $\psi_{m+1}$ is supported on $[-l_{m+1},l_{m+1}]^d$,
	%
	\[ S_i \subset \bigcup \{ R_{i_0} : R_{i_0} \cap R_i \neq \emptyset \}. \]
	%
	For any cube $Q_{ij} \in \Sigma_{m+1}^d$, there are $O_d(1)$ pairs $(i_0,j_0)$ such that $Q_{i_0j_0} \cap Q_{ij} \neq \emptyset$, and so a union bound together with \eqref{equation129412904912090} gives
	%
    \begin{equation} \label{equation5901490129129012409}
        \PP(Q_{ij} \in \DQ_{m+1}(S)) \leq \sum\nolimits_{Q_{i_0j_0} \cap Q_{ij} \neq \emptyset} \PP(j_{i'} = j') \lesssim_d N_{m+1}^{-d}.
    \end{equation}
	%
	Without loss of generality, removing cubes from $B$ if necessary, we may assume all cubes in $B$ are strongly non-diagonal. Let $Q = Q_{i_1j_1} \times \dots \times Q_{i_nj_n} \in \DQ_{m+1}(B)$ be such a cube. Since $Q$ is strongly diagonal, the events $\{ Q_{i_kj_k} \in S \}$ are independent from one another, which together with \eqref{equation5901490129129012409} implies that
	%
    \begin{equation} \label{equation190589012590812892189}
	   \PP(Q \in \DQ_{m+1}(S^n)) = \PP(Q_{i_1j_1} \in S) \dots \PP(Q_{i_nj_n} \in S) \lesssim_{d,n} N_{m+1}^{-dn}.
    \end{equation}
	%
	Taking expectations over all cubes in $B$, and applying \eqref{equation1290419204912090120912} and \eqref{equation190589012590812892189} gives
	%
    \begin{equation} \label{equation129041289589128921891289}
	\begin{split}
		\EE(\#(\DQ_{m+1}(B) \cap \DQ_{m+1}(S^n))) &\lesssim_{d,n} \#(\DQ_{m+1}(B)) \cdot N_{m+1}^{-dn}\\
		&\leq l_{m+1}^{-(s + \varepsilon)} N_{m+1}^{- dn}\\
		&= \frac{M_{m+1}^{s + \varepsilon} l_m^{-(s + \varepsilon)}}{N_{m+1}^{dn - s - \varepsilon}}.
	\end{split}
    \end{equation}
    %
    If \eqref{equation5890129048128941891} holds, for an appropriately chosen constant depending only on $l_m, d, n$, and $s$, we can apply Markov's inequality together with \eqref{equation129041289589128921891289} to conclude
    %
    \begin{equation} \label{fourierdim2}
    \begin{split}
        \mathbf{P}(\DQ_{k+1}(B) \cap \DQ_{k+1}(S^n) \neq \emptyset) &= \mathbf{P}(\# (\DQ_{k+1}(B) \cap \DQ_{k+1}(S^n)) \geq 1)\\
        &\leq \EE(\#(\DQ_{m+1}(B) \cap \DQ_{m+1}(S^n)))\\
        &\leq 1/N_{m+1}^\varepsilon \leq 1/10.
    \end{split}
    \end{equation}
    %
    Thus $\DQ_{k+1}(S^n)$ is disjoint from $\DQ_{k+1}(B)$ with high probability.

    Now we analyze the Fourier transform of the measure $\nu$. For each $i \in \Pi_{m+1}^d$, and $m \in \ZZ$, define $X_{im} = \widehat{\nu_i}(m) - \widehat{\EE(\nu_i)}(m)$. Applying \eqref{equation50914902149012} gives 
    %
    \begin{equation} \label{equation891248921894128942189}
    \begin{split}
        \sum_{i \in \Pi_{m+1}^d} \widehat{\EE(\nu_i)}(m) &= \sum_{i \in \Pi_{m+1}^d} l_{m+1}^d \sum_{j \in [N_{m+1}]^d} \int_{\RR^d} e^{- 2 \pi i m \cdot x} \psi_{m+1}(x - a_{ij}) d\mu_T(x)\\
        &= \int_{\RR^d} e^{-2 \pi i m \cdot x} d\mu_T(x) = \widehat{\mu_T}(m).
    \end{split}
    \end{equation}
    %
    For each $i$ and $m$, the standard $(L^1,L^\infty)$ bound on the Fourier transform, combined with \eqref{equation491040912491}, shows
    %
    \begin{equation} \label{equation12904912049012}
    \begin{split}
        \psitwo{X_{im}} &\leq \| X_{im} \|_{L^\infty}\\
        &\leq \| \nu_i(\RR^d) \|_{L^\infty} + \EE(\nu_i)(\RR^d)\\
        &\lesssim_d \EE(\nu_i)(\RR^d) + r_{m+1}^{d+1} \| \nabla \mu_T \|_{L^\infty(\RR^d)}.
    \end{split}
    \end{equation}
    %
    For a fixed $m$, the family of random variables $\{ X_{im} \}$ are independent. Furthermore, $\sum X_{im} = \widehat{\nu}(m) - \widehat{\EE(\nu)}(m)$, and furthermore, \eqref{equation990249012409129041290} and \eqref{equation129412904912090} imply that
    %
    \begin{equation} \label{equation19241902490129021}
    \begin{split}
        \EE(\widehat{\nu_S}(m)) &= \frac{r_{m+1}^d}{N_{m+1}^d} \int_{\RR^d} e^{-2 \pi i m \cdot x} \left( \sum_{(i,j) \in \Sigma_{m+1}^d} \psi_{m+1}(x - a_{ij}) \right) d\mu_T(x)\\
        &= \frac{r_{m+1}^d l_{m+1}^{-d}}{N_{m+1}^d} \int_{\RR^d} e^{-2 \pi i m \cdot x} d\mu_T(x)\\
        &= \frac{r_{m+1}^d l_{m+1}^{-d}}{N_{m+1}^d} \widehat{\mu_T}(m) = \widehat{\mu_T}(m).
    \end{split}
    \end{equation}
    %
    Hoeffding's inequality, together with \eqref{equation12904912049012} and \eqref{equation19241902490129021}, imply that
    %
    \[ \psitwo{\widehat{\nu}(m) - \widehat{\mu_T}(m)} \lesssim_d \left( \sum \EE(\nu_i)(\RR^d)^2 \right)^{1/2} + r_{m+1}^{d/2+1} \| \nabla \mu_T \|_{L^\infty(\RR^d)}. \]
    %
    Now taking in absolute values into the definition of $\nu_i$ gives
    %
    \begin{align*}
        \EE(\nu_i)(\RR^d) &= l_{m+1}^d \sum_{j \in [N_{m+1}]^d} \int \psi_{m+1}(x - a_{ij}) d\mu_T(x)\\
        &\leq r_{m+1}^d \| \mu_T \|_{L^\infty(\RR^d)}.
    \end{align*}
    %
    Applying \eqref{equation491040912491} shows 
    %
    \begin{equation} \label{equation10491204901290}
        \psitwo{\widehat{\nu}(m) - \widehat{\mu_T}(m)} \lesssim_d [\| \mu_T \|_{L^\infty(\RR^d)} + \| \nabla \mu_T \|_{L^\infty(\RR^d)}] r_{m+1}^{d/2}.
    \end{equation}
    %
    We can then apply a union bound over $D = \{ m \in \ZZ^d : |m| \leq 10 l_{m+1}^{-1} \}$ together with \eqref{equation10491204901290} to conclude that there exists a constant $c(\mu_T,d)$ such that
    %
    \begin{equation} \label{equation1290421941021290}
    \begin{split}
        \PP \left(\| \widehat{\nu} - \widehat{\mu_T} \|_{L^\infty(D)} \geq r_{m+1}^{d/2} \log(M_{m+1}) \right) &\lesssim_d l_{m+1}^{-d} \exp \left( - c(\mu_T,d) \log(M_{m+1})^2 \right).
    \end{split}
    \end{equation}
    %
    If \eqref{equation5890129048128941891} holds, for an appropriately chosen constant depending only on $l_m, d, n$, and $s$, then \eqref{equation1290421941021290} implies
    %
    \[ \PP \left(\| \widehat{\nu} - \widehat{\mu_T} \|_{L^\infty(D)} \right) \leq 1/10. \]
    %
    Thus $\widehat{\nu}$ and $\widehat{\mu_T}$ are highly like to differ only by a miniscule amount over small frequencies.

    Finally, it suffices to analyze the values of $\widehat{\nu_S}(m)$ when $|m| \geq 10 l_{m+1}^{-1}$. If we define a random measure
    %
    \[ \alpha = r_{m+1}^d \sum\nolimits_{\substack{i \in \Pi_{m+1}^d\\d(a_i,T) \leq 2 r_{m+1}^{-1}}} \delta_{a_{ij_i}}, \]
    %
    then $\nu_S = (\alpha * \psi_{m+1}) \mu_T$.
    %Since $\mu_T$ is supported on $T$, we can really truncate the sum defining $\eta$ to $O_d(r_{m+1}^{-d})$ terms such that the convolution identity remains valid.
    Thus we have $\widehat{\nu_S} = (\widehat{\alpha} \cdot \widehat{\psi_{m+1}}) * \widehat{\mu_T}$. Since $\mu_T$ is compactly supported, we can define, for each $t > 0$,
    %
    \[ A(t) = \sup |\widehat{\mu_T}(\xi)| |\xi|^t < \infty. \]
    %
    In light of \eqref{equation12901902419209012}, if we define, for each $t > 0$,
    %
    \[ B(t) = \sup |\widehat{\psi}(\xi)| |\xi|^t, \]
    %
    then
    %
    \[ \sup |\widehat{\psi_{m+1}}(\xi)| |\xi|^t = l_{m+1}^{-t} B(t). \]
    %
    It now suffices to bound
    %
    \[ \sup_{|\eta| \geq 10 l_{m+1}^{-1}} |\eta|^{s/2} \int \widehat{\mu_T}(\eta - \xi) \widehat{\alpha}(\xi) \widehat{\psi_{m+1}}(\xi)\; d\xi. \]
    %
    The measure $\alpha$ is the sum of at most $2^d r_{m+1}^{-d}$ delta functions, we have $\alpha(\RR^d) \leq 2^d$, so $\| \widehat{\alpha} \|_{L^\infty(\RR^d)} \leq 2^d$, so it suffices to bound
    %
    \[ \int |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi. \]
    %
    If $|\xi| \leq |\eta|/2$, $|\eta - \xi| \geq |\xi|/2$, so for all $t > 0$, and combined with the fact that $\| \widehat{\psi_{m+1}} \|_{L^\infty(\RR^d)} \leq 1$, we find
    %
    \[ \int_{0 \leq |\xi| \leq |\eta|/2} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi \leq \frac{A(t) 2^{t-d}}{|\eta|^{t-d}}. \]
    %
    If we set $t = d + 1 + s/2$ and apply \eqref{equation5890129048128941891} for an appropriate chosen constant depending only on $d$ and $\mu_T$, we conclude
    %
    \[ \int_{0 \leq |\xi| \leq |\eta|/2} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi \leq \frac{A(d + 1 + s/2) 2^{1 + s/2} |\eta|^{-1}}{|\eta|^{s/2}} \leq \frac{|\eta|^{-s/2}}{10 \cdot 2^d}. \]
    %
    Conversely, if $|\xi| \geq 2|\eta|$, then $|\eta - \xi| \geq |\xi|/2$, so for each $t > 0$,
    %
    \begin{align*}
        \int_{|\xi| \geq 2|\eta|} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi}_{m+1}(\xi)|\; d\xi &\leq \int_{|\xi| \geq 2|\eta|} \frac{A(t) 2^t}{|\xi|^t}\\
        &\lesssim_d \int_{2|\eta|}^\infty r^{d - t} A(t) 2^t.
    \end{align*}
    %
    Provided $t > d + 1$, this integral is finite, and is
    %
    \[ \lesssim_{d,t} A(t) 2^{d + 1} |\eta|^{d + 1 - t}. \]
    %
    Setting $t = d + 2 + s/2$, and applying \eqref{equation5890129048128941891}, we conclude
    %
    \[ \int_{|\xi| \geq 2|\eta|} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi}_{m+1}(\xi)|\; d\xi \leq \frac{|\eta|^{-s/2}}{10 \cdot 2^d}. \]
    %
    Finally, if $t > 0$, we use the fact that $\| \widehat{\mu_T} \|_{L^\infty(\RR^d)} \leq 1$ to conclude that
    %
    \begin{align*}
        \int_{|\eta|/2 \leq |\xi| \leq 2|\eta|} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi &\leq \frac{2^{d+t} B(t)}{|\eta|^{t-d}}.
    \end{align*}
    %
    If we set $t = d + s/2 + 1$ and apply \eqref{equation5890129048128941891}, we conclude
    %
    \[ \int_{|\eta|/2 \leq |\xi| \leq 2|\eta} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi \leq \frac{|\xi|^{-s/2}}{10 \cdot 2^d}. \]
    %
    Summing up the three bounds, we conclude that if $|\eta| \geq 10 l_{m+1}^{-1}$, then
    %
    \[ |\widehat{\nu_S}(\eta)| \leq |\eta|^{-s/2}. \]
    %
    Thus, almost surely, $\widehat{\nu_S}(\eta)$ has fast Fourier decay for $|\eta| \geq 10 l_{m+1}^{-1}$.

    Let us put all our calculations together.
\end{proof}

\end{document}