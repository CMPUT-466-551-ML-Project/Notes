\input{../style.tex}

\title{Modular Forms}
\author{Jacob Denson}

\begin{document}

\pagenumbering{gobble}

\maketitle

\tableofcontents

\pagenumbering{arabic}

\chapter{Modular Forms}

Modular forms is an interesting field where one meets deep ideas, intwined with the concrete mathematics of combinatorics and number theory. At the core, the theory of modular forms the relation between two ideas.
%
\begin{itemize}
    \item Functions on the upper half plane $\mathbf{H}$, which are invariant under an infinite group of symmetries known as M\"{o}bius transformations.
    \item Certain infinite series, known as `$q$-expansions', of the form
    %
    \[ \sum_{k = -\infty}^\infty a_k q^k \]
    %
    where $q = e^{2 \pi i z}$ connects the convergence of the series in $\mathbf{D}$ to a function in the upper half plane.
\end{itemize}
%
The first viewpoint gives us deep viewpoints into the theory, whereas the second gives us very useful applications in number theory, combinatorics, and particle physics. For instance, these forms occur when counting curves in algebraic geometry, or when understanding the dimensions of finite simple groups. Because they occur so often in mathematics, the number theorist Joseph Eichler has been told to have said that there are five fundamental arithmetical operations -- addition, subtraction, multiplication, division, and modular forms. We begin by examining in detail the symmetries which characterize modular forms, and then we explore how modular forms arise, and the most fundamental examples.

\section{Geometry of the Upper Half Plane}

The nicest holomorphic functions on $\mathbf{C}^\infty$ are the M\"{o}bius transformations, obtained via an action from $GL_2(\mathbf{C})$ by the map
%
\[ \begin{pmatrix} a & b \\ c & d \end{pmatrix}(z)  = \frac{az + b}{cz + d} \]
%
\[ \begin{pmatrix} a & b \\ c & d \end{pmatrix}(\infty) = \lim_{z \to \infty } \frac{az + b}{cz + d} = \frac{a}{c} \]
%
The restriction that the matrix is invertible is required in order to prevent the transformations from reducing to a constant. The kernel of this representation is $K = \mathbf{C} - \{ 0 \}$. Indeed, the constraint that $(az + b)(cz + d)^{-1} = z$ for all $z$ can be expressed in terms of the triviality of the polynomial $cz^2 + (d-a)z - b$, so that $c = b = d-a = 0$. Performing a quotient, we obtain the group $PGL_2(\mathbf{C}) = GL_2(\mathbf{C})/K$, which now acts faithfully on $\mathbf{C}^\infty$. It is a scale invariant version of the general linear group.

Modular forms arise from a study of the actions of certain M\"{o}bius transformations on the hyperbolic plane. We shall take the upper half of the complex plane, denoted $\mathbf{H}$, as our model, whose `straight lines' consist of circular arcs passing through the origin. The biholomorphisms of $\mathbf{H}$ are exactly the M\"{o}bius transformations obtained from matrices in $GL_2(\mathbf{R})$ with positive determinant, and can therefore be described as the image of $SL_2(\mathbf{R})$ in $PGL_2(\mathbf{C})$, denoted $PSL_2(\mathbf{R})$ and called the projective special linear group. We calculate
%
\begin{align*}
    \Im \left( \frac{az + b}{cz + d} \right) &= \frac{\Im[(az + b)(c\overline{z} + d)]}{|cz + d|^2}\\
    &= \frac{(ad - bc)}{|cz + d|^2} \Im(z)
\end{align*}
%
Thus if $ad - bc > 0$, the matrix maps the upper half plane to itself. We shall, perhaps by a little notational abuse, denote an element of $PSL_2(\mathbf{R})$ as an ordinary matrix, even though elements of the group are really cosets. Note that the kernel of $SL_2(\mathbf{R})$ under the M\"{o}bius transformation representation is only $\{ \pm 1 \}$, so two matrices have equal actions on the Riemann sphere if and only if they can be obtained from one another by negation.

We define the modular group $\Gamma = PSL_2(\mathbf{Z})$ to be the discrete counterpart of the projective special linear group, the set of matrices in $PSL_2(\mathbf{R})$ with integer coefficients. We can understand the structure of $\Gamma$ via it's action on $\mathbf{H}$. One such way is to determine the equivalence classes of the orbits of $\Gamma$. A {\bf fundamental region} of a group action on $\mathbf{C}$ is a subset $D \subset \mathbf{H}$ which contains a point in every orbit, which is unique to that orbit, except perhaps if it is on the boundary of $D$. Then $D$ `represents' the group action in some fashion, by paramaterizing it's orbit space. Perhaps the most `fundamental' fundamental region is the set
%
\[ D = \{ z \in \mathbf{H} : |z| \geq 1, |\Re(z)| \leq 1/2 \} \]
%
which is a fundamental region over $\Gamma$. The region transforms nicely under two important matrices
%
\[ S = \begin{pmatrix} 0 & -1 \\ +1 & 0 \end{pmatrix}\ \ \ \ \ \ \ \ \ \ T = \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix} \]
%
which induce the maps $z \mapsto -1/z$ and $z \mapsto z + 1$ on $\mathbf{H}$.

\begin{theorem}
    Let $D$ be the region described above.
    %
    \begin{enumerate}
        \item For any $z \in \mathbf{H}$, there is $M \in \Gamma$ for which $Mz \in D$.
        \item If $Mz = w$, and $z,w \in D$, then $z$ and $w$ both occur on the boundary of $D$ and are obtained from each other by reflection in the $y$ axis.
        \item For each $z$, the stabilizers $\Gamma_z$ are trivial except that
        %
        \begin{align*}
            \Gamma_i &= \{ 1, S \}\\
            \Gamma_{e^{\pi i/3}} &= \{ 1, ST, (ST)^2 \}\\
            \Gamma_{e^{2 \pi i/3}} &= \{ 1, TS, (TS)^2 \}
        \end{align*}
    \end{enumerate}
\end{theorem}
\begin{proof}
    Let $G = \langle S,T \rangle$. If $D$ really was a fundamental region, then we could identify the point in $D$ corresponding to each orbit $\Gamma x$ by taking the point in the strip $|\Re(z)| < 1$ such that $|\Im(\Gamma x)|$ is maximized. Since
    %
    \[ \Im(Mz) = \frac{\Im(z)}{|cz+d|^2} \]
    %
    Maximizing $\Im(Mz)$ is equivalent to minimizing $|cz + d|$. For each $M$, there are only finitely many matrices with $|cz + d| < M$. We have
    %
    \[ |cz + d| \geq \Im(z) |c|\ \ \ \ \ \ \ \ \ \ |cz + d| \geq |c \Re(z) + d| \geq |d| - |c \Re(z)| \]
    %
    There are only finitely many integers $c$ for which $\Im(z) |c| < M$, and therefore only finitely many values of $d$ for which $|d| - |c \Re(z)| < M$. Let $M$ maximize the value of $\Im(z)$. Without loss of generality, we may assume $|\Re(Mz)| < 1/2$, for otherwise we may apply $T$ multiple times to transport $Mz$ onto this strip, without changing the imaginary part. If $|Mz| < 1$, then
    %
    \[ \Im(SMz) = \frac{\Im(Mz)}{|Mz|^2} > \Im(Mz) \]
    %
    contradicting the maximality of $M$, so $Mz \in D$, and we have proved (i).

    Now suppose that for $z,w \in D$,
    %
    \[ Mz = \frac{az + b}{cz + d} = w \]
    %
    We may assume $\Im(w) \geq \Im(z)$. Since
    %
    \[ \Im(w) = \frac{\Im(z)}{|cz + d|^2} \]
    %
    $|cz + d| \leq 1$. Because $z \in D$, $\Im(z) \geq \sqrt{1/2}$, so $|c| \leq \sqrt{2} < 2$, and we can split the proof into two cases ($c = \pm 1$ or $c = 0$):

    \begin{itemize}
        \item First assume $c = 0$. Then
        %
        \[ M = \begin{pmatrix} a & b \\ 0 & a^{-1} \end{pmatrix} \]
        %
        since $a$ and $a^{-1}$ are integers, we must have $a = \pm 1$, and we might as well let $a = 1$, since $M = - M$ in $PSL_2(\mathbf{R})$. Then
        %
        \[ w = z + b \]
        %
        Now $|b| = |\Re(z-w)| \leq 1$, so either $b = 0$, and $w = z$, $b = 1$, and $w = z + 1$, or $b = -1$, and $w = z - 1$.

        \item Assume $c = 1$ (if $c = -1$, replace $M$ with $-M$). We must have
        %
        \[ |z + d|^2 = \Im(z)^2 + (\Re(z) + d)^2 \leq 1 \]
        %
        One possibility is that $d = 0$, so that $z \in \partial D \cap S^1$. Because
        %
        \[ M = \begin{pmatrix} a & -1 \\ 1 & 0 \end{pmatrix} \]
        %
        $w = a - 1/z$. Now $-1/z \in D$ is also on the unit circle, so either $a = 0$, and $w = -1/z$, which is a just a reflect in the $y$ axis, $a = 1$, $z = e^{i\pi/3}$, $w = z$, and $M = ST$, or $a = -1$, $z = e^{2i\pi/3}$, $w = z$, and $M = S^{-1}T = (TS)^2$.

        If $d = 1$, then
        %
        \[ M = \begin{pmatrix} a & a-1 \\ 1 & 1 \end{pmatrix} \]
        %
        So
        %
        \[ w = \frac{az + (a-1)}{z + 1} = a - \frac{1}{z+1} \]
        %
        Now $|z+1| \geq 1$ if $z \in D$, so $|\frac{1}{z+1}| \leq 1$, and $a - \frac{1}{z+1}$ is in $D$ if and only if $a = 0$, $z = e^{2\pi i/3}$, $w = z$, and $M = TS$. If $a = 1$, $- \frac{1}{z+1} = e^{2\pi i/3}$, so $z = e^{2 \pi i/3}$, and $w = e^{\pi i/3}$. If $a = -1$, $- \frac{1}{z+1} = e^{\pi i/3}$, which implies $z = e^{2 \pi i/3} - 1 \not \in D$.

        Finally, let $d = -1$. Then
        %
        \[ M = \begin{pmatrix} a & -(1 + a) \\ 1 & -1 \end{pmatrix} \]
        %
        so
        %
        \[ w = \frac{az - (1+a)}{z-1} = a - \frac{1}{z-1} \]
        %
        As before, $|z-1| \geq 1$ if $z \in D$, so $|\frac{1}{z-1}| \leq 1$. Either $a = 0$, in which case $|z-1| = 1$, so $z = w = e^{\pi i/3}$, $M = TS^{-1} = (ST)^2$, or $a = 1$, in which case $\frac{-1}{z-1} = e^{2\pi i/3}$, implying $z = e^{2\pi i/3}$, $w = e^{\pi i/3}$, or $a = -1$, in which case $\frac{-1}{z-1} = e^{\pi i/3}$, which would imply $z = e^{2\pi i/3} - 1 \not \in D$.
    \end{itemize}
    %
    We have addressed all cases, which shows that (ii) and (iii) hold.
\end{proof}

\begin{corollary}
    $PSL_2(\mathbf{Z})$ is generated by $S$ and $T$.
\end{corollary}
\begin{proof}
    Given $M \in PSL_2(\mathbf{Z})$ pick $z$ in the interior of $D$, and let $w = M z$. We have verified in the above proof that there is $N \in \langle S, T \rangle$ for which $Nw \in D$, and since the orbit is unique on the interior of $D$, $MNz = z$. But then $MN \in \Gamma_z = \{ I \}$, so $N = M^{-1}$, and so $M \in \langle S, T \rangle$.
\end{proof}

If we look at the non-coset counterparts, we find $SL_2(\mathbf{Z})$ is also generated by $S$ and $T$, because $(ST)^3 = -I$. If $M \in SL_2(\mathbf{Z})$ is arbitrary, then either $M$ or $-M$ is in $\langle S ,T \rangle$, and regardless, we find $M \in \langle S, T \rangle$ because the space is closed under negation.

\section{The Integral Special Linear Group}

We now take a general look at $SL_2(\mathbf{Z})$, which will be profitable later. We have shown that $SL_2(\mathbf{Z})$ can be described by the relations
%
\[ SL_2(\mathbf{Z}) = \langle S, T : S^4 = (ST)^6 = 1 \rangle \]
%
It is natural to look at the finite index subgroups of $SL_2(\mathbf{Z})$, as for other groups. The easiest way to find them is by considering the reduction of coefficients modulo some integer $n$, obtaining a group homomorphism from $SL_2(\mathbf{Z}) \to SL_2(\mathbf{Z}_n)$.

\begin{theorem}
    The canonical reduction from $SL_2(\mathbf{Z})$ to $SL_2(\mathbf{Z}_n)$ is surjective.
\end{theorem}
\begin{proof}
    Take a matrix $\left( \begin{smallmatrix} a & b \\ c & d \end{smallmatrix} \right)$ with $ad - bc \equiv 1$ (mod $n$). Using the Chinese remainder theorem, defining $d = a/\gcd(a,n)$ we may find $b'$ such that
    %
    \[ b' \equiv 1\ (\text{mod}\ d)\ \ \ \ \ \ \ b' \equiv b\ (\text{mod}\ n) \]
    %
    we then claim that $b'$ is relatively prime to $a$. Indeed any prime dividing $d$ cannot divide $b'$, and if a prime $p$ divides $a$ and $n$, then from the equation $ad - b'c \equiv 1$ (mod $n$) we find that $- b'c \equiv 1$ (mod $p$), so $b'$ is invertible mod $p$, and hence $p$ does not divide $b'$. Thus we may assume that $a$ and $b$ are relatively prime from the getgo. Suppose that $ax + by = 1$, and that $ad - bc = 1 + mn$. Then
    %
    \[ a(d - xmn) - b(c + ymn) = ad - bc - (ax + by)nm = 1 \]
    %
    so by replacing $d$ with $d - xmn$ and $c$ with $c + ymn$, we find a matrix in $SL_2(\mathbf{Z})$ equal to $\left( \begin{smallmatrix} a & b \\ c & d \end{smallmatrix} \right)$ modulo $n$.
\end{proof}

It follows that if we define $\Gamma(n)$ to be the kernel of the reduction of $SL_2(\mathbf{Z})$ modulo $n$, then $SL_2(\mathbf{Z})/\Gamma(n) \equiv SL_2(\mathbf{Z}_n)$. In particular, $SL_2(\mathbf{Z}_n)$ must be generated by at most two elements, since $SL_2(\mathbf{Z})$ is. What's more, the reduction maps from $SL_2(\mathbf{Z}_{nm})$ to $SL_2(\mathbf{Z}_n)$ are also verified to be surjective.

It is an interesting combinatorial problem to count the number of elements in $GL_2(\mathbf{Z}_n)$. Since $SL_2(\mathbf{Z}_n)$ has index $\phi(n)$ in $GL_n(\mathbf{Z}_n)$, the counting problems over the two groups are equivalent. Since $M_n(Q \times R) \cong M_n(Q) \times M_n(R)$, and if $n = p_1^{n_1} \dots p_m^{n_m}$, then $\mathbf{Z}_n \cong \mathbf{Z}_{p_1^{n_1}} \dots \mathbf{Z}_{p_m^{n_m}}$, it suffices to count $GL_2(\mathbf{Z}_{p^n})$ where $p$ is a prime number. It is easiest to count $GL_2(\mathbf{Z}_p)$, since $\mathbf{Z}_p$ is a field. In this case, $GL_2(\mathbf{Z}_p)$ consists of ordered bases $(v,w)$, with $v,w \in \mathbf{Z}_p^2$. In this case, there are $p^2 - 1$ choices for $v$ (the number of nonzero vectors in $\mathbf{Z}_p^2$), and then $p^2 - p$ choices for $w$ after choosing $v$ (the number of vectors not in the span of $v$). Thus
%
\[ \#[GL_2(\mathbf{Z}_p)] = (p^2 - 1)(p^2 - p)\ \ \ \ \ \ \ \ \#[SL_2(\mathbf{Z}_p)] = p (p^2 - 1) \]
%
Consider the reduction from $GL_2(\mathbf{Z}_{p^n})$ to $GL_2(\mathbf{Z}_p)$. The kernel consists of the matrices
%
\[ \begin{pmatrix} 1 + pa & pb \\ pc & 1 + pd \end{pmatrix} \]
%
where $a,b,c,d$ are arbitrary integers modulo $p^n$. There are $p^{n-1}$ different choices for each integer, so that the kernel contains $p^{4(n-1)}$ different matrices. Thus
%
\[ \#[GL_2(\mathbf{Z}_{p^n})] = (p^2 - 1)(p^2 - p) p^{4(n-1)}\ \ \ \ \#[SL_2(\mathbf{Z}_{p^n})] = (p^2 - 1)p^{3(n-1) + 1} \]
%
Thus the number of matrices in the general linear group $GL_2(\mathbf{Z}_n)$ grows only slightly faster than $n^4$.

\section{Congruence Subgroups}

An important family of subgroups of $\Gamma$ are the principal congruence subgroups
%
\[ \Gamma(N) = \left\{ \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \Gamma : a \equiv d \equiv 1, b \equiv c \equiv 0\ \ \text{modulo N} \right\} \]
%
The group is the kernel of the homomorphism obtained by reducing the integer coefficients of elements of $\Gamma$ modulo $N$, giving us the exact sequence
%
\[ 0 \to \Gamma(N) \to \Gamma \to PSL_2(\mathbf{Z}_n) \to 0 \]
%
A congruence subgroup of $\Gamma$ is one which contains a principal congruence subgroup. Two important examples are
%
\[ \Gamma_0(N) = \left\{ \begin{pmatrix} a & b \\ c & d \end{pmatrix} : c \equiv 0\ \text{modulo}\ N \right\} \]
\[ \Gamma_1(N) = \left\{ \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \Gamma_0(N) : a \equiv d \equiv 1\ \text{modulo}\ N \right\} \]
%
The matrices of $\Gamma_1(N)$, when reduced modulo $N$, are written in the form
%
\[ \begin{pmatrix} 1 & a \\ 0 & 1 \end{pmatrix} \]
%
and the reduced $\Gamma_0(N)$ are the upper triangle matrices modulo $N$.

Using the combinatorics we developed over $SL_2(\mathbf{Z})$, we can count the indices of the various congruence subgroups in $\Gamma$. For instance, note that if $n \neq 2$, then $I \neq -I$, and so
%
\[ [\Gamma: \Gamma(N)] = |PSL_2(\mathbf{Z}_n)| = \frac{1}{2} |SL_2(\mathbf{Z}_n)| \]
%
However, $|PSL_2(\mathbf{Z}_2)| = |SL_2(\mathbf{Z}_2)|$, so $[\Gamma: \Gamma(2)] = |SL_2(\mathbf{Z}_2)| = 6$. We have a formula to calculate $|SL_2(\mathbf{Z}_n)|$, so we can calculate $[\Gamma: \Gamma(N)]$ in essentially the same way. The indices here will tell us the number of `cusps' in the fundamental domains of these congruences groups (For instance $[\Gamma, \Gamma] = 1$, so the standard fundamental domain has only one cusp at $\infty$).

As we work with fewer and fewer elements of $\Gamma$, the action of $\Gamma$ on $\mathbf{H}$ gets weaker and weaker, and the fundamental domain gets larger and larger. As an example, let's compute the fundamental domain of $\Gamma(2)$. The index of $\Gamma$ in $\Gamma(2)$ is easily computed to be
%
\[ [\Gamma: \Gamma(2)] = |PSL_2(\mathbf{Z}_2)| = |SL_2(\mathbf{Z}_2)| = 6 \]
%
Thus we may write $\Gamma = \bigcup_{i = 1}^6 M_i \Gamma(2)$ as the disjoint union of cosets, for some $M_i \in \Gamma$. We can choose these $M_i$ to be
%
\[ M_1 =  \begin{pmatrix} 1 & 0 \\ 0 & 1 \end{pmatrix}\ \ \ \ M_2 =  \begin{pmatrix} 1 & 1 \\ 0 & 1 \end{pmatrix}\ \ \ \ M_3 =  \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix} \]
\[ M_4 =  \begin{pmatrix} 1 & -1 \\ 1 & 0 \end{pmatrix}\ \ \ \ M_5 =  \begin{pmatrix} 0 & -1 \\ 1 & 1 \end{pmatrix}\ \ \ \ M_6 =  \begin{pmatrix} 0 & -1 \\ 1 & 0 \end{pmatrix} \]
%
The elements must be in different cosets, since these elements differ modulo $2$. It then follows that we have a fundamental domain
%
\[ D_2 = \bigcup_{i = 1}^6 M_i^{-1} D \]
%
Certainly it contains a point in every orbit. It remains to check that repeated points occur only on the boundary, but I think it's pretty tedious to check this so I'll `leave it for the reader'. The points $0$, $1$, and $\infty$ are known as cusps, for they are places where the fundamental domain can `go off to infinity'. $D$ only has one cusp, the one at $\infty$.

\section{The Modular Curve}

The fundamental domain of a congruence subgroup $G$ of $\Gamma$ allows us to understand the topology of $\mathbf{H}/G$ in greater detail. The space $\mathbf{H}/G$ is denoted $Y(G)$, and known as the {\bf modular curve} of the group $G$. Our first statement should be obvious -- since $\Gamma$ acts on $\mathbf{H}$ discretely, any two points in $z,w \in \mathbf{H}$ not identified in $Y(G)$ have neighbourhoods $z \in U$ and $w \in W$ such that $MU$ and $NW$ are disjoint, for any $M,N \in \Gamma$. This implies that $Y(G)$ is a Hausdorff topological space.

We would like to put an analytic structure on $Y(G)$, so that we can talk about holomorphic maps on the space. To do this, we need an atlas of mutually holomorphic coordinate maps. This is simple to do so, except at singularity points on $Y(G)$, which algebraically manifest themselves as points in $\mathbf{H}$ whose stabilizers with respect to the action of $G$ are nontrivial. Let us address the trivial case first.

If the stabilizer is trivial at a point $z$, we may select a compact neighbourhood $U$ of points all of whose stabilizer's are trivial, and then we notice that $U$ intersects only finitely many of its translates $M_1U ,\dots, M_nU$, because it is bounded a distance away from the real axis -- where the space `concentrates itself'. If we take a set $V_i$ of disjoint neighbuorhoods around each $M_iz$, transport them back to $z$, and then take the intersection to get a neighbourhood $V$, then we obtain a neighbourhood whose translates are disjoint. It then follows that $V$ projects injectively into $\mathbf{H}/G$, and this map is open so we have a local homeomorphism. They are mutually holomorphic, since in the inverse image the maps are just the maps $z \mapsto Mz$.

The problem with the points where the stabilizer is non-trivial is that the neighbourhoods are not locally injective here. Indeed, if $Mw = w$, then locally we identify points infinitely close to $w$ because
%
\[ M(w + M'(w)z) \approx w + M'(w)^{k+1}z \]
%
giving us a series of identifications around $w$ which imply no neighbourhood around $w$ can contained unique representatives of equivalence classes unless $M'(w) = 0$ (which only occurs when $M$ is trivial, because $M$ is a biholomorphic at every point on the Riemann sphere). In the case of the modular group, the map $z \mapsto -1/z$ fixes $i$, and locally acts like a rotation about 180 degrees, so every neighbourhood of $i$ contains duplicates of representatives of points in $Y(G)$. The neighbourhoods of $\omega$ and $\omega^2$ contain triplicates of points in the equivalence classes, and so locally the space around $\omega$ is $120^\circ$. We call such a point {\bf elliptic}.

There is another way to determine the topological structure around an elliptic point. We note that the stabilizer subgroups of points identified under $G$ are isomorphic, and in fact obtained from each other by conjugation. Provided that $G$ is normal in $\Gamma$ all the points identified by $\Gamma$ have the same stabilizer. Since the stabilizer subgroup with respect to $G$ is always contained in the stabilizer subgroup with respect to $\Gamma$, the stabilizer is always finite and cyclic. The cardinality gives us a sense of the `angle' of the quotient around the point.

This discussion allows us to place coordinate maps at elliptic points of $Y(G)$. Indeed, given a point $z$, with $Mz = z$, we can consider the M\"{o}bius transformation $N$ which maps $z$ to 0 and $\overline{z}$ to $\infty$. Since $M\overline{z} = \overline{z}$, $NMN^{-1}$ fixes 0 and $\infty$, so it is a composition of a rotation and a dilation. Since $NMN^{-1}$ has finite order, it must be a rotation by a commensurable angle. In fact, for the elliptic point $i$, $NMN^{-1}$ is just a rotation by $180^\circ$, and for $\omega$ and $\omega^2$, $NMN^{-1}$ is just a rotation by $120^\circ$. Thus if we consider the power map $f(z) = z^k$, for $k = 2,3$, $f \circ N$ is a continuous map which identifies points locally around the singularity if and only if they are identified in $Y(G)$. Thus $f \circ N$ decends to a map around the singularity point in $Y(G)$, which forms a coordinate chart. These maps remain mutually holomorphic with the maps we initially defined, because all in all transition maps will either be a power of a M\"{o}bius transform or a root of a M\"{o}bius transform. Thus $Y(G)$ is a Riemann surface.

The only deficiency of $Y(G)$ is that it is not compact -- we left out the action at $\infty$. We may remedy this by taking the space $\mathbf{H}^*/G$, where $\mathbf{H}^* = \mathbf{H} \cup \{ \infty \} \cup \mathbf{Q}$ is the half plane with `cusps' added. These rational points are necessary for the action of $G$ to be well defined on $\mathbf{H}^*$, because $\infty$ can be moved to every rational point. The stabilizer at $\infty$ is the same of all maps of the form $z \mapsto z + m$, where $m \in \mathbf{Z}$. The orbit space obtained is denoted $X(G)$, and is known as the {\bf compactified modular curve}.

The points addended to $Y(G)$ to form the compactification $X(G)$ are known as cusps. For instance, we only have one cusp for $G = \Gamma$, the point at $\infty$, whereas for the congruence subgroup considered before we have 3 cusps, $\infty, 0, 1$. Each modular curve has only finitely many cusps, precisely because $G$ has a finite index in $\Gamma$.

The only problem with this construction is that if we take the quotient topology on $X(G)$ from $\mathbf{H}^*/G$, there are simply not enough open sets in $\mathbf{H}^*/G$ to separate the rational points (which is obvious on the real line, since the rational points form a dense subset). Thus we define a new topological structure at the rational points and at $\infty$. First, we take the neighbourhoods of $\infty$ to be half spaces
%
\[ \{ \infty \} \cup \{ z : \Im(z) > M \} \]
%
We then ascribe a topological structure to the rational points by making the M\"{o}bius transforms homeomorphisms of $\mathbf{H}^*$. The half spaces are mapped conformally onto circles tangent to the rational point. We can then take the quotient topology on $X(G)$ relative to this topology, and now $X(G)$ is compact and Hausdorff.

To complete our discussion, we need only define analytic coordinate maps at the cusps. First, if we are analyzing a rational cusp $q$, we first consider an $M \in \Gamma$ which maps $q$ to $\infty$. We then define the width of $q$ to be the index of the group $MGM^{-1}$ in $\Gamma$. This is essentially dual to the period of an elliptic point. The period tells us the number of sectors of the disc surrounding an elliptic point that are identified in $Y(G)$. At a cusp, infinitely many sectors converge, but at $\infty$ these are straightened out to become vertical strips -- the width tells us how many vertical strips are distinct in the identification. If $q$ has width $h$, then we define the coordinate map $z \mapsto e^{2 \pi i M(z) / h}$ to be the chart at $q$.

\section{Modular Forms}

A meromorphic function $f: \mathbf{H} \to \mathbf{C}$ is {\bf weakly modular} of weight $k$ (where $k$ is an even integer) such that for any $M = \left(\begin{smallmatrix} a & b \\ c & d \end{smallmatrix}\right) \in \Gamma$,
%
\[ f(Mz) = (cz + d)^k f(z) \]
%
We assume $k$ is even, for if $k$ is odd $(cz + d)^k \neq (-(cz + d))^k$, and so there are no non-zero weight $k$ modular functions. Since
%
\begin{align*}
    M'(z) &= \left( \frac{az + b}{cz + d} \right) \left( \frac{a}{az + b} - \frac{c}{cz + d} \right)\\
    &= \left( \frac{az + b}{cz + d} \right) \frac{1}{(az + b)(cz + d)}\\
    &= \frac{1}{(cz + d)^2}
\end{align*}
%
we can write
%
\[ \frac{f(\phi(z))}{f(z)}  = (cz + d)^k = \phi'(z)^{-k/2} \]
%
which we see as a relation between differential forms.
%
\[ \phi_*(f dz^{k/2}) = (f \circ \phi) (\phi')^{k/2} dz^{k/2} = f dz^{k/2} \]
%
The structure theorem for $SL_2(\mathbf{Z})$ simplifies the verification of the transformation properties of weakly modular functions.

\begin{theorem}
    $f$ is weakly modular of weight $k$ if and only if
    %
    \[ f(z + 1) = f(z) \]
    \[ f(-1/z) = z^k f(z) \]
\end{theorem}
\begin{proof}
    Certainly the relations hold if $f$ is weakly modular. Conversely, suppose $f$ satisfies the relations, and define
    %
    \[ G = \left\{ \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in \Gamma : f\left(\frac{az + b}{cz + d}\right) = (cz + d)^k f(z) \right\} \]
    %
    Certainly $S, T$, and $T^{-1}$ are in $G$. If $M = \begin{pmatrix} a & b \\ c & d \end{pmatrix} \in G$ and $N = \begin{pmatrix} m & n \\ o & p \end{pmatrix}$, then
    %
    \[ MN = \begin{pmatrix} am + bo & an + bp \\ cm + do & cn + dp \end{pmatrix} \]
    %
    and we know
    %
    \[ f\left( MN(z) \right) = (cNz + d)^k f(Nz) = (cNz + d)^k (oz + p)^k f(z) \]
    %
    since
    %
    \[ (cNz + d)(oz + p) = d(oz + p) + c(mz + n) = (cm + do)z + (cn + dp) \]
    %
    so $MN \in G$. We conclude that all monomials in the variables $T, T^{-1}, S$ are in $G$. But all elements of $\Gamma$ are of this form, so $G = \Gamma$.
\end{proof}

A weakly modular function is periodic, so we may consider the map
%
\[ g(z) = e^{2 \pi i z} \]
%
which maps $\mathbf{H}$ holomorphically onto the punctured unit disk. We may then expand $f \circ g^{-1}$ at the origin in a Laurent series, leading to an expansion of $f$ of the form
%
\[ f(z) = \sum_{k = -\infty}^\infty a_kq^k \]
%
where $q = e^{2 \pi i z}$. If $f$ is meromorphic at $\infty$ (so that the coefficients $a_k$ vanish for $k$ small enough), it is a {\bf modular function} of weight $k$. If $f$ is actually holomorphic at $\infty$, so that $a_k = 0$ for $k < 0$, and is holomorphic on $\mathbf{H}$, then we call it a {\bf modular form}. If, even further, we have $a_0 = 0$, then we say that $f$ is a {\bf cusp form}, for then $f$ vanishes at $\infty$, and therefore at all cusps. We denote the set of modular forms, of weight $k$, by $M_k$, and the set of cusp forms by $S_k$ (the German word for a cusp form is a `spitzenform'). We note that holomorphicity at $\infty$ manifests as a growth condition $f(x + iy) = O(e^{Cy})$ for some $C > 0$, for then the corresponding function on $\mathbf{D}$ is, in polar coordinates, $O(r^{-C})$. If $f(x + iy) = O(e^{Cy})$ for all $C > 0$, then $f$ is actually bounded near $i \infty$, and so $f$ is a modular form.

To obtain a geometric picture, it is useful to add a point $\infty$ at infinity on $\mathbf{H}$. If we wish for the map $z \mapsto q$ to be a homeomorphism in $\mathbf{H} \cup \{ \infty \}$, we put a topology on $\mathbf{H}$ by saying $z_i \to \infty$ if $\Im(z_i) \to \infty$. Equivalently, the neighbourhoods of $\infty$ are sets of the form
%
\[ \{ z \in \mathbf{H} : \Im(z) > M \} \]
%
as $M$ ranges from $0$ to $\infty$. This is certainly different to the relative topology induced by the Riemann sphere (if we need to explicitly identify the topology, we often say that $z \to i \infty$ if $z$ converges to $\infty$ in the topology of the upper half plane. If we wish to analyze the effects of the M\"{o}bius group on this set, then we are forced to also consider all rational points, for these points comprise the orbit of $\infty$ under the modular group. If we now want to make the maps $\gamma \in \Gamma$ homeomorphisms, then we must let the neighbourhoods of each rational point be the images of the neighbourhoods of $\infty$. These are exactly the circles whose boundary cross through the rational number. These points are known as {\bf cusps}, and are the minimal number of points needed to compactify the orbit space of $\Gamma$, and still maintain a nice theory of modular forms. We can then compactify the fundamental region to $\overline{D} = D \cup \{ \infty \}$, which is now the fundamental region of $\Gamma$ over $\overline{\mathbf{H}}$.

The sets of modular functions, forms, and cusp-forms form complex vector spaces. In addition, if $f$ is a modular (function or form) of weight $k$, and $g$ modular of weight $k'$, then $fg$ is modular of weight $k + k'$, and if $g \neq 0$, $f/g$ modular of weight $k - k'$ ($g$ needs to have no zeroes in $\mathbf{H}$ for $f/g$ to be a modular form). In particular, we may consider the graded algebra $M_*$ of all modular forms (which is also a field), and the set $S_*$ of all cusp forms is an ideal.

\section{Eisenstein Series}

Here's a classical and very important family of modular forms.

\begin{lemma}
    For any $z,w \in \mathbf{C}$, the value
    %
    \[ G_s(z,w) = \sum_{(m,n) \neq 0} \frac{1}{|mz + nw|^s} \]
    %
    converges for $s > 2$.
\end{lemma}
\begin{proof}
    Formally, we have
    %
    \[ G_s(\lambda z, \lambda w) = \sum_{m,n = -\infty}^\infty \frac{1}{|\lambda m z + \lambda n w|^s} = \frac{G_s(L(z,w))}{|\lambda|^s} \]
    %
    so the convergence of the series for a particular value of $s$ is invariant under complex multiplication. This also shows that $G_s$ is a weakly modular of weight $s$, when $s$ is an even integer. Thus we may assume that we are summing over $(1,z)$. If we count the number of elements in the $k$'th `layer' of elements around the origin, we end up with $O(k)$ elements, and the value of $1/|m + nz|^s$ here is bounded above by $\min(1,|z|)^s/k^s = O(1/k^s)$. Thus
    %
    \[ \sum_{m,n = \infty}^\infty \frac{1}{|m + n z|^s} \leq O(1) \sum_{k = 1}^\infty \frac{1}{k^{s-1}} \]
    %
    which converges for $s - 1 > 1$, so $s > 2$. We can actually check that $G_s(z,w)$ converges absolutely if and only if $s > 2$ by analyzing the coefficients in the sequence more carefully.
\end{proof}

This series gives rise to an important modular form. We define
%
\[ G_k(z) = G_k(z,1) = \sum_{(n,m) \neq 0} \frac{1}{(mz + n)^{k}} \]
%
which converges absolutely for $k > 2$, and locally uniformly convergent, so that $G_k$ is holomorphic, and
%
\[ G_k(z + 1) = \sum_{(n,m) \neq 0} \frac{1}{(mz + (m + n))^k} = G_k(z) \]
%
\[ G_k(-1/z) = \sum_{(n,m) \neq 0} \frac{1}{(n - m/z)^k} = \sum_{(n,m) \neq 0} \frac{z^k}{(n - mz)} = z^k G_k(z) \]
%
Thus $G_k$ is weakly modular, of weight 12. These functions are known as Eisenstein series. Note that for $|z| > 1$, $|mz + n| \geq |m|$, so the series converges uniformly for $|z| > 2$. The symmetry condition defining modular forms then tells us that the series converges locally uniformly on $\mathbf{H}$, and therefore converges to a holomorphic function everywhere. Finally, by applying uniform convergence on $|z| > 2$, we find
%
\[ \lim_{z \to i\infty} \sum_{m,n = -\infty}^\infty \frac{1}{(mz + n)^k} = \sum_{m,n = -\infty}^\infty \lim_{z \to i \infty} \frac{1}{(mz + n)^k} = \sum_{n = -\infty}^\infty \frac{1}{n^k} = 2 \zeta(k) \]
%
So the function has a limit at $i \infty$, and is therefore holomorphic there. Thus we find

\begin{theorem}
    $G_k$ is a modular form of weight $k$.
\end{theorem}

It turns out that the coefficients of the $G_k$ represent a certain arithmetic function of interest to number theorists. First, a proposition about the Riemann zeta function.

\begin{lemma}
    If $k$ is a positive integer, then
    %
    \[ \zeta(2k) = (-1)^{n+1} \frac{(2 \pi)^{2k}}{2 (2k)!} B_{2k} \]
    %
    where $B_k$ is the $k$'th Bernoulli number, defined by the expansion
    %
    \[ \frac{x}{e^x - 1} = \sum_{k = 0}^\infty B_k \frac{x^k}{k!} \]
\end{lemma}
\begin{proof}
    Consider the locally uniformly convergent Fourier expansion
    %
    \[ \cos(a y) = \frac{2 a \sin \pi a}{\pi} \left( \frac{1}{2 a^2} + \sum_{n = 1}^\infty \frac{(-1)^n}{a^2 - n^2} \cos ny \right) \]
    %
    Taking $y = 1$, we find
    %
    \[ \pi \cot \pi a = \frac{1}{a} + \sum_{n = 1}^\infty \frac{2a}{a^2 - n^2} = \frac{1}{a} + \sum_{n = 1}^\infty \frac{1}{a - n} + \frac{1}{a + n} \]
    %
    But
    %
    \[ \pi \cot \pi a = \pi i \frac{e^{i \pi a} + e^{- i \pi a}}{e^{i \pi a} - e^{- i \pi a}} = \pi i + \frac{2 \pi i}{e^{2 \pi i a} - 1} \]
    %
    so if we write $2 \pi i a = x$, we have two different expansions. The first is
    %
    \[ \pi \cot(-ix/2) = \pi i + \frac{2 \pi i}{x} \frac{x}{e^x - 1} = \frac{2 \pi i B_0}{x} + (\pi i + 2 \pi i B_1) + 2 \pi i \sum_{k = 1}^\infty \frac{B_{k+1}}{(k+1)!} x^k \]
    %
    and the second is
    %
    \begin{align*}
        \pi \cot(-ix/2) &= \frac{2 \pi i}{x} + \sum_{n = 0}^\infty \frac{1}{n} \left( \frac{1}{1 - (-a/n)} - \frac{1}{1 - (n/a)} \right)\\
        &= \frac{2 \pi i}{x}  + \sum_{n = 1}^\infty \frac{1}{n} \sum_{m = 0}^\infty (-a/n)^m - (a/n)^m\\
        &= \frac{2 \pi i}{x} - \sum_{m = 0}^\infty \left( \frac{2}{(2 \pi i)^m} \sum_{n = 1}^\infty \frac{1}{n^{2m + 2}} \right) x^{2m + 1}\\
        &= \frac{2 \pi i}{x} + \sum_{m = 0}^\infty \frac{-2 \zeta(2m + 2)}{(2 \pi i)^m} x^{2m + 1}
    \end{align*}
    %
    This shows us that $\zeta(2m) = - \frac{(2 \pi i)^{2m}}{2 (2m)!} B_{2m}$, and also that $B_k$ vanishes for odd numbers greater than or equal to $3$.
\end{proof}

We use similar techniques to compute the $q$ expansion of the Eisenstein series. Define the $k$'th divisor sum to be $\sigma_k(n) = \sum_{d \divides n} d^k$.

\begin{theorem}
    The Eisenstein series has the $q$-expansion
    %
    \[ G_k(z) = 2 \zeta(k) \left( 1 - \frac{2k}{B_k} \sum_{n = 1}^\infty \sigma_{k-1}(n) q^n \right) \]
\end{theorem}
\begin{proof}
    Replace $a$ with $mz$ in the last proof to obtain the expansion
    %
    \[ \sum_{n = -\infty}^\infty \frac{1}{mz + n} = \pi \cot(m \pi z) = \pi i + \frac{2 \pi i}{q^m - 1} = \pi i - 2 \pi i \sum_{k = 1}^\infty e^{2 \pi i km z} \]
    %
    Differentiating in the variable $mz$ $2n - 1$ times, we find
    %
    \begin{align*}
        \sum_{k = -\infty}^\infty \frac{1}{(mz + k)^{2n}} &= (-1)^n \frac{(2 \pi)^{2n}}{(2n-1)!} \sum_{k = 1}^\infty k^{2n-1} q^{k m}\\
        &= - \zeta(2n) \frac{2n}{B_{2n}} \sum_{k = 1}^\infty k^{2n - 1} q^{km}
    \end{align*}
    %
    Thus
    %
    \begin{align*} 
        G_{2n}(z) &= 2 \zeta(2n) - 2 \zeta(2n) \frac{2n}{B_{2n}} \sum_{m = 1}^\infty \sum_{k = 1}^\infty k^{2n - 1} q^{km}\\
        &= 2 \zeta(2n) \left[ 1 - \frac{2n}{B_{2n}} \sum_{m = 1}^\infty \left( \sum_{k \divides m} k^{2n-1} \right) q^m \right]
    \end{align*}
    %
    and this is the formula we wanted.
\end{proof}

We get rational coefficients to the Eisenstein series if we normalize by the zeta function, defining
%
\[ E_{2n}(z) = \frac{G_{2n}(z)}{2\zeta(2n)} = 1 - \frac{2n}{B_{2n}} \sum_{m = 1}^\infty \sigma_{2n-1}(m) q^m \]
%
This series actually comes about naturally in the theory. For instance, we could define
%
\[ E_{2n}(z) = \frac{1}{2} \sum_{\text{gcd}(m,n) = 1} \frac{1}{(mz + n)^{2n}} \]
%
since it would then follow
%
\[ G_{2n}(z) = \sum_{a = 1}^\infty \sum_{\text{gcd}(m,n) = a} \frac{1}{(mz + n)^{2n}} = 2 \sum_{a = 1}^\infty \frac{1}{a^{2n}} E_{2n}(z) = 2 \zeta(2n) E_{2n}(z) \]
%
In particular, we have a series of group actions on the set of meromorphic functions defined by
%
\[ M_n f (z) = (cz + d)^{-n} f \left(\frac{az + bz}{cz + d} \right) \]
%
The weakly modular functions of weight $k$ are exactly the functions stabilized by the action. In general, if we have a group action from a finite group $G$ on a vector space $V$, and we want to find vectors stabilized by the action, we can start by fixing some $v_0 \in V$, and then consider $\sum_{x \in G} xv_0$. If $v_0$ is invariant under $G_0 \subset G$, then we need only consider $\sum_{x \in G/G_0} xv_0$. If $G$ is infinite, this method still works provided that $v_0$ is invariant under a group $G_0$ of finite index in $G$, or if $G_0$ is a maximal stabilizer (so elements aren't repeated) and the sum converges. If we take $f$ to be a rational function, and $G = \Gamma$, and $G_0$ the set of modular transformations which fix $f$, then we obtain a series of modular functions of weight $n$ known as Poincare series.
%
\[ \sum_{M \in G/G_0} (cz + d)^{-n} f \left( \frac{az + b}{cz + d} \right) \]
%
In particular, if we take $v_0$ to be the constant function, and set $G_0$ to be the set of $M \in \Gamma$ which preserve infinity, then the Poincare series is exactly the function $E_{2n}$.

We have not yet found a Modular form of weight 2. We can define the Eisenstein series
%
\[ G_2(z) = 2\zeta(2) + \sum_{m \neq 0} \sum_{n = - \infty}^\infty \frac{1}{(mz + n)^2} \]
%
\begin{align*}
    E_2(z) = \frac{G_2(z)}{2\zeta(2)} &= 1 + \frac{3}{\pi^2} \sum_{m \neq 0} \sum_{n = -\infty}^\infty \frac{1}{(mz + n)^2}\\
    &= 1 + \frac{6}{\pi^2} \sum_{m = 1}^\infty \sum_{n = -\infty}^\infty \frac{1}{(mz + n)^2}
\end{align*}
%
But these sums do not converge absolutely, though the inner sums do for any $z$ and $m$. As when determining the $q$ coefficients of the higher order $G_k$, we have
%
\[ \sum_{n = -\infty}^\infty \frac{1}{(mz + n)^2} = -\frac{4}{B_2} \zeta(2) \sum_{n = 1}^\infty n q^{nm} = - 4 \pi^2 \sum_{n = 1}^\infty n q^{nm} \]
%
Hence
%
\[ E_2(z) = 1 - 24 \sum_{m = 1}^\infty \sum_{n = 1}^\infty n q^{nm} \]
%
Since the coefficients of $q^n$ are determined here for small enough values of $m$, we may collect the coefficients to conclude
%
\[ E_2(z) = 1 - 24 \sum_{n = 1}^\infty \sigma_1(n) q^n \]
%
Since
%
\[ \sigma_1(n) = \sum_{m \divides n} m \leq \sum_{m \divides n} n \leq \sum_{m = 1}^n n = O(n^2) \]
%
The series converges for all $|q| \leq 1$, so we see $E_2$ is a holomorphic function well defined at $\infty$. However, the transformation law fails. It is easy to be decieved here. We calculate
%
\begin{align*}
    E_2(-1/z) &= \frac{z^2}{2 \zeta(2)} \sum_{n = -\infty}^\infty \sum_{m = -\infty}^\infty \frac{1}{(m - nz)^2} = \frac{z^2}{2 \zeta(2)} \sum_{n = -\infty}^\infty \sum_{m = -\infty}^\infty \frac{1}{(mz + n)^2}
\end{align*}
%
where we ignore the case where $m = n = 0$ when summing. We could conclude that $E_2$ was a modular form, provided that the summation operations can be swapped -- this is where we need to apply absolutely convergence -- something we don't have, and something which causes the transformation property to fail. Let us define
%
\[ a_{mn} = \frac{1}{(mz+n-1)(mz + n)} = \frac{1}{mz + n - 1} - \frac{1}{mz + n} \]
%
Then
%
\begin{align*}
    \frac{1}{(mz + n)^2} - a_{mn} &= \frac{1}{(mz + n)} \left( \frac{1}{mz + n} - \frac{1}{mz + n - 1} \right)\\
    &= \frac{-1}{(mz + n)^2 (mz + n - 1)}
\end{align*}
%
So the modified series
%
\[ \tilde{E}_2(z) = \frac{1}{2 \zeta(2)} \sum_{m = -\infty}^\infty \sum_{n = -\infty}^\infty \frac{1}{(mz + n)^2} - a_{mn} \]
%
converges absolutely. The $a_{mn}$ telescope to zero when summed over $n$, so $\tilde{E}_2(z) = E_2(z)$. This means that
%
\[ E_2(-1/z) - z^2E_2(z) = \frac{z^2}{2 \zeta(2)} \sum_{n = -\infty}^\infty \sum_{m = -\infty}^\infty a_{mn} \]
%
and now
%
\begin{align*}
    \lim_{N \to \infty} \sum_{n = -N}^N \sum_{m = -\infty}^\infty a_{mn} &= \lim_{N \to \infty} \sum_{m = -\infty}^\infty \sum_{n = -N}^N a_{mn}\\
    &= \lim_{N \to \infty} \sum_{m = -\infty}^\infty \left( \frac{1}{mz - N} - \frac{1}{mz + N} \right)\\
    &= \lim_{N \to \infty} \frac{2}{z} \left( \pi \cot(- \pi N/z) + z/N \right)\\
    &= \frac{2 \pi i}{z} \lim_{N \to \infty} \frac{e^{-2 \pi i N/z} + 1}{e^{- 2 \pi i N/z} - 1} = -\frac{2 \pi i}{z}
\end{align*}
%
and we conclude that
%
\[ E_2(-1/z) = z^2 E_2(z) - \frac{6 i z}{\pi} = z^2 E_2(z) + \frac{12z}{2 i \pi} \]
%
This procedure can be seen as introducing a `correction coefficient' $a_{nm}$ into the inner sums which make both sums absolutely converge, then the two sums would be equal, and we would find the sum above equal to
%
\[ \sum_m \sum_n a_{mn} - \sum_n \sum_m a_{mn} \]
%
and can be applied to other problems of this type.

\section{Classification of Modular Forms}

We shall now show that all functions can be represented in terms of the Eisenstein series. Recall that the order $\text{ord}(f,w)$ of a non-zero meromorphic function $f$ at a point $w$ is the unique integer $k$ such that $(z - w)^k f(z)$ is a function non-zero and holomorphic at $w$. Note that if $f$ is a weakly modular function, then $\text{ord}(f,w) = \text{ord}(f, Mw)$, because the behaviour of $f$ around $w$ is, up to a power of $(cz + d)^k$, the Certainly. same this is true for $\gamma = T$, since $f$ is periodic, and
%
\begin{align*}
    w^m f(-1/z + w) &= w^m f\left( -\frac{1-wz}{z} \right)\\
    &= w^m \left( \frac{z}{1 - wz} \right)^k f \left( \frac{z}{1 - wz} \right)\\
    &= \left( \frac{w (1 - wz)}{z} \right)^m \left( \frac{z}{1 - wz} \right)^k \left( \frac{z}{1 - wz} \right)^m f\left( \frac{z}{1 - wz} \right)
\end{align*}
%
This function is holomorphic at $w = 0$, provided $m$ is the order of $f(z)$, and it is nonzero at $-1/z$, so this shows that the order is preserved by $\gamma = S$. The general case is then true because $\Gamma$ is generated by $S$ and $T$. Thus we may talk about the order of a point on $\mathbf{H} / \Gamma$. We also define, for a modular function, the order at $\infty$ to be the smallest integer whose corresponding $q$-coefficent is non-zero.

The key assertion is that the total number of zeroes depends only on the weight of the modular form. This depends on the geometry of $\mathbf{H}/\Gamma$, especially the singularities of the region (the {\it elliptic fixed points}, whose stabilizer over $\Gamma$ is not trivial) and the non-compactness of the region -- the cusp at $\infty$. Recall that $\mathbf{H}/\Gamma$ is obtained from the fundamental region by attaching the boundary be reflection in the $y$-axis. The only problem is that this quotient has singularities at $\omega = e^{i \pi/6}$, $i$, $\omega^2$, and $\infty$, which have neighbourhoods that aren't discs ($\omega$ and $\omega^2$, and $\infty$ have arcs of length $2\pi/3$ and $i$ has an arc of length $\pi$). These lengths give us the ratios which we can use to count the zeroes of the function.

\begin{theorem}
    If $f \neq 0$ is a modular function of weight $k$, then
    %
    \[ \text{ord}(f,\infty) + \frac{\text{ord}(f,i)}{2} + \frac{\text{ord}(f,\omega)}{3} + \sum_{\substack{p \in \mathbf{H}/\Gamma\\p \not \equiv i, e^{i \pi/6}}} \text{ord}(f,p) = \frac{k}{12} \]
    %
    or perhaps more lucidly,
    %
    \[ \text{ord}(f,\infty) + \sum_{p \in \mathbf{H}/\Gamma} \frac{\text{ord}(f,p)}{\Gamma_p} = \frac{k}{12} \]
\end{theorem}
\begin{proof}
    The idea of the proof results from counting zeroes and poles via integrating the logarithmic derivative. Consider the oriented curve $\alpha$ shown in the image below.
    %
    \begin{center}
    \includegraphics[scale=0.5]{k12proof.jpg}
    \end{center}
    %
    which is tall enough that the region contains one of each zero and pole in each orbit (orbits cannot go to infinity because $f$ is meromorphic there). We swerve around points $p \in \partial D$ which are zeroes and poles, such that only one of each point in the orbit class in contained in the region in question. The residue theorem performs its magic, telling us that
    %
    \[ \frac{1}{2\pi i} \int_\alpha \frac{f'(z)}{f(z)} dz = \sum_{p \in \mathbf{H}/\Gamma, p \neq i, \omega} \text{ord}(f,p) \]
    %
    Now let's calculate the integral explicitly. Let $q = e^{2 \pi i z}$ and $\tilde{f}(q) = f(z)$. Then
    %
    \[ 2 \pi i q \tilde{f}'(q) = f'(z)  \]
    %
    Thus
    %
    \[ \frac{1}{2 \pi i} \int_{HA} \frac{f'(z)}{f(z)} dz = \frac{1}{2 \pi i} \int_{\omega} \frac{\tilde{f}'(q)}{\tilde{f}(q)} dq \]
    %
    Where $\omega$ is now a clockwise rotation around the origin. The only possible poles and zeroes are at $q = 0$, so this evaluates to $- \text{ord}(f,\infty)$. $T$ takes $AB$ to $HG$, so
    %
    \[ \frac{1}{2 \pi i} \int_{AB} \frac{f'(z)}{f(z)} dz = - \frac{1}{2 \pi i} \int_{GH} \frac{f'(z)}{f(z)} dz \]
    %
    so the integrals cancel out when they are added together. Similarily, $S$ takes $CD$ to $FE$, and because $f(Sz) = z^k f(z)$, we find
    %
    \begin{align*}
        \frac{1}{2 \pi i} \left( \int_{CD} \frac{f'(z)}{f(z)} - \int_{FE} \frac{f'(z)}{f(z)} dz \right) &= \frac{1}{2 \pi i} \int_{CD} \left( \frac{f'(z)}{f(z)} - \frac{f'(Sz)}{f(Sz)} \right) dz\\
        &= -\frac{k}{2 \pi i} \int_{CD} \frac{1}{z} dz
    \end{align*}
    %
    We will be taking the limit as we shrink the radius of the circles defining $BC$, $DE$, and $FG$ to zero, in which case we trace out an angle of size $\pi/6$ in the limit, and so the value of the integral is $k/12$. Finally, we integrate $BC$, $FG$, and $DE$. In the limit, as we decrease the size of the circle, the circles have angles $\pi/6$, $\pi/2$, and $\pi/6$, so the path integrals integrate to $- \text{ord}(f,\omega)/6$, $- \text{ord}(f,i)/2$, and $- \text{ord}(f, -\overline{\omega})/6$. Summing up these integrals, and then combining them with our original deduction in terms of the residue theorem, we obtain the required formula.
\end{proof}

The factor of $1/12$ can be explained as $1/4\pi$ times the volume of $\mathbf{H}/\Gamma$, taken with respect to the hyperbolic metric. The factor will change when we weaken the group we analyze -- for instance, when we look at modular forms over congruence subgroups of $\Gamma$.

The pole formula for modular function places a vast restriction on the degrees of freedom of modular forms, because the order of the points in its domain must be positive, so there can only be a very limited number of zeroes. If $f \neq 0$ is a modular form of weight $k < 0$, then
%
\[ 0 \leq \text{ord}(f,\infty) + \frac{\text{ord}(f,i)}{2} + \frac{\text{ord}(f,e^{\frac{i \pi}{6}})}{3} + \sum_{\substack{p \in \mathbf{H}/\Gamma\\p \not \equiv i, e^{i \pi/6}}} \text{ord}(f,p) = \frac{k}{12} < 0 \]
%
which is clearly impossible, $M_k = (0)$ for $k < 0$. If $f$ has weight zero, then it certainly must have no zeroes on $\mathbf{H}$ (for the sum of zeroes must equal zero), but then if $f(w) = w'$, $f - w'$ is a form of weight zero, with a zero in $\mathbf{H}$, so $f - w = 0$, and so $f = w$ is a constant function. Suppose that $f$ is a non-zero modular form of weight $k$, where $k = 4$, $k = 6$, $k = 8$, and $k = 10$, and $k = 14$. Then the zero order formula tells us that $f$ has no zeroes at $i \infty$. But then $2 \zeta(k) f - f(i \infty) E_k$ has a zero at $i \infty$, so $2 \zeta(k) f =  f(i \infty) E_k$, and so $M_k = \mathbf{C} E_k$. In general, we have a bound

\begin{theorem}
    The dimension on the space of modular forms is bounded by
    %
    \[ \text{dim}(M_k) \leq \begin{cases} [k/12] + 1 & k \not \equiv 2\ (\text{mod}\ 12) \\ [k/12] & k \equiv 2\ (\text{mod}\ 12) \end{cases} \]
    %
    where $[x]$ is the smallest integer greater than or equal to $x$.
\end{theorem}
\begin{proof}
    If $f_1, \dots, f_{n+1} \in M_k$, then we may choose $g = \sum a_i f_i$ to have zeroes at $n$ non-elliptic points. Provided $n > k/12$, the pole formula tells us that $g = 0$. Thus the dimension of $M_k$ must be less than or equal to $n$. If $k \equiv 2\ (\text{mod}\ 12)$, we can improve the bound by noticing that we must have at least a single zero at $i$ and a double zero at $\omega$, which already gives us $14/12$ `zeroes' to start with, and we need only find a function with greater than or equal to $k - 2/12 = (k-2)/12$ zeroes to conclude it is constant.
\end{proof}

One of the beautiful facts about Modular forms is that low weight forms are very low dimensional, so that if two modular forms are the same weight, chances are they are related in a very significant way. This gives rise to many of the beautiful equalities which emerge from the theory, such as Euler's pentagonal equality, and the formula for the discriminant we now show. For instance, the space of modular forms of weight 8 is one-dimensional, so $E_4^2$ and $E_8$ are scalar multiples of each other. Since $E_4^2$ and $E_8$ have the same value at $\infty$, they actually must be equal. Expanding out the $q$ series of $E_4^2$ and $E_8$, we find that
%
\begin{align*}
    1 + 240 \sum_{m = 1}^\infty \sigma_7(m) q^m &= \left( 1 + 120 \sum_{m = 1}^\infty \sigma_3(m) q^m \right)^2\\
    &= 1 + \sum_{m = 1}^\infty \left( 240 \sigma_3(m) + 120^2 \sum_{n = 1}^{m-1} \sigma_3(n) \sigma_3(m-n) \right) q^m\\
\end{align*}
%
Which gives us the arithmetic identity
%
\[ \sigma_7(m) = \sigma_3(m) + 120 \sum_{n = 1}^{m-1} \sigma_3(n) \sigma_3(m-n) \]
%
whose proof would be nigh impossible with the analytic facts we've uncovered.

\section{The Modular Discriminant}

We define the discriminant function as
%
\[ \Delta(z) = q \prod_{n = 1}^\infty (1 - q^n)^{24} \]
%
This is a modular form of weight $12$. To see this, note that
%
\begin{align*}
    \frac{1}{2 \pi i} \frac{d \log(\Delta)}{dz} &= 1  - 24 \sum_{n = 1}^\infty \frac{n q^n}{1 - q^n} = 1 - 24 \sum_{n = 1}^\infty \sum_{m = 1}^\infty n q^{nm}\\
    &= 1 - 24 \sum_{n = 1}^\infty \sigma_1(n) q^n = E_2(z)
\end{align*}
%
So using the transformation rule for $E_2$, we find
%
\[ \frac{1}{2 \pi i} \frac{\Delta((az + b)(cz + d)^{-1})}{(cz + d)^{12} \Delta(z)} = \frac{1}{(cz + d)^2} E_2 \left( \frac{az + b}{cz + d} \right) - \frac{12}{2 \pi i} \frac{c}{cz + d} - E_2(z) = 0 \]
%
and this effectively completes the proof.

$\Delta$ has a zero at $\infty$, which must be of order one by the zero summation formula, and can therefore have no zeroes anywhere else. Thus the map $f \mapsto f \Delta$ is an isomorphism from $M_k$ to $S_{k+12}$, and since $M_k = S_k \oplus \mathbf{C} E_k$, we find that all modular forms can be written as the sum and product of Eisenstein series. In particular, $\mathbf{C}[E_4,E_6] = M_*$, which can shown by induction since $\Delta \in \mathbf{C}[E_4,E_6]$, and for any even $n = 4m + 6l$, we find $E_4^m E_6^l$ is a modular form of order $n$, non-zero at $\infty$, and $M_n = S_n \oplus \mathbf{C} E_4^m E_6^l$. Thus all elements in $M_n$ can be written
%
\[ \sum_{4m + 6l = n} a_{m,l} E_4^m E_6^l \]
%
and there is a one-to-one correspondence here.

The set of cusp forms of weight 12 form a space of dimension one, so any two cusp forms of weight twelve differ by a constant (see what I mean now?). $\Delta$ is a cusp form, as is the function
%
\[ F(z) = \frac{1}{1728} [E_4^3(z) - E_6^2(z)] \]
%
The first $q$ coefficent of $\Delta$ is $1$. To calculate the first $q$ coefficient of $F$, we write
%
\begin{align*}
    F(z) &= \frac{1}{1728} \left[\left(1 - \frac{8}{B_4} q + \dots \right)^3 - \left(1 - \frac{12}{B_6} q + \dots \right)^2 \right]\\
    &= \frac{24}{1728} [1/B_6 - 1/B_4] q + \dots\\
    &= q + \dots
\end{align*}
%
Since $F$ is a scale multiple of $\Delta$, and they both have the same first $q$ coefficient, they must be equal!

The coefficients of the expansion of $\Delta$ are known as the Ramanujan tau function,
%
\[ \Delta(z) = \sum_{n = 1}^\infty \tau(n) q^n \]
%
$\tau$ has many interesting properties, conjectured by Ramanujan well before the theory of modular forms was properly developed. For instance, $\tau$ is a multiplicative function, and if $p$ is prime, then $|\tau(p)| \leq 2p^5 \sqrt{p}$. This is an incredibly deep inequality, and was only proved recently in the 1970s. It is easier to prove that $|\tau(p)| = O(p^6)$, proved by Hecke in the 30s in a general bound for cusp forms.

The coefficients of the Eisenstein's series $G_{2n}(z) = \sum a_k q^k$ grow on the order of $n^{2n-1}$, since
%
\[ n^m \leq \sum_{k \divides n} k^m \leq \zeta(m) n^m \]
%
The upper bound is easily seen, if $n = p_1^{n_1} \dots p_m^{n_m}$, from the prime representation
%
\[ \zeta(m) n^m \geq n^m \prod_{i = 1}^n \left(1 + \frac{1}{p_i^m} + \frac{1}{p_i^{2m}} + \dots + \frac{1}{p_i^{m n_i}} \right) = \sum_{k \divides n} k^m \]
%
We obtain much better decay for cusp forms.

\begin{theorem}
    If $f(z)$ is a cusp form of weight $k$, with Fourier expansion $f(z) = \sum a_k q^k$, then $|a_n| = O(n^{k/2})$, via  constant dependant on $f$.
\end{theorem}
\begin{proof}
    The map $z \mapsto y^{k/2} |f(z)|$ is invariant under the modular group, since certainly $y^{k/2} |f(z + 1)| = y^{k/2} |f(z)|$, and
    %
    \[ \frac{y^{k/2} |f(-1/z)|}{(x^2 + y^2)^{k/2}} = \frac{y^{k/2} |z|^k |f(z)|}{|z|^k} = y^{k/2} |f(z)| \]
    %
    So the map is invariant under $\Gamma$. As $z \to i \infty$, $y^{k/2} |f(z)| \to 0$ because $|f(z)|$ decays rapidly at infinity. Thus the map is bounded on the fundamental domain of $\mathbf{H}$, and thus everywhere, so that a global maximum exists, and we may assume $|f(z)| \leq C y^{-k/2}$. The Fourier coefficients can be defined by the equations
    %
    \[ a_n = e^{2 \pi n y} \int_0^1 f(x + iy) e^{-2 \pi i n x} dx \]
    %
    Since $|f(z)| \leq C$, $|a_n| \leq C e^{2 \pi n y} y^{-k/2}$, valid for any $y$. If we set $y = 1/n$, we find $|a_n| \leq C e^{2 \pi} y^{-k/2}$.
\end{proof}

In general, we find that the coefficients of modular form of weight $k$ is $O(n^k)$, because any modular form can be written as the sum of a cusp form and an Eisenstein series.

Returning to the $\tau$ function, we note that it has interesting congruence properties. Indeed we have
%
\begin{align*}
    \Delta &= \frac{E_4^3 - E_6^2}{1728} = \frac{\left( 1 + 240 A_3 \right)^3 - \left( 1 - 504 A_5 \right)^2}{1728}\\
    &= \frac{5}{12} (A_3 - A_5) + A_5 + 100A_3^2 - 147A_5^2 + 8000A_5^3
\end{align*}
%
where $A_n = \sum_{m = 1}^\infty \sigma_n(m) q^m$. But $\sigma_5(n) - \sigma_3(n)$ is divisible by $12$ for every $n$, because $d^5 - d^3 = d^3(d - 1)(d + 1)$ is divisible by 12 for each $d$ (the product contains at least 2 even numbers, and one number divisible by 3). Thus $(5/12) (A_3 - A_5)$ has integral coefficients. This shows that $\Delta$ itself has integral coefficients (an alternate proof, not assuming the product description we already constructed). We actually have $\sigma_5(n) \equiv \sigma_3(n)$ modulo 24, because 24 divides $d^3(d^2 - 1)$, so $A_3 - A_5$ has even coefficients, and therefore the coefficients of $\Delta$ modulo $2$ are equal to the coefficients of $A_5 + A_5^2$, and since the coefficients of $A_5^2$ modulo $2$ are just $\sum \sigma_5(n) q^{2n}$, we find
%
\[ \tau(2n) \equiv \sigma_5(2n) + \sigma_5(n) \]
%
and for odd $n$,
%
\[ \tau(n) \equiv \sigma_5(n) \]
%
Modulo 2, $\sigma_5(n)$ is just the number of odd divisors of $n$, and if we write the odd prime factors of $n$ as $p_1^{k_1} \dots p_m^{k_m}$, we find that $\sigma_5(n) \equiv (k_1 + 1) \dots (k_m + 1)$, so if $n$ is odd, $\tau(n)$ is odd if and only if all the $k_i$ are even -- i.e. if $n$ is the square of an odd number. If we consider the number $n = 2^m n_0$, where $n_0$ is an odd square, then $\tau(n) \equiv \sigma_5(2^{m-1}n_0) + \sigma_5(n) \equiv 1 + 1 \equiv 0$, and if $n_0$ is not an odd square, $\tau(n) \equiv 0 + 0 \equiv 0$. Thus $\tau(n)$ is odd if and only if $n$ is the square of an odd number.

In a completely different calculation, we can calculate over modular forms of order 12 that
%
\[ - \frac{B_{12}}{24} + \sum_{m = 1}^\infty \sigma_{11}(n) q^n = \Delta(z) + \frac{691}{156} \left( \frac{E_4^3}{720} + \frac{E_6^2}{1008} \right) \]
%
So we have a famous congruence of Ramanujan, that $\tau(n) \equiv \sigma_{11}(n)\ (\text{mod}\ 691)$.

\section{The j-invariant}

Let's get back to modular functions now. Define the function
%
\[ j(z) = \frac{E_4^3}{\Delta} = \frac{1}{q} + 744 + 196884 q + 21493760 q^2 + \dots \]
%
a modular function of weight zero, known as the modular invariant. Since $\Delta$ has no zeroes on $\mathbf{H}$, $j$ is holomorphic on $\mathbf{H}$, and has a simple pole at $\infty$, since $\Delta$ has a simple zero there.

\begin{theorem}
    $j$ is a bijection from $\overline{H}/\Gamma$ to the Riemann sphere $\mathbf{P} \mathbf{C} = \mathbf{C} \cup \{ \infty \}$.
\end{theorem}
\begin{proof}
    $j$ has a simple pole at infinity since $E_4$ does not vanish at infinity and $\Delta$ is a cusp form. For any $w \in \mathbf{C}$ the modular form $1728 E_4^3 - w \Delta$ must vanish at exactly one point, for it is a modular form of order 1. But this implies $j(z) - w = 0$ for exactly one value in $\overline{H}/\Gamma$.
\end{proof}

\begin{theorem}
    The Modular functions of weight zero for $\Gamma$ are precisely the rational functions of $j$.
\end{theorem}
\begin{proof}
    Certainly every element of $\mathbf{C}(j)$ is a modular function of weight zero, since $j$ is a meromorphic modular function of weight zero. If $f$ has poles $z_1, \dots, z_l$ of order $n_1, \dots, n_l$, then
    %
    \[ g(z) = \prod_{n = 1}^\infty [j(z) - j(z_1)]^{n_1} f(z) \]
    %
    is a modular function of weight zero with no poles in $\mathbf{H}$, so we may assume that $f$ has no finite poles. If $f$ has a pole at $i \infty$, define $g = \Delta^k f$, for a suitable value of $k$ such that the pole at $\infty$ is removed, and so $g$ is a modular form of weight $12k$. We may therefore write
    %
    \[ f(z) = \sum_{4n + 6m = 12k} a_{n,m} \frac{E_4^n E_6^m}{\Delta^k} \]
    %
    We find $n = 3n'$, $m = 2m'$ by division laws, and $E_4^3/\Delta$ and $E_6^2/\Delta$ are each in $\mathbf{C}(j)$ (they are actually linear in $j$), and because each monomial in the sum is the product of such factors, we conclude that $\mathbf{C}(j)$ is the space of all weight zero modular functions.
\end{proof}

The compactification of $\mathbf{H}/\Gamma$ can be given the structure of a complex analytic manifold, and these propositions imply a Biholomorphism with $\mathbf{C} \mathbf{P}^1$ by $j$, and hence the only holomorphic functions on the compactification are rational functions of $j$, as the only holomorphic functions on $\mathbf{C} \mathbf{P}^1$ are rational functions.










\chapter{Complex Torii and Elliptic Curves}

\section{Lattices}

There is an interesting connection between the theory of modular forms and the theory of lattices which emerges because of the translation invariant properties of the spaces. As with modular forms, there are many different ways of looking at lattices, and they all have useful consequences. Recall that a {\bf lattice} in a finite dimensional real vector-space $V$ is an additive subgroup $L$ of $V$ such that one of the equivalent conditions holds.
%
\begin{enumerate}
    \item $L$ is discrete, and $V/L$ is compact.
    \item There is an $\mathbf{R}$ basis $e_1, \dots, e_n$ of $V$ such that $L = \mathbf{Z} e_1 \oplus \dots \oplus \mathbf{Z} e_n$.
    \item $L$ is discrete, and spans $V$.
\end{enumerate}
%
In our situation, we take $V = \mathbf{C}$, and we let $\mathcal{R}$ denote the set of all lattices on $\mathbf{C}$. Such lattices can be described by pairs of $\mathbf{R}$-independant complex numbers $(z,w) \in \mathbf{C}^2$. Given any particular pair, we let $L(z,w)$ denote the lattice generated by the two numbers. Note that $z$ and $w$ are dependant if and only if $z/w \in \mathbf{R}$, so we may assume that $z/w \in \mathbf{H}$ (if $z/w$ is in the other side of the plane, consider $w/z$ instead). We let
%
\[ M = \{ (z,w) \in \mathbf{C}^2 : z/w \in \mathbf{H} \} \]
%
And we then view $L$ as a map from $M$ to $\mathcal{R}$.

A lattice can be defined by many different pairs of complex numbers. For instance, if $w' = -z$, and $z' = w$, then $L(z,w) = L(z',w')$, and we find
%
\[ z'/w' = -w/z = S(z/w) \]
%
Furthermore, if we let $z' = z + w$ and $w' = z$, then $L(z',w') = L(z,w)$ and
%
\[ z'/w' = z/w + 1 = T(z/w) \]
%
So we begin to see the modular group $\Gamma$ giving us information about the various different bases of any particular lattice. Indeed, if $M = \left( \begin{smallmatrix} a & b \\ c & d \end{smallmatrix} \right) \in \Gamma$, and $(z',w') = M(z,w)$ (where we define the action of $\Gamma$ on $M$ in the obvious way), then $L(z', w') = L(z, w)$, because $(z,w) = M^{-1}(z',w')$. What's more,
%
\[ z'/w' = \frac{az + bw}{cz + dw} = \frac{a(z/w) + b}{c(z/w) + d} = M(z/w) \]
%
The group $\Gamma$ plays a role in the theory of lattices because the theory has discrete scale invariance, which is essentially the role of $\Gamma$ as a subgroup of $PGL_2(\mathbf{C})$.

\begin{theorem}
    If $z/w, z'/w' \in \mathbf{H}$, then $L(z,w) = L(z',w')$ if and only if $(z,w)$ is congruent to $(z',w')$ relative to $\Gamma$.
\end{theorem}
\begin{proof}
    If $L(z,w) = L(z',w')$, we can write
    %
    \[ z' = az + bw\ \ \ \ \ w' = cz + dw \]
    %
    It then follows that
    %
    \[ z = \frac{az' - bw'}{ad - bc}\ \ \ \ \ w = \frac{dw' - cz'}{ad-bc} \]
    %
    Since all of the coefficients of these relations must be integer valued, we have $ad - bc \divides a,b,c,d$. We may assume the $a,b,c,d$ are relatively prime, for if we write $a = \lambda a_1$, $b = \lambda b_1$, $c = \lambda c_1$, and $d = \lambda d_1$, with $a_1, b_1, c_1$, and $d_1$ relatively prime, we find
    %
    \[ z = \frac{1}{\lambda} \frac{a_1 z' - b_1 w'}{a_1 d_1 - b_1 c_1} \ \ \ \ \ w =  \frac{1}{\lambda} \frac{d_1 w' - c_1 z'}{a_1 d_1 - b_1 c_1} \]
    %
    from which we conclude that $\lambda \divides a_1, b_1, c_1, d_1$ again, hence $\lambda = 1$. It then follows that $ad - bc = \pm 1$. But if $ad - bc = -1$, we find $z'/w'$ and $z/w$ lie on opposite sides of the complex plane, contradicting the fact that they both lie on $\mathbf{H}$. Thus we find $(z',w') = M(z,w)$ for $M \in \Gamma$, and then $z'/w' = M(z/w)$.
\end{proof}

We can therefore identify $\mathcal{R}$ with $M/\Gamma$. Now $\mathbf{C}^*$ acts on $\mathcal{R}$ by scaling, and this is the same map induced on the quotient $M/\Gamma$ from $M$ by scaling. Now we may identify $M/\mathbf{C}^*$ with $\mathbf{H}$, by the quotient map $(z,w) \mapsto z/w$, and the action of $\Gamma$ on $M$ induces the action of $\Gamma$ on $\mathbf{H}$, so
%
\[ \mathcal{R}/\mathbf{C}^* \cong (M/\Gamma)/\mathbf{C}^* \cong (M/\mathbf{C}^*)/\Gamma \cong \mathbf{H}/\Gamma \]
%
This is the main reason why $\Gamma$ is called the modular group, because it characterizes the {\it moduli space} of lattices.

This observation can be used to construct modular functions from lattices. Let $F$ be a complex valued function on $\mathcal{R}$. These are just functions $F(z,w)$ on $M$ which are invariant under the action of $\Gamma$. If
%
\[ \lambda^k F(\lambda z, \lambda w) = F(z,w) \]
%
Then we obtain a function $f: \mathbf{H} \to \mathbf{C}$ defined by $f(z) = F(z,1)$, and this function satisfies
%
\[ f \left( \frac{az + b}{cz + d} \right) = F \left( \frac{az + b}{cz + d}, 1 \right) = (cz + d)^{k} F(az + b, cz + d) = (cz + d)^{k} f(z) \]
%
Conversely, given any $f$, we may define $F(z,w) = w^{-k} f(z/w)$. We shall call $F$ a modular function if it induces a meromorphic $f$ which is meromorphic at infinity.

\section{Class Numbers}

Let us apply what we have learned to the study of quadratic forms $Q(x,y) = Ax^2 + Bxy + Cy^2$, for $A,B,C \in \mathbf{Z}$, a classic problem in number theory. Provided that the discriminant $D = B^2 - 4AC < 0$, $Q(x,y)$ has no non-zero roots in $\mathbf{R}^2$, and so either $Q(x,y) > 0$ for all $(x,y) \neq 0$, or $Q(x,y) < 0$. Without loss of generality, we assume $Q$ is a positive quadratic form, so that $A, C > 0$. We also assume that $Q$ is primitive, in the sense that $\text{gcd}(A,B,C) = 1$. Let $\mathfrak{Q}_D$ denote the set of all primitive quadratic forms with discriminant $D$. Note that $Q(\lambda x, \lambda y) = \lambda^2 Q(x,y)$, and if $ad - bc = 1$, and $\Gamma$ acts on $\mathfrak{Q}_D$ by composition. That is,
%
\begin{align*}
    \left[ \begin{pmatrix} a & b \\ c & d \end{pmatrix} Q \right] (x,y) &= Q(ax + by, cx + dy)\\
    &= (Aa^2 + Bac + Cc^2) x^2\\
    &\ + (2Aab + B(ad + bc) + 2Ccd) xy\\
    &\ + (Ab^2 + Bbd + Cd^2) y^2
\end{align*}
%
and this form has discriminant $D$, verified by calculation. Thus we expect the theory of modular forms to apply somewhere due to the scale invariance. The number of orbits of this action is actually finite, and is called the class number of the discriminant. To prove this, we associate with any $Q \in \mathfrak{Q}_D$ the unique root of $z_Q$ in $\mathbf{H}$ for which $Q(x,z_Q x) = 0$. One verifies that $z_Q = (-B + i\sqrt{-D})/2A$. If the roots of two positive primitive quadratic forms $Q = [A,B,C]$ and $R = [A',B',C']$ are equal, then $Q = R$, because if
%
\[ Q(x,y) = A (x - z y)(x - \overline{z} y) = Ax^2 - 2 A\Re(z) xy + A|z|^2 y^2 \]
\[ R(x,y) = A' (x - z y)(x - \overline{z} y) = A'x^2 - 2A'\Re(z) xy + A'|z|^2 y^2 \]
%
then $B'/B = A'/A = C'/C$, so $R$ is a multiple of $Q$, and since $R$ is also primitive and positive, $R$ must be a multiple of $Q$ by $1$, i.e. $Q = R$. Thus we can uniquely identify an element of $\mathfrak{Q}_D$ from its roots. One can also see that if $M \in \Gamma$, then $z_{MQ} = M^{-1}z_Q$, so by applying the classification of the orbit space of $\Gamma$ over $\mathbf{H}$, we find each equivalence classes in $\mathfrak{Q}_D$ has a unique representive of $Q = [A,B,C]$ with $z_Q$ in the fundamental domain. A short calculation shows this means exactly that
%
\[ -A \leq B \leq A\ \ \ \ \ C \geq A \]
%
This set is finite, because
%
\[ |D| = 4AC - B^2 \geq 3A^2 \]
%
so $A$ is bounded, which implies $B$ is bounded, and then $C$ is bounded because there is at most one $C$ for each pair of $A$ and $B$. We remark that the sequence of all class numbers form the coefficients of a certain modular form, but we do not go into detail about this.

\section{Hecke Theory}

Consider the space of formal sums of lattices, and define the operator $T_n$ on this space, mapping a lattice $L$ to the formal sum of sublattices $L'$ of index $n$ with respect to $L$. If $(L: L') = n$, then clearly $L'$ is contains the lattice $nL$, for if $x \in L$ is arbitrary, then by Lagrange's theorem we must have $nx = 0 \in L/L'$, so $nx \in L'$. If we consider the image $L'/nL$ of $L'$ in $L/nL$, then we see from one of the isomorphism theorems that $(L/nL, L'/nL) = n$, and $(L/nL)/(L'/nL) \cong L/L'$. Conversely, if $G$ is a subgroup of $L/nL$ of index $n$, then we may identify $G$ with its inverse image in $L$, and we find this group has index $n$ in $L$. Since $L/nL \cong \mathbf{Z}_n^2$, so a group has index $n$ in $L/nL$ if and only if it is a group of size $n$, and it is normally much easier to count the groups of size $n$ then the subgroups of index $n$ of $L$.

Since we can identify the group $L$ with $\mathbf{Z}^2$, and $L/nL$ with $\mathbf{Z}_n^2$, the operator $T_n$ is not really that interesting to the theory of lattices, since it is locally (with respect to sublattices of a particular lattice) just a function related to $\mathbf{Z}^2$. The fun begins when we add additional operators. For instance, we have the scale operators $R_\lambda(L) = \lambda L$. Together, these operators have nice composition properties.

\begin{theorem}
The Lattice operators satisfy
\begin{enumerate}
    \item[(a)] $R_\lambda \circ R_\gamma = R_{\lambda \gamma}$.
    \item[(b)] $R_\lambda \circ T_n = T_n \circ R_\lambda$.
    \item[(c)] If $n$ and $m$ are relatively prime, then $T_n \circ T_m = T_{nm}$.
    \item[(d)] If $p$ is prime, $T_{p^n} \circ T_p = T_{p^{n+1}} + p T_{p^{n-1}} R_p$
\end{enumerate}
\end{theorem}
\begin{proof}
    (a) is obvious, and (b) follows because $R_\lambda$ preserves the index of lattices. Now (c) is true if there is a unique lattice of degreee $n$ between a lattice of degree $nm$ and $L$. The group $L/nmL \cong \mathbf{Z}^2_{nm}$ decomposes into the direct product of $\mathbf{Z}^2_n$ and $\mathbf{Z}^2_m$. Given a group $L'$ of index $nm$, $L'/nmL$ is a group of size $nm$ so we need only need to prove that every group $G$ of size $nm$ in $\mathbf{Z}^2_n \oplus \mathbf{Z}^2_m$ extends to a unique group of size $nm^2$. This is certainly true if $\mathbf{Z}_n^2 \oplus \mathbf{Z}_m^2 / G \cong \mathbf{Z}_n \oplus \mathbf{Z}_m$, but this isomorphism always holds, because $\mathbf{Z}_n^2 \oplus \mathbf{Z}_m^2 / G$ is a group of order $nm$ containing elements of order $n$ and $m$, but no element has an order which properly divides $n$ or $m$. Now (d) is the really interesting property. Note that the range of all three operators consists of sums of lattices of index $p^{n+1}$ with respect to the original lattice. Let $L$ be the lattice we are computing the coefficients of, and $L'$ a lattice of index $p^{n+1}$ in $L$, with coefficients $(a,b,c)$ relative to the operators $T_{p^n} T_p$, $T_{p^{n+1}}$, and $T_{p^{n-1}} R_p$. Note that $b$ is always equal to 1, so suffices to prove that $a = 1 + pc$. We split the proof into two cases
    %
    \begin{itemize}
        \item ($L' \not \subset pL$). Then $c = 0$, and we need to prove $a = 1$. We want to prove that there is a unique lattice $L''$ with $L' \subset L'' \subset L$, with $L''$ index $p$ in $L$. $L''/pL$ is a group of order $p$. But the image of $L'$ in $L''/pL$ is nontrivial, and contained within $L''/pL$, so $L'/pL = L''/pL$, and this uniquely identifies $L''$.
        \item ($L' \subset pL$) Then $c = 1$, and we need to prove $a = p + 1$. That is, $L'$ is contained within $p + 1$ lattices of index $p$ with respect to $L$. But if a lattice has index $p$ it contains $pL$, so we need only count the number of lattices of index $p$, which is the number of size $p$ subgroups of $L/pL \cong \mathbf{Z}_p^2$. This then follows from vector space theory.
    \end{itemize}
\end{proof}

There are some nice corollaries to this theorem. Indeed, as with most multiplicative functions, $T_{p^n}$ can be written as a polynomial in $R_p$ and $T_p$, and thus $T_n$ as a polynomial in the primes which form $T_n$. Furthermore, the algebra generated by all prime $T_p$ and $R_p$ is abelian, and contains all $T_n$.

Recall that a function $F$ on lattices is weakly modular if $F(\lambda L) = \lambda^{-k} F(L)$. This can be rewritten in terms of the operators we have defined, via the equation $F \circ R_\lambda = \lambda^{-k} F$. If we view $R_\lambda$ as an operator on the set of lattice functions, the weakly modular functions are exactly the eigenvectors of eigenvalue $\lambda^{-k}$. Since $T_n$ commutes with $R_\lambda$, we find
%
\[ R_\lambda T_n F = T_n R_\lambda F = \lambda^{-k} T_n F \]
%
So that $T_n F$ is also weakly modular (we can extend a function on lattices to formal sums of lattices by linearity). In order to apply the operator $T_n$, we shall construct a more explicit formula.

\begin{lemma}
    The index of the lattice $L(az + bw, cz + dw)$ in $L(z,w)$ is the determinant of the matrix $\left( \begin{smallmatrix} a & b \\ c & d \end{smallmatrix} \right)$.
\end{lemma}
\begin{proof}
    We may reduce the matrix above into smith normal form by multiplying to the left and right by invertible integer matrices, which must therefore have determinant $\pm 1$, and thus the lattice we obtain from the new matrix is the same as the original lattice, but now of the form $L(xz, yw)$. But then $L(z,w)/L(xz,yw) \cong \mathbf{Z}_x \oplus \mathbf{Z}_y$, so $L(xz, yw)$ has index $xy$ in $L(z,w)$.
\end{proof}

\begin{lemma}
    For a fixed lattice $L(z,w)$, the map
    %
    \[ \begin{pmatrix} a & b \\ 0 & d \end{pmatrix} \mapsto L(az + bw, dw) \]
    %
    is a bijection between matrices with $ad = n$ and $0 \leq b < d$, and index $n$ sublattices of $L(z,w)$.
\end{lemma}
\begin{proof}
    Certainly the image of any matrix with $ad = n$ is a sublattice of index $n$. On the other hand, let $L'$ be an index $n$ sublattice, and consider
    %
    \[ Y = L/(L' + \mathbf{Z}w)\ \ \ \ \ \ \ \ \ \ Z = \mathbf{Z}w/(L' \cap \mathbf{Z}w) \]
    %
    Then $Y$ is cyclic and generated by the image of $z$, and $Z$ is cyclic generated by the image of $w$. Let $Y$ have order $a$, and $Z$ order $d$. We have an exact sequence
    %
    \[ 0 \to Z \to L/L' \to Y \to 0 \]
    %
    so $ad = n$. If $w' = dw$, then $w' \in L'$. Furthermore, there is $z' \in L'$ such that $z' = az$ modulo $\mathbf{Z}w$. Write $z' = az + bw$. Then $b$ is uniquely determined modulo $d$ relative to $z'$. Thus we have shown the bijection between the two sets.
\end{proof}

Given a weakly modular weight $k$ lattice function $F$, we may define a function $f(z) = F(z,1)$, and then one lets the operators $T_n$ act on $f$, by
%
\[ T_n f = n^{k-1} T_n F \]
%
The $n^{k-1}$ is for now an arbitrary constant, but we shall see that if the $q$-expansion of $f$ is integral, then the $q$ expansion of $T_n f$ will be integral, when we include the factor of $n^{k-1}$. The previous lemma tells us that
%
\[ T_n f (z) = n^{k-1} \sum_{ad = n} \sum_{b = 0}^{d-1} F(az + b, d) = n^{k-1} \sum_{ad = n} \sum_{b = 0}^{d-1} d^{-k} f \left( \frac{az + b}{d} \right) \]
%
By our previous discussion, we known $f$ is weakly modular. The $T_n$ also transforms the $q$ coefficients of $f$ in a predictable way, assuming $f$ is a modular function.

\begin{theorem}
    If $f(z) = \sum b_m q^m$, then $T_nf = \sum c_m q^m$,
    %
    \[ c_m = \sum_{a \divides \text{gcd}(n,m)} a^{2k-1} b_{nm/a^2} \]
    %
    where we sum only over positive choices of $a$.
\end{theorem}
\begin{proof}
    If we write $a/d = r$, then
    %
    \begin{align*}
        T_n f &= \sum_{ad = n} \sum_{m = -\infty}^\infty \left( \sum_{b = 0}^{d-1} e^{2 \pi i mb/d} \right) b_m n^{k-1} d^{-k} e^{2 \pi i maz/d}\\
        &= \sum_{m = -\infty}^\infty \sum_{ad = n} b_{md} (n/d)^{k-1} q^{maz}\\
        &= \sum_{r = -\infty}^\infty \left( \sum_{ad = n} \sum_{ma = r} b_{md} (n/d)^{k-1} \right) q^r\\
        &= \sum_{r = -\infty}^\infty \left( \sum_{a \divides \text{gcd}(n,r)} b_{rn/a^2} a^{k-1} \right) q^r
    \end{align*}
    %
    So the equation is obtained by combining terms.
\end{proof}

If $f$ is a modular function, then $b_m$ is zero for $m$ negative enough. We can use the formula above to conclude that $c_m$ is zero for $m$ negative enough. In fact, if $b_m = 0$ for $m < -M$, then $c_m = 0$ for $m < -n^2M$, for then $mn/a^2 \leq -Mn^3/a^2 < -M$, when $a \divides \text{gcd}(m,n)$. Thus $T_n f$ is a modular function whenever $f$ is a modular function, and is in fact a modular form if $f$ is a modular form. What's more, we find by direct calculation that $c_0 = b_0 \sigma_{k-1}(n)$, $c_1 = b_n$, and if $n$ is a prime number $p$, then $c_m = b_{mp}$ for all $m$ reatively prime to $p$, because then $\text{gcd}(m,p) = 1$.

\section{Hecke Eigenfunctions}

A modular form $f$ is a Hecke eigenfunction if there is a sequence $z_0, z_1, z_2, \dots$ such that $T_n f = z_n f$. The eigenfunctions form a subspace of all modular forms.

\begin{theorem}
    If $f = \sum a_n q^n$ is a non-zero Hecke eigenform, then $a_1 \neq 0$, and if $a_1 = 1$, then $a_n = z_n$ are the sequence of eigenvalues defining the eigenform.
\end{theorem}
\begin{proof}
    If $T_n f = \sum b_n q^n$, then we have already shown that $b_1 = a_n$, so that $a_n = z_n a_1$. If $a_1 = 0$, then $a_n = 0$ for all $n$, and hence $f = 0$. If $a_1 = 0$, then $a_n = z_n$.
\end{proof}

This also tells us that we can identify an eigenfunction by its eigenvalues, up to a scalar multiple. What's more, the $q$-coefficients of eigenfunctions are now seen to have very useful properties. By the composition properties of the operators $T_n$, we find that $a_m a_n = b_{mn}$ when $m$ and $n$ are relatively prime, and $a_p a_{p^n} = a_{p^{n+1}} + p^{k-1} a_{p^{n-1}}$ for $p$ prime.

Given a Hecke eigenfunction, the $q$-coefficients are multiplicative, which allows us to consider the Dirichlet series of $f$, denoted
%
\[ \phi_f(s) = \sum_{n = 1}^\infty \frac{a_n}{n^s} \]
%
and for all $s$ where the series is defined, we have
%
\[ \sum_{n = 1}^\infty \frac{a_n}{n^s} = \prod_{p\ \text{prime}} (1 + a_p p^{-s} + \dots + a_{p^n} p^{-ns} + \dots) \]
%
essentially for the same reason that the product formula holds for the Riemann zeta function. In fact, we have the formula
%
\[ \phi_f(s) = \prod_{p\ \text{prime}} \frac{1}{1 - c_p p^{-s} + p^{k-1-2s}} \]
%
Which follows because of the recurrence relation for the coefficients of prime powers.

The first example of an eigenfunction we can construct is the Eisenstein series $E_k$. First we rely on the fact that we need only prove that $E_k$ is an eigenfunction of $T_p$ for $p$ prime, because all of the operators $T_n$ are obtained from prime operators by composition. We reduce to the lattice definition of the series
%
\[ E_k(L) = \sum_{\substack{x \in L\\x \neq 0}} \frac{1}{|x|^k} \]
%
Now we have
%
\[ T_p E_k (L) = \sum_{(L':L) = p} \sum_{\substack{x \in L'\\x \neq 0}} \frac{1}{|x|^k} \]
%
Fix $x \in L$. If $x \in pL$ then $x \in L'$ for each of the $p + 1$ index $p$ sublattices of $L$. If $x$ is not in $pL$ then it belongs to exactly one of the sublattices $L'$, since these sublattices intersect trivially. It follows that
%
\[ T_p E_k (L) = E_k(L) + p E_k(pL) = (1 + p^{1-k}) E_k(L) \]
%
and thus $E_k$ is an eigenfunction. This shows that the divisor functions $\sigma_k$ are multiplicative, but this is already obvious from their definition.

The second example results from the low dimensionality of low order modular forms. The set of cusp forms of order 12 is one dimensional, because the set of all modular forms of order 12 is two dimensional, spanned by $E_4^3$ and $E_3^4$. Since $T_n \Delta$ is a cusp form of order 12 for every $n$, $T_n \Delta$ must be a multiple of $\Delta$ for each $n$, so $\Delta$ must be an eigenfunction! Since the coefficients of $\Delta$ are the values of the Ramanujan tau function, we have proved the famous result that $\tau$ is multiplicative.










\chapter{Congruence Modular Forms}

Two subgroups $H$ and $K$ are commensurable if $H \cap K$ has finite index in both $H$ and $K$. Given these two groups, for a fixed $x \in G$, we can consider the double coset $HxK$.

\begin{theorem}
    Let $H$ be a subgroup of a group $G$ and let $x \in G$ be such that $H$ and $x^{-1}Hx$ are commensurable. Let $K = x^{-1}Hx \cap H$ and let $n = [H:K]$. Then if $y_1, \dots, y_n$ is a set of coset representatives for $H/K$, then
    %
    \[ H x H = \bigcup_{j = 1}^n H x y_n \]
    %
    is a disjoint union of right cosets. Conversely, if $HxH$ is a disjoint union of right cosets with representatives $y_1, \dots, y_n$ then $H = \bigcup_{j = 1}^n K y_j$.
\end{theorem}
\begin{proof}
    By coset arithmetic, we find
    %
    \[ HxH = \bigcup_{j = 1}^n HxKy_j \subset \bigcup_{j = 1}^n Hxx^{-1}Hxy_j = \bigcup_{j = 1}^n Hxy_j \]
    %
    That the reverse relation holds is trivial, because $K \subset H$. This is a disjoint union, for if $zxy_n = z'xy_m$ then $y_my_n^{-1} = x^{-1}z'^{-1}zx \in x^{-1}Hx$, and trivially $y_my_n^{-1} \in H$, so $y_m = y_n$.

    Conversely, suppose that $HxH = \bigcup_{j = 1}^n Hxy_n$. Then
    %
    \[ H = Hxx^{-1} \subset HxHx^{-1} = \bigcup_{j = 1}^n Hxy_nx^{-1} \subset \bigcup_{j = 1}^n Ky_n \]
    %
    The last inequality follows because $xy_nx^{-1}$ is in the same coset of $K$ as $y_n$.
\end{proof}

\end{document}