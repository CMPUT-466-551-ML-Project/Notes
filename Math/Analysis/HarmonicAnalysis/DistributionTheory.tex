%% The following is a directive for TeXShop to indicate the main file
%%!TEX root = HarmonicAnalysis.tex

\part{Distributional Methods}

\chapter{The Theory of Distributions}

Distribution theory is a tool which enables us to justify formal manipulations in harmonic analysis without having to worry about technical issues arising form interpreting these manipulations analytically. In particular, it enables us to define the formal derivative of a much more general class of functions than given by the classical differential calculus. That such a consistant formal definition of the derivative is possible is hinted at by equations in Fourier analysis such as
%
\[ (D^i v)^\ft = M^i \widehat{v} \quad\text{and}\quad (M^i v)^\ft = -D^i \widehat{v}, \]
%
where $Mf(x) = (2 \pi i x_i) f(x)$, and $D^i f(x)$ is differentiation in the variable $x_i$. The domains of the classical definition of the terms on each side of these equations is different from one another. Using the theory of distributions, we will find a common domain (the space of tempered distributions) upon which each term in these equations can be well defined. If we consider solutions $u \in C^2(\RR^d)$ to elliptic partial differential equations like the Laplace equation $\Delta u = 0$, then the family of such functions is closed under the topology of uniform convergence. This is no longer true for solutions to certain non-elliptic partial differential equations, such as solutions to the wave equation $\partial_t u = \Delta u$ in $C^2(\RR \times \RR^d)$. For instance, such a class would have to contain all function of the form $f(x + y) + g(x - y)$ for $f,g \in C(\RR \times \RR^d)$. We can fix this problem by considering \emph{weak solutions} to the wave equation, i.e. functions $u \in L^1(\RR^d)$ such that for any $\phi \in C_c^\infty(\RR \times \RR^d)$,
%
\[ \int u(t,x) (\Delta \phi - \partial_t \phi)(t,x)\; dt\; dx = 0, \]
%
an equation true for any classical solution, as verified by integration by parts. This class will certainly be closed in $L^\infty(\RR^d)$. The step to distributional solutions to partial differential equations from classical solutions is then not far off, allowing one to find a \emph{distribution} $v(t,x)$ such that
%
\[ \int u(t,x) (\Delta \phi - \partial_t \phi)(t,x)\; dt\; dx = \int v(t,x) \phi(t,x)\; dt\; dx \]
%
for \emph{any} $u \in L^1(\RR^d)$, thus enabling us to define $\partial_t u - \Delta u$ for any such function. And for any such `function' $v$, the family of \emph{distributional solutions} $u$ to the equation $\partial_t u - \Delta u = v$ will be closed under a very general topology. These properties show why distributions have become a cornerstone to the formulation of many problems in modern harmonic analysis.

The path of modern analysis has extended analysis from the study of continuous and differentiable functions to measurable functions. The power of this approach is that we can study a very general class of functions. On the other hand, the more general the class of functions we work with, the more restricted the analytical operations we can perform. Nonetheless, $C^\infty_c(\RR^d)$ is dense in almost all the spaces of measurable functions we consider in basic analysis, and for such functions we can apply all the fundamental analytical operations in this region. One approach to studying the general class of measurable functions is to prove results for elements of $\DD(\RR^d)$, and then apply an approximation result to obtain the result for a wider class of measurable functions. The theory of distributions provides a complimentary approach, using \emph{duality} to formally extend analytical operations on $C^\infty_c(\RR^d)$ to larger sets.

From the perspective of set theory, functions $f: X \to Y$ are a way of assigning values in $Y$ to each point in $X$. However, in analysis this perspective is often not the most useful. This is most clear in measure theory, where we are used to treating a function only defined `up to a set of measure zero', and thus not defined at any particular point. In distribution theory, we view functions as `integrands', whose properties are understood by integration against a family of `test functions'. For instance, recall that for $1 \leq p < \infty$, the dual space of $L^p(\RR^d)$ is $L^q(\RR^d)$. Thus we can think of elements $f \in L^q(\RR^d)$ as `integrands', whose properties can be understood by integration (or `testing') against elements of $L^p(\RR^d)$, i.e. through the linear functional on $L^p(\RR^d)$ given by
%
\[ \phi \mapsto \int_{\RR^d} f(x) \phi(x)\; dx. \]
%
Similarily, the dual space of $C(K)$, where $K$ is a compact topological space, is the space $M(K)$ of finite Borel measures on $K$. Thus we can think of measures as a family of `generalized functions'. For each measure $\mu \in M(K)$, we consider the linear functional on $C(K)$ through the map
%
\[ \phi \mapsto \int_K \phi(x) d\mu(x). \]
%
Notice that as we shrink the family of test functions, the resultant family of `generalized functions' becomes larger and larger, and so elements can behave more and more erratically. A distribution is a `generalized function' tested against functions in $\DD(\RR^d)$. Since most operations in analysis can be applied to elements of $\DD(\RR^d)$, we can then use duality to extend these operations to distributions. Moreover, since $\DD(\RR^d)$ is a very `tame' space of functions, distributions are a very general family of generalized functions. The class $\DD(\RR^d)$ has proven to be the most natural class of functions for most problems studied in harmonic analysis. But one can apply the ideas described in this chapter to many other classes of test functions. Provided that the test functions can be suitably localized, one will likely obtain similar results to that described in this chapter. On the other hand, if one deals with non localizable families of test functions, one is likely to obtain quite a different theory of generalized functions. This is encountered, for instance, if one takes the family of analytic functions as the test functions, which gives the theory of \emph{hyperfunctions}.

\begin{remark}
  From the perspective of experimental physics, viewing functions as integrands is more natural than viewing functions in the set-theoretic sense. Indeed, points in space are idealizations which do not correspond to real world phenomena. One can never measure the exact value of some quantity of a function at a point, but rather only understand the function by looking at it's averages over a small region around that point. Thus the only physically meaningful properties of a `function' are those obtained by testing that function against some family of test functions, obtained from some physical measurements.
\end{remark}

\section{The Space of Test Functions}

We fix an open subset $\Omega$ of $\RR^n$, and let $\DD(\Omega) = \DD(\Omega)$ denote the family of all smooth functions on $\Omega$ with compact support. Our goal is to equip $\DD(\Omega)$ with a complete locally convex topology, so that we can consider the dual space $\DD^*(\Omega)$ of \emph{distributions} on $\Omega$. We could equip $\DD(\Omega)$ with a locally convex, metrizable topology with respect to the seminorms
%
\[ \| f \|_{C^n(\Omega)} = \max_{|\alpha| \leq n} \| D^\alpha f \|_{L^\infty(\Omega)} \]
%
However, the resultant topology on $\DD(\Omega)$ is not complete.

\begin{example}
    Let $\Omega = \RR$, pick a bump function $\phi \in \DD(\RR)$ supported on $[0,1]$ with $\phi > 0$ on $(0,1)$, and define
    %
    \[ \psi_m(x) = \phi(x-1) + \frac{\phi(x-2)}{2} + \dots + \frac{\phi(x-m)}{m} \]
    %
    Then $\psi_m$ is compactly supported on $[1,m]$, and Cauchy, since for $m_1 \geq m_0$,
    %
    \[ \| \psi_{m_0} - \psi_{m_1} \|_{C^n(\RR)} = \frac{ \max_{r \leq n} \| D^r \phi \|_{L^\infty(\RR^d)}}{m_0+1} \lesssim_n 1/m_0. \]
    %
    However, the sequence $\{ \psi_m \}$ does not converge to any element of $\DD(\RR)$, since the sequence converges uniformly to the function
    %
    \[ \psi(x) = \sum_{n = 1}^\infty \psi(x-n) \]
    %
    an element of $C^\infty(\RR)$ which is not compactly supported.
\end{example}

We instead assign $\DD(\Omega)$ a stronger locally convex topology which prevents convergent functions from `escaping open sets'; the cost, however, is that the topology is no longer metrizable. The process we perform here is quite general and can be viewed as a way to construct the `categorical limit' of a family of complete, locally convex spaces. For each compact set $K \subset \Omega$, the subspace $C_c^\infty(K) \subset \DD(\Omega)$ is a complete metric space under the family of seminorms $\| \cdot \|_{C^n(K)}$. We consider a convex topology on $\DD(\Omega)$ by considering the family of sets $\{ \phi + W \}$ as a basis, where $\phi$ ranges over all elements of $\DD(\Omega)$, and $W$ ranges over all convex, balanced subsets of $\DD(\Omega)$ such that $W \cap C_c^\infty(K)$ is open in $C_c^\infty(K)$ for each $K \subset \Omega$.

\begin{theorem}
    This gives a basis of a Hausdorff topology on $\DD(\Omega)$.
\end{theorem}
\begin{proof}
    If $\phi_1 + W_1$ and $\phi_2 + W_2$ both contain $\phi$, then $\phi - \phi_1 \in W_1$ and $\phi - \phi_2 \in W_2$. The functions $\phi, \phi_1$, and $\phi_2$ are all supported on some compact set $K$. By continuity of multiplication on $C_c^\infty(K)$, and the fact that $W_n \cap C_c^\infty(K)$ is open, there is a small constant $\delta$ such that $\phi - \phi_n \in (1 - \delta) W_n$ for each $n \in \{ 1, 2 \}$. The convexity of the $W_n$ implies that $\phi - \phi_n + \delta W_n \subset W_n$. But then $\phi + \delta W_n \subset \phi_n + W_n$, and so $\phi + \delta (W_1 \cap W_2) \subset (\phi_1 + W_1) \cap (\phi_2 + W_2)$. Thus we have verified the family of sets specified above is a basis. Now we show $\DD(\Omega)$ is Hausdorff under this topology. Suppose $\phi$ is in every open neighbourhood of the origin, then in particular, for each $\varepsilon > 0$, $\phi$ lies in the set $W_\varepsilon = \{ f \in \DD(\Omega): \| f \|_{L^\infty(\Omega)} < \varepsilon \}$, and it is easy to see these sets are open. Since $\bigcap_{\varepsilon > 0} W_\varepsilon = \{ 0 \}$, this means $\phi = 0$.
\end{proof}

\begin{remark}
    This technique can be formulated more abstractly to give a locally convex topological structure to the direct limit of locally convex spaces. From this perspective, we also see why our metrization doesn't work; if $X = \lim X_n$, with each $X_n$ a locally convex metrizable space, then we cannot give $X$ a complete metrizable topology such that each $X_n$ is an embedding and has empty interior in $X$, because this would contradict the Baire category theorem. In particular, this means that the topology we have given to $C_c(\Omega)$ cannot be metrizable, and therefore the space cannot be first countable. Later we will see a more explicit proof of this.
\end{remark}

\begin{theorem}
    $\DD(\Omega)$ is a locally convex space.
\end{theorem}
\begin{proof}
    Fix $\phi$ and $\psi$, and consider any neighbourhood $W$ of the origin. By convexity, we have $(\phi + W/2) + (\psi + W/2) \subset (\phi + \psi) + W$. This shows addition is continuous. To show multiplication is continuous, fix $\lambda$, $\phi$, and a neighbourhood $W$ of the origin. Then $\phi$ is supported on some compact set $K$, and $W \cap C_c^\infty(K)$ is open, in particular absorbing, so there is $\varepsilon > 0$ such that if $|\alpha| < \varepsilon$, $\alpha \phi \in W/2$. Then if $|\gamma - \lambda| < \varepsilon$, then because $W$ is balanced and convex,
    %
    \begin{align*}
        \gamma \left(\phi + \frac{W}{2(|\lambda| + \varepsilon)} \right) &= \lambda \phi + (\gamma - \lambda) \phi + \frac{\gamma}{2(|\lambda| + \varepsilon)} W\\
        &\subset \lambda \phi + W/2 + W/2 \subset \lambda \phi + W
    \end{align*}
    %
    so multiplication is continuous.
\end{proof}

\begin{theorem}
    For each compact set $K \subset \Omega$, the canonical embedding of $C_c^\infty(K)$ in $\DD(\Omega)$ is continuous.
\end{theorem}
\begin{proof}
    We shall prove a convex, balanced neighbourhood $V$ is open in $\DD(\Omega)$ if and only if $C_c^\infty(K) \cap V$ is open in $C_c^\infty(K)$ for each $K$. Since $V$ is open, $V$ is the union of convex, balanced sets $W_\alpha$ with $W_\alpha \cap C_c^\infty(K)$ open in $C_c^\infty(K)$ for each $K$. But then $V \cap C_c^\infty(K) = (\bigcup W_\alpha) \cap C_c^\infty(K)$ is open in $C_c^\infty(K)$. The converse is true by definition of the topology. But this statement means exactly that the map $C_c^\infty(K) \to \DD(\Omega)$ is an embedding, because it is certainly continuous, and if $W$ is a convex neighbourhood of the origin equal to the set of $\phi$ supported on $K$ with $\| \phi \|_{C^n(K)} \leq \varepsilon$ for some $n$, then the image is the intersection of $C_c^\infty(K)$ with the set of all $\phi$ supported on $\Omega$ satisfying the inequality, which is open. This shows that the map is open onto its image, hence an embedding.
\end{proof}

It is difficult to see from the definition above why the topology is much stronger than the previous one given. We can see this more numerically by introducing the topology in terms of seminorms. The topology we have given $\DD(\Omega)$ is the same as the locally convex topology introduced by all norms $\| \cdot \|$ on the space which are continuous when restricted to each $C_c^\infty(K)$. As an example, if we choose an increasing family $U_1, U_2, \dots$ of precompact open sets whose closure is contained in $\Omega$, then any compact set $K$ is contained in some $U_N$ for large enough $N$, and for any increasing sequence $\alpha_1, \alpha_2, \dots$ of positive constants and increasing sequence $k_1, k_2, \dots$ of positive integers the norm
%
\[ \| f \| = \min_{\text{supp}(f) \subset U_n} \alpha_n \| f \|_{C^{k_n}(U_n)} \]
%
is well defined on $\DD(\Omega)$ and continuous. But if $\{ f_i \}$ is a sequence such that $\lim_{i \to \infty} f_i = 0$, then $\lim_{i \to \infty} \| f_i \| = 0$ for any choice of constants $\alpha_n$ and $k_n$. This means that, asymptotically, as we approach the boundary of $\Omega$, the sequence $\{ f_i \}$ must converge arbitrarily rapidly to zero. The next theorem shows that this implies that the union of the domains $f_n$ must actually be precompact. It is this `uniform compactness' that gives us completeness.

\begin{theorem}
    Consider any $E \subset \DD(\Omega)$. Then $E$ is a bounded subset of $\DD(\Omega)$ if and only if $E$ is contained in $C_c^\infty(K)$ for some compact set $K$, and there is a sequence of constants $\{ M_n \}$ such that $\| \phi \|_{C^n(\Omega)} \leq M_n$ for all $\phi \in E$.
\end{theorem}
\begin{proof}
    We shall now prove that if $E$ is not contained in some $C_c^\infty(K)$ for any compact set $K \subset \Omega$, then $E$ is not bounded. If our assumption is true, we can find functions $\phi_n \in E$ and a set of points $x_n \in X$ with no limit point such that $\phi_n(x_n) \neq 0$. For each $n$, set
    %
    \[ W_n = \left\{ \psi \in \DD(\RR^d): |\psi(x_n)| < n^{-1} |\phi_n(x_n)| \right\}. \]
    %
    Certainly $W_n$ is convex and balanced, and for each compact set $K$, if $\psi \in W_n \cap C_c^\infty(K)$, then there is $\varepsilon > 0$ such that $|\psi(x_n)| < n^{-1} |\phi_n(x_n)| - \varepsilon$. Thus if $\eta \in C_c^\infty(K)$ satisfies $\| \eta \|_{L^\infty(\RR^d)} < \varepsilon$, then $\psi + \eta \in W_n$. In particular, this means $W_n \cap C_c^\infty(K)$ is open in $C_c^\infty(K)$ for each $K$, so $W_n$ is open.

    Now we claim $W = \bigcap_{n = 1}^\infty W_n$ is open. Certainly this set is convex and balanced. Moreover, each compact set $K$ contains finitely many of the points $\{ x_n \}$, so $W \cap C_c^\infty(K)$ can be replaced by a finite intersection of the $W_n$, and is therefore open. Since $\phi_n \not \in nW$ for all $n$, this implies that $E$ is not bounded. The fact that $\| \cdot \|_{C^n(\Omega)}$ specifies the topological structure of $C_c^\infty(K)$ for each compact $K$ now shows that if $E$ is bounded, there exists constants $\{ M_n \}$ such that $\| \phi \|_{C^n(\Omega)} \leq M_n$ for all $\phi \in E$. The converse property follows because $C_c^\infty(K)$ is embedded in $\DD(\Omega)$.
\end{proof}

\begin{corollary}
    $\DD(\Omega)$ has the Heine Borel property.
\end{corollary}
\begin{proof}
    This follows because if $E$ is bounded and closed, it is a closed and bounded subset of some $C_c^\infty(K)$ for some $K$, hence $E$ is compact since $C_c^\infty(K)$ satisfies the Heine-Borel property (this can be proved by a technical application of the Arzela-Ascoli theorem).
\end{proof}

\begin{corollary}
    $\DD(\Omega)$ is quasicomplete.
\end{corollary}
\begin{proof}
    If $\phi_1, \phi_2, \dots$ is a Cauchy sequence in $\DD(\Omega)$, then the sequence is bounded, hence contained in some common $C_c^\infty(K)$. Since the sequence is Cauchy, they converge in $C_c^\infty(K)$ to some $\phi$, since $C_c^\infty(K)$ is complete, and thus the $\phi_n$ converge to $\phi$ in $\DD(\Omega)$.
\end{proof}

It is often useful to use the fact that we can perform a `separation of variables' to a smooth function. This is done formally in the following manner. Say $f \in \DD(\RR^d)$ is a {\it tensor function} if there are $f_1, \dots, f_n \in \DD(\RR)$ such that $f(x) = f_1(x_1) \dots f_n(x_n)$. We write $f = f_1 \otimes \dots \otimes f_n$. Since the product of two tensor functions is a tensor function, the family of all finite sums of tensor functions forms an algebra.

\begin{theorem}
    Finite sums of tensor functions are dense in $\DD(\RR^d)$.
\end{theorem}
\begin{proof}
    Recall from the theory of multiple Fourier series that if $f \in C^\infty(\RR^d)$ is $N$ periodic, in the sense that $f(x + n) = f(x)$ for all $x \in \RR^d$ and $n \in (N \ZZ)^d$, then there are coefficients $a_m$ for each $m \in \ZZ^n$ such that $f = \lim_{M \to \infty} S_M f$, where the convergence is dominated by the sminorms $\| \cdot \|_{C^n(\RR^d)}$, for all $n > 0$, and
    %
    \[ (S_M f)(x) = \sum_{\substack{m \in \ZZ^d\\|m| \leq M}} a_m e^{\frac{2 \pi i m \cdot x}{N}}. \]
    %
    Note that since
    %
    \[ e^{\frac{2 \pi i m \cdot x}{N}} = \prod_{k = 1}^d e^{2 \pi i m_ix_i/N} \]
    %
    is a tensor product, $S_M f$ is a finite sum of tensor functions. If $\phi \in \DD(\RR^d)$ is compactly supported on $[-N,N]^d$, we let $f$ be a $10N$ periodic function which is equal to $\phi$ on $[-N,N]^d$. We then find coefficients $\{ a_m \}$ such that $S_M f$ converges to $f$. If $\psi: \RR \to \RR$ is a compactly supported bump function equal to one on $[-N,N]^d$, and vanishing outside of $[-2N,2N]^d$, then $\psi^{\otimes d} S_M f$ converges to $\psi$ as $M \to \infty$, and each is a finite sum of tensor functions.
\end{proof}

We can actually go one step further than this.

\begin{theorem}
    For any open sets $\Omega$ and $\Psi$, $\DD(\Omega \times \Psi)$ is isomorphic to the \emph{projective} tensor product $\DD(\Omega) \otimes \DD(\Psi)$.
\end{theorem}
\begin{proof}
    Let $X$ denote the \emph{algebraic} tensor product of $\DD(\Omega)$ and $\DD(\Psi)$. Then we have an injective map $i: X \to \DD(\Omega \times \Psi)$ with dense image. Because $i$ is bilinearly continuous, $i$ is continuous in the projective tensor product topology. Conversely, for any two compact sets $K_1 \subset \Omega$ and $K_2 \subset \Psi$, $i(C_c^\infty(K_1) \otimes C_c^\infty(K_2)) \subset \DD(K_1 \times K_2)$. For any $N > 0$, pick multi-indices $\alpha_i = \lambda_i + \gamma_i$ such that $\| f_i \|_{C^N(K_1)} = |D^{\lambda_i} f_i(x_i)|$ and $\| g_i \|_{C^N(K_2)} = |D^{\gamma_i} g_i(y_i)|$.

    Doesn't diagonal example show this map is not open (i.e. $h(x) = \sum_{k = 1}^{n-1} \phi(nx - k) \phi(ny - k)$, with $\| h \|_{C^N} \sim n^N$, but with the projective tensor product norm proportional to $n^{2N}$)

    find a multi-index $\alpha = \alpha_1 + \alpha_2$ with $|\alpha| \leq N$ and $(x_0,y_0)$ such that
    %
    \[ \| h \|_{C^N(K_1 \times K_2)} = |D^\alpha h(x_0,y_0)|. \]
    %
    Then $D^\alpha h(x_0,y_0) = \sum D^{\alpha_1} f_i(x_0) D^{\alpha_2} g_i(y_0)$



    We claim this is continuous when we equip $X$ with the projective tensor topology. For any $f_1,\dots,f_n \in C_c^\infty(K_1)$, $g_1,\dots,g_n \in C_c^\infty(K_2)$, $h = f_1 \otimes g_1 + \dots + f_n \otimes g_n$ is supported on $K_1 \times K_2$, and for any $N > 0$,
    %
    \begin{align*}
        \| h \|_{C^N(K_1 \times K_2)} &\leq \| f_1 \otimes g_1 \|_{C^N(K_1 \otimes K_2)} + \dots + \| f_n \otimes g_n \|_{C^N(K_1 \times K_2)}\\
        &\leq \| f_1 \|_{C^N(K_1 \otimes K_2)} \| g_1 \|_{C^N(K_1 \otimes K_2)} + \dots + \| f_n \|_{C^N(K_1 \otimes K_2)} \| g_n \|_{C^N(K_1 \otimes K_2)}.
    \end{align*}
    %
    Taking infima over all representations of $h$ as a sum of tensor products therefore gives that $\| h \|_{C^N(K_1 \times K_2)} \leq \| h \|_{C^N(K_1) \otimes C^N(K_2)}$. Conversely, given any function $h \in i(X)$, fix $N > 0$, and suppose $(x_0,y_0)$ and $\alpha$ are such that $\| h \|_{C^N(K_1 \times K_2)} = |D^\alpha h(x_0,y_0)|$. Then if $h = \sum f_i \otimes g_i$, $\sum D^\alpha (f_i \otimes g_i)(x) = h(x_0,y_0)$, so 
\end{proof}

Because $\DD(\Omega)$ is the limit of metrizable spaces, it's linear operators still have many of the same properties as metrizable spaces.

\begin{theorem}
    If $T: \DD(\Omega) \to X$ is a map from $\DD(\Omega)$ to some locally convex space $X$, then the following are equivalent:
    %
    \begin{itemize}
        \item[(1)] $T$ is continuous.
        \item[(2)] $T$ is bounded.
        \item[(3)] If $\{ \phi_n \}$ converges to zero, then $\{ T\phi_n \}$ converges to zero.
        \item[(4)] For each compact set $K \subset \Omega$, $T$ is continuous restricted to $C_c^\infty(K)$.
    \end{itemize}
\end{theorem}
\begin{proof}
    We already known that (1) implies (2). If $T$ is bounded, and we have a sequence $\{ \phi_n \}$ converging to zero, then the sequence is bounded, hence contained in some $C_c^\infty(K)$. Then $T$ is bounded as a map from $C_c^\infty(K)$ to $X$, hence $\{ T\phi_n \} \to 0$. (3) implies (4) because each $C_c^\infty(K)$ is metrizable, and any convergent sequence is contained in some common $C_c^\infty(K)$. To prove that (4) implies (1), we let $V$ be a convex, balanced, open subset of $X$. Then $T^{-1}(V) \cap C_c^\infty(K)$ is open for each $K$, and $T^{-1}(V)$ is convex and balanced, so $T^{-1}(V)$ is an open set.
\end{proof}

Because convergence is so strict in $\DD(\Omega)$, almost every operation we want to perform on smooth functions is continuous in this space.
%
\begin{itemize}
    \item Since $f \mapsto D^\alpha f$ is a continuous operator from $C_c^\infty(K)$ to itself, it is therefore continuous on the entire space $\DD(\Omega)$. More generally, any linear differential operator with coefficients in $\DD(\Omega)$ is a continuous operator from $\DD(\Omega)$ to itself.

    \item The inclusion $\DD(\Omega) \to L^p(\Omega)$ is continuous. To prove this, it suffices to prove for each compact $K$, the inclusion $C_c^\infty(K) \to L^p(\Omega)$ is continuous, and this follows because $\| f \|_{L^p(\Omega)} \leq |K|^{1/p} \| f \|_\infty$.

    \item If $f \in L^1(\RR^d)$ is compactly supported, then for any $g \in \DD(\RR^d)$, $f * g \in \DD(\RR^d)$. This is because $f * g$ is continuous since $g \in L^\infty(\RR^n)$, and it's support is contained in the algebraic sums of the support of $f$ and $g$, as well as the identity $D^\alpha(f * g) = f * (D^\alpha g)$. In fact, the map $g \mapsto f * g$ is a continuous operator on $\DD(\RR^n)$. This is because if we restrict our attention to $C_c^\infty(K)$, and $f$ has supported on $K'$, then our convolution operator maps into the compact set $K+K'$, and since
    %
    \[ \| D^\alpha (g * f) \|_{L^\infty(K + K')} = \| D^\alpha g * f \|_{L^\infty(K + K')} \leq \| D^\alpha g \|_{L^\infty(K)} \| f \|_{L^1(K')}, \]
    %
    we conclude
    %
    \[ \| g * f \|_{C^n(K+K')} \leq \| g \|_{C^n(K)} \| f \|_{L^1(K')}, \]
    %
    which gives continuity of the operator as a map from $C_c^\infty(K)$ to $C_c^\infty(K+K')$. Since the latter space embeds in $\DD(\RR^n)$, we obtain continuity of the operator on $\DD(\RR^n)$.
\end{itemize}

\begin{theorem}
    If a map $T: C_c^\infty(K_0) \to \DD(\RR^n)$ is continuous, then the image of $C_c^\infty(K_0)$ is actually $C_c^\infty(K_1)$ for some compact set $K_1$.
\end{theorem}
\begin{proof}
    Suppose there is a sequence $\{ x_i \}$ in $\RR^d$ with no limit point and smooth functions $\{ \phi_i \}$ compactly supported on $C_c^\infty(K_0)$ such that
    %
    \[ (T\phi_i)(x_i) \neq 0. \]
    %
    Then for any sequence $\{ \alpha_i \}$ of positive scalars, the sequence $\{ \alpha_i T\phi_i \}$ does not converge to zero, since the union of the supports of $\alpha_i T\phi_i$ is unbounded. This means $\alpha_i \phi_i$ does not converge to zero. But this is clearly not true, for if we let
    %
    \[ \alpha_i = \frac{1}{2^i \| \phi_i \|_{C^i(\RR^d)}}, \]
    %
    then for any fixed $n$, $\lim_{i \to \infty} \| \alpha_i \phi_i \|_{C^n(\RR^d)} = 0$, so the sequence $\{ \alpha_i \phi_i \}$ converges to zero. Thus there cannot exist a sequence $\{ x_i \}$, and so the union of the supports of $T(C_c^\infty(K_0))$ is supported on some compact set $K_1$.
\end{proof}

Thus the topology on the space $\DD(\RR^d)$ is as strict as can be. As a consequence, we shall see that the weak-$*$ topology on $\DD^*(\RR^d)$ is essentially the weakest topology available in analysis. This is surprising, because we are still able to obtain the continuity of many operators in the dual space to $\DD(\RR^d)$.

\section{The Space of Distributions}

We now have the tools to explain the idea of a distribution. If $\psi \in \DD(\Omega)$, then the linear functional $\Lambda[\psi]$ on $\DD(\Omega)$ defined for each $\phi \in \DD(\Omega)$ by setting
%
\[ \Lambda[\psi](\phi) = \int \psi(x) \phi(x)\; dx \]
%
is continuous. Moreover, $\Lambda[\psi]$ determines $\psi$ uniquely, and so we can safely identify $\psi$ with $\Lambda[\psi]$ (thus looking at $\psi$ from a `distributional viewpoint'). The idea of the theory of distributions is to treat any continuous linear functional $\Lambda$ on $\DD(\Omega)$ as if it were given by integration against a test function. Thus for such a linear functional $\Lambda$, we often denote $\Lambda(\phi)$ by
%
\[ \int_{\RR^d} \Lambda(x) \phi(x)\; dx, \]
%
even if $\Lambda$ is not given by integration against some function. The space $\DD^*(\Omega)$ will be called the space of distributions on $\Omega$.

One huge advantage of this approach is that we can generalize many analytical operations defined on $\DD(\Omega)$ \emph{distributionally} to give an operation on $\DD^*(\Omega)$, even if the original analytical operations required some degree of smoothness to define. If $A$ is an operator on $\DD(\RR^d)$ with adjoint $A^*$, then for any $\phi,\psi \in \DD(\RR^d)$,
%
\[ \int_{\RR^d} (A\phi)(x) \psi(x)\; dx = \int_{\RR^d} \phi(x) (A^* \psi)(x)\; dx. \]
%
Thus given \emph{any} distribution $\Lambda$, we define $A \Lambda$ to be the distribution such that
%
\[ \int_{\RR^d} (A \Lambda)(x) \phi(x)\; dx = \int_{\RR^d} \Lambda(x) (A^* \phi)(x)\; dx. \]
%
Thus we have obtained a formal definition of $A$ which works for arbitrary distributions.

For instance, we can use this idea to define the derivative of an arbitrary distribution. For $\phi,\psi \in \DD(\RR)$, integration by parts tells us that
%
\[ \int_{-\infty}^\infty \phi'(x) \psi(x)\; dx = - \int_{-\infty}^\infty \phi(x) \psi'(x)\; dx. \]
%
Thus if $A\phi = \phi'$ is the derivative operator then it's adjoint is $A^* \psi = - \psi'$. Thus, for a distribution $\Lambda$ on $\RR$, we define it's derivative to be the distribution $\Lambda'$ such that for $\phi \in \DD(\RR)$,
%
\[ \Lambda'(\phi) = \Lambda(A^* \phi) = - \Lambda(\phi'). \]
%
More generally, for a distribution $\Lambda$ on $\RR^d$, and a multi-index $\alpha$, we define $D^\alpha \Lambda(\phi) = (-1)^{|\alpha|} \Lambda(D^\alpha \phi)$.

\begin{example}
    Let $H(x) = \mathbf{I}(x > 0)$ denote the {\it Heaviside step function}. Then $H$ is locally integrable, and so for any test function $\phi$, we calculate
    %
    \[ \int_{-\infty}^\infty H'(x) \phi(x)\; dx = - \int_{-\infty}^\infty H(x) \phi'(x) = - \int_0^\infty \phi'(x) = \phi(0) \]
    %
    Thus the \emph{distributional derivative} of the Heaviside step function is the Dirac delta function. It is not a function, but if we were to think of it as a `generalized function', it would be zero everywhere except at the origin, where it is infinitely peaked.
\end{example}

\begin{example}
    Consider the Dirac delta function at the origin, which is the distribution $\delta$ such that for any $\phi \in \DD(\RR)$,
    %
    \[ \int_{-\infty}^\infty \delta(x) \phi(x)\; dx = \phi(0). \]
    %
    Then
    %
    \[ \int_{-\infty}^\infty \delta'(x) \phi(x)\; dx = - \int_{\RR^d} \delta(x) \phi'(x)\; dx = - \phi'(0). \]
    %
    This is a distribution that does not arise from integration with respect to a locally integrable function nor integration against a measure, but it is an appropriate model of certain physical situations, i.e. for the distribution of electrical charge in a polarized point mass with positive charge to the `left', and negative charge to the 'right'.
\end{example}

\begin{example}
    Let $U \subset \RR^d$ be any open set such that $\partial U$ is a $C^1$ hypersurface. Then we can find a $C^1$ function $\rho: \RR^d \to \RR$ such that $U = \{ x : \rho(x) > 0 \}$, and $\nabla \rho$ is non-zero on $\partial U$. Let us calculate the derivatives of the distribution $u = \mathbf{I}_U$. Clearly $\nabla u$ is supported on the surface $S = \partial U$. Let us work locally around a point $x_0 \in S$, and without loss of generality, let us rotate so that in a neighborhood of $x_0$, if we write $x = (x',x_d)$, then $S$ is described by the equation $x_d = \psi(x')$, where $\psi$ is $C^1$. Pick $f \in C^\infty(\RR)$ such that $f(t) = 0$ for $t < 0$ and $f(t) = 1$ for $t \geq 1$. Then, locally around $x_0$, $u$ is the distributional limit of the functions $u_\varepsilon$, where
    %
    \[ u_\varepsilon(x) = f \left( \frac{x_d - \psi(x')}{\varepsilon} \right). \]
    %
    But
    %
    \[ \nabla u_\varepsilon(x) = (1/\varepsilon) \cdot f' \left( \frac{x_d - \psi(x')}{\varepsilon} \right) \cdot \left( 1, - \nabla \psi(x') \right) \]
    %
    which implies that for any $\phi \in C_c^\infty(\RR^d)$ supported near $x_0$, we calculate using a change of variables that
    %
    \begin{align*}
        \int &\phi(x) \nabla u(x)\; dx\\
        &= \lim_{\varepsilon \to 0} \int \phi(x) (1/\varepsilon) \cdot f' \left( \frac{x_d - \psi(x')}{\varepsilon} \right) \cdot \left( 1, - \nabla \psi(x') \right)\\
        &= \lim_{\varepsilon \to 0} \int \phi(x', \psi(x') + \varepsilon t) f'(t) (1, -\nabla \psi(x'))\; dt\; dx'\\
        &= \int \phi(x', \psi(x')) (1, -\nabla \psi(x'))\; dx.
    \end{align*}
    %
    Since the surface measure on $S$ is given by $dS = (1 + |\psi'|^2)^{1/2}\; dx'$, and the normal vector to the surface is given by $n = (1, -\nabla \psi(x')) / (1 + |\psi'|^2)^{1/2}$, it follows that
    %
    \[ \int \phi(x) \nabla u(x)\; dx = \int_S \phi(x) n(x)\; dS. \]
    %
    Switching to the global viewpoint, we now see that $\nabla u = n \cdot dS$. In particular, we have proved that for any smooth, compactly supported vector field $X = (X_1,\dots,X_n)$ on $\RR^d$,
    %
    \[ \int_S (\nabla \cdot X) = \sum \int u(x) \partial_i X_i(x)\; dx = - \int_S X \cdot n\; dS, \]
    %
    so our proof amounts exactly to the Gauss-Green divergence theorem. The fact that $n \cdot dS$ is a distribution of order zero implies that the Gauss-Green formula continues to hold for any $C^1$ compactly supported vector field. Perhaps the most general setting in which the distributional derivative calculation continues to hold for any domain $U$ which is a \emph{Caccioppoli set}, i.e. such that $u = \mathbf{I}_U$ is a function with bounded variation, which is where we can define a Radon measure which forms an analog $n \cdot dS$. In particular, we can still use the calculation for open sets with Lipschitz boundary, in which case the normal vector is only defined almost everywhere on the boundary.    
\end{example}

In general, we define a \emph{distribution} to be a continuous linear functional on the space of test functions $\DD(\Omega)$, i.e. an element of $\DD(\Omega)^*$. In the last section, our exploration of continuous linear transformations on $\DD(\Omega)$ guarantees that a linear functional $\Lambda$ on $\DD(\Omega)$ is continuous if and only if for every compact $K \subset X$ there is an integer $n_k$ such that $|\Lambda \phi| \lesssim_K \| \phi \|_{C^{n_k}(K)}$ for $\phi \in C_c^\infty(K)$. If one integer $n$ works for all $K$, and $n$ is the smallest integer with such a property, we say that $\Lambda$ is a distribution of \emph{order $n$}. If such an $n$ doesn't exist, we say the distribution has infinite order. If such an $n$ doesn't exist, we say the distribution has infinite order. Applying the Hahn-Banach theorem shows that if $\Lambda \in \DD^*(\Omega)$ has order $n$, then $\Lambda$ extends uniquely to a continuous functional on $C^n_c(\Omega)$.

In many other ways, distributions act like functions. For instance, any distribution $\Lambda$ can be uniquely written as $\Lambda_1 + i \Lambda_2$ for two distributions $\Lambda_1, \Lambda_2$ that are real valued for any real-valued smooth continuous function. However, we cannot write a real-valued distribution as the difference of two positive distributions, i.e. those which are non-negative when evaluated at any non-negative functional. This is because any non-negative distribution is actually given by integration against a Radon measure, and thus has order zero. Given a non-negative functional $\Lambda$ (which is automatically continuous),  we define $\Lambda f$ for a compactly supported continuous function $f \geq 0$ as
%
\[ \Lambda f = \sup \{ \Lambda g: g \in \DD(\RR^n), g \leq f \} \]
%
and then in general define $\Lambda (f^+ - f^-) = \Lambda f^+ - \Lambda f^-$. Then $\Lambda$ is obviously a positive extension of $\Lambda$ to all continuous functions, and is linear. But then the Riesz representation theorem implies that there is a positive Radon measure such that $\Lambda = \Lambda_\mu$, completing the proof.

\begin{example}
    If $\mu$ is a complex-valued Radon measure, then we can define a distribution $\Lambda[\mu]$ such that for each $\phi \in \DD(\RR^d)$.
    %
    \[ \Lambda[\mu](\phi) = \int_{\RR^d} \phi(x) d\mu(x) \]
    %
    Thus $\Lambda[\mu]$ is a distribution, since if $\phi$ is supported on $K$, then
    %
    \[ |\Lambda[\mu](\phi)| \leq \mu(K) \| \phi \|_{L^\infty(K)}. \]
    %
    The fact that this bound does not require information about the derivatives of $\phi$ implies that $\Lambda[\mu]$ is a distribution of order zero. In particular, the last pararaph, together with the Riesz-Markov-Kakutani representation theorem, shows that \emph{any} distribution of order zero is given by a complex-valued Radon measure.
\end{example}

\begin{example}
    Consider a functional $\Lambda$ defined for functions $\phi \in \DD(\RR)$ vanishing in a neighbourhood of the origin by setting
    %
    \[ \Lambda(\phi) = \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx. \]
    %
    Such functions are \emph{not} dense in $\DD(\RR)$. But we claim $\Lambda$ is bounded on it's domain, and thus by the Hahn-Banach theorem, extends to at least one continuous functional on the entirety of $\DD(\RR)$. To prove this, fix $\phi \in C_c^\infty[-N,N]$ vanishing on a neighbourhood $(-\varepsilon,\varepsilon)$ of the origin. Then
    %
    \[ |\Lambda \phi| = \left| \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx \right| = \left| \int_{\varepsilon \leq |x| \leq N} \frac{\phi(x) - \phi(0)}{x}\; dx \right|. \]
    %
    Applying the mean-value theorem, we find
    %
    \[ |\Lambda \phi| \leq N \| \phi \|_{C^1[-N,N]}. \]
    %
    Since $N$ was arbitrary, it follows that $\Lambda$ is continuous in the topology induced by that of $\DD(\RR)$, and thus by the Hahn-Banach theorem, extends uniquely to at least one distribution on the entirety of $\DD(\RR)$.

    One canonical choice of $\Lambda$ is the \emph{principal value distribution} $\text{p.v.}(1/x)$, defined such that
    %
    \[ \int_{-\infty}^\infty \text{p.v.}(1/x) \phi(x)\; dx = \lim_{\delta \to 0} \int_{|x| \geq \delta} \phi(x) / x\; dx. \]
    %
    We essentially showed that this functional was continuous above. Another choice is the distribution $\lim_{\varepsilon \to 0} 1/(x + i \varepsilon)$, defined such that
    %
    \[ \int_{-\infty}^\infty \lim_{\varepsilon \to 0} 1/(x + i \varepsilon) \cdot \phi(x)\; dx = \lim_{\varepsilon \to 0} \int_{-\infty}^\infty \phi(x) / (x + i \varepsilon)\; dx. \]
    %
    If we pick $\delta = \varepsilon^{1/4}$, then we can show using the fact that $1/x$ and $1/(x + i \varepsilon)$ are not too different for large $x$ that
    %
    \begin{align*}
        \left| \int_{|x| \geq \delta} \frac{\phi(x)}{x} - \int_{-\infty}^\infty \frac{\phi(x)}{x + i\varepsilon} \right| \leq \| \phi \|_1 \cdot \varepsilon^{1/2}.
    \end{align*}
    %
    A contour integral shift shows that
    %
    \begin{align*}
        \int_{-\delta}^\delta \frac{\phi(x)}{x + i\varepsilon} &= \int_{-\delta}^\delta \frac{\phi(0)}{x + i \varepsilon} + O(\delta)\\
        &= -i \pi \phi(0) + O(\varepsilon / \delta) + O(\delta)\\
        &= -i \pi \phi(0) + O(\varepsilon^{1/4}).
    \end{align*}
    %
    Taking $\varepsilon \to 0$ shows that
    %
    \[ \text{p.v}(1/x) = i \pi \delta + \lim_{\varepsilon \to 0} 1/(x + i \varepsilon), \]
    %
    where $\delta$ is the Dirac delta distribution at the origin.

    More generally, if $\Lambda_1$ and $\Lambda_2$ are two distributions which extend the functional $\Lambda$, then one can show that for any function $\phi$ vanishing away from the origin, $\Lambda_1(\phi) - \Lambda_2(\phi) = 0$. We will later define the \emph{support} of a distribution, and so we have shown here that $\Lambda_1 - \Lambda_2$ is supported at $\{ 0 \}$. It follows from later theorems in this chapter than $\Lambda_1$ and $\Lambda_2$, applied to a function $\phi \in \DD(\RR)$, will differ by a finite linear combination of the values of $\phi$ and it's derivatives at the origin.

    The distribution $\text{p.v}(1/x)$ can also be described as the distributional derivative of the locally integrable function $\log |x|$, since an integration by parts shows that for each $\phi \in \DD(\RR^d)$,
    %
    \begin{align*}
        \int (\log |x|)'\; \phi(x)\; dx &= - \int \log |x| \phi'(x)\; dx\\
        &= \lim_{\varepsilon \to 0} \int_{|x| \geq \varepsilon} \log |x| \phi'(x)\\
        &= \lim_{\varepsilon \to 0} \left( \log(\varepsilon) \cdot \left( \phi(x) - \phi(-x) \right) + \int_{|x| \geq \varepsilon} \frac{\phi(x)}{x} \right)\\
        &= \text{p.v.} \int \frac{\phi(x)}{x}\; dx.
    \end{align*}
    %
    An important elementary application of these distributions arises in the theory of the Hilbert transform.
\end{example}

\begin{example}
    One reason we could define a distribution agreeing with $1/x$ away from the origin is because there is a lot of cancellation at the origin from either side of the origin, since $1/x$ switches sign here. One has to rely on other tricks to make sense of a distribution extending $1/x^2$. Indeed, if we write
    %
    \[ \Lambda(\phi) = \int \frac{\phi(x)}{x^2} \]
    %
    for $\phi$ ranging over all functions vanishing in the neighborhood of the origin, then we can use the mean value theorem to obtain a bound $|\phi(x)| \leq x^2 \| \phi'' \|_\infty$, from which it follows that
    %
    \[ \Lambda(\phi) \lesssim \| \phi'' \|_\infty, \]
    %
    and so Hahn-Banach extends $\Lambda$ to a family of distributions. But in this case the principal value
    %
    \[ \lim_{\delta \to 0} \int_{|x| \geq \delta} \frac{\phi(x)}{x^2} \]
    %
    rarely exists. Indeed, for any fixed $\phi \in \DD(\RR)$ we have
    %
    \[ \int_{|x| \geq \delta} \frac{\phi(x)}{x^2} = 2 \phi(0) / \delta + O(\delta). \]
    %
    which will only converge if $\phi(0) = 0$. Thus, to get around this, we define the \emph{finite part distribution} (or \emph{Hadamard regularization}) of $1/x^2$, i.e. the distribution $\text{f.p}(1/x^2)$ by setting
    %
    \[ \int \text{f.p}(1/x^2)\; \phi(x)\; dx = \lim_{\delta \to 0} \left( \int_{|x| \geq \delta} \phi(x)/x^2 - \frac{2 \phi(0)}{\delta} \right), \]
    %
    which gets around the result that the distribution might explode near the origin if $\phi(0) \neq 0$ ($\phi'(0)$ does not cause a problem because of cancellation on both sides of the integral). Another approach is to consider the derivative of the distribution $- \text{p.v}(1/x)$, since the derivative of this distribution agrees with integration against $1/x^2$ away from the origin. In fact, the derivative of $- \text{p.v}(1/x)$ is precisely $\text{f.p}(1/x^2)$. We leave it to the reader to use similar tricks to define the finite parts of higher order singularities, such as $1/x^3$.
\end{example}

\begin{example}
    Let $f$ be a left continuous function on the real line with bounded variation and with $f(-\infty) = 0$. Then $f'$ exists almost everywhere in the classical sense, and $f' \in L^1(\RR)$. By Fubini's theorem, if we let $\mu$ be the measure defined by $\mu([a,b)) = f(b) - f(a)$, then for any $\phi \in \DD(\RR)$,
    %
    \begin{align*}
        \int_{-\infty}^\infty \phi(x) d\mu(x) &= - \int_{-\infty}^\infty \int_x^\infty \phi'(y)\; dy\; d\mu(x)\\
        &= - \int_{-\infty}^\infty \phi'(y) \int_{-\infty}^y d\mu(x)\; dy\\
        &= - \int_{-\infty}^\infty \phi'(y) f(y) dy
    \end{align*}
    %
    Thus if $\Lambda$ is the distribution corresponding to integration with respect to $f(x)\; dx$, then $\Lambda'$ is given by integration with respect to $\mu$. In particular, $\Lambda'$ is given by integration with respect to $f'(x)\; dx$ precisely when $f$ is absolutely continuous.
\end{example}

\begin{example}
    If $f \in C^1(\RR - \{ 0 \})$, and if the function $v(x)$ defined to be $f'(x)$ for $x \neq 0$ is integrable, then the limits $f(0-)$ and $f(0+)$ both exist (a simple argument using the fundamental theorem of calculus), and the distributional derivative of $f$ is equal to
    %
    \[ f' = v + (f(0+) - f(0-)) \delta_0. \]
    %
    To see this, we calculate that for $\phi \in C_c^\infty(\RR)$,
    %
    \begin{align*}
        \int f'(x) \phi(x)\; dx &= -\int f(x) \phi'(x)\; dx\\
        &= \lim_{\varepsilon \to 0} - \int_{-\infty}^{-\varepsilon} f(x) \phi'(x)\; dx - \int_\varepsilon^\infty f(x) \phi'(x)\; dx\\
        &= \lim_{\varepsilon \to 0} f(\varepsilon) \phi(\varepsilon) - f(-\varepsilon) \phi(-\varepsilon) + \int_{-\infty}^{-\varepsilon} v(x) \phi(x)\; dx + \int_{-\infty}^{-\varepsilon} v(x) \phi(x)\; dx\\
        &= \int v(x) \phi(x)\; dx + [f(0+) - f(0-)] \phi(0).
    \end{align*}
    %
    As a particular example of this, the distributional derivative of $|x|$ is $\text{sgn}(x)$, and the distributional derivative of the Heaviside step function $H$ given above is evaluated to be $\delta_0$.
\end{example}

There are many other important operations one can apply to distributions. If $\Omega$ is a conic subset of $\RR^d$, and $\phi,\psi \in \DD(\Omega)$, we find
%
\[ \int_{\Omega} \text{Dil}_\lambda \phi(x) \psi(x)\; dx = \lambda^{-d} \int_{\Omega} \phi(x) \cdot \text{Dil}_{1/\lambda} \psi(x)\; dx, \]
%
Thus if $\Lambda$ is a distribution on $\Omega$, then we define $\text{Dil}_\lambda \Lambda$ by setting
%
\[ \text{Dil}_\lambda \Lambda (\phi) = \lambda^{-d} \Lambda( \text{Dil}_{1/\lambda} \phi). \]
%
For $f \in C^\infty(\Omega)$, we have an operator $\phi \mapsto f \phi$ on $\DD(\Omega)$. The adjoint is clearly $\psi \mapsto f \psi$, so for a distribution $\Lambda$ on $\Omega$, we define $f \Lambda$ by setting $(f\Lambda)(\phi) = \Lambda(f \phi)$. Thus $\DD^*(\Omega)$ is naturally a $C^\infty(\Omega)$ module. Similarily, the family $\DD^*(\Omega)_k$ consisting of distributions of order $k$ form a $C^k(\Omega)$ module.

\begin{remark}
    H\"{o}rmander developed a sophisticated theory that enables us to define the product of two \emph{distributions} using the Fourier transform. In many basic situations, one can perform a spatial decomposition to define the product. Given a distribution $\Lambda$, we define it's \emph{singular support} $\text{supp}_{\text{sing}}(\Lambda)$ to be the \emph{complement} of the set of all points $x$ which have a neighborhood $U$ such that $\Lambda|_U \in C^\infty(U)$. For any two distributions $\Lambda$ and $\Psi$ whose singular supports are disjoint, a decomposition argument enables us to define the product $\Lambda \cdot \Psi$ in a natural way.
\end{remark}

Since $\DD^*(\Omega)$ is the dual space of a topological vector space, we can give it a natural topology, the weak $*$ topology. Thus a net of distributions $\{ \Lambda_\alpha \}$ converges to $\Lambda$ if and only if $\Lambda_\alpha(\phi) \to \Lambda(\phi)$ for all test functions $\phi$. This gives a further topology on the space of measures and functions, and we often write $f_\alpha \to f$ `in the distributional sense' if we have a convergence $\Lambda[f_\alpha] \to \Lambda[f]$ for the corresponding distributions.

\begin{example}
    If $u \in C_c^\infty(\RR^d)$, and we set $u_\varepsilon(x) = \varepsilon^{-d} \text{Dil}_\varepsilon u(x)$, then for any $\phi \in C_c^\infty(\RR^d)$,
    %
    \[ \lim_{\varepsilon \to 0} \int u_\varepsilon(x) \phi(x)\; dx \to \phi(0) \int u(x)\; dx. \]
    %
    Thus $u_\varepsilon$ converges distributionally to $(\int u(x)\; dx) \cdot \delta_0$. Similarily, if $u \in C_c^\infty(\RR^d)$ and for any multi-index $\alpha$ with $|\alpha| \leq k$,
    %
    \[ \int u(x) x^\alpha\; dx = 0, \]
    %
    and we define $u_\varepsilon(x) = \varepsilon^{-d-k} \text{Dil}_\varepsilon u(x)$, then for any $\phi \in C_c^\infty(\RR^d)$,
    %
    \[ \lim_{\varepsilon \to 0} u_\varepsilon(x) \phi(x)\; dx \to \frac{1}{k!} \sum_{|\alpha| = k} \left( \int x^\alpha u(x)\; dx \right) \cdot D^\alpha \phi(0) \]
    %
    Thus $u_\varepsilon$ converges distributionally to an appropriate linear combination of $D^\alpha \delta_0$.
\end{example}

\begin{example}
    The distribution $\lim_{\varepsilon \to 0} 1/(x + i\varepsilon)$ defined above is precisely the limit of the distributions $1/(x + i \varepsilon)$ in the weak $*$ topology. Similarily, $\text{p.v}(1/x)$ is the weak $*$ limit of the functions $\mathbf{I}_{|x| \geq \delta}(x) \cdot (1/x)$. The distribution $\text{f.p}(1/x^2)$ is the distributional limit of $\mathbf{I}_{|x| \geq \delta}(x) \cdot (1/x^2) - 2 \delta_0 / \delta$, where $\delta_0$ is the Dirac delta function at the origin.
\end{example}

\begin{example}
    If $n$ is a positive integer, then integration by parts shows that for any $\phi \in \DD(\RR)$,
    %
    \[ \int_{-\infty}^\infty t^n e^{2 \pi itx} \phi(x)\; dx = i^{n+1} t^{-1} \int_{-\infty}^\infty e^{itx} \phi^{(n+1)}(x)\; dx, \]
    %
    which converges to zero as $t \to \infty$. Thus $t^n e^{2 \pi itx}$ converges distributionally to zero as $t \to \infty$. Another way to see this is to note that the distribution $\Lambda_t$ given by integration against $t^n e^{itx}$ can be written as $\Lambda_t(\phi) = t^n \widehat{\phi}(-t)$, and the Fourier transform of $\phi$ decays rapidly. Note that if we tested against functions that were less smooth (say, viewing these distributions as linear functionals on $L^1(\RR^d)$, or even $C^\infty$ functions that are only of polynomial decrease as they approach $\infty$) then this statement would no longer be true.
\end{example}

\begin{example}
    Let $u_t(x) = t^{1/k} e^{itx^k}$, where $k$ is an integer bigger than one. Let
    %
    \[ F(x) = \int_0^x e^{iy^k}\; dy. \]
    %
    When $x > 0$, a contour integration shift shows that
    %
    \[ F(x) = e^{i \pi / 2k} \int_0^x e^{-y^k}\; dy + O(|x|^{-(k-1)}). \]
    %
    If $k$ is even, then for $x < 0$,
    %
    \[ F(x) = - e^{i \pi / 2k} \int_0^x e^{-y^k}\; dy + O(|x|^{-(k-1)}) \]
    %
    and for $k$ odd,
    %
    \[ F(x) = - e^{-i \pi / 2k} \int_0^x e^{-y^k}\; dy + O(|x|^{-(k-1)}). \]
    %
    Thus given $\phi \in \DD(\RR)$, we can apply an integration by parts to write
    %
    \begin{align*}
        \int_{-\infty}^\infty u_t(x) \phi(x)\; dx &= \int_{-\infty}^\infty t^{1/k} e^{itx^k} \phi(x)\; dx \\
        &= \int_{-\infty}^\infty t^{1/k} F'(t^{1/k} x) \phi(x)\; dx\\
        &= - \int_{-\infty}^\infty F(t^{1/k} x) \phi'(x)\; dx,
     \end{align*}
     %
     By decomposing this integral into the region where $|x| \geq t^{1/k}$ and $|x| \leq t^{1/k}$ shows that this quantity converges to
     %
     \[ - F(\infty) \int_0^\infty \phi'(x)\; dx - F(-\infty) \int_{-\infty}^0 \phi'(x)\; dx = (F(\infty) - F(-\infty)) \phi(0). \]
     %
     Thus $u_t$ converges distributionally to $\left( 2 e^{i \pi / 2k} \int_0^\infty e^{-y^k}\; dy \right) \cdot \delta_0$ if $k$ is even, and to $\left( 2 \cos(\pi / 2k) \int_0^\infty e^{-y^k}\; dy \right) \cdot \delta_0$ if $k$ is odd.
\end{example}

Since convergence in $\DD(\Omega)$ is incredibly strict, a sequence of distributions can very easily converge in the weak $*$ topology. The following is thus quite a surprising result.

\begin{theorem}
  Suppose that $\{ \Lambda_\alpha \}$ converges weakly to a distribution $\Lambda$. Then $D^\alpha \Lambda_i$ converges weakly to $D^\alpha \Lambda$ for any multi-index $\alpha$.
\end{theorem}
\begin{proof}
  For each $\phi \in \DD(\Omega)$, $D^\alpha \phi \in \DD(\Omega)$, so
  %
  \begin{align*}
    \lim_\alpha (D^\alpha \Lambda_i)(\phi) &= (-1)^{|\alpha|} \lim_\alpha \Lambda_i(D^\alpha \phi)\\
    &= (-1)^{|\alpha|} \Lambda(D^\alpha \phi)\\
    &= (D^\alpha \Lambda)(\phi). \qedhere
  \end{align*}
\end{proof}

Thus differentiation is continuous in the space of distributions.

\begin{theorem}
  Fix $\{ g_\alpha \}$ in $C^\infty(\Omega)$ and $\{ \Lambda_\alpha \}$ in $\DD^*(\Omega)$ such that $g_\alpha \to g$ in $C^\infty(\RR^d)$ and $\Lambda_\alpha \to \Lambda$ weakly. Then $g_\alpha \Lambda_\alpha$ converges weakly to $g \Lambda$.
\end{theorem}
\begin{proof}
  For each $\phi \in \DD(\RR^d)$, the map
  %
  \[ (\Lambda_\alpha, g_\alpha) \mapsto (\Lambda_\alpha(x) g_\alpha)(\phi) \]
  %
  is bilinear, and continuous in each variable. The result then follows from a variant of Banach-Steinhaus.
\end{proof}

There is also an often useful result resulting from bounded countable families of distributions.

\begin{theorem}
    Suppose $\mathcal{U} \subset \DD^*(\Omega)$ is a family of distributions such that for each $\phi \in \DD(\Omega)$, $\sup_{u \in \mathcal{U}} |u(\phi)| < \infty$. Then for every compact set $K$, there exists $m$ such that for an $u \in \mathcal{U}$ and $\phi \in C_c^\infty(K)$,
    %
    \[ |u(\phi)| \lesssim \| \phi \|_{C^m(K)}. \]
    %
    If $\{ u_n \}$ is a sequence of distributions for which $\lim_n u_n(\phi)$ exists for every $\phi \in \DD(\Omega)$, then $u(\phi) = \lim_n u_n(\phi)$ defines a distribution, and for every compact set $K$ there is an integer $m$ such that for each $\phi \in C_c^\infty(K)$,
    %
    \[ |u_n(\phi)| \lesssim \| \phi \|_{C^m(K)} \]
    %
    and
    %
    \[ \lim_{n \to \infty} \sup_{\phi \in C_c^\infty(K)} \frac{|u(\phi) - u_n(\phi)|}{\| \phi \|_{C^m(K)}} = 0. \]
\end{theorem}
\begin{proof}
    Each distribution in $\mathcal{U}$ acts as a continuous operator on the Frech\'{e}t space $C_c^\infty(K)$, and this family satisfies the uniform boundedness principle, and the existence of an $n$ as above follows as a result of the uniform boundedness principle, i.e. it shows that restricted to $K$, the distributions in $\mathcal{U}$ are equicontinuous.

    Now assume the second condition. This clearly implies the first, hence we get the uniform boundedness property above. Now a ball of finite radius in $C^{m+1}(K)$ is precompact in $C^m(K)$, by the Arzela-Ascoli theorem. Thus we can find $\phi_1,\dots,\phi_N \in C_c^\infty(K)$ such that if $\phi \in C_c^\infty(K)$ and $\| \phi \|_{C^{n+1}(K)} \leq 2$, then there exists $i$ such that $\| \phi - \phi_i \|_{C^n(K)} \leq \varepsilon$. Pick $n_0$ such that for any $n \geq n_0$ and $1 \leq i \leq N$, $|(u - u_n)(\phi_i)| \leq \varepsilon$. Then given any $\phi \in C_c^\infty(K)$ with $\| \phi \|_{C^{n+1}(K)} \leq 1$, we can find $i$ as above, and then
    %
    \begin{align*}
        |(u - u_n)(\phi)| &\leq |(u - u_n)(\phi - \phi_i)| + |(u - u_n)(\phi_i)|\\
        &\lesssim \| \phi - \phi_i \|_{C^n(K)} + \varepsilon\\
        &\lesssim \varepsilon.
    \end{align*}
    %
    Thus we have proven the required limiting statement.
\end{proof}

\section{Homogeneous Distributions}

An important family of distributions are the \emph{homogenous distributions}, which are those distributions $\Lambda$ on $\RR^d - \{ 0 \}$ such that for each $\lambda > 0$, $\text{Dil}_\lambda \Lambda = \lambda^\alpha \Lambda$, where $\alpha$ is the \emph{order} of the homogenous distribution $\Lambda$.

\begin{example}
  If $f \in L_1^{\text{loc}}(\RR^d)$ and $f(\lambda x) = \lambda^\alpha f(x)$ for all $x \in \RR^d - \{ 0 \}$ then integration against $f(x)\; dx$ defines a homogenous distribution of order $\alpha$.
\end{example}

\begin{example}
  For any complex number $a$ with $\text{Re}(a) > -1$, if we define a distribution on $\RR - \{ 0 \}$ by setting
  %
  \[ x^a_+ = \begin{cases} x^a & x > 0 \\ 0 &: x <= 0 \end{cases}, \]
  %
  then $x^a_+$ is a homogeneous distribution of order $\alpha$, and $x \cdot x^a_+ = x^{a+1}_+$, and if $\text{Re}(a) > 0$,
  %
  \[ \frac{d}{dx} \left( x^a_+ \right) = a x^{a-1}_+. \]
  %
  Our goal is to extend this distribution to a larger range of values $a \in \CC$, such that the association $a \mapsto x^a_+$ is continuous. For any $\phi \in \DD(\RR)$, the function
  %
  \[ a \mapsto \langle x^a_+, \phi \rangle \]
  %
  is analytic in $a$ for $\text{Re}(a) > -1$. Integration by parts shows that
  %
  \[ \langle x^{a+1}_+, \phi' \rangle = - (a+1) \langle x^a_+, \phi \rangle. \]
  %
  The formula $\langle x^a_+, \phi \rangle = -(a+1)^{-1} \langle x^{a+1}_+, \phi' \rangle$ allows us to extend the definition of $x^a_+$ to all $a \in \CC$ with $\text{Re}(a) > -2$, except that we have a pole of order one when $a = -1$. Iterating this allows us to uniquely extend the definition of $x^a_+$ for all $a \in \CC$, except when $a$ is a negative integer, and these distributions will all be homogeneous.

  Marcel Riesz also used some other complex analytic tricks to define $x^{-k}_+$ for all integers $k$, but then we lose some of the homogeneity. For any $\phi \in \DD(\RR)$, the function $a \mapsto \langle x^a_+, \phi \rangle$ is meromorphic, with simple poles at each negative integer $-k$, and the residue at $-k$ is equal to $(-1)^k D^{k-1} \phi(0) / (k-1)!$, then we conclude that for any $\phi \in \mathcal{S}(\RR)$, as $a \to -k$,
  %
  \[ \langle (a + k) x^a_+, \phi \rangle \to (-1)^{k-1} D^{k-1} \phi(0) / (k-1)! \]
  %
  In fact, expanding things out gives a constant $C_{-k}(\phi)$ such that as $a \to k$,
  %
  \[ \langle x^a_+, \phi \rangle = \frac{(-1)^{k-1} D^{k-1} \phi(0)}{(k-1)!} \cdot \frac{1}{a + k} + C_{-k}(\phi) + O(a+k). \]
  %
  We define $\langle x^{-k}_+, \phi \rangle = C_{-k}(\phi)$, i.e. by keeping only the \emph{finite part} of the integral. Since, for $a$ close to $k$, we have
  %
  \begin{align*} \langle x^a_+, \phi \rangle &- \frac{(-1)^{k-1} D^{k-1} \phi(0)}{(k-1)!} \cdot (a+k)^{-1}\\
  &= (-1)^k (a+1)^{-1} \cdots (a+k-1)^{-1} \int_0^\infty \frac{x^{a + k} - 1}{a+k} D^k \phi(x)\; dx\\
  &\quad\quad + \frac{(-1)^{k-1}}{a+k} \left( (-1-a)^{-1} \dots (1-a-k) - \frac{1}{(k-1)!} \right) D^{k-1} \phi(0)\\
  &\to \frac{-1}{(k-1)!} \int_0^\infty \log(x) D^k \phi(x)\; dx + \frac{1}{(k-1)!} \left(\sum_{i = 1}^k 1/i \right) D^{k-1} \phi(0).
  \end{align*}
  %
  and thus
  %
  \[ \langle x^{-k}_+, \phi \rangle = \frac{-1}{(k-1)!} \int_0^\infty \log(x) D^k \phi(x)\; dx + \frac{1}{(k-1)!} \left(\sum_{i = 1}^k 1/i \right) D^{k-1} \phi(0). \]
  %
  Our extension of $x^a_+$ for all $a \in \CC$ continues to satisfy $x \cdot x^a_+ = x^{a+1}_+$ for all $a \in \CC$. The derivative formula is \emph{not} maintained, namely,
  %
  \[ D x^{-k}_+ = -k x^{-k-1}_+ + (-1)^k D^k \delta / k! \]
  %
  Moreover, $x^{-k}_+$ is no longer homogeneous of degree $-k$. Plugging into the formula shows that
  %
  \[ (tx)^{-k}_+ = t^{-k} x^{-k}_+ + \frac{\log t}{(k-1)!} \cdot D^{k-1} \delta. \]
  %
  One can also define $x^a_+$ by first removing the singularity, considering the distributions
  %
  \[ \langle x^a_\varepsilon, \phi \rangle = \int_\varepsilon^\infty x^a \phi(x)\; dx. \]
  %
  If $k$ is the smallest non-negative integer such that $k + \text{Re}(a) > -1$, then we can integrate by parts to conclude that there are constants $C_k$ such that
  %
  \[ \langle x^a_\varepsilon, \phi \rangle = \sum_{i = 0}^{k-1} C_i \varepsilon^{-i} + (-1)^k \int_0^\infty \frac{1}{(a+1) \dots (a+k)} x^{a + k} D^k \phi(x)\; dx + o(1). \]
  %
  Discarding the singular terms, and letting $\varepsilon \to 0$ gives the distributions $x^a_+$ above. One can analogously define the distributions $x^a_-$, and the distributions $|x|^a$, by reflecting and symmetrizing the distributions about the origin.
\end{example}

\begin{example}
    One can fix the singularities at the integers by normalizing. The appearance of the singularities in the extension of $x^a_+$ occured because of the $a$ term in the formula $D(x^a_+) = a x^{a-1}_+$. If we consider the normalization $\chi^a_+ = x^a_+ / \Gamma(a)$ when $\text{Re}(a) > -1$, then $D(\chi^a_+) = - \chi^{a-1}_+$, and because the Gamma function has no zeroes, this allows us to extend the definition of $\chi^a_+$ to an analytic function for all $a \in \CC$, each a homogeneous distribution of order $a$. But since $\chi^0_+$ is the Heaviside step function, we conclude that $\chi^{-k}_+ = D^{k-1} \delta$.
\end{example}

\begin{example}
  Let $\delta$ be the Dirac-delta distribution at the origin in $\RR^d$. Then for $\phi \in \DD(\RR^d)$,
  %
  \begin{align*}
    \int_{\RR^d} (\text{Dil}_\lambda \delta)(x) \phi(x)\; dx = \lambda^{-d} \int_{\RR^d} \delta(x) \text{Dil}_{1/\lambda} \phi(x)\; dx = \lambda^{-d} \phi(0).
  \end{align*}
  %
  Thus $\text{Dil}_\lambda \delta = \lambda^{-d} \delta$, which implies $\delta$ is a homogenous distribution of order $-d$.
\end{example}

A homogeneous distribution is apriori defined by testing against a distribution in $\DD(\RR^d - \{ 0 \})$. But in most cases the distribution can be extended so that it can be tested against an arbitrary distribution in $\DD(\RR^d)$. Before we prove this, we begin with some simple observations. First is a formula due to Euler, which in the distributional setting states that for any distribution $u$ of degree $a$,
%
\[ \sum_{i = 1}^d x_i \partial_i u = (a + d) u. \]
%
When $d = 1$, this actually implies that $u$ is a multiple of $|x|^a$ on each coordinate axis. The identity also implies that for any $\psi \in C_c^\infty(\RR^d - \{ 0 \})$ with $\int_0^\infty r^{a + d-1} \psi(rx)\; dr = 0$ for all $x$, $\langle u, \phi \rangle = 0$ by rewriting the formula in polar coordinates.

\begin{theorem}
    Let $u$ be a homogeneous distribution of order $a$, which is not a negative integer smaller than or equal to $-n$. Then $u$ has a unique extension to a distribution $E(u)$ on $\RR^d$, such that for any homogeneous polynomial $P$, $E(Pu) = P E(u)$, and if $u$ is not a distribution of order $1-n$, $E(\partial_i u) = \partial_i E(u)$. Moreover, the map $u \mapsto E(u)$ is continuous between the two spaces of distributions.
\end{theorem}
\begin{proof}
    The uniqueness is obvious, because any distribution supported at the origin is a linear combination of derivatives of the Dirac delta function, which are all homogeneous of integer order $\leq -n$. To show existence, we note that if $u$ was locally integrable, then polar coordinates gives
    %
    \[ \int u(x) \phi(x) = \int_0^\infty \int_{|w| = 1} u(w) t^{a + d-1} \phi(t w)\; d\sigma(w)\; dt. \]
    %
    Thus we need only study the behaviour of $u$ near the unit sphere, which is supported away from the origin. Doing this more formally yields the extension map $E$. For any $\phi \in \DD(\RR^d)$, define $R_a \phi(x) = \langle t^{a + d-1}_+, \phi(tx) \rangle$. Then $R_a \phi$ is homogeneous of degree $-n-a$, and is continuous from $C_c^\infty(K)$ to $C^\infty(\RR^d - \{ 0 \})$ for any compact set $K$. If $\psi \in C_c(\RR^d - \{ 0 \})$ and $\int_0^\infty \psi(tx)/t\; dt = 1$ for all $x \neq 0$, then $\psi R_a \phi \in C_c^\infty(\RR^d - \{ 0 \})$, and $R_a(\psi R_a \phi) = R_a \phi$, so that (because of our observations before the proof) $E(u) = \langle u, \psi R_a \phi \rangle$ is independent of the choice of $\psi$. Moreover, $\langle u, \psi R_a \phi \rangle = \phi$ for each $\phi \in C_c^\infty(\RR^d - \{ 0 \})$. The continuity of the map $u \mapsto E(u)$ is not too difficult to see, completing the proof.
\end{proof}

When $a$ is an integer smaller than or equal to $-n$, one can still use the construction in the proof to define an operator $E(u)$, but then it can depend on $\psi$, may fail to be homogeneous near the origin, and may fail to satisfy the identities $E(Pu) = PE(u)$ and $E(\partial_i u) = \partial_i E(u)$ (See H\"{o}rmander, 3.2, in particular, one can obtain a reasonable theory for \emph{integer} degree homogeneous distributions past this range).

\section{Localization of Distribuitions}

Just as we can consider the local behaviour of functions around a point, we can consider the local behaviour of a distribution around points, and this local behaviour contains most of the information of the distribution. For instance, given an open subset $U$ of $X$, we say two distributions $\Lambda$ and $\Psi$ are equal on $U$ if $\Lambda \phi = \Psi \phi$ for every test function $\phi$ compactly supported in $U$. We recall the notion of a partition of unity, which, for each open cover $U_\alpha$ of Euclidean space, gives a family of $C^\infty$ functions $\psi_\alpha$ which are positive, {\it locally finite}, in the sense that only finitely many functions are positive on each compact set, and satisfy $\sum \psi_\alpha = 1$ on the union of the $U_\alpha$.

\begin{theorem}
    If $X$ is covered by a family of open sets $U_\alpha$, and $\Lambda$ and $\Psi$ are locally equal on each $U_\alpha$, then $\Lambda = \Psi$. If we have a family of distributions $\Lambda_\alpha$ which agree with one another on $U_\alpha \cap U_\beta$, then there is a unique distribution $\Lambda$ locally equal to each $\Lambda_\alpha$.
\end{theorem}
\begin{proof}
    Since we can find a $C^\infty$ partition of unity $\psi_\alpha$ compactly supported on the $U_\alpha$, upon which we find if $\phi$ is supported on $K$, then finitely many of the $\psi_\alpha$ are non-zero on $K$, and so
    %
    \[ \Lambda(\phi) = \sum \Lambda(\psi_\alpha \phi) = \sum \Psi(\psi_\alpha \phi) = \Psi(\phi) \]
    %
    Thus $\Lambda = \Psi$. Conversely, if we have a family of distributions $\Lambda_\alpha$ like in the hypothesis, then we can find a partition of unity $\psi_{\alpha \beta}$ subordinate to $U_\alpha \cap U_\beta$, and we can define
    %
    \[ \Lambda(\phi) = \sum \Lambda_\alpha(\psi_{\alpha \beta} \phi) = \sum \Lambda_\beta(\psi_{\alpha \beta} \phi) \]
    %
    The continuity is verified by fixing a compact $K$, from which there are only finitely many nonzero $\psi_{\alpha \beta}$ on $K$, and the fact that this definition is independant of the partition of unity follows from the first part of the theorem.
\end{proof}

In the language of commutative algebra, the association of $\DD^*(U)$ to each open subset $U$ of $\Omega$ gives the structure of a sheaf of modules on $\Omega$. Given a distribution $\Lambda$, we might have $\Lambda(\phi) = 0$ for every $\phi$ supported on some open set $U$. The complement of the largest open set $U$ for which this is true is called the \emph{support} of $\Lambda$. This agrees with the sheaf theoretic definition.

\begin{theorem}
    If a distribution $\Lambda \in \DD^*(\Omega)$ has compact support, then $\Lambda$ has some finite order $n$, and extends uniquely to a continuous linear functional on $C^n(\Omega)$.
\end{theorem}
\begin{proof}
    Let $\Lambda$ be a distribution supported on a compact set. If $\psi$ is a function with compact support with $\psi(x) = 1$ on the support of $\Lambda$, then $\psi \Lambda = \Lambda$, because for any $\phi$, $\phi - \phi \psi$ is supported on a set disjoint from the support of $\Lambda$. But if $\psi$ is supported on some compact set $K$, then there is $n$ such that for any $\phi \in C_c^\infty(K)$,
    %
    \[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(K)}, \]
    %
    and so for any other compact set $K$,
    %
    \[ |\Lambda(\phi)| = |\Lambda(\phi \psi)| \lesssim \| \phi \psi \|_{C^n(K)} \lesssim \| \psi \|_{C^n(K)} \| \phi \|_{C^n(K)}. \]
    %
    which shows $\Lambda$ has order $N$. We have shown that $\Lambda$ is continuous with respect to the seminorm $\| \cdot \|_{C^N(K)}$ on $C^\infty(X)$, and so by the Hahn Banach theorem, $\Lambda$ extends uniquely to a continuous functional on $C^\infty(X)$.
\end{proof}

If $\mathcal{E}(\Omega)$ denotes $C^\infty(\Omega)$, equipped with the topology such that $f_n \to f$ if $D^\alpha f_n$ converges to $D^\alpha f$ locally uniformly for all $\alpha$, then the last theorem implies the family of compactly supported distributions embeds itself in $\mathcal{E}(\Omega)^*$. Conversely, \emph{every} element of $\mathcal{E}(\Omega)^*$ is a compactly supported distribution. Indeed, since $\mathcal{E}(\Omega)$ is a Frech\'{e}t space, if $\Lambda$ is a continuous linear functional on $\mathcal{E}(\Omega)$, then there exists a compact set $K$ and some $n > 0$ such that
%
\[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(K)}. \]
%
It follows from this that $\Lambda$ is a distribution with support contained in $K$.

\begin{remark}
    For general compact sets $K$, it is \emph{not} true that if $\Lambda$ is a distribution supported on a set $K$, then there exists $n > 0$ such that
    %
    \[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(K)}. \]
    %
    Suppose $K$ is not the union of finitely many compact connected sets. Then we can find a family of disjoint compact sets $\{ K_i \}$ in $K$ such that $K - (K_1 \cup \dots \cup K_n)$ is compact for any $n > 0$. Fix $x_i \in K_i$, let $x \in K$ be a limit point of this sequence, consider a sequence of numbers $\{ a_i \}$ such that $\sum a_i |x_i - x| = 1$, and $\sum a_i = \infty$, and let $\Lambda$ be the distribution
    %
    \[ \Lambda(\phi) = \sum_i a_i (\phi(x_i) - \phi(x)). \]
    %
    Then
    %
    \[ |\Lambda(\phi)| \leq \| \phi' \|_{L^\infty(\RR^d)}, \]
    %
    so $\Lambda$ is a distribution of order at most 1. On the other hand, if we choose a function $\phi \in \DD(\Omega)$ which is equal to one on a neighborhood of $K_1 \cup \dots \cup K_n$, and zero on a neighborhood of $K - (K_1 \cup \dots \cup K_n)$, then
    %
    \[ \Lambda(\phi) = \sum_{i = 1}^n a_i, \]
    %
    so we cannot have a bound of the form
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)} \lesssim 1. \]
    %
    On the other hand, for any precompact neighborhood $U$ of $K$, we have a bound
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq 1} \| D^\alpha \phi \|_{L^\infty(U)}. \]
    %
    which is almost as good as the bound above.
\end{remark}

If $\Lambda$ is a distribution of order $k$ supported on $K$, though we do not have a uniform bound $|\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)}$, if the right hand side vanishes, so does the left hand side.

\begin{lemma}
    Suppose $\Lambda$ is a distribution of order $k$ supported on $K$, and $\phi \in C^k(\Omega)$ satisfies $D^\alpha \phi(x) = 0$ for all $|\alpha| \leq k$ and $x \in K$, then $\Lambda(\phi) = 0$.
\end{lemma}
\begin{proof}
    By a density argument, we may assume that $\phi \in C^\infty(\Omega)$ without loss of generality. Find $\chi_\varepsilon \in \DD(\Omega)$ such that $\chi_\varepsilon(x) = 1$ for $x \in K$, $\chi_\varepsilon(x) = 0$ if $d(x,K) \geq \varepsilon$, and $\| D^\alpha \chi_\varepsilon \|_{L^\infty} \lesssim \varepsilon^{-|\alpha|}$ for all $|\alpha| \leq k$. Then for any $\phi \in \DD(\Omega)$,
    %
    \[ |\Lambda(\phi)| = |\Lambda(\phi \chi_\varepsilon)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha(\phi \chi_\varepsilon) \|_{L^\infty} \lesssim \sum_{|\alpha| \leq k} \varepsilon^{|\alpha|-k} \| D^\alpha \phi \|_{L^\infty(K_\varepsilon)}. \]
    %
    For any $y \in K_\varepsilon$, we can pick $x \in K$ such that $|x - y| \leq \varepsilon$. Taylor's formula at $x$, together with the fact that all the derivatives of $\phi$ up to order $k$ vanish at $x$, implies that
    %
    \[ |(D^\alpha \phi)(y)| \lesssim \varepsilon^{k+1 - |\alpha|}. \]
    %
    Thus we conclude that $|\Lambda(\phi)| \lesssim \varepsilon$, and we can then take $\varepsilon \to 0$.
\end{proof}

The last lemma implies that the value of \emph{any distribution} $\Lambda$ of order $k$ supported on a point $x_0$ depends solely on the values $D^\alpha \phi(x_0)$ for $|\alpha| \leq k$. Thus there exists constants $\lambda_\alpha$ such that
%
\[ \Lambda(\phi) = \sum_{|\alpha| \leq k} \lambda_\alpha D^\alpha \phi(x_0). \]
%
This means that $\Lambda$ is a sum of Dirac delta functions and their derivatives. If we work harder, using the Whitney extension theorem as a black box, we can obtain a similar process for more general supports.

\begin{theorem}[Whitney]
    Let $K$ be a compact set in $\RR^d$, and for each $|\alpha| \leq k$, a function $u_\alpha \in C(K)$. If
    %
    \[ U_\alpha(x,y) = \sum_{|\alpha| \leq k} \sup_{x,y \in K} \left| u_\alpha(x) - \sum_{|\beta| \leq k - |\alpha|} u_{\alpha + \beta}(y) \cdot (x - y)^\beta / \beta! \right| \cdot |x - y|^{|\alpha| - k}  \]
    %
    for $x \neq y$, and $U_\alpha(x,x) = 0$, then provided $U_\alpha$ is continuous on $K \times K$, we can find a function $v \in C^k(\RR^d)$ such that $D^\alpha v = u_\alpha$ on $K$ for $|\alpha| \leq k$, and
    %
    \[ \sum_{|\alpha| \leq k} \| D^\alpha v \|_{L^\infty} \lesssim \sum_{|\alpha| \leq k} \| U_\alpha \|_{L^\infty(K \times K)} + \sum_{|\alpha| \leq k} \| u_\alpha \|_{L^\infty(K)}. \]
\end{theorem}

A consequence is the following strengthening of the last lemma.

\begin{lemma}
    For \emph{any} compact set $K$, and any distribution $\Lambda$ of order $k$ supported on $K$, we have
    %
    \begin{align*}
        |\Lambda(\phi)| &\lesssim \sum_{|\alpha| \leq k} \sup_{x,y \in K} \left| D^\alpha \phi(x) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) \cdot (x - y)^\beta / \beta! \right| \cdot |x - y|^{|\alpha| - k}\\
        &\quad\quad + \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)}.
    \end{align*}
\end{lemma}
\begin{proof}
    To do this, we apply the Whitney extension theorem, setting $u_\alpha = D^\alpha \phi |_K$. We then apply the Whitney extension theorem to find $\psi \in C^k(\RR^n)$ extending $u_\alpha$ with the required bounds above. Then $D^\alpha(\phi - \psi) = 0$ on $K$ for all $|\alpha| \leq K$, from which it follows that $\Lambda(\phi) = \Lambda(\psi)$. The bound
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \psi \|_{L^\infty}, \]
    %
    which gives the required bound above.
\end{proof}

Recall that a compact set $K$ is \emph{Whitney regular}, which means that $K$ is a finite union of compact, connected components, and for any two points $x,y \in K$ contained in a common component, there exists a rectifiable curve $\gamma$ from $x$ to $y$ with length $O(|x - y|)$.

\begin{lemma}
    If $K$ is Whitney regular, then for any distribution $\Lambda$ supported on $K$, there exists $k$ such that we have a bound
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq k} \| D^\alpha \phi \|_{L^\infty(K)}. \]    
\end{lemma}
\begin{proof}
    Fix a rectifiable unit velocity curve $\gamma: [0,L] \to K$ between two points $x$ and $y$ in $K$, and let
    %
    \[ F_\alpha(s) = D^\alpha \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) (\gamma(s) - y)^\beta / \beta! \]
    %
    Then $|F_\alpha(s)| \lesssim s^{k-|\alpha|} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}$. This is immediate if $|\alpha| = k$. For $|\alpha| < k$ we prove this result by induction, noting that the case for higher order $k$ implies that
    %
    \begin{align*}
        \left| dF_\alpha / ds \right| &\leq \sum_{i = 1}^d \left| \left( D^{\alpha + i} \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{(\alpha + i) + (\beta - i)} \phi(y) (\gamma(s) - y)^{\beta - i} / (\beta - 1)! \right) \cdot \gamma_i'(s) \right|\\
        &\lesssim s^{k - |\alpha| - 1} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}
    \end{align*}
    %
    Integrating this inequality in $s$ together with the fact that $F_\alpha(0) = 0$ gives the higher order bound. But this means that
    %
    \begin{align*}
        \left| D^\alpha \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) (\gamma(s) - y)^\beta / \beta! \right| &= |F_\alpha(L)|\\
        &\lesssim L^{k-|\alpha|} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}.
    \end{align*}
    %
    Choosing $\gamma$ optimally gives
    %
    \[ \left| D^\alpha \phi(\gamma(s)) - \sum_{|\beta| \leq k - |\alpha|} D^{\alpha + \beta} \phi(y) (\gamma(s) - y)^\beta / \beta! \right| \lesssim |x - y|^{k - |\alpha|} \sum_{|\beta| = k} \| D^\beta \phi \|_{L^\infty(K)}. \]
    %
    The last Lemma, together with this bound, completes the proof.
\end{proof}

\begin{remark}
    Similar arguments can be used to show that if $\Lambda$ is a distribution of order $k$ supported on a compact set $K$, and there exists $\gamma \leq 1$ such that $K$ is a finite union of connected components, such that for any pair of points $x,y$ in that component, there exists a rectifiable path from $x$ to $y$ with length $O(|x - y|^\gamma)$, and $m \geq k / \gamma$, then
    %
    \[ |\Lambda(\phi)| \lesssim \sum_{|\alpha| \leq m} \| D^\alpha \phi \|_{L^\infty(K)}. \]
\end{remark}

Let us finish by considering a consequence of these results, applied to distributions supported on hyperplanes. For simplicity in notation, we assume this hyperplane is axis oriented.

\begin{theorem}
    Let $x = (x_0,x_1)$, where $x_0 \in \RR^{d_1}$, $x_1 \in \RR^{d_2}$, and $d = d_1 + d_2$. Let $H = \{ (x_0,x_1) \in \RR^d: x_1 = 0 \}$. If $\Lambda$ is a distribution of order $k$ compactly supported on $H$, then there exists distributions $\Lambda_\alpha$ of order $k - |\alpha|$ on $\RR^{d_1}$ for each $|\alpha| \leq k$, where $\alpha$ is a multi-index in the $\RR^{d_2}$ variables, and constants $\gamma_\alpha$ such that
    %
    \[ \Lambda(\phi) = \sum \Lambda_\alpha(D^\alpha \phi |_H). \]
\end{theorem}
\begin{proof}
    Fix a function $\psi \in C_c^\infty(\RR^{d_1})$ equal to one in a neighborhood of the origin. Given $\phi \in \DD(\RR^{d_1})$, all derivatives of the function
    %
    \[ \sum_{|\alpha| \leq k} D^\alpha \phi(x_0,0) \cdot (x_1^\alpha / \alpha!) \cdot \psi(x_1) = \sum_{|\alpha| \leq k} D^\alpha \phi |_H (x_0) \cdot (x_1^\alpha / \alpha!) \]
    %
    agree with $\phi$ on $H$, where $\alpha$ ranges over all derivatives in the $x_1$ direction. It follows that if we define a distribution $\Lambda_\alpha$ on $\RR^{d_1}$ such that for $\psi \in \DD(\RR^{d_1})$,
    %
    \[ \Lambda_\alpha(\psi) = \Lambda( \psi \otimes (x_1^\alpha / \alpha!)), \]
    %
    then
    %
    \[ \Lambda(\phi) = \sum_{|\alpha| \leq k} \Lambda_\alpha( D^\alpha \phi |_H ). \]
    %
    The hard part is showing that $\Lambda_\alpha$ has order $k - |\alpha|$. If the support of $\Lambda$ in the $x_0$ variable is contained in a compact ball $B$, then, because $B$ is Whitney regular,
    %
    \begin{align*}
        |\Lambda_\alpha(\psi)| &\lesssim \sum_{|\beta_1| + |\beta_2| \leq k} \| D^{\beta_1 + \beta_2} \left\{ \psi \otimes (x_1^\alpha / \alpha!) \right\} \|_{L^\infty(B \times \{ 0 \})}\\
        &= \sum_{|\beta| \leq k - |\alpha|} \| D^\beta \psi \|_{L^\infty(B)}.
    \end{align*}
    %
    This implies $\Lambda_\alpha$ has order $k-|\alpha|$.
\end{proof}

\begin{remark}
    This argument does not really need the power of the full extension theorem machinery, since the Whitney extension theorem is relatively trivial in the application we give (we can consider a simple convolution argument to extend a function on a hyperplane to the full space). But the more developed machinery can be applied to characterize distributions on more general sets, which we leave to the reader to experiment with.
\end{remark}

\section{Derivatives of Continuous Functions}

One of the main reasons to consider the theory of distributions is so that we can take the derivative of any function we want. We now show that, at least locally, every distribution is the derivative of some continuous function, which means the theory of distributions is essentially the minimal such class of objects which enable us to take derivatives of continuous functions.

\begin{theorem}
    If $\Lambda$ is a distribution on $\Omega$, and $K$ is a compact set, then there is a continuous function $f$ and $\alpha$ such that for every $\phi$,
    %
    \[ \Lambda \phi = (-1)^{|\alpha|} \int_\Omega f(x) (D^\alpha \phi)(x)\; dx \]
\end{theorem}
\begin{proof}
    TODO
\end{proof}

\begin{theorem}
    If $K$ is compact, contained in some open subset $V$, which in turn is a subset of $\Omega$, and $\Lambda$ has order $N$, then there exists finitely many continuous functions $f_\beta \in C(\Omega)$ supported on $V$, for each $|\beta| \leq N + 2$, with supports on $V$, and with $\Lambda = \sum D^\beta f_\beta$.
\end{theorem}

\begin{theorem}
    If $\Lambda$ is a distribution on $\Omega$, then there exists continuous functions $g_\alpha$ on $\Omega$ such that each compact set $K$ intersects the supports of finitely many of the $g_\alpha$, and $\Lambda = \sum D^\alpha g_\alpha$. If $\Lambda$ has finite order, then only finitely many of the $g_\alpha$ are nonzero.
\end{theorem}

\section{Convolutions of Distributions}

Using the convolution of two functions as inspiration, we will not define the convolution of a distribution $\Lambda$ with a test function $\phi$, and under certain conditions, the convolution of two distributions. Recall that if $f,g \in L^1(\RR^n)$, then their convolution is the function in $L^1(\RR^n)$ defined by
%
\[ (f * g)(x) = \int f(y) g(x - y)\; dy \]
%
If we define the translation operators $(T_y g)(x) = g(x-y)$, then $(f * g)(x) = \int f(y) (T_x g^*)(y)\; dy$, where $g^*$ is the function defined by $g^*(x) = g(-x)$. Thus, if $\Lambda$ is any distribution on $\RR^n$, and $\phi$ is a test function on $\RR^n$, we can define a function $\Lambda * \phi$ by setting $(\Lambda * \phi)(x) = \Lambda(T_x \phi^*)$. Notice that since
%
\begin{align*}
    \int (T_x f)(y) g(y)\; dy &= \int f(y-x) g(y)\; dy = \int f(y) g(x+y)\; dy\\
    &= \int f(y) (T_{-x}g)(y)\; dy,
\end{align*}
%
so we can also define the translation operators on distributions by setting $(T_x \Lambda)(\phi) = \Lambda (T_{-x} \phi)$. One mechanically verifies that convolution commutes with translations, i.e. $T_x (\Lambda * \phi) = (T_x \Lambda) * \phi = \Lambda * (T_x \phi)$.

\begin{theorem}
    $\Lambda * \phi$ is $C^\infty$, and $D^\alpha(\Lambda * \phi) = (D^\alpha \Lambda) * \phi = \Lambda * (D^\alpha \phi)$.
\end{theorem}
\begin{proof}
    It is easy to calculate that
    %
    \begin{align*}
        (D^\alpha \Lambda * \phi)(x) &= (D^\alpha \Lambda)(\phi^*_x) = (-1)^{|\alpha|} \Lambda(D^\alpha (T_x \phi^*))\\
        &= \Lambda(T_x (D^\alpha \phi)^*) = (\Lambda * D^\alpha \phi)(x)
    \end{align*}
    %
    If $k \in \{ 1, \dots, d \}$ and $h \in \RR$, we set
    %
    \[ (\Delta_h f)(x) = \frac{f(x + he_k) - f(x)}{h} \]
    %
    then $\Delta_h \phi$ converges to $D^k \phi$ in $\DD(\RR^d)$, and as such
    %
    \begin{align*}
      \Delta_h(\Lambda * \phi)(x) &= \frac{(\Lambda * \phi)(x + he_k) - (\Lambda * \phi)(x)}{ h}\\
      &= \Lambda \left( \frac{T_{-x - he_k} \phi^* - T_{-x} \phi^*}{h} \right)
    \end{align*}
    %
    As $h \to 0$, in $\DD(\RR^d)$ we have
    %
    \[ \frac{T_{-x - he_k} \phi^* - T_{-x} \phi^*}{h} \to - T_{-x} D_k \phi^* = T_{-x} (D_k \phi)^*. \]
    %
    Thus, by continuity,
    %
    \[ \lim_{h \to 0} \Delta_h(\Lambda * \phi)(x) = \Lambda(T_{-x} (D_k \phi)^*) = (\Lambda * D_k \phi)(x) \]
    %
    Iteration gives the general result that $\Lambda * \phi \in C^\infty(\RR^d)$. An easy calculation then shows that for each $x \in \RR^d$,
    %
    \begin{align*}
      [(D^\alpha \Lambda) * \phi](x) &= (D^\alpha \Lambda)(T_{-x} \phi^*)\\
      &= (-1)^{|\alpha|} \Lambda(T_{-x} D^\alpha \phi^*)\\
      &= \Lambda(T_{-x} (D^\alpha \phi)^*)\\
      &= (\Lambda * D^\alpha \phi)(x). \qedhere
    \end{align*}
\end{proof}

There is a certain duality going on here. Distributions can be viewed as linear functionals on $\DD(\RR^d)$, but one can also view them as a certain family of linear operators from $\DD(\RR^d) \to C^\infty(\RR^d)$ , and the convolution operator uniquely represents the distribuition. In fact, any such operator that is translation invariant and continuous can be represented as convolution by a distribution.

\begin{theorem}
  Let $T: \DD(\RR^d) \to C^\infty(\RR^d)$ be a translation invariant continuous operator. Then there exists a distribution $\Lambda$ such that $T\phi = \Lambda * \phi$ for all $\phi \in \DD(\RR^d)$.
\end{theorem}
\begin{proof}
  If we knew $T\phi = \Lambda * \phi$ for some $\Lambda$, then we could recover $\Lambda$ since
  %
  \[ \int \Lambda(x) \phi(x)\; dx = T \tilde{\phi}(0). \]
  %
  Since $T$ is a continuous operator, the right hand side defines a distribution $\Lambda$, and translation invariance allows us to conclude that $T\phi = \Lambda * \phi$ for all $\phi \in \DD(\RR^d)$.
\end{proof}

\begin{example}
        A linear differential operator $P: \DD(\RR^d) \to \DD(\RR^d)$ is translation invariant, from which it follows that there exists a distribution $\Lambda$ such that $P\phi = \Lambda * \phi$. Of course, $\Lambda(\phi) = P\phi(0)$ is just given by applying the differential operator at the origin.
\end{example}

For more general operators that are translation invariant, we cannot represent all operators via convolution by distributions. A significantly more general family of operators can be found if, instead of considering operators of the form
%
\[ T\phi(x) = \int \Lambda(x - y) \phi(y)\; dy \]
%
we instead study \emph{kernel} operators
%
\[ T\phi(x) = \int K(x,y) \phi(y)\; dy \]
%
where $K$ is a distribution on $\Omega_1 \times \Omega_2$ and $\phi \in \DD(\Omega_1)$. To formally interpret the output of this operator, we need to test it against another bump function, i.e. for $\psi \in \DD(\Omega_2)$ we consider
%
\[ \int T\phi(x) \psi(x)\; dx = \int K(x,y) \psi(x) \phi(y)\; dx\; dy, \]
%
which is $K$ tested against $\phi \otimes \psi$. Thus $T\phi$ is naturally a distribution on $\RR^m$, and this definition gives a continuous map $T: \DD(\RR^n) \to \DD^*(\RR^m)$. The behaviour of the operator $T$ uniquely determines the distribution $K$, and we call $K$ the \emph{Schwartz kernel} of $T$. In 1953, Schwartz showed that essentially every linear operator encountered in Euclidean analysis is of this form, which explains the prevalence of kernel operators in analysis.

\begin{theorem}
  Let $T: \DD(\Omega_1) \to \DD^*(\Omega_2)$ be a continuous linear operator. Then there exists a unique distribution $K \in \DD^*(\Omega_1 \times \Omega_2$ such that for $\phi \in \DD(\RR^n)$ and $\psi \in \DD(\RR^m)$,
  %
  \[ \int T\phi(y) \psi(y)\; dy = \int K(x,y) \phi(x) \psi(y)\; dx\; dy. \]
\end{theorem}
\begin{proof}
    TODO
\end{proof}

\begin{remark}
    When $\Omega_1 = \Omega_2 = \RR^d$ it is often more elegant to work with a representation of kernel operators in \emph{convolution form}, i.e. writing
    %
    \[ T \phi(x) = \int k(x,z) \phi(x-z)\; dz \]
    %
    which is just another way to represent the operators above by considering the change of variables $z = x - y$, i.e. we have $k(x,z) = K(x,x-z)$, or $K(x,y) = k(x,x-y)$. We call $k$ the \emph{Schwartz convolution kernel} associated with the operator $T$. 
\end{remark}

Looking at the properties of kernels defining an operator is often a useful technique to gain insight in how an operator behaves, since one can study the singularities and smoothness of the kernel separately from the operator itself.

\begin{theorem}
    If $\phi, \psi \in \DD(\RR^n)$, then $\Lambda * (\phi * \psi) = (\Lambda * \phi) * \psi$.
\end{theorem}
\begin{proof}
  Let $K$ be a compact set containing the supports of $\phi$ and $\psi$. It is simple to verify that for each $x \in \RR^d$,
    %
    \[ (\phi * \psi)^*(x) = \int \phi^*(x + y) \psi(y)\; dy = \int (T_y \phi^*)(x) \psi(y)\; dy \]
    %
    since the map $y \mapsto (T_y \phi)^* \psi(y)$ is continuous, and vanishes out of the compact set $K$, we can consider the $C_c^\infty(K)$ valued integral
    %
    \[ (\phi * \psi)^* = \int_K \psi^*(y) T_y \phi^*\; ds \]
    %
    This means precisely that
    %
    \begin{align*}
        (\Lambda * (\phi * \psi))(0) &= \Lambda((\phi * \psi)^*) = \int_K \psi^*(y) \Lambda(T_y \phi^*)\; dy\\
        &= \int_K \psi^*(y) (\Lambda * \phi)(y)\; dy = ((\Lambda * \phi) * \psi)(0)
    \end{align*}
    %
    The commutativity in general results from applying the commutativity of the translation operators.
\end{proof}

A net $\{ \phi_\alpha \}$ is known as an {\it approximate identity} in the space of distributions if $\Lambda * \phi_\alpha \to \Lambda$ weakly as $\alpha \to \infty$, for every distribution $\Lambda$, and an approximate identity in the space of test functions if $\psi * \phi_\alpha \to \psi$ in $\DD(\RR^n)$.

\begin{theorem}
    If $\phi_\alpha$ is a family of non-negative functions in $\DD(\RR^n)$ which are eventually supported on every neighbourhood of the origin, and integrate to one, then $\phi_\alpha$ is an approximation to the identity in the space of test functions and in the space of distributions.
\end{theorem}
\begin{proof}
    It is easy to verify that if $f$ is a continuous function, then $f * \phi_\delta$ converges locally uniformly to $f$ as $\delta \to 0$. But now we calculate that if $f \in \DD(\RR^n)$, then $D^\alpha(f * \phi_\delta) = (D^\alpha f) * \phi_\delta$ converges locally uniformly to $D^\alpha \phi$, which gives that $f * \phi$ converges to $f$ in $\DD(\RR^n)$. Now if $\Lambda$ is a distribution, and $\psi$ is a test function, then continuity gives
    %
    \begin{align*}
        \Lambda(\psi^*) &= \lim_{\delta \to 0} \Lambda(\phi_\delta * \psi) = \lim_{\delta \to 0} (\Lambda * (\phi_\delta * \psi))(0)\\
        &= \lim_{\delta \to 0} ((\Lambda * \phi_\delta) * \psi)(0) = \lim_{\delta \to 0} (\Lambda * \phi_\delta)(\psi^*)
    \end{align*}
    %
    and $\psi$ was arbitrary.
\end{proof}

If $\Lambda$ is a distribution on $\RR^n$, then the map $\phi \mapsto \Lambda * \phi$ is a linear transformation from $\DD(\RR^n)$ into $C^\infty(\RR^n)$, which commutes with translations. It is also continuous. To see this, we consider a fixed compact $K$, and consider the map from $C_c^\infty(K)$ to $C^\infty(\RR^n)$. We can apply the closed graph theorem to prove continuity, so we assume the existence of $\phi_1, \phi_2, \dots$ converging to $\phi$ in $C_c^\infty(K)$ and $\Lambda * \phi_1, \Lambda * \phi_2, \dots$ converges to $f$. It suffices to show $f = \Lambda * \phi$. But we calculate that for each $x \in \RR^d$,
%
\[ f(x) = \lim (\Lambda * \phi_n)(x) = \lim \Lambda(T_x \phi^*_n) = \Lambda (\lim T_x \phi^*_n) = \Lambda(T_x \phi^*) = (\Lambda * \phi)(x). \]
%
Here we have used the fact that $T_x \phi_n^*$ converges to $T_x \phi^*$ in $\DD(\RR^n)$. Suprisingly, the converse is also true.

\begin{theorem}
    If $L: \DD(\RR^n) \to C^\infty(\RR^n)$ and commutes with translations, then there is a distribution $\Lambda$ such that $L(\phi) = \Lambda * \phi$.
\end{theorem}
\begin{proof}
    If $L(\phi) = \Lambda * \phi$, then we would have
    %
    \[ \Lambda(\phi) = (\Lambda * \phi^*)(0) = L(\phi^*)(0) \]
    %
    and we take this as the definition of $\Lambda$ for an arbitrary operator $L$. Indeed, it then follows that $\Lambda$ is continuous because all the operations here are continuous, and because $L$ commutes with translations, we conclude
    %
    \[ (\Lambda * \phi)(x) = \Lambda(T_x \phi^*) = L(T_{-x} \phi)(0) = L(\phi)(x) \]
    %
    which gives the theorem.
\end{proof}

We now move onto the case where a distribution $\Lambda$ has compact support. Then $\Lambda$ extends to a continuous functional on $C^\infty(\RR^n)$, and we can define the convolution $\Lambda * \phi$ if $\phi \in C^\infty(\RR^n)$. The same techniques as before verify that translations and derivatives are carried into the convolution.

\begin{theorem}
    If $\phi$ and $\Lambda$ have compact support, then $\Lambda * \phi$ has compact support.
\end{theorem}
\begin{proof}
    Let $\phi$ and $\Lambda$ be supported on $K$. Then $(\Lambda * \phi)(x) = \Lambda(T_x \phi^*)$. Since $T_x \phi^*$ is supported on $x - K$, for $x$ large enough $x-K$ is disjoint from $K$, and so $\Lambda * \phi$ vanishes outside of $K + K$.
\end{proof}

\begin{theorem}
    If $\Lambda$ and $\psi$ have compact support, and $\phi \in C^\infty(\RR^n)$, then
    %
    \[ \Lambda * (\phi * \psi) = (\Lambda * \phi) * \psi = (\Lambda * \psi) * \phi \]
\end{theorem}
\begin{proof}
    Let $\Lambda$ and $\psi$ be supported on some balanced compact set $K$. Let $V$ be a bounded, balanced open set containing $K$. If $\phi_0$ is a function with compact support equal to $\phi$ on $V + K$, then for $x \in V$,
    %
    \[ (\phi * \psi)(x) = \int \phi(x - y) \psi(y)\; dy = \int \phi_0(x - y) \psi(y)\; dy = (\phi_0 * \psi)(x) \]
    %
    Thus
    %
    \[ (\Lambda * (\phi * \psi))(0) = (\Lambda * (\phi_0 * \psi))(0) = ((\Lambda * \psi) * \phi_0)(0) \]
    %
    But $\Lambda * \psi$ is supported on $K + K$, so $((\Lambda * \psi) * \phi_0)(0) = ((\Lambda * \psi) * \phi)(0)$. Now we also calculate
    %
    \[ (\Lambda * (\phi * \psi))(0) = ((\Lambda * \phi_0) * \psi)(0) = ((\Lambda * \phi) * \psi)(0) \int (\Lambda * \phi_0)(-y) \psi(y) \]
    %
    where the last fact follows because $\Lambda * \phi_0$ agrees with $\Lambda * \phi$ on $K$. The general fact follows by applying the translation operators.
\end{proof}

Now we come to the grand finale, defining the convolution of two distributions. Given two distributions $\Lambda$ and $\Psi$, one of which has compact support, we define the linear operator
%
\[ L(\phi) = \Lambda * (\Psi * \phi) \]
%
Then $L$ commutes with translations, and is continuous, because if we have $\phi_1, \phi_2, \dots$ converging to $\phi$ in $C_c^\infty(K)$, then $\Psi * \phi_n$ converges to $\Psi * \phi$ in $C^\infty(\RR^n)$. If $\Psi$ is supported on a compact support $C$, then the $\Psi * \phi_n$ have common compact support $C + K$, and actually converge in $C_c^\infty(C + K)$, hence $\Lambda * (\Psi * \phi_n)$ converges to $\Lambda * (\Psi * \phi)$. Conversely, if $\Lambda$ has compact support, then $\Psi * \phi_n$ converges in $C^\infty(\RR^n)$, which implies $\Lambda * (\Psi * \phi_n)$ converges to $\Lambda * (\Psi * \phi)$ in $C^\infty(\RR^n)$. Thus $L$ corresponds to a distribution, and we define this distribution to be $\Lambda * \Psi$.

\begin{theorem}
    If $\Lambda$ and $\Psi$ are distributions, one of which has compact support, then $\Lambda * \Psi = \Psi * \Lambda$. Let $S_\Lambda$ and $S_\Psi$, and $S_{\Lambda * \Psi}$ denote the supports of $\Lambda$, $\Psi$, and $\Lambda * \Psi$. Then $\Lambda * \Psi = \Psi * \Lambda$, and $S_{\Lambda * \Psi} \subset S_\Lambda + S_\Psi$.
\end{theorem}
\begin{proof}
    We calculate that for any two test functions $\phi$ and $\psi$,
    %
    \[ (\Lambda * \Psi) * (\phi * \psi) = \Lambda * (\Psi * (\phi * \psi)) = \Lambda * ((\Psi * \phi) * \psi) \]
    %
    If $\Lambda$ has compact support, then
    %
    \[ \Lambda * ((\Psi * \phi) * \psi) = (\Lambda * \psi) * (\Psi * \phi) \]
    %
    Conversely, if $\Psi$ has compact support, then
    %
    \[ \Lambda * ((\Psi * \phi) * \psi) = \Lambda * (\psi * (\Psi * \phi)) = (\Lambda * \psi) * (\Psi * \phi) \]
    %
    We also calculate
    %
    \begin{align*}
        \Psi * ((\Lambda * \phi) * \psi) &= \Psi * (\Lambda * (\phi * \psi)) = \Psi * (\Lambda * (\psi * \phi))\\
        &= \Psi * ((\Lambda * \psi) * \phi) = (\Psi * \phi) * (\Lambda * \psi)
    \end{align*}
    %
    But since convolution is commutative, we have
    %
    \[ ((\Lambda * (\Psi * \phi)) * \psi) = \Lambda * ((\Psi * \phi) * \psi) = \Psi * ((\Lambda * \phi) * \psi) = (\Psi * (\Lambda * \phi)) * \psi \]
    %
    Since $\psi$ was arbitrary, we conclude
    %
    \[ (\Lambda * \Psi) * \phi = \Lambda * (\Psi * \phi) = \Psi * (\Lambda * \phi) = (\Psi * \Lambda) * \phi \]
    %
    and now since $\phi$ was arbitrary, we conclude $\Lambda * \Psi = \Psi * \Lambda$. Now we know convolution is commuatative, we may assume $S_\Psi$ is compact. The support of $\Psi * \phi^*$ lies in $S_\Psi - S_\phi$. But this means that if $S_\phi - S_\Psi$ is disjoint from $S_\Lambda$, which means exactly that $S_\phi$ is disjoint from $S_\Lambda + S_\Psi$, then
    %
    \[ (\Lambda * \Psi)(\phi) = (\Lambda * (\Psi * \phi))(0) = 0 \]
    %
    and this gives the support of $\Lambda * \Psi$.
\end{proof}

This means that the convolution of two distributions with compact support also has compact support. This means that if we have three distributions $\Lambda, \Psi$, and $\Phi$, two of which have compact support, then the distributions $\Lambda * (\Psi * \Phi)$ and $(\Lambda * \Psi) * \Phi$ are well defined, so convolution is associative and commutative. We calculate that for any test function $\phi$,
%
\[ (\Lambda * (\Psi * \Phi)) * \phi = \Lambda * (\Psi * (\Phi * \phi)) \]
\[ ((\Lambda * \Psi) * \Phi) * \phi = (\Lambda * \Psi) * (\Phi * \phi) \]
%
If $\Phi$ has compact support, then $\Phi * \phi$ has compact support, and so we can move $(\Lambda * \Psi)$ into the equation to prove equality. If $\Phi$ does not have compact support, then $\Lambda$ and $\Psi$ have compact support, and
%
\[ \Lambda * (\Psi * \Phi) = \Lambda * (\Phi * \Psi) \]
%
and we can apply the previous case to obtain that this is equal to $(\Lambda * \Phi) * \Psi$. Repeatedly applying the previous case brings this to what we want.

\begin{theorem}
    If $\Lambda$ and $\Psi$ are distributions, one of which having compact support, then
    %
    \[ D^\alpha(\Lambda * \Psi) = (D^\alpha \Lambda) * \Psi = \Lambda * (D^\alpha \Psi). \]
\end{theorem}
\begin{proof}
    The Dirac delta function $\delta$ satisfies
    %
    \[ (\delta * \phi)(x) = \int \phi(y) \delta(x-y)\; dy = \phi(x) \]
    %
    so $\delta * \phi = \phi$. Now $D^\alpha \delta$ is also supported at $x$, since
    %
    \[ (D^\alpha \delta)(\phi) = (-1)^{|\alpha|} \int \delta(x) (D^\alpha \phi)(x)\; dx = (-1)^{|\alpha|} (D^\alpha \phi)(0) \]
    %
    which means that for any distribution $\Lambda$, then $(D^\alpha \delta) * \Lambda$ has compact support,
    %
    \[ (((D^\alpha \delta) * \Lambda) * \phi)(0) = (D^\alpha \delta)((\Lambda * \phi)^*) = (-1)^{|\alpha|} D^\alpha (\Lambda * \phi)^* = ((D^\alpha \Lambda) * \phi)(0) \]
    %
    which verifies that $(D^\alpha \delta) * \Lambda = \delta * (D^\alpha \Lambda)$. But now we find
    %
    \[ D^\alpha(\Lambda * \Psi) = (D^\alpha \delta) * \Lambda * \Psi = ((D^\alpha \delta) * \Lambda) * \Psi = D^\alpha \Lambda * \Psi \]
    \[ D^\alpha(\Lambda * \Psi) = D^\alpha(\Psi * \Lambda) = (D^\alpha \Psi) * \Lambda = \Lambda * (D^\alpha \Psi) \]
    %
    which verifies the theorem in general.
\end{proof}

\section{Schwartz Space and Tempered Distributions}

We have already encountered the fact that Fourier transforms are well behaved under differentiation and multiplication by polynomials. If we let $\mathcal{S}(\RR^d)$ denote a class of functions under which to study this phenomenon, it must be contained in $L^1(\RR^d)$ and $C^\infty(\RR^d)$, and closed under multiplication by polynomials, and closed under applications of arbitrary constant-coefficient differential operators. A natural choice is then the family of functions which \emph{decays rapidly}, as well as all of it's derivatives; i.e. we let $\mathcal{S}(\RR^d)$ be the space of all functions $f \in C^\infty(\RR^d)$ such that for any integer $n$ and multi-index $\alpha$, $|x|^n D^\alpha f \in L^\infty(\RR^d)$. The space $\mathcal{S}(\RR^d)$ is then locally convex if we consider the family of seminorms
%
\[ \| f \|_{\mathcal{S}^{n,m}(\RR^d)} = \| \langle x \rangle^m \nabla^n f \|_{L^\infty(\RR^d)}. \]
%
Elements of $\mathcal{S}(\RR^d)$ are known as \emph{Schwartz functions}, and $\mathcal{S}(\RR^d)$ is often known as the \emph{Schwartz space}. The seminorms naturally give $\mathcal{S}(\RR^d)$ the structure of a Fr\'{e}chet space. Sometimes, it is more convenient to use the equivalent family of seminorms $\| f \|_{\mathcal{S}^{\alpha, \beta}(\RR^d)} = \| x^\alpha D^\beta f \|_{L^\infty(\RR^d)}$, because $x^\alpha$ often behaves more nicely under various Fourier analytic operations. It is obvious that $\mathcal{S}(\RR^d)$ is separated by the seminorms defined on it, because $\| \cdot \|_{L^\infty(\RR^d)} = \| \cdot \|_{\mathcal{S}^{0,0}(\RR^d)}$ is a norm used to define the space. We now show the choice of seminorms make the space complete.

\begin{theorem}
    $\mathcal{S}(\RR^d)$ is a complete metric space.
\end{theorem}
\begin{proof}
    Let $\{ f_i \}$ be a Cauchy sequence with respect to the seminorms $\| \cdot \|_{\mathcal{S}^{n,\alpha}(\RR^d)}$. This implies that for each integer $m$, and multi-index $\alpha$, the sequence of functions $\langle x \rangle^m D^\alpha f_k$ is Cauchy in $L^\infty(\RR^d)$. Since $L^\infty(\RR^d)$ is complete, there are functions $g_{m,\alpha}$ such that $\langle x \rangle^m D^\alpha f_k$ converges uniformly to $g_{m,\alpha}$. If we set $f = g_{0,0}$, then it is easy to see using the basic real analysis of uniform continuity that $f$ is infinitely differentiable, and $\langle x \rangle^m D^\alpha f = g_{m,\alpha}$. It is then easy to show that $f_i$ converges to $f$ in $\mathcal{S}(\RR^d)$.
\end{proof}

\begin{example}
    The Gaussian function $\phi: \RR^d \to \RR$ defined by $\phi(x) = e^{-|x|^2}$ is Schwartz. For any multi-index $\alpha$, there is a polynomial $P_\alpha$ of degree at most $|\alpha|$ such that $D^\alpha \phi = P_\alpha \phi$; this can be established by a simple induction. But this means that for each fixed $\alpha$, $|P_\alpha(x)| \lesssim_\alpha 1 + |x|^{|\alpha|}$. Since $e^{-|x|^2} \lesssim_{m,\alpha} \langle x \rangle^{-m -|\alpha|}$ for any fixed $m$ and $\alpha$, we find that for any $x \in \RR^d$,
    %
    \[ | (1 + |x|^m) D^\alpha \phi| \lesssim_{\alpha,m} 1. \]
    %
    Since $m$ and $\alpha$ were arbitrary, this shows $\phi$ is Schwartz.
\end{example}

\begin{example}
    The space $C^\infty_c(\RR^d)$ consists of all compactly supported $C^\infty$ functions. If $f \in C^\infty_c(\RR^d)$, then $f$ is Schwartz. This is because for each $\alpha$ and $m$, $(1 + |x|)^m f_\alpha$ is a continuous function vanishing outside a compact set, and is therefore bounded.
\end{example} 

Because of the sharp control we have over functions in $\mathcal{S}(\RR^d)$, almost every analytic operation we want to perform on $\mathcal{S}(\RR^d)$ is continuous. To show that an operator $T$ on $\mathcal{S}(\RR^d)$ is bounded, it suffices to show that for each $n_0$ and $m_0$, there is $n_1$, $m_1$ such that
%
\[ \| Tf \|_{\mathcal{S}^{n_0,m_0}(\RR^d)} \lesssim_{n_0,m_0} \| f \|_{\mathcal{S}^{n_1,m_1}(\RR^d)}. \]
%
For a functional $\Lambda: \mathcal{S}(\RR^d) \to \RR$, it suffices to show that there exists $n$ and $m$ such that $|\Lambda f| \lesssim \| f \|_{\mathcal{S}^{n,m}(\RR^d)}$. The minimal such choice of $n$ is known as the \emph{order} of the functional $\Lambda$. We normally do not care about the constant behind the operators for these norms, since the norms are not translation invariant and therefore highly sensitive to the positions of various functions. We really just care about proving the existence of such a constant.

\begin{lemma}
  The map $(f,g) \mapsto fg$ for $f,g \in \mathcal{S}(\RR^d)$ gives a bounded bilinear map from $\mathcal{S}(\RR^d) \times \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$.
\end{lemma}
\begin{proof}
  A simple application of the Leibnitz formula shows that for any multi-index $\alpha$ with $|\alpha| = m$, and two non-negative integers $n_1$ and $n_2$ with $n_1 + n_2 = n$,
  %
  \[ \| fg \|_{\mathcal{S}^{n,\alpha}(\RR^d)} \lesssim_n \| f \|_{\mathcal{S}^{n_1,m}(\RR^d)} \| g \|_{\mathcal{S}^{n_2,m}(\RR^d)}. \]
  %
  More generally, this argument shows that the analogoue bilinear map from $C^\infty(\RR^d) \times \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$ is bounded.
\end{proof}

\begin{theorem}
    The following operators are all bounded on $\mathcal{S}(\RR^n)$.
    %
    \begin{itemize}
        \item For each $h \in \RR^n$, the translation operator $(T_h f)(x) = f(x - h)$.

        \item For each $\xi \in \RR^n$, the modulation operator $(M_\xi f)(x) = e(\xi \cdot x) f(x)$.

        \item The $L^p$ norms $\| f \|_{L^p(\RR^n)}$, for $1 \leq p \leq \infty$.

        \item The Fourier transform from $\mathcal{S}(\RR^d)$ to $\mathcal{S}(\RR^d)$.
    \end{itemize}
    %
    Furthermore, the Fourier transform is an isomorphism of $\mathcal{S}(\RR^d)$.
\end{theorem}
\begin{proof}
%   Let $(T_h f)(x) = f(x - h)$. We calculate that if $|\alpha| \leq n$, then
    %
%   \begin{align*}
%       (1 + |x|^m) (T_h f)_\alpha &= T_h((1 + |x + h|^m) f_\beta)\\
%       &\leq 2^m T_h((1 + |x|^m + |h|^m) f_\alpha)\\
%       &\leq 2^m |h|^m \| f_\alpha \|_{n,0} + 2^m \| f \|_{n,m}.
%   \end{align*}
    %
%   Thus $\| T_h f \|_{n,m} \leq 2^m(1 + |h|^m) \| f \|_{n,m}$, so $T_h$ is continuous.

%   Similarily, we calculate using the Leibnitz formula and the formula for the derivatives of $e(\xi \cdot x)$ that if $|\alpha| \leq n$, then
    %
%   \[ (1 + |x|^m) |(e(\xi \cdot x) f)_\alpha| \leq 4^n (2\pi)^n (1 + |\xi|^n) \| f \|_{n,m} \]
    %
%   Thus $\| M_\xi f \|_{n,m} \leq (8 \pi)^n (1 + |\xi|^n) \| f \|_{n,m}$.

%   For any Schwartz function $f$, and $|\alpha| \leq n$,
    %
%   \[ f(x) \leq \frac{\| f \|_{0,d+1}}{1 + |x|^{d+1}} \]
    %
%   Integrating this equation gives
    %
%   \[ \| f_\alpha \|_{L^1(\RR^d)} \leq 2^d \| f \|_{0,d+1}. \]
    %
%   Thus $\| \cdot \|_1$ is a bounded norm on the space. Interpolation then shows that for any $1 < p < \infty$,
    %
%   \[ \| f \|_{L^p(\RR^d)} \leq \| f \|_{L^1(\RR^d)}^{1 - 1/p} \| f \|_{L^\infty(\RR^d)}^{1/p} \leq \| f \|_{L^1(\RR^d)} + \| f \|_{L^\infty(\RR^d)} \leq 2 \| f \|_{0,d+1}. \]
    %
%   This implies $\| \cdot \|_{L^p(\RR^d)}$ is bounded.

%   A simple calculation using the Leibnitz formula shows that if $|\alpha| \leq n$,
    %
%   \begin{align*}
%       (1 + |x|^m) |\mathcal{F}(f)_\alpha| &\leq |\mathcal{F}(f)_\alpha| + \sum_{k = 1}^d |x_k^m \mathcal{F}(f)_\alpha|\\
%       &\leq (2 \pi)^n \left( \| \mathcal{F} f \|_{L^\infty(\RR^d)} + \sum_{k = 1}^d |\mathcal{F}((x^\alpha f)_{me_k})| \right)\\
%       &\leq n! (2 \pi)^n 2^m (n+1) \max_{0 \leq k \leq d} \max_{1 \leq l \leq m} \left( \| \mathcal{F} f \|_{L^\infty(\RR^d)} + \sum_{k = 1}^n \max_{1 \leq l \leq m} \| \mathcal{F}(f_{le_k}) \|_{L^\infty(\RR^d)} \right)\\
%       &\leq n! (2 \pi)^n 2^m \left( \| f \|_{L^1(\RR^d)} + \sum_{k = 1}^n \max_{1 \leq l \leq m} \| f_{le_k} \|_{L^1(\RR^d)} \right)\\
%       &\leq n! (2 \pi)^n 2^m 2^d (n+1) \| f \|_{n,d+1}.
%   \end{align*}

%   there are constants $c_{\alpha \beta \gamma}$ for each $\gamma \leq \alpha \wedge \beta$ such that
    %
%   \begin{align*}
%       |x^\alpha \mathcal{F}(f)_\beta| &= (2 \pi)^{|\beta|} |x^\alpha \cdot \mathcal{F}(x^\beta f)|\\
%       &= (2\pi)^{|\beta| - |\alpha|} \mathcal{F}((x^\beta f)_\alpha)\\
%       &\leq (2\pi)^{|\beta| - |\alpha|} \sum_{\gamma \leq \alpha \wedge \beta} c_{\alpha \beta \gamma} |\mathcal{F}(x^{\beta - \gamma} f_{\alpha - \gamma})|.
%   \end{align*}
    %
%   This calculation shows
    %
%   \begin{align*}
%       \| \mathcal{F} f \|_{\alpha,\beta} &\lesssim_{\alpha,\beta} \sum \| \mathcal{F}(x^{\beta - \gamma} f_{\alpha - \gamma}) \|_{L^\infty(\RR^n)}\\
%       &\leq \sum \| x^{\beta - \gamma} f_{\alpha - \gamma} \|_{L^1(\RR^n)}.
%   \end{align*}
    %
%   The right hand side is a continuous function of $f$, so the Fourier transform is bounded. The smoothness of the Schwartz space implies that $\mathcal{F}$ is a bijective map. But then the open mapping theorem implies that $\mathcal{F}^{-1}$ is a bounded operation, and therefore $\mathcal{F}$ is a homeomorphism.

    We leave all but the last point as exercises. Here it will be convenient to use the norms $\| \cdot \|_{\mathcal{S}^{\alpha,\beta}(\RR^d)}$ as well as the norms $\| \cdot \|_{\mathcal{S}^{n,m}(\RR^d)}$. If $|\alpha| \leq m$, $|\beta| \leq n$, then we can use the Leibnitz formula to conclude that
    %
    \begin{align*}
        \| \xi^\alpha D^\beta \mathcal{F}(f) \|_{L^\infty(\RR^d)} &\lesssim_{\alpha,\beta} \| \mathcal{F}(D^\alpha(x^\beta f)) \|_{L^\infty(\RR^d)}\\
        &\lesssim_{\alpha,\beta} \max_{\gamma \leq \alpha \wedge \beta} \| \mathcal{F}(x^{\gamma} D^\gamma f) \|_{L^\infty(\RR^d)}\\
        &\leq \max_{\gamma \leq \alpha \wedge \beta} \| x^\gamma D^\gamma f \|_{L^1(\RR^d)}\\
        &\lesssim \| f \|_{\mathcal{S}^{\gamma,|\gamma| + d+1}(\RR^d)}.
    \end{align*}
    %
    Thus $\mathcal{F}$ is a bounded linear operator on $\mathcal{S}(\RR^d)$. Since all Schwartz functions are arbitrarily smooth, the Fourier inversion formula applies to all Schwartz functions, and so $\mathcal{F}$ is a bijective bounded linear operator with inverse $\mathcal{F}^{-1}$. The open mapping theorem then immediately implies that $\mathcal{F}^{-1}$ is bounded.
\end{proof}

\begin{corollary}
    If $f$ and $g$ are Schwartz, then $f * g$ is Schwartz.
\end{corollary}
\begin{proof}
    Since
    %
    \[ f * g = \mathcal{F}^{-1}(\mathcal{F}(f) \mathcal{F}(g)), \]
    %
    the result follows from the previous results we have shown.
\end{proof}

Now we get to the interesting part of the theory. We have defined a homeomorphic linear transform from $\mathcal{S}(\RR^d)$ to itself. The theory of functional analysis then says that we can define a dual map, which is a homeomorphism from the dual space $\mathcal{S}(\RR^d)^*$ to itself. Note the inclusion map $\DD(\RR^d) \to \mathcal{S}(\RR^d)$ is continuous, and $\DD(\RR^d)$ is dense in $\mathcal{S}(\RR^d)$. This implies that we have an injective, continuous map from $\mathcal{S}^*(\RR^d)$ to $(C_c^\infty)^*(\RR^d)$, so every functional on the Schwarz space can be identified with a distribution. We call such distributions \emph{tempered}. They are precisely the linear functionals on $\DD(\RR^d)$ which have a continuous extension to $\mathcal{S}(\RR^d)$. Intuitively, this corresponds to an asymptotic decay condition.

\begin{example}
    Recall that for any $f \in L^1_{\text{loc}}(\RR^d)$, we can consider the distribution $\Lambda[f]$ defined by setting
    %
    \[ \Lambda[f](\phi) = \int f(x) \phi(x)\; dx. \]
    %
    However, this distribution is not always tempered. If $f \in L^p(\RR^d)$ for some $p$, then, applying H\"{o}lder's inequality, we obtain that
    %
    \[ |\Lambda[f](\phi)| \leq \| f \|_{L^p(\RR^d)} \| \phi \|_{L^q(\RR^d)}. \]
    %
    Since $\| \cdot \|_{L^q(\RR^d)}$ is a continuous norm on $\mathcal{S}(\RR^d)$, this shows $\Lambda[f]$ is bounded. More generally, if $f \in L^1_{\text{loc}}(\RR^d)$, and $f(x) (1 + |x|)^{-m}$ is in $L^p(\RR^d)$ for some $m$, then $\Lambda[f]$ is a tempered distribution. If $p = \infty$, such a function is known as \emph{slowly increasing}.
\end{example}

\begin{example}
    For any Radon measure, $\mu$, we can define a distribution
    %
    \[ \Lambda[\mu](\phi) = \int \phi(x) d\mu(x) \]
    %
    But this distribution is not always tempered. If $|\mu|$ is finite, the inequality $\| \Lambda[\mu](\phi) \| \leq \| \mu \| \| \phi \|_{L^\infty(\RR^d)}$ gives boundedness. More generally, if $\mu$ is a measure such that for some $n$,
    %
    \[ \int_{\RR^d} \frac{d|\mu|(x)}{1 + |x|^n}\; dx < \infty \]
    %
    then $\mu$ is known as a \emph{tempered measure}, and acts as a tempered distribution since
    %
    \begin{align*}
      |\Lambda[\mu](\phi)| &\leq \int_{\RR^d} |\phi(x)|\; d|\mu|(x)\\
      &\leq \left( \int_{\RR^d} \frac{d|\mu|(x)}{1 + |x|^n}\; dx \right) \cdot \| \phi \|_{\mathcal{S}^{0,n}(\RR^d)}.
    \end{align*}
\end{example}

\begin{example}
  Any compactly supported distribution is tempered. Indeed, if $\Lambda$ is a distribution supported on a compact set $K$, then it has finite order $n$ for some integer $n$, and extends to an operator on $C^\infty(\RR^d)$. We then find
  %
  \[ |\Lambda(\phi)| \lesssim \| \phi \|_{C^n(\RR^d)} \leq \| \phi \|_{\mathcal{S}^{0,n}(\RR^d)}. \]
\end{example}

\begin{example}
  The distribution $\Lambda$ on $\RR$ given by
  %
  \[ \Lambda(\phi) = \text{p.v.} \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx \]
  %
  is tempered, since
  %
  \[ \int_{|x| \geq 1} \frac{\phi(x)}{x} \lesssim \| \phi \|_{\mathcal{S}^{1,0}(\RR^d)} \]
  %
  and
  %
  \[ \text{p.v.} \int_{-\infty}^\infty \frac{\phi(x)}{x}\; dx \lesssim \| \phi \|_{C^1(\RR^d)} = \| \phi \|_{\mathcal{S}^{0,1}(\RR^d)} \]
  %
  and so $\Lambda$ is tempered of order 1. The $\text{p.v.}$ is called the \emph{principal value} of $1/x$.
\end{example}

Using the same techniques as for distributions, the derivative $D^\alpha \Lambda$ of a tempered distribution $\Lambda$ is tempered, as is $\phi \Lambda$, whenever $\phi$ is a Schwartz function, or $f \Lambda$, where $f$ is a polynomial. Of course, we can multiply by polynomially increasing smooth functions as well.

Let us now apply the distributional method to define the Fourier transform of a tempered distribution. Recall that we heuristically think of $\Lambda$ as formally corresponding to a regular function $f$ such that
%
\[ \Lambda(\phi) = \int f(x) \phi(x)\; dx \]
%
The multiplication formula
%
\[ \int_{\RR^d} \widehat{f}(\xi) g(\xi)\; d\xi = \int_{\RR^d} f(x) \widehat{g}(x)\; dx \]
%
gives us the perfect opportunity to move the analytical operations on $f$ to analytical operations on $g$. Thus if $\Lambda$ is the distribution corresponding to a Schwartz $f \in \mathcal{S}(\RR^d)$, the distribution $\widehat{\Lambda}$ corresponding to $\widehat{f}$, then for any Schwartz $\phi \in \mathcal{S}(\RR^d)$,
%
\[ \widehat{\Lambda}(\phi) = \Lambda \left( \widehat{g} \right). \]
%
In particular, this motivates us to define the Fourier transform of \emph{any} tempered distribution $\Lambda$ to be the unique tempered distribution $\widehat{\Lambda}$ such that the equation above holds for all Schwartz $\phi$. This distribution exists because the Fourier transform is an isomorphism on the space of Schwartz functions. Clearly, the Fourier transform is a homeomorphism on the space of tempered distributions under the weak topology, and moreover, satisfies all the symmetry properties that the ordinary Fourier transform does, once we interpret scalar, rotation, translation, differentiation, etc, in a natural way on the space of distributions.

\begin{example}
    Consider the constant function $1$, interpreted as a tempered distribution on $\RR^d$. Then for any $\phi \in \mathcal{S}(\RR^d)$,
    %
    \[ 1(\phi) = \int \phi(x)\; dx, \]
    %
    Thus for any $\phi \in \mathcal{S}(\RR^d)$,
    %
    \[ \widehat{1} \left( \widehat{\phi} \right) = 1(\phi) = \int \phi(\xi)\; d\xi = \widehat{\phi}(0). \]
    %
    Thus $\widehat{1}$ is the Dirac delta function at the origin. Similarily, the Fourier inversion formula implies that
    %
    \[ \widehat{\delta} \left( \widehat{\phi} \right) = \phi(0) = \int \widehat{\phi}(\xi)\; d\xi = 1 \left( \widehat{\phi} \right) \]
    %
    so the Fourier transform of the Dirac delta function is the constant 1 function.
\end{example}

\begin{example}
    Let $u$ denote a compactly supported distribution. We claim that $\widehat{u} \in C^\infty(\RR^n)$ is a smooth function, such that
    %
    \[ \widehat{u}(\xi) = \langle u, e^{-2 \pi i \xi \cdot x} \rangle. \]
    %
    Indeed, formally speaking,
    %
    \[ \langle \widehat{u}, \phi \rangle = \langle u, \widehat{\phi} \rangle = \langle u, \int \phi(x) e^{-2 \pi i \xi \cdot x}\; dx \rangle = \int \phi(x) \langle u, e^{-2 \pi i \xi \cdot x} \rangle\; dx. \]
    %
    The proof that $\widehat{u}$ is smooth follows because we have control of the derivatives of $e^{-2 \pi i \xi \cdot x}$ on the support of $u$. 
\end{example}

\begin{example}
  The theory of tempered distributions enables us to take the Fourier transform of $f \in L^p(\RR^d)$, when $p > 2$ or when $p < 1$. The introduction of distributions is in some sense, essential to this process, because for each $p \not \in [1,2]$, there is $f \in L^p(\RR^d)$ such that $\widehat{f}$ is \emph{not} a locally integrable function. Otherwise, we could define an operator $T: L^p(\RR^d) \to L^1(\RR^d)$ given by
  %
  \[ Tf = \widehat{f} \mathbf{I}_{|\xi| \leq 1}. \]
  %
  If a sequence of functions $\{ f_n \}$ converges to $f$ in $L^p(\RR^d)$, and $Tf_n$ converges to $g$ in $L^1(\RR^d)$, then $Tf_n$ converges distributionally to $g$, which implies $Tf = g$. The closed graph theorem thus implies that $T$ is a continuous operator from $L^p(\RR^d)$ to $L^1(\RR^d)$, so there exists $M > 0$ such that
  %
  \[ \int_{|\xi| \leq 1} |\widehat{f}(\xi)| \leq M \| f \|_{L^p(\RR^d)}. \]
  %
  If $f_\alpha(x) = e^{-\pi \alpha |x|^2}$, then $\widehat{f_\alpha}(\xi) = \alpha^{-d/2} e^{-\pi |x|^2 / \alpha}$. We have
  %
  \begin{align*}
    \| f_\alpha \|_{L^p(\RR^d)} &= \left( \int_{\RR^d} e^{- \pi \alpha p |x|^2}\; dx \right)^{1/p}\\
    &= (\alpha p)^{-d/2p} \left( \int_{\RR^d} e^{- \pi |x|^2}\; dx \right)^{1/p} \lesssim_d (\alpha p)^{-1/2p}.
  \end{align*}
  %
  On the other hand, for $|\xi| \leq 1$, $|\widehat{f_\alpha}(\xi)| \geq \alpha^{-d/2} e^{-\pi/\alpha}$, so
  %
  \[ \int_{|\xi| \leq 1} |\widehat{f_\alpha}(\xi)| \gtrsim_d \alpha^{-d/2} e^{-\pi/\alpha}. \]
  %
  Thus we conclude that $\alpha^{-d/2} e^{-\pi/\alpha} \lesssim_d M (\alpha p)^{-d/2p}$, or equivalently,
  %
  \[ \alpha^{d/2(1/p-1)} e^{-\pi/\alpha} \lesssim_d M p^{-d/2p}. \]
  %
  Taking $\alpha \to \infty$ gives a contradiction if $p < 1$. For $p > 2$, we give the Gaussian an oscillatory factor that does not affect the $L^p$ norm but boosts the $L^1$ norm of the Fourier transform. We set
  %
  \[ g_\delta(x) = \prod_{k = 1}^d \frac{e^{- \pi x_k^2 / (1 + i \delta)}}{(1 + i \delta)^{1/2}}. \]
  %
  The Fourier transform formula of the Gaussian, when applied using the theory of analytic continuation, shows that
  %
  \[ \widehat{g_\delta}(\xi) = \prod_{k = 1}^d e^{- \pi (1 + i \delta) \xi_k^2}. \]
  %
  We have
  %
  \[ \int_{|\xi| \leq 1} |\widehat{g_\delta}(\xi)| = \int_{|\xi| \leq 1} e^{- \pi |\xi|^2} \gtrsim 1. \]
  %
  On the other hand, for $\delta \geq 1$,
  %
  \begin{align*}
    \| g_\delta \|_{L^p(\RR^d)} &= \left( \int |g_\delta(x)|^p\; dx \right)^{1/p}\\
    &= |1 + i \delta|^{-d/2} \left( \int_{-\infty}^\infty e^{- p \pi x^2/(1 + \delta^2)}\; dx \right)^{d/p}\\
    &\lesssim_d \delta^{-d/2} \delta^{d/p} p^{-d/p} = \delta^{d(1/p - 1/2)} p^{-d/p}.
  \end{align*}
  %
  Thus we conclude $1 \lesssim_d M \delta^{d(1/p - 1/2)} p^{d/p}$, which gives a contradiction as $\delta \to \infty$ if $p > 2$.
\end{example}

\begin{example}
  Consider the Riesz Kernel on $\RR^d$, for each $\alpha \in \CC$ with positive real part, as the function
  %
  \[ K_\alpha(x) = \frac{\Gamma(\alpha/2)}{\pi^{\alpha/2}} |x|^{-\alpha}. \]
  %
  Then for $0 < \text{Re}(\alpha) < d$, $\widehat{K_\alpha} = K_{d-\alpha}$. We recall that $\Gamma$ is defined by the integral formula
  %
  \[ \Gamma(s) = \int_0^\infty e^{-t} t^{s-1}\; ds, \]
  %
  where $\text{Re}(s) > 0$. We note that if $p = d/\text{Re}(\alpha)$, $K_\alpha \in L^{p,\infty}(\RR^d)$. The Marcinkiewicz interpolation theorem implies that if $d/2 < \text{Re}(\alpha) < d$, then $K_\alpha$ can be decomposed as the sum of a $L^1(\RR^d)$ function and a $L^2(\RR^d)$ function, and so we can intepret the Fourier transform of $\widehat{K_\alpha}$ using techniques in $L^1(\RR^d)$ and $L^2(\RR^d)$, and moreover, the Marcinkiewicz interpolation theorem implies that
  %
  \[ \| \widehat{K_\alpha} \|_{L^{q,\infty}(\RR^d)} \leq \| K_\alpha \|_{L^{p,\infty}(\RR^d)}. \]
  %
  where $q$ is the dual of $p$. In particualr, the Fourier transform of $K_\alpha$ is a function. We note that $K_\alpha$ obeys multiple symmetries. First of all, $K_\alpha$ is radial, so $\widehat{K_\alpha}$ is also radial. Moreover, $K_\alpha$ is homogenous of degree $-\alpha$, i.e. for each $x \in \RR^d$, $K_\alpha(\varepsilon x) = \varepsilon^{-\alpha} K_\alpha(x)$. This actually uniquely characterizes $K_\alpha$ among all locally integrable functions. Taking the Fourier transform of both sides of the equation for homogeneity, we find
  %
  \[ \varepsilon^{-d} \widehat{K_\alpha}(\xi/\varepsilon) = \varepsilon^{-\alpha} \widehat{K_\alpha}(x). \]
  %
  Thus $\widehat{K_\alpha}$ is homogenous of degree $\alpha - d$. But this uniquely characterizes $\widehat{K_{d-\alpha}}$ out of any distribution, up to multiplicity, so we conclude that for $d/2 < \text{Re}(\alpha) < d$, that $\widehat{K_\alpha}$ is a scalar multiple of $K_{d-\alpha}$. But we know that by a change into polar coordinates, if $A_d$ is the surface area of a unit sphere in $\RR^d$, then
  %
  \begin{align*}
    \int_{\RR^d} K_\alpha(x) e^{- \pi |x|^2}\; dx &= \frac{\Gamma(\alpha/2)}{\pi^{\alpha/2}} \int_{\RR^d} |x|^{-\alpha} e^{-\pi |x|^2}\; dx\\
    &= A_d \frac{\Gamma(\alpha/2)}{\pi^{\alpha/2}} \int_0^\infty r^{d-1-\alpha} e^{- \pi r^2}\; dr\\
    &= A_d \frac{\Gamma(\alpha/2)}{2 \pi^{d/2}} \int_0^\infty s^{(d-\alpha)/2 - 1} e^{-s}\; ds\\
    &= A_d \frac{\Gamma(\alpha/2) \Gamma((d-\alpha)/2)}{\pi^{d/2}}.
  \end{align*}
  %
  But this is also the value of
  %
  \[ \int_{\RR^d} K_{d - \alpha}(x) e^{- \pi |x|^2}, \]
  %
  so we conclude $\widehat{K_\alpha} = K_{d-\alpha}$ if $d/2 < \text{Re}(\alpha) < d$. We could apply Fourier inversion to obtain the result for $0 < \text{Re}(\alpha) < d/2$, but to obtain the case $\text{Re}(\alpha) = d/2$, we must apply something different. For each $s \in \CC$ with $0 < \text{Re}(s) < d$, and for each Schwartz $\phi \in \mathcal{S}(\RR^d)$ we define
  %
  \[ A(s) = \int K_s(\xi) \widehat{\phi}(\xi)\; d\xi = \frac{\Gamma(s/2)}{\pi^{s/2}} \int |\xi|^{-s/2} \widehat{\phi}(\xi)\; d\xi. \]
  %
  and
  %
  \[ B(s) = \int K_{d-s}(\xi) \widehat{\phi}(\xi)\; d\xi = \frac{\Gamma((d-s)/2)}{\pi^{(d-s)/2}} \int |\xi|^{(d-s)/2} \widehat{\phi}(\xi)\; d\xi. \]
  %
  The integrals above converge absolutely for $0 < \text{Re}(s) < d$, and the dominated convergence theorem implies that $A$ and $B$ are both complex differentiable. Since $A(s) = B(s)$ for $d/2 < \text{Re}(s) < d$, analytic continuation implies $A(s) = B(s)$ for all $0 < \text{Re}(s) < d$, completing the proof. For $\text{Re}(\alpha) \geq d$, $K_\alpha$ is no longer locally integrable, and so we must interpret the distribution given by integration by $K_\alpha$ in terms of principal values. The fourier transform of these functions then becomes harder to define.
\end{example}

\begin{example}
  Let us consider the complex Gaussian defined, for a given invertible symmetric matrix $T: \RR^d \to \RR^d$, as $G_T(x) = e^{- i \pi (Tx \cdot x)}$. Then
  %
  \[ \widehat{G_T} = e^{- i \pi \sigma/4} |\det(T)|^{-1/2} G_{-T^{-1}}, \]
  %
  where $\sigma$ is the \emph{signature} of $T$, i.e. the number of positive eigenvalues, minus the number of negative eigenvalues, counted up to multiplicity. Thus we need to show that for any Schwartz $\phi \in \mathcal{S}(\RR^d)$,
  %
  \[ e^{-i \pi \sigma/4} |\det(T)|^{-1/2} \int_{\RR^d} e^{i \pi (T^{-1}\xi \cdot \xi)} \widehat{\phi}(\xi)\; d\xi = \int_{\RR^d} e^{- i \pi (Tx \cdot x)} \phi(x)\; dx. \]
  %
  Let us begin with the case $d = 1$, in which case we also prove the theorem when $T$ is a complex symmetric matrix. If $T$ is given by multiplication by $-iz$, and if $\sqrt{\cdot}$ denotes the branch of the square root defined for all non-negative numbers and positive on the real-axis, then we note that when $z = \lambda i$,
  %
  \[ e^{- i \pi \sigma/4} |\det(T)|^{-1/2} = e^{- i \pi \text{sgn}(\lambda)/4} |\lambda|^{-1/2} = \sqrt{z}. \]
  %
  Thus it suffices to prove the analytic family of identities
  %
  \[ \int_{-\infty}^\infty e^{- (\pi/z) \xi^2} \widehat{\phi}(\xi)\; d\xi = \sqrt{z} \int_{-\infty}^\infty e^{-\pi z x^2} \phi(x)\; dx, \]
  %
  where both sides are well defined and analytic whenever $z$ has positive real part. But we already know from the Fourier transform of the Gaussian that this identity holds whenever $z$ is positive and real, and so the remaining identities follows by analytic continuation. We note that the higher dimensional identity is invariant under changes of coordinates in $SO(n)$. Thus it suffices to prove the remaining theorem when $T$ is diagonal. But then everything tensorizes and reduces to the one dimensional case. More generally, if $T = T_0 - i T_1$ is a complex symmetric matrix, which is well defined if $T_1$ is positive semidefinite, then
  %
  \[ \widehat{G_T} = \frac{1}{\sqrt{i \det(T)}} \cdot G_{-T^{-1}}, \]
  %
  which follows from analytic continuation of the case for real $T$.
\end{example}

Thus we conclude that
%
\[ |\langle \widehat{u}, \phi \rangle| = |\langle u, \widehat{\phi} \rangle| \lesssim \| (1 + |x|)^K \phi \|_{L^\infty(\RR^d)}. \]
%
Thus $\widehat{u}$ is a distribution of order zero, and thus a measure. But $x^\alpha u$ is a compactly supported distribution for all $\alpha$, which implies that $D^\alpha \widehat{u}$ is a distribution of order zero, and thus a measure. 

\begin{example}
    We know $((-2 \pi i x)^\alpha)^\ft = ((- 2 \pi i x)^\alpha \cdot 1)^\ft = D^\alpha \delta$, which essentially provides us a way to compute the Fourier transform of any polynomial, i.e. as a linear combination of dirac deltas and the distribution derivatives of dirac deltas, which are derivatives evaluated at points.
\end{example}

\begin{example}
    Consider the Hilbert kernel $\Lambda = \text{p.v}(1/x)$. We have seen this distribution is tempered, so we can take it's Fourier transform. Now $x \Lambda = 1$, so the dericative of $\widehat{\Lambda}$ is $- 2 \pi i \delta$, where $\delta$ is the Dirac delta function at the origin. But this means there exists $A$ such that $\widehat{\Lambda}(\xi) = A - 2 \pi i \cdot \mathbf{I}(\xi > 0)$. But $\Lambda(-x) = - \Lambda(x)$, implying that $\widehat{\Lambda}(-\xi) = -\widehat{\Lambda}(\xi)$, and thus $A - 2 \pi i = -A$, i.e. $A = i \pi$. Thus
    %
    \[ \widehat{\Lambda}(\xi) = \pi i - 2 \pi i \cdot \mathbf{I}(\xi > 0) = - i \pi \cdot \text{sgn}(\xi). \]
\end{example}

\begin{theorem}
    If $\mu$ is a finite measure, $\widehat{\mu}$ is a uniformly continuous bounded function with $\| \widehat{\mu} \|_{L^\infty(\RR^d)} \leq \| \mu \|$, and
    %
    \[ \widehat{\mu}(\xi) = \int e(- 2 \pi i x \cdot \xi) d\mu(x) \]
    %
    The function $\widehat{\mu}$ is also smooth if $\mu$ has moments of all orders, i.e. $\int |x|^k d\mu(x) < \infty$ for all $k > 0$.
\end{theorem}
\begin{proof}
    Let $\phi \in \mathcal{S}(\RR^d)$. We must understand the integral
    %
    \[ \int_{\RR^d} \widehat{\phi}(x)\; d\mu(x). \]
    %
    Applying Fubini's theorem, which applies since $\mu$ has finite mass, we conclude that
    %
    \[ \int_{\RR^d} \widehat{\phi}(x)\; d\mu(x) = \int_{\RR^d} \int_{\RR^d} \phi(\xi) e^{-2 \pi i \xi \cdot x} d\mu(x)\; d\xi = \int_{\RR^d} \phi(\xi) f(\xi)\; d\xi, \]
    %
    where
    %
    \[ f(\xi) = \int_{\RR^d} e^{-2 \pi i \xi x} d\mu(x). \]
    %
    Thus $\widehat{\mu}$ is precisely $f$, and it suffices to show that $\| f \|_{L^\infty(\RR^d)} \leq \| \mu \|$, and that $f$ is uniformly continuous. The inequality follows from a simple calculation of the triangle inequality, and the second inequality follows because for some $y$,
    %
    \begin{align*}
      |f(\xi + \eta) - f(\xi)| &= \left| \int_{\RR^d} e^{-2 \pi i \xi \cdot x} (e^{-2 \pi i \eta \cdot x} - 1)\; d\mu(x) \right|\\
      &\leq \int_{\RR^d} |e^{-2 \pi i \eta \cdot x} - 1|\; d|\mu|(x).
    \end{align*}
    %
    As $\eta \to 0$, the dominated convergence theorem implies that this quantity tends to zero, which proves uniform continuity. On the other hand, if $x_i \mu$ is finite for some $i$, then
    %
    \begin{align*}
      \frac{f(\xi + \varepsilon e_i) - f(\xi)}{\varepsilon} &= \int_{\RR^d} e^{-2 \pi i \xi \cdot x} \frac{(e^{- 2 \pi \varepsilon i x_i} - 1)}{\varepsilon} d\mu(x).
    \end{align*}
    %
    We can apply the dominated convergence theorem to show that as $\varepsilon \to 0$, this quantity converges to the classical partial derivative $f_i$, which has the integral formula
    %
    \[ f_i(\xi) = (-2 \pi i) \int_{\RR^d} e^{-2 \pi i \xi \cdot x} x_i d\mu(x), \]
    %
    which is the Fourier transform of $x_i \mu$. Higher derivatives are similar.
\end{proof}

Not being compactly supported, we cannot compute the convolution of tempered distributions with all $C^\infty$ functions. Nonetheless, if $\phi$ is Schwartz, and $\Lambda$ is tempered, then the definition $(\Lambda * \phi)(x) = \Lambda(T_{-x} \phi^*)$ certainly makes sense, and gives a $C^\infty$ function satisfying $D^\alpha(\Lambda * \phi) = (D^\alpha \Lambda) * \phi = \Lambda * (D^\alpha \phi)$ just as for $\phi \in \DD(\RR^d)$. Moreover, $\Lambda * \phi$ is a slowly increasing function; to see this, we know there is $n$ such that
%
\[ |\Lambda \phi| \lesssim \| \phi \|_{\mathcal{S}^{n,m}(\RR^d)}. \]
%
Now for $|y| \geq 1$,
%
\[ \| T_y \phi \|_{\mathcal{S}^{n,m}(\RR^d)} \leq |x-y|^n \leq 2^n (1 + |y|^n) \| \phi \|_{\mathcal{S}^{n,m}(\RR^d)}, \]
%
and so
%
\[ (\Lambda * \phi)(x) = \Lambda(T_{-x} \phi^*) \lesssim_n (1 + |x|^n) \| \phi \|_{\mathcal{S}^{n,m}(\RR^d)}, \]
%
which gives that $\Lambda * \phi$ is slowly increasing. In particular, we can take the Fourier transform of $\Lambda * \phi$. Now for any $\psi \in \mathcal{S}(\RR^d)$ with $\widehat{\psi} \in \DD(\RR^d)$,
%
\begin{align*}
  \int_{\RR^d} \widehat{\Lambda * \phi}(\xi) \psi(\xi)\; d\xi &= \int_{\RR^d} (\Lambda * \phi)(x) \widehat{\psi}(x)\; dx\\
  &= \int_{\RR^d} \Lambda( \widehat{\psi}(x) \cdot T_{-x} \phi^*)\; dx\\
  &= \Lambda \left( \int_{\RR^d} \widehat{\psi}(x) T_{-x} \phi^*\; dx \right)\\
  &= \Lambda \left( \widehat{\psi} * \phi^* \right) = \Lambda \left( \widehat{\psi} * \widehat{\widehat{\phi}} \right)\\
  &= \Lambda \left( \widehat{\psi \widehat{\phi}} \right) = \widehat{\Lambda} \left( \psi \widehat{\phi} \right) = \widehat{\phi} \widehat{\Lambda}(\psi).
\end{align*}
%
We therefore conclude that $\widehat{\Lambda * \phi} = \widehat{\phi} \widehat{\Lambda}$.

Because of the dilation symmetry of the Fourier transform, the family of homogeneous distributions (which are all tempered) is invariant under the Fourier transform. More precisely, the Fourier transform of a distribution on $\RR^d$ which is homogeneous of degree $\sigma$ is a homogeneous distribution of degree $-d - \sigma$.

\begin{lemma}
    If $u$ is homogeneous and in $C^\infty(\RR^d - \{ 0 \})$, then so is $\widehat{u}$.
\end{lemma}
\begin{proof}
    Suppose first that $u$ is homogeneous of order $a$, with $\text{Re}(a) < -n$. Then we can write $u = u_0 + u_1$, where $u_0$ is supported near the origin, and $u_1$ is an integrable function. But the Fourier transform of both of these terms is continuous. Thus $\widehat{u}$ is continuous.

    To upgrade this fact, given any homogeneous function $u$ in $C^\infty(\RR^d - \{ 0 \})$, if $\alpha$ is suitably large, then $D^\alpha u$ is homogeneous of degree less than $-n$ and in $C^\infty(\RR^d - \{ 0 \})$, and so $\widehat{D^\alpha u} = \xi^\alpha \widehat{u}$ is continuous. But this means tht $|\xi|^\alpha \widehat{u}$ is continuous, which means $\widehat{u}$ is continuous. But since $x^\beta u$ is homogeneous if $u$ is homogeneous, we conclude that $\widehat{x^\beta u} = D^\beta \widehat{u}$ is continuous for all $\beta$, so that $\widehat{u}$ lies in $C^\infty(\RR^d - \{ 0 \})$.
\end{proof}



\section{Test Functions on a Manifold}

For a general smooth manifold $M$, it is unnatural to define the space of test functions $\mathcal{D}(M)$ to be $C_c^\infty(M)$. This is because there is no natural inclusion map from $C^\infty(M)$ to this dual, given that there is no natural definition of integration on a manifold $M$. Thus one cannot naturally think of the dual of $C_c^\infty(M)$ as being a space of `generalized functions' on $M$.

We remedy this, we work with \emph{scalar densities} rather than scalar-valued functions. Recall that on any manifold $M$, we can define a line bundle $\text{Vol}(TM)$, and scalar densities are sections of this line bundle. In coordinates, a scalar density corresponds to a family of functions $\omega_x \in C^\infty(U)$ for each coordinate chart $(x,U)$, such that for any other coordinate chart $(y,V)$, on $U \cap V$,
%
\[ \omega_y = \omega_x \cdot \left| \det \left( \frac{\partial y^i}{\partial x^j} \right) \right|. \]
%
We define $\mathcal{D}(M)$ to be the space of all compactly supported smooth scalar densities, which we can equip with a natural locally convex structure analogous to the topology on the space of test functions in Euclidean space. Given any $f \in C^\infty(M)$, and any $\omega \in \mathcal{D}(M)$, the quantity
%
\[ \langle f, \omega \rangle = \int_M f \cdot \omega \]
%
is well defined, where the integral on the right is defined by working in local coordinates. Moreover, the map $\omega \mapsto \langle f, \omega \rangle$ is then a continuous linear functional on $\mathcal{D}(M)$. Thus we have a continuous inclusion $C^\infty(M) \to \mathcal{D}(M)^*$, which means it makes sense to define $\mathcal{D}(M)^*$ be the space of generalized functions on $M$.

\begin{remark} 
    If it helps to think more generally, given a smooth line bundle $E$ over $M$, we define $\mathcal{D}(M,E)$ to be the space of all smooth, compactly supported sections of $E^*$, the \emph{dual} line bundle to $E$. Then the space $\Gamma(E)$ of all smooth sections of $E$ is naturally included in $\mathcal{D}(M,E)^*$, which we call the space of \emph{generalized sections} of $E$.

    As an example of this approach, we can consider the line bundle $\text{Vol}^\alpha(TM)$ for each $0 \leq \alpha \leq 1$, whose sections $\omega$ consist of \emph{scalar densities of order $\alpha$}, which transform in coordinates via the relation
    %
    \[ \omega_y = \omega_x \cdot \left| \det \left( \frac{\partial y^i}{\partial x^j} \right) \right|^\alpha. \]
    %
    Thus $\text{Vol}(TM) = \text{Vol}^1(TM)$, and $TM = \text{Vol}^0(TM)$. The dual bundle to $\text{Vol}^\alpha(TM)$ can naturally be identified with $\text{Vol}^{1-\alpha}(TM)$ since if $\omega$ is a scalar density of order $\alpha$, and $\eta$ is a scalar density of order $1 - \alpha$, then $\omega \eta$ is a scalar density of order one, and thus can be integrated on $M$ in an invariant manner. Thus we can define the space $\mathcal{D}^\alpha(M)^*$ of generalized scalar densities of order $\alpha$ to be the dual to the space of compactly supported scalar densities of order $1 - \alpha$.
\end{remark}

Much of the basic theory of distributions follows for distributions on manifolds. In particular, a version of the Schwartz kernel theorem holds, i.e. for any smooth manifolds $M$ and $N$, and any continuous linear operator $T: C_c^\infty(M) \to \mathcal{D}(N)^*$, there exists a generalized section $K$ of $\text{Vol}(M) \oplus TN$ such that for any smooth, compactly supported function $f$ on $M$, we formally have
%
\[ Tf(x) = \int K(x,y) f(y)\; dy, \]
%
in the sense that for any smooth, compactly supported scalar density $\omega$ on $N$,
%
\[ \langle Tf, \omega \rangle = \int \omega(x) K(x,y) f(y)\; dx\; dy. \]
%
The idea of the proof is to work locally in coordinates, applying the Schwartz kernel theorem in Euclidean space, and then noting that the kernels patch together if we viwe them as sections of $\text{Vol}(M) \oplus TN$.

It is more difficult to see how one would build a canonical definition of the space $\mathcal{S}^*(M)$ of tempered distributions on a manifold $M$, because there is no natural direction to measure the rate of decay of a function. Thus it is often wiser to do the things one does in Schwartz space (e.g. Fourier-type arguments) by working locally in coordinates, or on a compact manifold, where $C^\infty(M)$ should coincide with $\mathcal{S}(M)$.

\section{Paley-Wiener Theorem}

TODO: See Rudin, Functional Analysis.

\begin{theorem}
    Let $f$ be an entire function on $\mathbf{C}^n$. Then there exists a compactly supported distribution $u$ on $\RR^n$ such that for all $z \in \CC^n$,
    %
    \[ f(z) = \int u(x) e^{-2 \pi i z \cdot x}\; dx, \]
    %
    if and only if there exists $n > 0$ and $B > 0$ such that
    %
    \[ |f(x + i y)| \lesssim (1 + |z|)^n e^{B|y|}. \]
    %
    In this case, the distribution $u$ will be supported on the closed ball of radius $B$ centered at the origin.
\end{theorem}







\chapter{Spectral Analysis of Singularities}

Suppose $u$ is a distribution on $\RR^d$. The \emph{singular support} of $u$ is the set of points $x_0 \in \RR^d$ which \emph{do not} have an open neighbourhood upon which $u$ acts as integration against a $C^\infty$ function. Understanding the singular support of a distribution, and how to control it, is often a useful perspective in harmonic analysis; to reduce the study of $u$ to the study of a $C^\infty$ function one need only smoothen around the singular support of $u$.

The smoothess of a distribution is linked to the decay of it's Fourier transform. In particular, suppose there is a compactly supported bump function $\phi \in C^\infty(\RR^d)$ with $\phi(x) = 1$ in a neighbourhood of some point $x_0 \in \RR^d$. Since $\phi u$ is compactly supported, the Paley-Wiener theorem implies $\widehat{\phi u}$ is an entire function with polynomial growth at infinity. The Fourier inversion formula implies that $\phi u \in \DD(\RR^d)$ if and only if for all $N \geq 0$, $|\widehat{\phi u}(\xi)| \lesssim_N |\xi|^{-N}$. Thus we can infer the singular support of $u$ via purely spectral means, provided we localize about a point.

We can therefore gain more detailed information about singularities of a distribution $u$ through the Fourier transform. If $x_0$ is a singularity of $u$, then for any bump function $\phi \in C^\infty(\RR^d)$ with $\phi(x) = 1$ in a neighbourhood of $x_0$, there must exist some direction in frequency space on which $\widehat{\phi u}$ does not decay. However, this does not mean that $\phi$ is unable to decay in certain directions; there might exist a conical neighbourhood $U$ about the origin containing some frequency $\xi_0$ such that for all $\xi \in U$ and all $N > 0$,
%
\begin{equation} \label{nonsingularfourierdecay}
  |\widehat{u \phi}(\xi)| \lesssim_N |\xi|^{-N}.
\end{equation}
%
the set of values $\xi_0$ which do \emph{not} satisfy \eqref{nonsingularfourierdecay} for any choice of bump function $\phi$ about $x_0$ forms a closed conical subset of $\RR^d$, and we call this the \emph{wavefront} of $u$ about the singularity $x_0$. The set
%
\[ \text{WF}(u) = \{ (x_0,\xi_0) : \xi_0\ \text{is in the wavefront of $u$ at $x_0$} \} \]
%
is the \emph{wavefront set} of the distribution, and provides a deeper characterization of the singularities of $u$. For instance, in order to smoothen out a distribution $u$ one need only average along the directions in the wave-front set.

Let us now discuss the wavefront set a little more precisely. If $u$ is a compactly supported distribution on $\RR^d$, we define $\Gamma(u)$ to be the set of $\xi_0 \in \RR^d$ which have no conical neighbourhood $U$ such that for each $N > 0$ and $\xi \in U$,
%
\begin{equation} \label{fastDecayEquation}
    |\widehat{u}(\xi)| \lesssim_N |\xi|^{-N}.
\end{equation}
%
It is simple to verify via a compactness argument that if $\Gamma(u) = \emptyset$, then $u \in C^\infty(\RR^d)$.

\begin{lemma} \label{wavefrontlocalizationlemma}
  If $u$ is a compactly supported distribution and $\phi \in \DD(\RR^d)$, then
  %
  \[ \Gamma(\phi u) \subset \Gamma(u). \]
\end{lemma}
\begin{proof}
  Suppose $\xi_0 \not \in \Gamma(u)$, so $\xi_0$ has a conical neighbourhood $U$ such that \eqref{fastDecayEquation} holds. Then there exists $\varepsilon > 0$ such that $U$ contains
  %
  \[ \left\{ \eta \in \RR^d : \frac{\xi_0 \cdot \eta}{|\xi_0| |\eta|} \geq 1 - 2\varepsilon \right\} \]
  %
  Let $V$ be the conical neighbourhood of $\xi_0$ defined by setting
  %
  \[ V = \left\{ \eta \in \RR^d : \frac{\xi_0 \cdot \eta}{|\xi_0| |\eta|} \geq 1 - \varepsilon \right\}. \]
  %
  We claim $V$ satisfies \eqref{fastDecayEquation}. Fix $\xi \in V$. Then
  %
  \[ |\widehat{\phi u}(\xi)| = (\widehat{\phi} * \widehat{u})(\xi) = \int_{\RR^d} \widehat{\phi}(\eta) \widehat{u}(\xi - \eta)\; d\xi. \]
  %
  If $|\xi - \eta| \leq 0.25 \varepsilon |\xi|$, then it is simple to verify that
  %
  \[ (\xi_0 \cdot \eta) \geq (1 - 2\varepsilon) |\xi_0| |\eta| \]
  %
  so $\eta \in U$. Thus for any $N > 0$, $\widehat{u}(\eta) \lesssim_N 1/(1 + |\eta|)^N$. Since $\phi \in L^\infty(\RR^d$, we conclude
  %
  \begin{align*}
    \int_{|\eta| \leq 0.25 \varepsilon |\xi|} \widehat{\phi}(\eta) \widehat{u}(\xi - \eta)\; d\xi &\lesssim_{\phi} \int_{|\eta| \leq 0.25 \varepsilon |\xi|} \frac{1}{1 + |\xi - \eta|^N}\\
    &\lesssim_{\varepsilon,d} \frac{|\xi|^d}{(1 + 2 |\xi|^{N})} \lesssim \frac{1}{1 + |\xi|^{N-d}}.
  \end{align*}
  %
  On the other hand, since $u$ is compactly supported, $\widehat{u}$ is slowly increasing, i.e. there exists $m > 0$ such that
  %
  \[ |\widehat{u}(\xi)| \leq 1 + |\xi|^m. \]
  %
  Since $\phi \in \DD(\RR^d)$, we have $|\widehat{\phi}(\eta)| \lesssim_M 1/(1 + |\eta|^M)$ for all $M > 0$ and thus we conclude that if $M > m + d$
  %
  \begin{align*}
    \int_{|\eta| \geq 0.25 \varepsilon |\xi|} \widehat{\phi}(\eta) \widehat{u}(\xi - \eta) &\lesssim_M \int_{|\eta| \geq 0.25 \varepsilon |\xi|} \frac{1 + |\xi - \eta|^m}{1 + |\eta|^M}\\
    &\lesssim_{\varepsilon,m} \int_{|\eta| \geq 0.25 \varepsilon |\xi|} \frac{1 + |\eta|^m}{1 + |\eta|^M}\\
    &\lesssim_{\varepsilon,d} \frac{1}{1 + |\xi|^{M-m-d}}.
  \end{align*}
  %
  Choosing the parameter $M$ and $N$ appropriately, we obtain the required bound which shows that $\xi_0 \not \in \Gamma(\phi u)$.
\end{proof}

This fact means that for each distribution $u$, and any pair of distributions $\phi_1,\phi_2 \in \DD(\RR^d)$ such that $\text{supp}(\phi_2)$ is contained in the interior of the support of $\phi_1$, then $\phi_2/\phi_1 \in \DD(\RR^d)$, and so we conclude that
%
\[ \Gamma(\phi_2 u) = \Gamma((\phi_2/\phi_1) \phi_1 u) \subset \Gamma(\phi_1 u). \]
%
Thus if $u$ is a distribution, and $x \in \RR^d$, then we define $\Gamma_x(U)$ to be equal to
%
\[ \bigcap \left\{ \Gamma(\phi u) : \phi \in \DD(\RR^d), x \in \text{supp}(\phi) \right\}. \]
%
If $\{ \phi_n \}$ is a sequence in $\DD(\RR^d)$ such that $\text{supp}(\phi_{n+1})$ is compactly supported in $\text{supp}(\phi_n)$ for each $n$, and if $\bigcap \text{supp}(\phi_n) = \{ x \}$, then $\Gamma_x(u) = \lim_{n \to \infty} \Gamma(\phi_n u)$. Finally, we define
%
\[ \text{WF}(u) = \{ (x,\xi): \xi \in \Gamma_x(u) \}. \]
%
This is the \emph{wavefront set} of $u$.

%\begin{remark}
%    The theory of wavefront sets can also be defined via a sheaf theoretic framework. The distributions on a manifold form a sheaf $\DD^*$, since one can restrict and glue distributions defined on open subsets of a manifold. Similarily, the smooth functions on a manifold form a sheaf $C^\infty$, which is a subsheaf of $\DD^*$. Thus we can consider the quotient sheaf $\mathcal{F} = \DD^* / C^\infty$.
%\end{remark}

\begin{lemma}
    If $u$ is a distribution, then $\pi_x(\text{WF}(u))$ is the singular support of $u$. If $u$ is compactly supported, then $\pi_\xi(\text{WF}(u)) = \Gamma(u)$.
\end{lemma}
\begin{proof}
    Fix $x_0 \in \RR^d$. If $(x_0,\xi_0) \not \in \text{WF}(u)$ for all $\xi_0 \in \RR^d$, then there exists $\phi \in \DD(\RR^d)$ such that $\phi(x_0) \neq 0$ and $\Gamma(\phi u) = \emptyset$. But this means $\phi u \in \DD(\RR^d)$, so $x_0$ is not in the singular support of $u$. This shows $\pi_x(\text{WF}(u))$ is a subset of the singular support. The converse is obvious.

    On the other hand, let us assume $u$ is compactly supported, and that $\xi_0 \not \in \Gamma(u)$. Then $(x_0,\xi_0) \not \in \text{WF}(u)$ for any $x_0 \in \RR^d$ since $\Gamma(\phi u) \subset \Gamma(u)$ for any $\phi \in \DD(\RR^d)$. But if $(x_0.\xi_0) \not \in \text{WF}(u)$ for any $x_0 \in \RR^d$ we can cover the support of $u$ by a partition of unity $\phi_1,\dots,\phi_N \in \DD(\RR^d)$ such that $\xi_0 \not \in \Gamma(\phi_i u)$ for each $i$, and summing up shows $\xi_0 \not \in \Gamma(u)$.
\end{proof}

\begin{example}
  Suppose $u$ is a homogenous distribution which is $C^\infty$ away from the origin. Then $\widehat{u}$ is homogenous and $C^\infty$ away from the origin, and we claim that
  %
  \[ \text{WF}(u) = \{ (0,\xi): \xi \in \text{supp}(\widehat{u}) \} = \{ 0 \} \times \Gamma(u). \]
  %
  Since the singular support of $u$ is $\{ 0 \}$, we know $\text{WF}(u) \subset \{ 0 \} \times \RR^d$, and so it suffices to calculate $\Gamma_0(u)$. Fix a non-negative radial function $\phi \in \DD(\RR^d)$ such that $\widehat{\phi}$ is a non-negative Schwartz function with total mass one. Let $\phi_t(x) = \phi(tx)$, let $\psi(\xi) = \widehat{\phi}(\xi)$, and let $\psi_t(\xi) = \widehat{\phi_t}(\xi) = t^{-d} \psi(\xi/t)$. Set $u_t = \psi_t u$. Then
  %
  \[ \Gamma_0(u) = \lim_{t \to \infty} \Gamma(u_t). \]
  %
  If $v$ is the homogeneous distribution given by the Fourier transform of $u$, and $v_t$ is the Fourier transform of $u_t$, then
  %
  \[ v_t = \widehat{\phi_t u} = \psi_t * v. \]
  %
  Since $\phi_t u$ is no longer homogeneous, neither are the distributions $\{ v_t \}$. But they do satisfy the homogeneity relations
  %
  \[ v_t(\xi) = (t/r)^s \text{Dil}_{t/r} v_r \]
  %
  for any $t,r > 0$. In particular, we see from this that $\Gamma(u_t) = \Gamma(u_r)$ for all $t,r > 0$. Thus $\Gamma_0(u) = \Gamma(u_t)$ for any $t > 0$. If $v$ vanishes in a neighborhood of $\xi_0$, then it vanishes in a conical neighborhood of $\xi_0$. It thus follows that $v_t$ vanishes in a conical neighborhood of $\xi_0$ if we pick $t$ to be sufficiently small, and thus $\xi_0 \not \in \Gamma(u_t) = \Gamma_0(u)$. Conversely, if $\xi_0 \not \in \Gamma_0(u)$, then for all $t > 0$, there is an open cone $U_t \subset \RR^d$ containing $\xi_0$ such that $|v_t(\eta)| \lesssim_{t,N} |\eta|^{-N}$ for all $\eta \in U_t$. The homogeneity relation above implies that we actually have
  %
  \[ |v_t(\eta)| \lesssim_N t^{N + |s|} |\eta|^{-N}. \]
  %
  for all $\eta \in U_1$. As $t \to 0$, $|v_t(\eta)| \to |v(\eta)|$, and if $N$ is taken larger than $|s|$ in the inequality above, this implies that
  %
  \[ |v(\eta)| \lesssim_N \limsup_{t \to 0} t^{N + |s|} |\eta|^{-N} = 0. \]
  %
  Thus $v(\eta) = 0$ for all $\eta \in U_1$, so in particular, $\xi_0 \not \in \text{supp}(v)$.

  Here are some special cases of the above example:
  %
  \begin{itemize}
    \item If $\delta$ is the Dirac delta distribution at the origin in $\RR^d$, then $\widehat{\delta}$ is the constant function, and so
    %
    \[ \text{WF}(\delta) = \{ 0 \} \times \RR^d. \]

    \item If $u(x) = \text{p.v}(1/x)$, then $\widehat{u}(\xi) = -i \pi \text{sgn}(\xi)$, and so
    %
    \[ \text{WF}(u) = \{ 0 \} \times \RR. \]

    \item If $H \subset \RR^d$ is a plane, and $\sigma_H$ is the distribution given by integration against the surface measure on $H$, then $\sigma_H$ is homogeneous, and we claim that $\widehat{\sigma}_H = \sigma_{H^\perp}$, from which the argument above implies that
    %
    \[ \Gamma_0(\sigma_H) = H^\perp. \]
    %
    Since $\sigma_H$ is invariant under translation by elements of $H$, it follows that for any $x \in H$, $\Gamma_x(\sigma_H) = H^\perp$. But $\sigma_H$ is $C^\infty$ away from $H$, so
    %
    \[ \text{WF}(u) = H \times H^\perp. \]
  \end{itemize}
\end{example}

The fact that $(x_0,\xi_0) \not \in \text{WF}(u)$ implies precisely that there exists a neighbourhood $U_0$ of $x_0$ such that for any $\phi \in C_c^\infty(U_0)$, and any $N > 0$,
%
\[ \int_{\RR^d} u(x) \phi(x) e^{-2 \pi i \lambda \xi \cdot x}\; dx \lesssim_N \langle \xi \rangle^{-N}. \]
%
It will be useful to consider a nonlinear analogue of this statement, which will be useful for showing the invariance of the wavefront set under changes of variables.

\begin{theorem}
    Let $u$ be a distribution, and let $(x_0,\xi_0) \not \in \text{WF}(u)$. Let $U$ be an open subset of $\RR^d$ containing $x_0$, let $V$ be an open subset of $\RR^p$ containing $a_0$, and let $\psi: U \times V \to \RR$ be a $C^\infty$ function with $\nabla_x \psi(x_0,a_0) = \xi_0$. Then there is an open set $U_0$ of $x_0$, an open set $V_0$ of $a_0$ such that for any $\phi \in C_c^\infty(U_0)$, and any $N > 0$,
    %
    \[ \left| \int u(x) \phi(x) e^{-2 \pi i \lambda \psi(x,a)}\; dx \right| \lesssim_N \lambda^{-N} \]
    %
    where the bound is uniform on $V_0$.
\end{theorem}
\begin{proof}
    Fix $\varepsilon > 0$, to be chosen later, and choose $U_0$ and $V_0$ such that $|\nabla_x \psi(x,a) - \xi_0| \leq \varepsilon/2$ for $x \in U_0$ and $a \in V_0$. For any given $\phi \in C_c^\infty(U_0)$, consider $\tilde{\phi} \in C_c^\infty(U_0)$ with $\tilde{\phi} \phi = \phi$. Then
    %
    \begin{align*}
        \int u(x) \phi(x) e^{-2 \pi i \lambda \psi(x,a)}\; dx &= \int u(x) \phi(x) \phi_1(x) e^{-2 \pi i \lambda \psi(x,a)}\; dx\\
        &= \int \widehat{u \phi}(\xi) \left( \int \phi_1(x) e^{-2 \pi i (\lambda \psi(x,a) - \xi)}\; dx \right)\; d\xi\\
        &= \lambda^d \int \widehat{u \phi}(\xi) \left( \int \phi_1(x) e^{-2 \pi \lambda i(\psi(x,a) - \xi)}\; dx \right)\; d\xi\\
        &= \lambda^d \int \widehat{u \phi}(\lambda \xi) J(\lambda,\xi,a)\; d\xi.
    \end{align*}
    %
    Let $\eta \in \DD(\RR^d)$ be a smooth bump function supported on $|\xi| \leq 1$ and with $\eta(\xi) = 1$ for $|\xi| \leq 1/2$. Fix $\varepsilon > 0$, and write $J(\lambda,\xi,a) = J_1(\lambda,\xi,a) + J_2(\lambda,\xi,a)$, where
    %
    \[ J_1(\lambda,\xi,a) = \eta \left( \frac{\xi - \xi_0}{\varepsilon} \right) \int_{\RR^d} \phi_1(x) e^{-2 \pi \lambda i(\psi(x,a) - \xi)}\; dx \]
    %
    and
    %
    \[ J_2(\lambda,\xi,a) = \left(1 - \eta \left( \frac{\xi - \xi_0}{\varepsilon} \right) \right) \int_{\RR^d} \phi_1(x) e^{-2 \pi \lambda i (\psi(x,a) - \xi)}\; dx. \]
    %
    If $\varepsilon$ is chosen appropriately small, then $|\widehat{u \phi}(\lambda \xi)| \lesssim_N \lambda^{-N}$ uniformly for $|\xi - \xi_0| \leq \varepsilon$. Since $|J_1(\lambda,\xi,a)| \lesssim 1$, this implies
    %
    \[ \left| \int \widehat{u \phi}(\lambda \xi) J_1(\lambda,\xi,a) \right|\; d\xi \lesssim_N \lambda^{-N}. \]
    %
    On the other hand, if $|\xi - \xi_0| \geq \varepsilon$, then $|\nabla_x \phi(x,a) - \xi| = |\xi_0 - \xi| - \varepsilon/2 \geq \varepsilon/2$. Thus the method of stationary phase implies that
    %
    \[ |J_2(\lambda,\xi,a)| \lesssim_N \lambda^{-N}, \]
    %
    uniformly in $a$. Combined with the fact that $\widehat{u \phi}$ is of polynomial growth, this implies that
    %
    \[ \left| \int \widehat{u \phi}(\lambda \xi) J_1(\lambda,\xi,a)\; d\xi \right| \lesssim_N \lambda^{-N}. \]
    %
    Combining these two estimates completes the proof.
\end{proof}

For a smooth function $\phi \in C_c^\infty(V)$ and a smooth diffeomorphism $f: U \to V$, we can define $f^* \phi \in C_c^\infty(U)$ by setting $f^* \phi(x) = \phi(f(x))$. Then for $\psi \in C_c^\infty(V)$,
%
\[ \int f^* \phi(x) \psi(x) = \int \phi(f(x)) \psi(x) = \int \phi(y) \psi(f^{-1}(y)) \cdot \frac{1}{|f'(f^{-1}(y))|} \; dy. \]
%
Thus for a distribution $u$ on $V$, to define a distribution $f^* u$ on $U$ such that for $\psi \in \DD(\RR^d)$,
%
\[ \int (f^* u)(x) \psi(x) = \int u(y) \phi(f^{-1}(y)) \cdot \frac{1}{|f'(f^{-1}(y))|}\; dy. \]
%
There is a simple relation between the wavefront set of $u$ and $f^* u$. We consider $f^*: V \times \RR^d \to U \times \RR^d$ by defining $f^*((y,v)) = (f^{-1}(y), f'(y)^T v)$. This agrees with the definition of $f^*$ encountered in differential geometry if we identify $V \times \RR^d$ and $U \times \RR^d$ with the cotangent bundle $T^* V$ and $T^* U$.

\begin{theorem}
    For any distribution $u$ on $V$, $\text{WF}(f^* u) = f^*(\text{WF}(U))$.
\end{theorem}
\begin{proof}
    Assume $(y_0,\eta_0) \not \in \text{WF}(u)$, let $(x_0,\xi_0) = f^*((y_0,\eta_0))$, and then define $\psi(y,\xi) = f^{-1}(y) \cdot \xi$. Then
    %
    \[ \nabla_y \psi(y_0,\xi_0) = (f^{-1}(y_0)')^T(\xi_0) = \eta_0. \]
    %
    Thus, applying the previous theorem, since
    %
    \[ \widehat{f^*(u \phi)}(\lambda \xi) = \int u(y) \frac{\phi(f^{-1}(y))}{|f'(f^{-1}(y))|} e^{-2 \pi i \lambda \xi \cdot f^{-1}(y)} = \int u(y) \tilde{\phi}(y) e^{-2 \pi i \lambda \psi(y,\xi)}\; dy, \]
    %
    we conclude that $|\widehat{f^*(u \phi)}(\lambda \xi) \lesssim_N \lambda^{-N}$, which implies $(x_0,\xi_0) \in \text{WF}(f^*(u))$. Thus $\text{WF}(f^* u) \subset f^*(\text{WF}(u))$. The converse statement that $f^*(\text{WF}(u)) \subset \text{WF}(f^* u)$ is obtained by symmetry.
\end{proof}

Using this change of variables formula, we see that the wavefront set transforms under a change of coordinates like a covector. Since this gives an invariant definition, we can define the wavefront set of distributions on any smooth manifold $M$, and the wavefront set will then be a closed, conical subset of $T^* M$.

\section{Oscillatory Integral Distributions}

In this section, we consider distributions on an open subset $U$ of $\RR^d$, formally defined by the formula
%
\[ I_{a,\phi}(x) = \int a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta. \]
%
Here $a$ is a \emph{symbol} lying in some class $\mathcal{S}^t(U \times \RR^p)$, i.e. a smooth function satisfying bounds of the form
%
\[ |\nabla_x^n \nabla_\theta^m a(x,\theta)| \lesssim_{n,m} \langle \theta \rangle^{t - m}, \]
%
and $\phi \in C^\infty(U \times (\RR^p - \{ 0 \}))$ is homogeneous of degree one in $\theta$, and $d\phi$ is nonvanishing on the support of $a$.

If $t < -d$, then the integrand formally defining $I_{a,\phi}$ is absolutely integrable, and interpreting $I_{a,\phi}$ as a Lebesgue integral gives us a locally integrable function $I_{a,\phi}$. But for $t \geq -d$, the integral defining $I_{a,\phi}$ need not be locally integrable; for instance, our definition will show that the distribution
%
\[ \int_{\RR^d} \xi^t e^{2 \pi i x \cdot \xi}\; d\xi \]
%
acts on functions as a constant multiple of the differential operator $D^t$.

To define the oscillatory integral distribution rigorously, we fix $\psi \in \DD(\RR^d)$, and $\rho \in \DD(\RR^p)$, equal to one in a neighborhood of the origin. The integral
%
\[ \int a(x,\theta) \psi(x) \rho(\theta / R) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
%
is then well defined, and we claim that the limit
%
\[ \lim_{R \to \infty} \int a(x,\theta) \psi(x) \rho(\theta / R) e^{2 \pi i \phi(x,\theta)}\; d\theta \]
%
exists and is independent of the choice of $\rho$. We can then define this limit to be
%
\[ \int I_{a,\phi}(x) \psi(x)\; dx \]
%
and this defines $I_{a,\phi}$ as a distribution. To prove the limit exists, we fix $R_1 \leq R_2$, and let $\tilde{\rho}(\theta) = \rho(\theta/R_2) - \rho(\theta/R_1)$. Then $\tilde{\rho}$ is supported on $R_1 \lesssim |x| \lesssim R_2$. Assume first that $R_2 \leq 2R_1$. Rescaling, we find that if $\eta(x,\theta) = a(x,R_2 \theta) \psi(x) \rho(\theta)$, then
%
\begin{align*}
    \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \psi(x) \tilde{\rho}(\theta) &= R_2^m \int_{\RR^n} \int_{\RR^p} e^{2 \pi i R_2 \phi(x,\theta)} a(x,R_2 \theta) \psi(x) \tilde{\rho}(\theta)\\
    &= R_2^p \int_{\RR^n} \int_{\RR^p} e^{2 \pi i R_2 \phi(x,\theta)} \eta(x,\theta).
\end{align*}
%
Then $\eta$ is supported on $1/2 \lesssim |\theta| \lesssim 1$ and $|x| \lesssim 1$. Thus the support of $\eta$ is independant of $R_1$ and $R_2$. It is simple to verify that
%
\[ |\nabla^n_x \nabla^m_\theta \eta(x,\theta)| \lesssim_{n,m} R_2^t \cdot |\nabla^n_x \psi(x)|, \]
%
where the bound is independant of $R_1$ and $R_2$. Since $\nabla_x \phi$ and $\nabla_\theta \phi$ have no common zeroes on the support of $a$, we can apply the principle of stationary phase to conclude that
%
\[ \left| R_2^p \int_{\RR^n} \int_{\RR^p} e^{2 \pi i R_2 \phi(x,\theta)} \eta(x,\theta) \right| \lesssim_N R_2^{p + m - N} \cdot \| \nabla^{\leq N} \psi \|_{L^\infty(\RR^d)}. \]
%
In general, if $R_2 \geq 2R_1$, we consider the largest $l$ such that $2^l R_1 \leq R_2$. If we set $a_k = 2^k R_1$ for $0 \leq k \leq l$, and $a_{l+1} = R_2$, then we write
%
\begin{align*}
    &\left| \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \phi(x) \tilde{\rho}(\theta) \right|\\
    &\quad\quad= \left| \sum_{k = 0}^l \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \phi(x) (\rho(\theta/a_{k+1}) - \rho(\theta / a_k)) \right|\\
    &\quad\quad\lesssim \sum_{k = 0}^l a_{k+1}^{p + m - N} \| \nabla^{\leq N} \psi \|_{L^\infty(\RR^d)}. 
\end{align*}
%
If we choose $N > p + m$, then we conclude that
%
\begin{align*}
    \left| \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \phi(x) \tilde{\rho}(\theta) \right| &\lesssim (R_1^{p + m - N} + R_2^{p + m - N}) \| \nabla^{\leq N}_x \psi \|_{L^\infty(\RR^d)}\\
    &\lesssim R_1^{p + t - N} \| \nabla^{\leq N} \psi \|_{L^\infty(\RR^d)}.
\end{align*}
%
In particular, this quantity tends to zero as $R_1 \to \infty$, which gives convergence of the limit, and also gives boundedness, showing $I_{a,\phi}$ is a distribution of order $\leq N$, where $N$ is the smallest integer bigger than $p + m$. A very similar argument shows that if $\rho \in C_c^\infty(\RR^p)$ is equal to zero in a neighborhood of the origin, then
%
\[ \lim_{R \to \infty} \int_{\RR^n} \int_{\RR^p} e^{2 \pi i \phi(x,\theta)} a(x,\theta) \psi(x) \rho(\theta / R)\; dx = 0. \]
%
It follows from the above observation that the definition is independent of the original choice of $\rho$. It is left as an exercise to show that the map $a \mapsto I_{a,\phi}$ is continuous from $S^t(U \times \RR^p)$ to $\DD^*(U)$.

\begin{remark}
    If $M$ is a manifold, and $E$ is a vector bundle over $M$, then for any homogeneous phase $\phi \in C^\infty(E - \{ 0 \})$ and any symbol $a \in \mathcal{S}^t(E^*)$, we can consider the oscillatory integral distribution formally defined by the integral
    %
    \[ I_{a,\phi}(x) = \int_{E_x} a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta, \]
    %
    which is a distribution on $M$.
\end{remark}

Let us now consider the wavefront set of $I_{a,\phi}$. If $\psi$ is a bump function supported in a neighbourhood of some point $x_0$, then rescaling gives
%
\[ \widehat{I_{a,\phi} \psi}(\lambda \xi_0) = \lambda^d \int \int e^{2 \pi i \lambda (\phi(x,\theta) - x \cdot \xi_0)} a(x,\lambda \theta) \psi(x)\; dx\; d\theta. \]
%
This is an oscillatory integral, and the phase is non-stationary in the $x$ and $\theta$ variables provided that the support of $\psi$ is small enough, and $\nabla_\theta \phi(x_0,\theta_0) \neq 0$, or if $\nabla_\theta \phi(x_0,\theta_0) = 0$, but $\nabla_x \phi(x_0,\theta_0) \neq \xi_0$, provided that $\psi$ is supported on a small enough neighborhood of $x_0$. Thus we are lead to conclude that
%
\[ \text{WF}(I_{a,\phi}) \subset \{ (x_0,\nabla_x \phi(x_0,\theta_0)): (x_0,\theta_0) \in \text{ess supp}(a)\ \text{and}\ \nabla_\theta \phi(x_0,\theta_0) = 0 \}. \]
%
Here $\text{ess supp}(a)$ is the complement of the set of pairs $(x_0,\theta_0)$ which have a conical neighborhood upon which $a$ lies in $S^{-\infty}$.

\begin{theorem}
    If $a \in \mathcal{S}^t(U \times \RR^p)$, and $\phi \in C^\infty(U \times \RR^p)$ is a phase satisfying the standard conditions to define the oscillatory integral distribution $I_{a,\phi}$, then
    %
    \[ \text{WF}(I_{a,\phi}) \subset \{ (x_0,\nabla_x \phi(x_0,\theta_0)): (x_0,\theta_0) \in \text{ess supp}(a)\ \text{and}\ \nabla_\theta \phi(x_0,\theta_0) = 0 \} \]
\end{theorem}
\begin{proof}
    Fix $(x_0,\xi_0) \in T^* U$, and suppose that for all $(x_0,\theta_0) \in U \times \RR^p$, either $\nabla_\theta \phi(x_0,\theta_0) \neq 0$, $\nabla_x \phi(x_0,\theta_0) \neq \xi_0$, or $(x_0,\theta_0) \not \in \text{ess supp}(a)$. Without loss of generality, we can assume that this third condition never holds, by decomposing $a$ as the sum of a symbol in $\mathcal{S}^{-\infty}$ and a symbol where $a$ vanishes in a neighborhood of any point $(x_0,\theta_0)$ with $\nabla_\theta \phi(x_0,\theta_0) = 0$ and $\nabla_x \phi(x_0,\theta_0) = \xi_0$, and if $a \in \mathcal{S}^{-\infty}$, then $I_{a,\phi} \in C^\infty(U)$. Write
    %
    \[ \widehat{I_{a,\phi} \psi}(\lambda \xi_0) = \lambda^d \int \int e^{2 \pi i \lambda \tilde{\phi}(x,\theta;\xi_0)} \tilde{a}_\lambda(x,\theta)\; dx\; d\theta \]
    %
    where $\tilde{a}_\lambda(x,\theta) = a(x, \lambda \theta) \psi(x)$, and write $\tilde{\phi}(x,\theta;\xi) = \phi(x,\theta) - x \cdot \xi$. If $Z$ is the set of all $\theta \in \RR^p$ with $|\theta| = 1$ such that $\nabla_\theta \phi(x_0,\theta) = 0$, then $Z$ is closed, and thus compact. Since $\nabla_x \phi(x_0,\theta) \neq \xi_0$ for all $\theta \in Z$, it follows by compactness that
    %
    \[ |\nabla_x \phi(x_0,\theta) - t \xi_0| \gtrsim 1 \]
    %
    for all $\theta \in Z$ and all $t > 0$. By homogeneity, for any $\theta \in \RR^p - \{ 0 \}$ such that $\nabla_\theta \phi(x_0,\theta) = 0$,
    %
    \[ |\nabla_x \phi(x_0,\theta) - \xi_0| \gtrsim |\theta|. \]
    %
    By reducing the implicit constant slightly, we may assume that there is $\varepsilon > 0$ such that for any $x \in \RR^d$ and $\xi \in \RR^d$ with $|x - x_0| \leq \varepsilon$ and $|\xi - \xi_0| \leq \varepsilon$, and any $\theta \in \RR^p - \{ 0 \}$ such that $|\nabla_\theta \phi(x_0,\theta)| \leq \varepsilon$, then
    %
    \[ |\nabla_x \phi(x,\theta) - \xi| \gtrsim |\theta|. \]
    %
    Now if $\psi$ has support in a $\varepsilon$ neighborhood of $x_0$, it follows that for all $x \in \text{supp}(\psi)$ and any $\theta \in \RR^p$,
    %
    \[ |\nabla_{x,\theta} \tilde{\phi}(x,\theta,\xi)| \gtrsim 1. \]
    %
    The principle of nonstationary phase thus guarantees that for any $N > 0$,
    %
    \[ |\widehat{I_{a,\phi} \psi}(\lambda \xi_0)| \lesssim_{\phi,N} \lambda^{-N} \sup_{|\alpha| \leq N} \| D^\alpha_{x,\theta} \tilde{a}_\lambda(x,\theta) |\nabla_{x,\theta} \tilde{\phi}(x,\theta;\xi)|^{|\alpha| - 2N} \|_{L^\infty(U \times \RR^p)}. \]
    %
    Now
    %
    \[ |\nabla_{x,\theta} \tilde{\phi}(x,\theta;\xi)| = |\nabla_x \phi(x,\theta) - \xi| \lesssim 1, \]
    %
    and if $D^\alpha_{x,\theta} = D^{\alpha_1}_x D^{\alpha_2}_\theta$, then $D^\alpha_{x,\theta} \tilde{a}_\lambda(x,\theta)$ is a finite sum of $O(\alpha)$ terms, each of the form
    %
    \[ \lambda^{|\alpha_2|} D^{\beta_1}_x D^{\alpha_2}_\theta a(x,\lambda \theta) D^{\beta_2}_x \psi(x), \]
    %
    and
    %
    \[ |\lambda^{|\alpha_2|} D^{\beta_1}_x D^{\alpha_2}_\theta a(x,\lambda \theta) D^{\beta_2}_x \psi(x)| \lesssim_{\beta_1,\beta_2} \lambda^{|\alpha_2|} \langle \lambda \rangle^{t - |\alpha_2|} \lesssim \langle \lambda \rangle^t \]
    Thus we conclude that
    %
    \[ |\widehat{I_{a,\phi} \psi}(\lambda \xi)| \lesssim_{\phi,\psi,N} \langle \lambda \rangle^{t - N}. \]
    %
    Thus $\xi_0 \not \in \text{WF}(I_{a,\phi})$.
\end{proof}

\begin{example}
    If we set $\phi(x,\xi) = - 2 \pi x \cdot \xi$, and $a(x,\xi) = a(\xi)$ is a symbol depending only on the $\xi$ variable, then
    %
    \[ I_{a,\phi}(x) = \int a(\xi) e^{- 2 \pi i x \cdot \xi}\; d\xi \]
    %
    is the Fourier transform of $a$. The result we have just calculated shows that for any symbol $a$,
    %
    \[ \text{WF}(I_{a,\phi}) \subset \{ 0 \} \times \RR^n. \]
    %
    Thus the Fourier transform of any symbol is smooth away from the origin. This result should be compared to the standard result that the Fourier transform of a homogeneous distribution which is $C^\infty$ away from the origin is also homogeneous and $C^\infty$ away from the origin.
\end{example}

Near the wavefront set of an oscillatory integral distribution, we can compute an asymptotic formula which characterizes the behaviour of the distribution near the wavefront set up to integration against a function in $C^\infty(U)$.

\begin{theorem}
    Consider a phase function $\phi_1$. Fix $(x_0,\theta_0) \in U \times \RR^p$ such that $\nabla_\theta \phi_1(x_0,\theta_0) = 0$. Let $\xi_0 = \nabla_x \phi_1(x_0,\theta_0)$. Consider any phase function $\phi_2 \in C^\infty(U \times \RR^q)$ and $\sigma_0 \in \RR^q$ with
    %
    \[ \nabla_x \phi_1(x_0,\theta_0) = \nabla_x \phi_2(x_0,\sigma_0). \]
    %
    Furthermore, assume that the Hessian $H_{x,\theta} (\phi - \psi)$ is nondegenerate at $(x_0,\theta_0,\sigma_0)$. Then there exists a conical neighborhood $\Gamma$ of $(x_0,\theta_0)$, an open neighborhood $V$ of $x_0$, and an open neighborhood $\Sigma$ of $\sigma_0$, such that if $\psi \in C_c^\infty(V)$, and $a$ is a symbol on $U \times \RR^p$ with $\text{ess sup}(a) \subset \Gamma$, then there exists a family of smooth functions $a_k$ such that as $\lambda \to \infty$,
    %
    \begin{align*}
        \int I_{a,\phi_1}(x) & \psi(x) e^{-2 \pi i \lambda \phi_2(x,\sigma)}\; dx\\
        &\sim e^{-2 \pi i \lambda \phi_2(x(\sigma),\sigma)} |\det Q(\sigma)|^{-1/2} e^{(i \pi/4) \text{sgn}(Q(\sigma))} \lambda^{(p-d)/2} \sum_{k = 0}^\infty a_k(\sigma,\lambda) \cdot \lambda^{-k},
    \end{align*}
    %
    Here $a_k(\sigma,\lambda)$ is a linear differential operator in $a$ and $u$ at $(x(\sigma), \theta(\sigma), \sigma)$
\end{theorem}

The phase $\phi$ of an oscillatory integral distribution is called \emph{nondegenerate} if whenever $\nabla_\theta \phi(x,\theta) = 0$, the matrix $D_{x,\theta}(\nabla_\theta \phi)(x,\theta)$ has full rank $p$. It follows that
%
\[ \Sigma_\phi = \{ (x,\theta): \nabla_\theta \phi(x,\theta) = 0 \} \]
%
is a $d$ dimensional submanifold of $U \times \RR^p$. Moreover, the map $f$ from $\Sigma_\phi$ to $U \times \RR^d$ given by $(x,\theta) \mapsto (x,\nabla_x \phi(x,\theta))$ is an immersion, the immersed submanifold in the image being denoted by $\Lambda_\phi \subset T^* U$. To verify the map is an immersion, we note that at a point $(x,\theta)$ the tangent space of $\Sigma_\phi$ consists of vectors $(v,w) \in \RR^d \times \RR^p$ such that
%
\[ D_x \nabla_\theta \phi(x,\theta) \cdot v + D_\theta \nabla_\theta \phi(x,\theta) \cdot w = 0. \]
%
Now
%
\[ D_{x,\theta}f(x,\theta)(v,w) = (v, D_x \nabla_x \phi(x,\theta) \cdot v + D_\theta \nabla_x \phi(x,\theta) \cdot w ). \]
%
Thus if $(v,w)$ lies in the tangent space and $Df(x,\theta)(v,w) = 0$, then $v = 0$, which implies
%
\[ D_\theta \nabla_\theta \phi(x,\theta) \cdot w = D_\theta \nabla_x \phi(x,\theta) \cdot w = 0. \]
%
Since mixed partials commute, this says exactly that $D(\nabla_\theta \phi)^T \cdot w = 0$. The full rank condition thus implies that $w = 0$. Thus $(v,w) = 0$, completing the argument that $f$ is an immersion.

%Many properties about the phase function can be summarized via the immersed manifold $\Lambda_\phi$. For instance, given a function $\psi(x,\sigma)$, the function $\eta(x,\theta,\sigma) = \phi(x,\theta) - \psi(x,\sigma)$ has a nondegenerate stationary point as a function of $x$ and $\theta$ at a point $(x_0,\theta_0,\sigma_0)$ if and only if $\phi$ is nondegenerate phase function in a neighborhood of $(x_0,\theta_0)$, and the covector field $d_x \psi$ intersects $\Lambda_\phi$ transversally at $(x_0,\xi_0)$, where $\xi_0 = \nabla_x \phi(x_0,\theta_0) = \nabla_x \psi(x_0,\sigma_0)$. In particular, we see that nondegenerate phase functions are `generic'.

TODO: If $I_{a_1,\phi_1} = I_{a_2,\phi_2}$, prove that $\Lambda_{\phi_1} = \Lambda_{\phi_2}$.

The converse is also true.

\begin{theorem}
    Suppose $\phi_1$ and $\phi_2$ are nondegenerate phase functions on $U \times \RR^{p_1}$ and $U \times \RR^{p_2}$. Let 
\end{theorem}

The manifold $\Lambda_\phi$ of $U \times \RR^d$ actually has special geometric structure. Consider the two form
%
\[ \sigma = d\xi^1 \wedge dx^1 + \dots + d\xi^d \wedge dx^d. \]
%
The $\sigma = d\omega$, where $\omega = \xi^1 dx^1 + \dots + \xi^d dx^d$. We claim that for any $p =(x,\theta) \in \Sigma_\phi$, and any $v,w \in T_p \Sigma_\phi$, $\sigma(f_* v, f_* w) = 0$. To see this, we calculate that
%
\[ f^*(\sigma) = f^*(d \omega) = d(f^* \omega), \]
%
and
%
\[ f^* \omega = \nabla_x \phi \cdot dx = d \phi - \nabla_\theta \phi \cdot d\theta. \]
%
On $\Sigma_\phi$, $\nabla_\theta \phi = 0$, so $f^* \omega = d \phi$, and so $f^*(\sigma) = d(f^* \omega) = d^2 \phi = 0$. Thus $\Lambda_\phi$ is a \emph{Lagrangian submanifold} of $T^* \RR^d$ with respect to the two form $\sigma$.

For any phase function $\phi$ (possibly degenerate), we can define
%
\[ \Sigma_\phi = \{ (x,\theta): \nabla_\theta \phi(x,\theta) = 0 \} \]
%
\[ \Lambda_\phi = \{ (x,\nabla_x \phi(x,\theta)) : \nabla_\theta \phi(x,\theta) = 0 \}. \]
%
If $\Lambda_\phi$ is an immersed Lagrangian manifold (though not necessarily an immersion through the map $f: \Sigma_\phi \to \Lambda_\phi$), we say $I_{a,\phi}$ is a \emph{Lagrangian distribution}. The phase $\phi$ might be degenerate in this case.

\begin{example}
    A degenerate example of a Lagrangian distribution is given for $p = d + 1$, $\theta = (\theta_0, \theta_1)$ with $\theta_0 \in \RR^d$ and $\theta_1 \in \RR$, and
    %
    \[ \phi(x,\theta) = x \cdot \theta_0, \]
    %
    then $\phi$ defines a Lagrangian distribution $I_{a,\phi}$ for any symbol $a$, provided that $a(x,\theta)$ vanishes for any $\theta$ in a cone containing the $\theta_1$ axis. Now $\Sigma_\phi = \{ 0 \} \times \RR^{d+1}$, and $\Lambda_\phi = \{ 0 \} \times \RR^d$, which is a Lagrangian manifold. Thus the distributions
    %
    \[ I_{a,\phi}(x) = \int a(x,\theta_0,\theta_1) e^{2 \pi i x \cdot \theta_0}\; d\theta_0\; d\theta_1 \]
    %
    are Lagrangian.
\end{example}

If $f: U \to V$ is a diffeomorphism between open subsets of $\RR^d$, and we equip $T^* U$ with coordinates $(x,\xi)$, and $T^* V$ with coordinates $(y,\eta)$, then we obtain an isomorphism $g: T^* U \to T^* V$ mapping $(x,\xi)$ in $T^* V$ to $(x, (Df(x)^T)^{-1} \eta)$ in $T^* U$. Under this correspondence, if we consider the two-form $\omega_V = \sum \eta_i \wedge dy^i$ on $U$, then
%
\[ g^* \omega_V = \sum (\eta^i \circ g) \cdot d(y^i \circ g) = \sum ((Df(x)^T)^{-1} \xi)_i df^i(x) = \sum \xi_i dx^i. \]
%
Thus the Lagrangian form is invariant under coordinate changes, and can thus be well defined on the cotangent bundle of any manifold $M$. Thus we can discuss Lagrangian submanifolds of $T^* M$ for any manifold $M$, and Lagrangian distributions on manifolds.

\begin{example}
    Consider a one-form $\psi$ on $M$, i.e. a smooth function $\psi: M \to T^* M$. Working in coordinates $(x,\xi)$ on $T^* M$, we have
    %
    \[ \psi^* \omega = \sum \psi^i dx^i = d\psi. \]
    %
    Thus we see that $\psi^* \sigma = 0$ if and only if $d\psi = 0$, so $\psi$ defines a Lagrangian submanifold of $T^* M$ if and only if it is closed.
\end{example}

\section{Singular Operations on Distributions}

A subset $\Gamma$ of $\Omega \times \RR^d$ is \emph{conic} if $(x,\xi) \in \Gamma$ implies that $(x,\lambda \xi) \in \Gamma$. Given a closed conic set $\Gamma$, let $\DD^*_\Gamma(\Omega)$ denote the family of all distributions $u$ with $\text{WF}(u) \subset \Gamma$, with the seminorms
%
\[ u \mapsto \sup_{\substack{\xi \in V\\\lambda > 0}} \lambda^N |\widehat{\phi u}(\lambda \xi)| \]
%
where $V$ is a closed conic set disjoint from $\Gamma$. Then $\DD^*_\Gamma(\Omega)$ is a Fr\'{e}chet space. To analyze this space, we require a lemma about general distributions.

\begin{lemma}
    Let $\mathcal{U}$ be a family in $\DD^*(\Omega)$ such that $\sup_{u \in \mathcal{U}} |u(\phi)| < \infty$ for all $\phi \in \DD(\Omega)$. Then for any $\phi \in \DD(\Omega)$, there exists $m > 0$ such that for any $\xi \in \mathbf{R}^d$,
    %
    \[ |\widehat{\phi u}(\xi)| \lesssim (1 + |\xi|)^m, \]
    %
    uniformly in $u$ and $\xi$. If we have a sequence $\{ u_n \}$ converging to some distribution $u$, then as $n \to \infty$,
    %
    \[ |\widehat{\phi u_n}(\xi) - \widehat{\phi u}(\xi)| = o((1 + |\xi|^m)). \]
    %
    In particular, $\widehat{\phi u_n}$ converges to $\widehat{\phi u}$ on compact subsets.
\end{lemma}
\begin{proof}
    For any compact set $K \subset \Omega$, the assumptions imply there exists $m$ such that for $u \in \mathcal{U}$ and $\phi \in C_c^\infty(K)$,
    %
    \[ |u(\phi)| \lesssim \| \phi \|_{C^m(K)}. \]
    %
    This is a result we have proven earlier following from the uniform boundedness principle. If $\phi$ is supported on $K$, then
    %
    \[ |u(\phi e^{-2 \pi i \xi \cdot x})| \lesssim \| \phi e^{-2 \pi i \xi \cdot x} \|_{C^m(K)} \lesssim (1 + |\xi|)^m. \]
    %
    A similar argument shows the result for a convergent sequence.
\end{proof}

\begin{theorem}
    A sequence of distributions $u_n$ converges to $u$ in $\DD^*_\Gamma(U)$ if and only if $u_n$ converges to $u$ distributionally, and for any conic set $V$ disjoint from $\Gamma$, and $N > 0$,
    %
    \[ \sup_{\substack{\xi \in V}} \lambda^N |\widehat{\phi u_n}(\lambda \xi)| \]
    %
    is bounded independantly of $n$.
\end{theorem}
\begin{proof}
    This conditions are certainly necessary for convergence. Conversely, if these conditions are satisfied, the previous lemma implies that as $n \to \infty$,
    %
    \[ \sup_{\lambda \geq 1} \sup_{\xi \in V} \lambda^{-m} |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| = o(1). \]
    %
    We also know that
    %
    \[ \sup_{\lambda \geq 1} \sup_{\xi \in V} \lambda^{N+1} |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| < \infty. \]
    %
    Let us call this supremum $C > 0$. Given any $\varepsilon > 0$, we find that
    %
    \[ \sup_{\lambda \geq C/\varepsilon} \lambda^N |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| \leq \varepsilon. \]
    %
    But
    %
    \[ \sup_{1 \leq \lambda \leq C/\varepsilon} \sup_{\xi \in V} \lambda^N |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| = o((C/\varepsilon)^{N+m}). \]
    %
    Taking $n$ suitably large, depending on $C$, $\varepsilon$, $N$, and $m$, we conclude that
    %
    \[ \sup_{1 \leq \lambda \leq C/\varepsilon} \sup_{\xi \in V} \lambda^N |\widehat{\phi u_n}(\lambda \xi) - \widehat{\phi u}(\lambda \xi)| \leq \varepsilon. \]
    %
    Combining this with the supremum above shows that we have convergence in $\DD^*_\Gamma(U)$.
\end{proof}

\begin{theorem}
    $\DD(\Omega)$ is sequentially dense in $\DD^*_\Gamma(\Omega)$.
\end{theorem}
\begin{proof}
    Consider a distribution $u \in \DD^*_\Gamma(\Omega)$. Without loss of generality we may assume $u$ is compactly supported. Consider an approximation to the identity $\{ \phi_\delta \}$. Then $u * \phi_{1/n} \in C^\infty(\Omega)$, and thus an element of $\DD^*_\Gamma(\Omega)$. $u * \phi_{1/n}$ converges to $u$ in $\DD^*(\Omega)$, so by the last result, it suffices to show that for any admissable choice of $\psi$, $V$, and $N > 0$,
    %
    \[ \sup_{\substack{\xi \in V}} \sup_n \lambda^N |\widehat{\psi (u * \phi_n)}(\lambda \xi)| < \infty. \]
    %
    But this is simple, for we get arbitrarily fast decay if $n$ is suitably large, depending on the distance from $V$ to $\Gamma$, and the finitely many smaller choices of $n$ are negligible.
\end{proof}

We have a continuous map $(\phi,\psi) \to \phi \psi$ from $\DD(\Omega) \times \DD(\Omega) \to \DD(\Omega)$, which extends to a continuous map $(\phi,u) \to \phi u$ from $\DD(\Omega) \times \DD^*(\Omega) \to \DD^*(\Omega)$. However, it is \emph{not} possible to extend this to a continuous map $(u,v) \mapsto uv$ from $\DD^*(\Omega) \times \DD^*(\Omega) \to \DD^*(\Omega)$. For instance, if $\{ \phi_\varepsilon \}$ is an approximation to the identity, then $\phi_\varepsilon$ converges to the Dirac delta distribution $\delta$ at the origin, so we would expect $\phi_\varepsilon^2$ to converge to a distribution representing the product $\delta \cdot \delta$, but this does not happen because if $\psi \in \DD(\RR^d)$ and $\psi(x) = 1$ for $|x| \leq 1$, then
%
\[ \left| \int \phi_\varepsilon^2(x) \psi(x) \right| \gtrsim 1/\varepsilon \]
%
and thus does not converge. It is a surprising fact that we can use the wavefront set of a distribution to define the product of two distributions, \emph{provided that the wavefront sets satisfy a disjointness relation}.

To see how this is possible, we note that for $\phi,\psi \in \DD(\RR^d)$, we might expect us to be able to take Fourier transforms, so that
%
\begin{align*}
    \int u(x) v(x) \phi(x) \psi(x)\; dx &= \int (\phi u)(x) (\psi v)(x)\; dx\\
    &= \int \int (\widehat{\phi u} * \widehat{\psi v})(\xi) e^{2 \pi i \xi \cdot x}\; d\xi\; dx\\
    &= \int \int \widehat{\phi u}(\eta) \widehat{\psi v}(\xi - \eta) e^{2 \pi i \xi \cdot x}\; d\xi\; dx.
\end{align*}
%
The only problem with taking this as the \emph{definition} of the product is that the integral we have obtained might not converge in general. However, if at least one of the Fourier transforms decreases rapidly in the right directions.

\begin{theorem}
    Fix conic sets $\Gamma_1,\Gamma_2 \subset \Omega \times \mathbf{R}^d - \{ 0 \}$. If $\Gamma_3 = \Gamma_1 + \Gamma_2$ does not contain any points in $0_\Omega = \Omega \times \{ 0 \}$, then we have a unique continuous map from $\DD^*_{\Gamma_1}(\Omega) \times \DD^*_{\Gamma_2}(\Omega) \to \DD^*_{\Gamma_3}(\Omega)$ which agrees with multiplication for elements of $C^\infty(\Omega)$.
\end{theorem}

\begin{example}
    Consider the distributions $\Lambda_1$ and $\Lambda_2$ on $\RR^2$, given by integration along the $x$ and $y$ axis respectively, i.e.
    %
    \[ \int \Lambda_1(x,y) \phi(x,y)\; dx\; dy = \int \phi(x,0)\; dx \]
    %
    and
    %
    \[ \int \Lambda_2(x,y) \phi(x,y)\; dx\; dy = \int \phi(0,y)\; dy. \]
    %
    We have seen that $\text{WF}(\Lambda_1) = \{ (x,0;0,\eta) : \eta \neq 0 \}$ and $\text{WF}(\Lambda_2) = \{ (0,\xi;y,0) : \xi \neq 0 \}$. Now
    %
    \[ \text{WF}(\Lambda_1) + \text{WF}(\Lambda_2) = \{ (x,\xi,y,\eta): \xi, \eta \neq 0 \}, \]
    %
    which is disjoint from $0_{\RR^2}$, and so a product $\Lambda_1 \cdot \Lambda_2$ is well defined. To determine what the product is, we consider a non-negative bump function $\phi \in \DD(RR^d)$ equal to one in a neighborhood of the origin, and define
    %
    \[ \phi_{x,\delta}(x,y) = (1/2\delta) \mathbf{I}(|x| \leq 1/\delta, |y| \leq \delta) \]
    %
    %
    \[ \phi_{y,\delta}(x,y) = (1/2\delta) \mathbf{I}(|x| \leq \delta, |y| \leq 1/\delta). \]
    %
    Then as $\delta \to 0$, $\phi_{x,\delta} \to \Lambda_1$ and $\phi_{y,\delta} \to \Lambda_2$. We find that
    %
    \[ \phi_{x,\delta} \phi_{y,\delta} = (1/4\delta^2) \mathbf{I}(|x| \leq \delta, |y| \leq \delta). \]
    %
    As $\delta \to 0$, $\phi_{x,\delta} \phi_{y,\delta}$ thus converges to the Dirac delta distribution $\delta$ at the origin. Thus $\Lambda_1 \cdot \Lambda_2 = \delta$.
\end{example}

\begin{example}
    Let $\Lambda = (x + i0^+)^{-1}$, i.e. the distribution
    %
    \[ \int \Lambda(x) \phi(x)\; dx = \lim_{y \to 0^+} \int \frac{\phi(x)}{x + iy}\; dx = \lim_{y \to 0^+} \Lambda_y(\phi). \]
    %
    The $\Lambda$ is homogeneous. Moreover, some formal manipulations, plus some contour integrals, show that
    %
    \[ \widehat{\Lambda}(\xi) = - 2 \pi i \cdot \mathbf{I}(\xi < 0). \]
    %
    In particular, $\text{WF}(\Lambda) = \{ (0,\xi) : \xi < 0 \}$. this means $\text{WF}(\Lambda) + \text{WF}(\Lambda)$ does not contain any zero vectors, so the product $\Lambda \cdot \Lambda$ is well defined. Now $\Lambda$ is the limit of the $C^\infty$ functions $\phi_y(x) = 1/(x + iy)$ in $\DD^*(\RR)$, and it requires only a simple calculation to show that $\Lambda$ is also the limit in $\DD^*_\Gamma(\RR)$, where $\Gamma = \{ (0,\xi): \xi < 0 \}$. Since
    %
    \[ \phi_y(x)^2 = 1/(x + iy)^2, \]
    %
    we find by continuity that
    %
    \[ \Lambda \cdot \Lambda = (x + i0^+)^{-2}, \]
    %
    i.e.
    %
    \[ \int \Lambda(x) \Lambda(x) \phi(x)\; dx = \lim_{y \to 0} \int \frac{\phi(x)}{(x + iy)^2}\; dx. \]
\end{example}

To define more sophisticated operations on distributions, we define the generic operations of \emph{pullback}, \emph{pushforward}, and \emph{tensoring}. Intuitively, the pullback of a distribution gives a way to `compose' a distribution with a smooth function in the domain, the push forward enables one to `integrate a distribution along fibres', and tensoring enables us to take the product of distributions.

Let us begin with the pullback. For a smooth map $f: \Omega \to \Psi$, not necessarily a diffeomorphism, and $\phi \in \DD(\Psi)$, we can define $f^* \phi = \phi \circ f \in C^\infty(\Omega)$. This map is continuous in the appropriate topology, and if $f$ is a proper map, $f^*$ is continuous from $\DD(\Psi) \to \DD(\Omega)$. To obtain a distributional definition, we apply the Fourier inversion formula; if $\psi \in \DD(\RR^d)$, then
%
\[ \int (f^* \phi)(x) \psi(x)\; dx = \int \phi(f(x)) \psi(x)\; dx = \int \int \widehat{\phi}(\eta) \psi(x) e^{2 \pi i \eta \cdot f(x)}\; d\xi\; dx. \]
%
For a compactly supported distribution $u$ on $\Psi$, it is therefore natural to define $f^* u$ on $\Omega$ such that
%
\[ \int (f^* u)(x) \psi(x)\; dx = \int \widehat{u}(\eta) \left( \int \psi(x) e^{2 \pi i \eta \cdot f(x)}\; dx \right)\; d\eta. \]
%
We can decompose this integral so that $\psi$ is supported on various small sets. If $\psi$ is supported in a neighbourhood of $x_0$, then the oscillatory integral on the inside decays fast as $\eta \to \infty$ provided that $Df(x_0)^T \eta \neq 0$. Thus, provided that $\widehat{u}(\eta)$ decays fast whenever $Df(x_0)^T \eta = 0$, the integral above is well defined. Proceeding through this argument more rigorously gives the following result, left as an exercise.

\begin{theorem}
    Given a smooth map $f: \Omega \to \Psi$, let
    %
    \[ N = \{ (f(x),\eta): Df(x)^T \eta = 0 \}. \]
    %
    Fix a closed cone $\Gamma$ with $\Gamma \cap N = \emptyset$. Then $f^*: \DD(\Psi) \to C^\infty(\Omega)$ extends to a continuous map from $\DD^*_\Gamma(\Psi) \to \DD^*_{f^* \Gamma}(\Omega)$, where
    %
    \[ f^* \Gamma = \{ (x,Df(x)^T \xi) : (f(x), \xi) \in \Gamma \}. \]
\end{theorem}

\begin{example}
    if $\pi_x: \RR^2 \to \RR$ and $\pi_y: \RR^2 \to \RR$ are the obvious projection maps, then we have
    %
    \begin{align*}
        \int (\pi_x^* \delta)(x,y) \phi(x,y)\; dx\; dy &= \int \widehat{\delta}(\xi) \phi(x,y) e^{2 \pi i \xi \cdot x}\; dx\; dy\; d\xi\\
        &= \int \phi(x,y) e^{2 \pi i \xi \cdot x}\; dx\; dy\; d\xi\\
        &= \int \phi(0,y)\; dy.
    \end{align*}
    %
    Thus $\pi_x^* \delta$ is the distribution given by integration on the $y$-axis. Similarily, one can calculate that $\pi_y^* \delta$ is the distribution given by integration on the $x$-axis. It is simple to calculate explicitly, or using the properties of pullback, that
    %
    \[ \text{WF}(\pi_x^* \delta) \subset \{ (0,\xi,y,0) : \xi \neq 0 \} \]
    %
    and
    %
    \[ \text{WF}(\pi_y^* \delta) \subset \{ (x,0,0,\eta): \eta \neq 0 \}. \]
    %
    In fact, in these two cases these equations are equalities.
\end{example}

Next, let us define the tensor product. Given a distribution $u_1$ on $\Omega_1$ and a distribution $u_2$ on $\Omega_2$, we define a distribution $u_1 \otimes u_2$ on $\Omega_1 \times \Omega_2$ such that for $\phi \in \DD(\Omega_1 \times \Omega_2)$,
%
\[ \int (u_1 \otimes u_2)(x_1,x_2) \phi(x_1,x_2)\; dx_1\; dx_2 = \int u_1(x_1) \left( \int u_2(x_2) \phi(x_1,x_2)\; dx_2 \right)\; dx_1, \]
%
where the function
%
\[ \tilde{\phi}(x_1) = \int u_2(x_2) \phi(x_1,x_2)\; dx_2 \]
%
is smooth, where one can easily verify that
%
\[ D^\alpha \tilde{\phi}(x_1) = \int u_2(x_2) D^\alpha \phi(x_1,x_2)\; dx_2. \]
%
Thus the tensor product of any two distributions is well defined. It is simple to check that
%
\[ \text{WF}(u_1 \otimes u_2) \subset \text{WF}(u_1) \times \text{WF}(u_2) \cup \text{WF}(u_1) \times \{ 0 \} \cup \{ 0 \} \times \text{WF}(u_1). \]
%
obtained by isolating each variable separately with a bump function and then tensoring the Fourier transform.

\begin{example}
    Given $\phi,\psi \in \DD(\Omega)$, we have
    %
    \[ \phi \cdot \psi = i^*(\phi \otimes \psi), \]
    %
    where $i(x) = (x,x)$, which gives us another way to define the product of distributions by a tensoring, combined with a pullback.
\end{example}

Finally, we define the pushforward of a distribution. This is most naturally defined distributionally. Given a smooth map $f: \Omega \to \Psi$, $\phi \in \DD(\Omega)$, and $\psi \in \DD(\Psi)$, we define
%
\[ \int f_* \phi(y) \psi(y) dy = \int \phi(x) \psi(f(x))\; dx. \]
%
Thus $f_*$ is just the adjoint of $f^*$. One problem which prevents us from directly using this definition to extend the definition to distributions is that $\psi \circ f$ need not be compactly supported if $\psi$ is compactly supported. But this technical issue is removed provided that $f$ is a \emph{proper map}, i.e. inverse images of compact sets are compact. It is then simple to define
%
\[ \int f_* u(y) \psi(y)\; dy = \int u(x) \psi(f(x))\; dx. \]
%
for a distribution $u$ on $\Omega$ and $\psi \in \DD(\Psi)$. To understand the wavefront set of $u$, we consider a bump function $\phi$ supported in a neighbourhood  on $\Omega$ and consider
%
\[ \int f_*(u \phi)(y) e^{-2 \pi i \eta \cdot y}\; dy = \int u(x) \phi(x) e^{-2 \pi i \eta \cdot f(x)}\; dx. \]
%
We have already show that for such an oscillatory integral, provided that $(f(x_0),Df(x_0)^T \eta) \not \in \text{WF}(u)$, this integral converges. Thus
%
\[ \text{WF}(f_* u) \subset \{ (y,\eta) : \text{There is $(x,\xi) \in \text{WF}(u)$ and $Df(x)^T \eta = \xi$} \}. \]
%
Now we have defined pushforward, pullback, and tensoring, let us see how they can be used to define useful operations on distributions.

Let us consider an important example which occurs in the theory of kernel operators. Recall that the Schwartz kernel theorem says that if $T: \DD(\Omega) \to \DD^*(\Psi)$ is any continuous linear map, then there exists a distribution $K \in \DD^*(\Omega \times \Psi)$ such that, formally speaking,
%
\[ T\phi(x) = \int K(x,y) \phi(y)\; dy \]

for any $\phi \in \DD(\Omega)$ and $\psi \in \DD(\Psi)$,
%
\[ \int T\phi(y) \psi(y)\; dy = \int K(x,y) \phi(x) \psi(y)\; dx\; dy. \]
%
In other words, if $\pi(x,y) = y$ and $\Delta(x,y) = (x,x,y)$, then
%
\begin{equation} \label{distributionkernelequation}
    T\phi = \pi_*(\Delta^* (\phi \otimes K)).
\end{equation}
%
Going through the definitions shows that $\text{WF}(T\phi) \subset \text{WF}(K)_Y$, where
%
\[ \text{WF}(K)_Y = \{ (y,\eta) : (x,0;y,\eta) \in \text{WF}(K)\ \text{for some $x \in \Omega$} \}. \]
%
We can also use equation \eqref{distributionkernelequation} to extend the domain of $T$ to certain compactly supported distributions. Going through the definition shows that for a compactly supported distribution $u$, the expression $\pi_*(\Delta^*(\phi \otimes K))$ is well defined provided that
%
\[ \text{WF}'_X(K) \cap \text{WF}(u) = \emptyset, \]
%
where
%
\[ \text{WF}'(K)_X = \{ (x,-\xi) : (x,\xi;y,0) \in \text{WF}(K)\ \text{for some $y$} \}. \]
%
In this case, we define $Tu = \pi_*(\Delta^*(\phi \otimes K))$. This gives a sequentially continuous map from the subspace of compactly supported distributions in $\DD^*_\Gamma(\Omega)$ to $\DD^*(\Omega)$ for any $\Gamma$ with $\text{WF}'_X(K) \cap \Gamma = \emptyset$. If, in addition, the projection map $\pi(x,y) = y$ is proper on $\text{supp}(K)$, then this can be extended to a sequentially continuous map from $\DD^*_\Gamma(\Omega)$ to $\DD^*(\Omega)$. It is a simple exercise to show that
%
\[ \text{WF}(Tu) \subset \text{WF}_Y(K) \cup \text{WF}'(K) \circ \text{WF}(u) \]
%
where
%
\[ \text{WF}'(K) = \{ (x,-\xi;y,\eta) : (x,\xi;y,\eta) \in \text{WF}(K) \}, \]
%
is the \emph{wavefront relation} of $K$, and the composition $R \circ E$ of a subset $E$ of $\Omega \times \RR^n$ and a subset $R$ of $(\Omega \times \Psi) \times (\RR^n \times \RR^m)$ is defined to be the set of $(y,\eta) \in \Psi \times \RR^m$ such that $(x,\xi) \in E$ for some $x$ and $\xi$, and $(x,\xi;y,\eta) \in R$. A simple way to remember the results of this construction is that $K$ can be applied to any distribution $u$ such that $\text{WF}'(K) \circ (\text{WF}(u) \cup 0_\Omega)$ contains no zero vector, and then $\text{WF}(Ku)$ is equal to this composition.

\begin{example}
    Consider a pseudodifferential operator $T$ given by a symbol $a$, i.e.
    %
    \[ T\phi(x) = \int a(x,\xi) \widehat{\phi}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi = \int a(x,\xi) \phi(y) e^{2 \pi i \xi \cdot (x - y)}\; d\xi\; dy. \]
    %
    We can also think of $T$ as a kernel operator with kernel
    %
    \[ K(x,y) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)} \; d\xi. \]
    %
    The kernel is a distribution defined by an oscillatory integral distribution, and our calculations for such distributions show that
    %
    \[ \text{WF}(K) \subset \{ (x,-\xi;x,\xi) : x \in \Omega, \xi \in \RR^n - \{ 0 \} \}. \]
    %
    Thus
    %
    \[ \text{WF}'(K) \subset \{ (x,\xi;x,\xi) : x \in \Omega, \xi \in \RR^n - \{ 0 \} \}. \]
    %
    In particular, $\text{WF}'(K)$, viewed as a relation, contains no zero vectors, and so we find that $T$ extends to a continuous operator from $\mathcal{E}(\RR^d)^*$ to $\mathcal{D}(\RR^d)^*$. Moreover, for any compactly supported distribution $u$, we find $\text{WF}(Tu) \subset \text{WF}(u)$. This is part of the \emph{pseudolocal} nature of pseudodifferential operators; when $T$ is applied to some distribution $u$ supported near $(x_0,\xi_0)$ in phase space, we should expect the same will be true of $Tu$.
\end{example}

\begin{example}
    Given a distribution $u$, convolution with $u$ is given by the Schwartz kernel $K(x,y) = u(y-x)$, i.e. $K = f^* u$, where $f:\RR^{2d} \to \RR^d$ is given by $f(x,y) = y-x$. Since $f$ is surjective, the resulting set $N$ is empty, so the pullback $K$ is always a well defined distribution. Moreover,
    %
    \[ \text{WF}(K) \subset f^* \text{WF}(u) = \{ (x_1,-\xi,x_2,\xi): (x_2 - x_1, \xi) \in \text{WF}(u) \}, \]     
    %
    and therefore
    %
    \[ \text{WF}'(K) \subset \{ (x_1,\xi,x_2,\xi): (x_2 - x_1,\xi) \in \text{WF}(u) \}. \]
    %
    We actually have equality here. To see this, for $a \in \RR^d$, and let $g: \RR^d \to \RR^{2d}$ such that $g(x) = (x + a, a)$. Then $u = g^* K$, and so it follows htat
    %
    \[ \text{WF}(u) \subset \{ (x,\xi) : (x + a, a, \xi, -\xi) \in \text{WF}(K) \}. \]
    %
    It follows from this that we have equality.

    If $u$ is a distribution supported at the origin, then $\text{WF}'(K)$ is a subset of the diagonal in $T^* X \times T^* X$. Thus if $P$ is a linear differential operator, then $\text{WF}(Pu) \subset \text{WF}(u)$.
\end{example}

How about the \emph{composition} of kernel operators? Intuitively, if $B: \DD(\Psi) \to \DD^*(\Phi)$, $A: \DD(\Omega) \to \DD^*(\Psi)$, with kernels $K_A(x,y)$ and $K_B(y,z)$, then, if we could define a kernel operator $C = B \circ A: \DD(\Omega) \to \DD^*(\Phi)$, then it should have kernel
%
\[ K_C(x,z) = \int K_A(x,y) K_B(y,z)\; dy. \]
%
Slightly more precisely, we might want to define $K_C = \pi_* \Delta^*(K_A \otimes K_B)$, where $\Delta: X \times Y \times Z \to X \times Y \times Y \times Z$, and $\pi: X \times Y \times Z \to X \times Z$. In order for this to make sense, we require the projection map $(x,y) \to x$ to be proper on $\text{supp}(K_A)$. Provided that $\text{WF}'(K_B) \circ \text{WF'}(K_A) \circ 0_\Omega$ does not contain a zero section, the composition $B \circ A$ is well defined as an operator from $\DD(\Omega) \to \DD^*(\Phi)$, where the kernel is defined by the formula above. Moreover,
%
\[ \text{WF}'(K_C) \subset \text{WF}'(K_B) \circ ((\text{WF}'(K_A) \cup 0_\Omega) \cup 0_\Psi). \]
%
For instance, this theorem says that if $P$ and $Q$ are pseudodifferential operators, then $P \circ Q$ is well defined, which is also pseudolocal in the sense that $\text{WF}((P \circ Q)(u)) \subset \text{WF}(u)$. Of course, one can show $P \circ Q$ is \emph{also} a pseudodifferential operator, from which this result automatically follows from the previous results we talked about in this chapter.

\begin{example}
    Given a kernel $K \in \DD^*(\Omega \times \Psi)$ generating an operator $T: \DD(\RR^n) \to \DD^*(\RR^m)$, the adjoint map $T^*: \DD(\RR^m) \to D'(\RR^n)$ is induced by the kernel $K^*(y,x) = \overline{K(x,y)}$. It is simple to verify that
    %
    \[ \text{WF}'(K^*) = \{ (y,\eta;x,\xi) : (x,\xi;y,\eta) \in \text{WF}(K) \}. \]
    %
    Thus provided the projection $(x,y) \mapsto x$ is proper on $\text{supp}(K)$, and
    %
    \[ \text{WF}'(K^*) \circ \text{WF}'(K) \circ 0_\Omega \]
    %
    does not contain a zero section, i.e. there does not exist any $(x,0;y,\eta) \in \text{WF}'(K)$. If $(x,y) \mapsto x$ is proper, then we can define $T^* T$. Similarily, if there does not exist any $(x,\xi;y,0) \in \text{WF}'(K)$, and $(x,y) \mapsto y$ is proper, then we can define $T T^*$.

    $\text{WF}_Y'(K^*) \cap \text{WF}_Y(K) = \emptyset$, we can define the kernel $K^* \circ K$. This means precisely that there doesn't exist any $(x,y,0,\eta) \in \text{WF}(K)$. We then calculate that
    %
    \[ \text{WF}(K^* \circ K) \subset \{ (x_1,x_2,\xi_1,\xi_2) : (x_1,y,\xi_1,\eta), (x_2,y,\xi_2,\eta) \in \text{WF}(K) \} \]
    %
    In particular, if $\text{WF}(K)$ is the graph of a function, then $\text{WF}(K \circ K^*)$ is a subset of the diagonal of $T^* X$.
\end{example}



\section{Propogation of Singularities Theorem}

One important relation between $u$ and $\text{WF}(u)$ is the \emph{propogation of singularities theorem}. If $u$ is a solution to a linear partial differential equation
%
\[ \sum_{|\alpha| \leq K} a_\alpha(x) (\partial_\alpha u)(x) = v \]
%
where $v$ is a distribution, then for any $(x,\xi) \in \text{WF}(u) - \text{WF}(v)$,
%
\[ q(x,\xi) = \sum_{|\alpha| \leq K} a_\alpha(x) \xi^\alpha = 0, \]
%
and $\text{WF}(u) - \text{WF}(v)$ is invariant under the flow generated by the Hamiltonian vector field
%
\[ H_{x,\xi} = \sum_{i = 1}^d \frac{\partial q}{\partial x^j} \frac{\partial}{\partial \xi^j} - \frac{\partial q}{\partial \xi_j} \frac{\partial}{\partial x^j}. \]
%
As a particular example, if $u(t,x,y)$ is a distributional solution to the wave equation $u_{tt} = \Delta u$ and we let $v_t(x,y) = u(t,x,y)$, then $\Delta v_t = u_{tt}$, and so by the propogation of singularities theorem $\text{WF}(v_t) \subset \text{WF}(u_{tt})$.

Then the Paley-Wiener theorem implies that $\widehat{u}$ is an analytic function on $\RR^d$. If $\widehat{u}$ decays rapidly, then $u$ is also a smooth function. However, even if $u$ is not smooth, $\widehat{u}$ may still decrease rapidly in certain directions, which implies that the singularities of $u$ `propogate' in certain directions and understanding these directions is often useful to understanding the distribution $u$. We can also get even more information about the distribution $u$ by looking at the singular frequencies.

To begin with, let 

To begin with, a distribution $u$ is \emph{nonsingular} at a point $x \in \RR^d$ if $u$ is locally a $C^\infty$ function in a neighbourhood of $x$, i.e. there exists a bump function $\phi \in C^\infty(\RR^d)$ with $\phi(x) \neq 0$ such that $\phi u \in C^\infty(\RR^d)$. The  \emph{singular support} of a compactly supported distribution $u$ to be the set of all points $x \in \RR^d$ upon which $u$ is not nonsingular.









\chapter{Distributional Solutions to Some PDEs}

Distribution theory was originally invented to provide a more amenable setting to the theory of existence for linear partial differential equations. Let us use the theory we have now established to solve some differential equations in the language of distributions. We begin with the most basic differential equation, namely solutions to the transport equation $D^i u = 0$.

\begin{theorem}
  If $u \in \DD^*(\RR^d)$ and there exists an index $i$ such that $D^i u = 0$, then there exists $v \in \DD^*(\RR^{d-1})$ such that
  %
  \[ \int_{\RR^d} u(x) \phi(x)\; dx = \int_{\RR^{d-1}} v(x) \left( \int_{-\infty}^\infty \phi(x)\; dx^i \right)\; dx, \]
  %
  i.e. $u$ is `constant' in the direction $i$. In particular, if $d = 1$, and $D u = 0$, then $u$ is a constant.
\end{theorem}
\begin{proof}
  Suppose without loss of generality that $i = d$. Suppose $\phi \in \DD(\RR^d)$ and for each $x \in \RR^{d-1}$,
  %
  \[ \int_{-\infty}^\infty \phi(x,t)\; dt = 0. \]
  %
  Then the function
  %
  \[ \psi(x,t) = \int_{-\infty}^t \phi(x,s)\; ds = 0 \]
  %
  has compact support and $D^i \psi = \phi$. Thus
  %
  \begin{align*}
    \int_{-\infty}^\infty u(x,t) \phi(x,t)\; dx\; dt &= \int_{-\infty}^\infty u(x,t) D^i \psi(x,t)\; dx\; dt\\
    &= - \int_{-\infty}^\infty D^i u(x,t) \psi(x,t)\; dx\; dt = 0.
  \end{align*}
  %
  Now fix $\phi_0 \in \DD(\RR)$ with $\int_{-\infty}^\infty \phi_0(x) = 1$. Then given any $\phi \in \DD(\RR^d)$,
  %
  \[ \int_{-\infty}^\infty u(x,t) \phi(x,t)\; dx\; dt = \int_{-\infty}^\infty u(x,t) \phi_0(t) \left( \int_{-\infty}^\infty \phi(x,s)\; ds \right)\; dx\; dt. \]
  %
  Thus it suffices to set
  %
  \[ v(x) = \int_{-\infty}^\infty u(x,t) \phi_0(t)\; dt. \qedhere \]
\end{proof}

A change of variables shows we have found all distributional solutions to the transport equation $w \cdot \nabla u = 0$ for a fixed vector $w \in \RR^d$. A corollary is a regularity result for distributional solutions to the equation $w \cdot \nabla u(x) + a(x) u(x) = f(x)$.

\begin{lemma}
    If $u \in \DD(\RR)^*$ is a distributional solution to the equation $D u + a u = f(x)$, where $f \in C(\RR)$, and $a \in C^\infty(\RR)$, then $u \in C^1(\RR)$, and so $u$ is a classical solution to the equation.
\end{lemma}
\begin{proof}
    We just apply classical techniques distributionally. First assume $a = 0$. If $F$ is an antiderivative of $f$ in the $i$th direction, then $F \in C^1(\RR)$, and $D(u - F) = 0$, so $u$ differs from $F$ by a constant, and is therefore also in $C^1(\RR)$. For $a \neq 0$, let $A$ be an antiderivative of $a$, and set
    %
    \[ E(x) = e^{A(x)}. \]
    %
    Then $E \in C^\infty(\RR)$. Thus if $u$ is a distribution solving $D u + a u = f(x)$, and if $v = E u$ then the product rule shows that $Dv = Ef$. The $a = 0$ case implies that $v \in C^1(\RR)$, and so $u \in C^1(\RR)$.
\end{proof}

\begin{remark}
    The idea of this result generalizes to a system of differential equations given by a matrix $a$ with $C^\infty$ entries, and where $f$ is a vector with continuous entries, by finding an invertible matrix $E(x)$ such that $E'(x) = E(x) \cdot a(x)$. In particular, since higher order ordinary differential equations can be reduced to one dimensional systems of ordinary differential equations, we conclude that if $u$ is a distribution satisfying the equation
    %
    \[ D^m u + a_{m-1} D^{m-1} u + \dots + au = f, \]
    %
    for $a_i \in C^\infty(\RR)$, and $f \in C(\RR)$, then $u$ actually lies in $C^m(\RR)$, and satisfies this equation pointwise in the classical sense.
\end{remark}

Higher dimensional analogues of these results are not as strong. Indeed, we have already seen that distributional solutions to $D^i u = 0$ may fail to be classical solutions `normal to the direction $i$'. On the other hand, we can `almost' obtain such a result if we assume that $u$ is a continuous function.

\begin{lemma}
    Suppose $u$ and $f$ are continuous functions in $C(\RR^d)$, and $u$, viewed as a distribution, satisfies the equation $D^i u = f$. Then $D^i u$ exists pointwise for all $x \in \RR^d$, and $D^i u (x) = f(x)$ for all $x \in \RR^d$.
\end{lemma}
\begin{proof}
    Assume $i = d$ without loss of generality, and write $x = (x_0,t)$, for $x_0 \in \RR^{d-1}$ and $t \in \RR$. Set
    %
    \[ v(x_0,t) = \int_0^t f(x_0,s)\; ds. \]
    %
    Then $v$ is a distributional solution to the equation $D^i v = f$, and so $D^i(u - v) = 0$. It follows that there exists a distribution $w \in \DD(\RR^{d-1})^*$ such that $u(x,t) - v(x,t) = w(x)$. The proof of the existence of $w$ actually implies that $w$ is continuous, since $u$ and $v$ are continuous. But then $u(x,t) = v(x,t) + w(x)$ is differentiable in the $t$-variable by the fundamental theorem of calculus.
\end{proof}

\begin{theorem}
    Fix $a_1,\dots,a_n \in C^1(\RR^d)$, and $b \in C^0(\RR^d)$, and suppose that $u \in C(\RR^d)$ is pointwise differentiable, and in a pointwise sense, the equation $a_1 D_1 u + \dots + a_n D_n u + b u = f$, where $f \in C(\RR^d)$. Then the same equation holds in a distributional sense (which makes sense because $D_i u$ is a distribution of order one, and thus can be multiplied against $C^1$ functions).
\end{theorem}
\begin{proof}
    We adapt the proof of Cauchy's theorem due to Goursat. Our goal is to prove, given the assumptions in the theorem, that for any $\phi \in C_c^\infty(\RR^d)$,
    %
    \[ \int (b \phi - D_1(a_1 \phi) + \dots + D_n(a_n \phi)) \cdot u = \int f \phi. \]
    %
    For any cube $I$, let
    %
    \[ A_I = \int_I (f \phi - (b \phi - D_1(a_1 \phi) - \dots - D_n(a_n \phi)) \cdot u) + \int_{\partial I} u (a \cdot n)\; dS. \]
    %
    For any fixed $x_0 \in \RR^d$, we claim that
    %
    \[ \lim_{\substack{x_0 \in I\\|I| \to 0}} \frac{|A_I|}{|I|} = 0. \]
    %
    To prove this, we may replace $u$ in the formula above with it's first order Taylor expansion, and $f$ with the resultant formula $a_1 D_1 u + \dots + a_n D_n u + bu$, without loss of generality, since the error term here disappears in the limit. But then the formula is easy to verify. But now it follows that we must have $A_I = 0$ for all $I$, because otherwise we could find a nested family of cubes $A_I$ with $|A_I| \gtrsim |I|$. But if we now take $I$ large enough that it contains the support of $\phi$, the theorem is proved.
\end{proof}

Using techniques from the next section, we obtain a higher dimensional variant of the ODE result above.

\begin{theorem}
    Let $U = V \times I$, where $V \subset \RR^{n-1}$ is open, and $I$ is an open interval. If $u \in \DD(U)^*$ satisfies
    %
    \[ D_{x_n}^m u + a_{m-1} D_{x_n}^{m-1} u + \dots + a_0 u = f, \]
    %
    where $f \in C(I, \DD(V)^*)$, and each $a_i$ is a differential operator in $x_1,\dots,x_{n-1}$ with coefficients in $C^\infty(X)$, then $u \in C^m(I,\DD(V)^*)$.
\end{theorem}
\begin{proof}
    Indeed, allowing vector-valued inputs reduces us to the study of $m = 1$, i.e. $\partial u + a u = f$. Localizing if necessary, write $u = \sum_{|\alpha| \leq N} D^\alpha u_\alpha$, where $u_\alpha \in C(U)$, and $f = \sum_{|\alpha| \leq N} D^\alpha f_\alpha$, where $f_\alpha \in C(U)$, and this sum does not involve any derivatives in the $\alpha_n$ variable since $f$ is continuous in this variable. If $u_\alpha = 0$ for any $\alpha$ with $\alpha_n = 0$, then $u \in C(I,\DD(V)^*)$. Otherwise, suppose the sum defining $u$ contains at most $M$ derivatives in $x_n$. Then
    %
    \[ \partial_n u = f - a u = \sum D^\alpha f_\alpha - \sum a D^\alpha u_\alpha. \]
    %
    Moving $a$ into $D^\alpha u_\alpha$, and then anti-differentiating allows us to write the right hand side as
    %
    \[ \partial_n u = \partial_n ( \sum D^\beta g_\beta ) \]
    %
    where the inner sum contains at most $M-1$ derivatives in $x_n$. But we have already proved that $u - \sum D^\beta g_\beta$ is then an element of $C(I,\DD(V)^*)$. Applying induction on $n$ then reduces to the case above that $u \in C(I,\DD(V)^*)$, and this allows us to show that $\partial_n u = u - a f \in C(I,\DD(V)^*)$, so that $u \in C^1(I,\DD(V)^*)$.
\end{proof}

\section{Fundamental Solutions}

Let us now discuss the idea of a \emph{fundamental solution} to a partial differential equation, a technique very useful to the study of the existence and uniqueness of such equations. For any differential operator $L = \sum c_\alpha D^\alpha$ with constant coefficients, a \emph{fundamental solution} for $L$ is a distribution $E$ such that $LE = \delta$ is the Dirac delta function at the origin. The reason that fundamental solutions are so useful is that for any compactly supported distribution $v \in \mathcal{E}(\RR^d)^*$, the distribution $u = E * v$ is a distribution satisfying $L u = (L E) * v = \delta * v = v$. Thus fundamental solutions give rise to a natural right inverse to a differential operator.

\begin{example}
    Consider Poisson's equation $\Delta u = v$. To determine a fundamental solution, we note that since $\Delta$ is invariant under rotations, as is the Dirac delta, so we might also expect the fundamental solution to be radially symmetric. If $E(x) = f(|x|)$, then Laplace's equation tells us that for $r > 0$,
    %
    \[ f''(r) + \frac{n-1}{r} f'(r) = 0. \]
    %
    For $d > 2$, this implies that $f(r) = C_1 r^{2-n} + C_2$, and for $d = 2$, $f(r) = C_1 \log(r) + C_2$. We may assume without loss of generality that $C_2 = 0$, since this does not affect the value of $\Delta E$. The correct choice of $C_1$ gives the \emph{Poisson kernel}
    %
    \[ E(x) = \begin{cases} - (2\pi)^{-1} \log |x| &: \text{if $d = 2$} \\ \frac{-1}{c_d (d-2) |x|^{d-2}} &: \text{if $d > 2$.} \end{cases} \]
    %
    Here $c_d$ is the volume of the unit ball in $\RR^d$. To prove this, it suffices to show for any $\phi \in C_c^\infty(\RR^d)$,
    %
    \[ \phi(0) = \int \Phi(x) \Delta \phi(x)\; dx. \]
    %
    To prove this, since $\Phi$ is locally integrable, the left hand side is approximated (via Gauss' formula) as $\varepsilon \to 0$ by
    %
    \[ \int_{|x| \geq \varepsilon} \Phi(x) \Delta \phi(x)\; dx = \int_{|x| = \varepsilon} \Phi(x) [\nabla \phi(x) \cdot n(x)] dS - \int \nabla \Phi(x) \cdot \nabla \phi(x)\; dx. \]
    %
    Now a simple estimate gives that as $\varepsilon \to 0$,
    %
    \[ \int_{|x| = \varepsilon} \Phi(x) [\nabla \phi(x) \cdot n(x)] dS \to 0. \]
    %
    Thus we conclude that
    %
    \[ \int \Phi(x) \Delta \phi(x)\; dx = - \int \nabla \Phi(x) \cdot \nabla \phi(x)\; dx. \]
    %
    Again, we approximate away from the origin by a $\varepsilon$ ball, integrate by parts, and calculate that
    %
    \begin{align*}
        \int_{|x| \geq \varepsilon} \nabla E(x) \cdot \nabla \phi(x)\; dx &= \int_{|x| = \varepsilon} \phi(x)\ [\nabla E(x) \cdot n(x)] dS - \int_{|x| \geq \varepsilon} \Delta E(x) \phi(x)\; dx\\
        &= \int_{|x| = \varepsilon} \phi(x)\ [\nabla E(x) \cdot n(x)] dS.
    \end{align*}
    %
    For $d = 2$, we have $\nabla E(x) = (2 \pi)^{-1} x/|x|^2$, hence
    %
    \begin{align*}
        \int_{|x| = \varepsilon} \phi(x) [\nabla E(x) \cdot n(x)] dS &= (2 \pi)^{-1} \int_{|x| = \varepsilon} [\phi(0) + O(\varepsilon)] \cdot (1/\varepsilon)\\
        &= \phi(0) + O(\varepsilon).
    \end{align*}
    %
    For $d > 2$, $\nabla E(x) = (1/c_d) |x|^{-d} x$, so
    %
    \begin{align*}
        \int_{|x| = \varepsilon} \phi(x) [\nabla E(x) \cdot n(x)] dS &= (c_d \varepsilon^{d-1})^{-1} \int_{|x| = \varepsilon} \phi(x)\; dS\\
        &= \phi(0) + O(\varepsilon).
    \end{align*}
\end{example}

\begin{example}
    Consider the d'Alembertian equation $\Box f = \partial_t^2 f - \Delta_x f$. This equation is symmetric with respect to the family of Lorentz transformations, i.e. linear maps from $\RR_t \times \RR^d_x$ to itself preserving the Lorentz form $Q(t,x) = t^2 - |x|^2$. Since $\delta$ and $\Box$ are invariant under such transformations, we expect the fundamental solution of $\Box$ to also be invariant under these Lorentz transformations, i.e. $E(t,x) = f(t^2 - |x|^2)$. The d'Alembertian equation becomes $f''(s) + [(n+1)/2s] f'(s) = 0$, which has solution $f(s) = C_1 s^{(1-n)/2} + C_2$, where $C_1$ and $C_2$ are allowed to depend on $\text{sign}(s)$.

    This fundamental solution is \emph{not necessarily locally integrable} as $t \to 0$, and must be interpreted carefully by integrating first in $x$, then in $t$, i.e.
    %
    \[ \langle E, \phi \rangle = \int_0^\infty \int_{\RR^d} (4 \pi t)^{-d/2} (\det A)^{-1/2} e^{-x^T A^{-1} x / 4t} \phi(t,x) \; dx\; dt, \]
    %
    and interpreting the integral in $t$ as the limit of the integrals $\int_\delta^\infty$ as $\delta$ converges to zero from above. This actually gives us a distribution, because TODO
\end{example}

\begin{example}
    Consider the Cauchy-Riemann equations on $\RR^2$, i.e. the operators $\partial_z = (1/2)(\partial_x - i \partial_y)$ and $\partial_{\overline{z}} = (1/2)(\partial_x + i \partial_y)$. The divergence theorem tells us that
    % F = (phi/2, -i \phi / 2)
    \[ \int_\Omega \frac{\partial \phi}{\partial z}\; dx\; dy = \frac{1}{2} \int_{\partial \Omega} \phi\; d\overline{z} \]
    %
    and
    %
    \[ \int_\Omega \frac{\partial \phi}{\partial \overline{z}}\; dx\; dy = \frac{1}{2} \int_{\partial \Omega} \phi\; dz \]
    %
    The variant of Green's formula then tells us that
    %
    \[ \int_\Omega \left( u \frac{\partial v}{\partial z} + \frac{\partial u}{\partial z} v \right)\; dx\; dy = \frac{1}{2} \int_{\partial \Omega} uv\; d\overline{z}. \]
    %
    Thus the operators $\partial_z$ and $\partial_{\overline{z}}$ are self adjoint. In particular, applying this formula gives that for any $\phi \in C_c^\infty(\RR^2)$,
    %
    \begin{align*}
        \int_{|z| \geq \varepsilon} \frac{\partial \phi}{\partial \overline{z}} \left( \frac{1}{\pi i} \frac{1}{z} \right)\; dx\; dy &= \frac{1}{2 \pi i} \int_{|z| = \varepsilon} \frac{\phi}{z}\; dz\\
        &= \frac{1}{2 \pi} \int_0^{2\pi} \phi(\varepsilon e^{i \theta})\; d\theta\\
        &= \phi(0) + O(\varepsilon).
    \end{align*}
    %
    Taking $\varepsilon \to 0$ allows us to conclude that
    %
    \[ \Phi(x,y) = \frac{1}{i \pi} \frac{1}{x + iy} \]
    %
    is a fundamental solution to the operator $\partial_{\overline{z}}$. Similarily,
    %
    \[ \Phi(x,y) = \frac{1}{i \pi} \frac{1}{x - iy} \]
    %
    is a fundamental solution to the operator $\partial_z$. The first fundamental solution is called the \emph{Cauchy Kernel}.
\end{example}

\begin{example}
    Consider the heat equation $L = \partial_t - \Delta$. To find a fundamental solution $\Phi$, we may assume the distribution is tempered in $x$, and take the Fourier transform in $x$ of the equation $L \Phi = \delta$, obtaining that
    %
    \[ \partial_t (\mathcal{F}_x \Phi)(t,\xi) + 4 \pi^2 |\xi|^2 \mathcal{F}_x \Phi = \delta(t). \]
    %
    Solving this equation using usual techniques (e.g. integrating factors), gives that we can choose
    %
    \[ \mathcal{F}_x \Phi(t,\xi) = H(t) e^{- 4 \pi^2 |\xi|^2 t}, \]
    %
    where $H$ is the heaviside step function. The inverse Fourier transform thus gives that
    %
    \[ \Phi(t,x) = H(t) \cdot (4 \pi t)^{-d/2} e^{- |x|^2 / 4t}. \]
    %
    The fact that $\int \Phi(t,x)\; dx = 1$ for all $t > 0$ implies that $\Phi$ is a locally integrable function. It is simple to check (ala the method in the last example) that $\Phi$ is actually a fundamental solution to the equation.

    More generally, we might want to consider families of partial differential equations related to the heat equation, e.g. the Schr\"{o}dinger operator $L = \partial_t - i \Delta_x$, it is natural to consider th general family of partial differential equations of the form
    %
    \[ L = \partial_t - \sum A_{ij} \partial_i \partial_j, \]
    %
    where $A$ is a symmetric matrix. If we assume a tempered fundamental solution $\Phi$ exists in this case, then taking the Fourier transform again leads us to an equation of the form
    %
    \[ \mathcal{F}_x \Phi(t,\xi) = H(t) e^{- 4 \pi^2 t \xi^T A \xi}. \]
    %
    In order for this equation to be tempered in $x$, we need $\text{Re}(A)$ to be positive semidefinite. In addition, assuming $A$ is invertible, we have already calculated in the chapter on tempered distributions that
    %
    \[ \Phi(t,x) = \frac{H(t)}{(4 \pi t)^{n/2} \det(A)^{1/2}} e^{- (A^{-1} x) \cdot x/4t}. \]
    %
    If $\text{Re}(A) > 0$, then $\text{Re}(A^{-1}) > 0$, so $\Phi$ is integrable in $x$, and rescaling shows the equation is locally integrable in $x$ and $t$. Conversely, if $\text{Re}(A)$ is only positive semidefinite, then $\Phi$ need not be locally integrable, e.g. for the Schr\"{o}dinger equation we get
    %
    \[ \Phi(t,x) = \frac{H(t)}{(4 \pi i t)^{n/2}} e^{i |x|^2 / 4t } \]
    %
    and then $|\Phi(t,x)| = H(t) / (4 \pi t)^{n/2}$, which is not a locally integrable function. Nonetheless, the oscillation present here does allow us to interpret the distribution correctly, e.g. by interpreting $\Phi$ as the distribution such that the integral against any test function $\phi \in C_c^\infty(\RR \times \RR^d)$ is
    %
    \[ \lim_{\varepsilon \to 0^+} \int_\varepsilon^\infty \int_{\RR^d} \Phi(t,x) \phi(t,x)\; dx\; dt. \]
    %
    We claim that this is a distribution of order at most $n+1$. One way to do this is via the method of oscillatory integrals. First, assume that $\text{Re}(A^{-1}) = 0$, i.e. that $A^{-1} = -iB$, for some invertible matrix $B$. Then for any $\phi \in C_c^\infty(\RR \times \RR^d)$, and for any $t > 0$, stationary phase shows that if $\phi$ is supported on a compact set $K \subset \RR \times \RR^d$, then 
    %
    \begin{align*}
        \left| \int_{\RR^d} \Phi(t,x) \phi(t,x)\; dx \right| &\lesssim_A t^{-d/2} \left| \int_{\RR^d} e^{i (Bx) \cdot x /4t} \phi(t,x)\; dx \right|\\
        &\lesssim_{A,K} \| \nabla^{\leq 2}_x \phi \|_{L^\infty(K)},
    \end{align*}
    %
    This implies that the integral above converges as $\varepsilon \to 0$, and moreover, shows that $\Phi$ is a distribution of order two. Now certainly $L \Phi = 0$ away from the line $t = 0$. Now integrating by parts shows that
    %
    \begin{align*}
        \lim_{\varepsilon \to 0} \int_\varepsilon^\infty \int_{\RR^d} \Phi(t,x) (- \partial_t \phi(t,x) - \sum A_{ij} \partial_i \partial_j \phi(t,x)) = \lim_{\varepsilon \to 0} \int \Phi(\varepsilon,x) \phi(\varepsilon, \varepsilon^{1/2} x)\; dx.
    \end{align*}
    %
    Rescaling and applying stationary phase again implies that this quantity is equal to $\phi(0,0)$.
\end{example}

A simple consequence of the fundamental solution technique is the intriguing statement that \emph{any} distribution is a successive derivative of a family of continuous functions.

\begin{theorem}
    For any open set $U \subset \RR^n$, and any distribution $u \in \DD(U)^*$, there exists $f_\alpha \in C(U)$, such that the cover $\{ \text{supp}(f_\alpha) \}$ is locally finite on $U$, and such that $u = \sum_\alpha D^\alpha f_\alpha$.
\end{theorem}
\begin{proof}
    Suppose first that $U = \RR^n$. For any $m$, the function
    %
    \[ \Phi(x) = \max(x_1,0)^m \dots \max(x_n,0)^m / (m!)^n \]
    %
    is a fundamental solution to the operator $L = (\partial_1 \cdots \partial_n)^{m+1}$, and lies in $C^{m-1}(\RR^d)$. If $u$ is a distribution of order $m-1$, then it follows that $v = \Phi * u$ lies in $C(\RR^d)$, and $Lv = u$, which completes the proof in this case. In general, we just localize.
\end{proof}

Note that the fundamental solutions to the heat equation and Cauchy-Riemann equation are only singular at the origin. Here are several consequences to this property.

\begin{lemma}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\text{sing supp}(\Phi) = \{ 0 \}$. Then for any open set $U \subset \RR^n$, and any distribution $u$ on $U$, $\text{sing supp}(Lu) = \text{sing supp}(u)$. Thus any distribution $u$ on $U$ with $Lu = 0$ lies in $C^\infty(U)$. If $\{ u_n \}$ is a sequence of solutions to the equation $Lu = 0$, with $u_n \to u$ distributionally, then $u_n \to u$ in $C^\infty(U)$.
\end{lemma}
\begin{proof}
    It is simple to see that $\text{sing supp}(Lu) \subset \text{sing supp}(u)$. Conversely, fix a compact set $K \subset U$, and consider $\psi \in C_c^\infty(U)$ equal to one on a neighbourhood of $K$. Then for any distribution $u$ on $U$ with $Lu = 0$,
    %
    \begin{align*}
        K \cap \text{sing supp}(Lu) &= K \cap \text{sing supp}(L(\psi u))\\
        &= K \cap \text{sing supp}(\Phi * (\psi u))\\
        &= K \cap [\text{sing supp}(\Phi) + \text{sing supp}(\psi u)]\\
        &= K \cap \text{sing supp}(u).
    \end{align*}
    %
    The first part is therefore completed, since $K$ was arbitrary. Now given the Fr\'{e}chet space $X = \{ u \in \DD(U)^* : Lu = 0 \}$, we have a natural inclusion map $i: X \to C^\infty(U)$. It's graph is obvious closed, so by the closed graph theorem, this map is continuous, and this implies the sequence property above.
\end{proof}

The fundamental solutions above are actually better than just being smooth away from the origin, they are \emph{analytic} away from the origin. It will turn out that there is an analytic fundamental solution to any partial differential operator if and only if that operator is elliptic. Then the following lemma applies.

\begin{lemma}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\Phi$ is real analytic away from the origin. Then for any open set $U \subset \RR^n$, there is an open set $V \subset \CC^n$ such that if $u$ is a distribution on $U$, and $Lu = 0$, then $u$ is an analytic function extending to a complex analytic function on $V$. In particular, we conclude that if $u$ vanishes in a neighborhood of a point $x_0 \in U$, then $u$ vanishes on the connected component of $U$ containing $x_0$. Moreover, if $u_n$ is a sequence in $C^\infty(U)$ with $Lu_n = 0$, and with $u_n \to u$, then the extension of the functions $u_n$ to analytic functions on $V$ converge locally uniformly to the extension of $u$.
\end{lemma}
\begin{proof}
    Choose any open set $\RR^n - \{ 0 \} \subset V_0 \subset \CC^n$ such that $\Phi$ extends to a complex analytic function on $V_0$. Since the question is local, consider a compact set $K$, and $\psi \in C_c^\infty(U)$ equal to one on a neighborhood of $K$. Then for $x \in K$, we have
    %
    \[ u(x) = (\psi u)(x) = (\Phi * L(\psi u))(x) = \int \Phi(x-y) L(\psi u)(y)\; dy, \]
    %
    and this formula continues to define a complex analytic function if we replace $x$ with a complex parameter $z$ provided that for any $y \in \text{supp}(\nabla (\psi u))$, $z - y \in V_0$. This is a neighborhood of $K$. We can then perform this extension for many different choices of $\psi$, and thus of $K$, to show that $u$ extends to an analytic function on some set $V$ depending only on $U$. To get the latter part of the Lemma, we just apply the closed graph theorem.
\end{proof}

Let us now extend the approximation theorem of Runge to the case of general elliptic partial differential equations.

\begin{lemma}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\Phi$ is real analytic away from the origin. Consider two open sets $V \subset U \subset \RR^n$, such that $U - V$ does not have a compact connected component. Then every solution $v \in C^\infty(V)$ to the equation $Lv = 0$ is a limit in $C^\infty(V)$ of the restriction of solutions $u \in C^\infty(U)$ to the equation $Lu = 0$.
\end{lemma}
\begin{proof}
    By duality, it suffices to show that if $w$ is a compactly-supported distribution in $V$, and
    %
    \[ \int_V w(x) u(x)\; dx = 0\ \]
    %
    for any $u \in C^\infty(U)$ such that $Lu = 0$, then for any $v \in C^\infty(V)$ with $Lv = 0$,
    %
    \[ \int_V w(x) v(x)\; dx = 0. \]
    %
    If $L^*$ is the adjoint of the operator $L$, and we set $\Psi(x) = \Phi(-x)$, then $\Psi$ is an analytic fundamental solution to $L^*$. If we can show that $\Psi * w$ is a compactly supported distribution in $V$, then for any $v \in C^\infty(V)$ with $Lv = 0$,
    %
    \[ \int w(x) v(x)\; dx = \int L^* (\Psi * w)(x) v(x)\; dx = \int (\Psi * w)(x) Lv(x)\; dx = 0. \]
    %
    This would therefore complete the proof.

    Let $K$ denote the support of $w$. The distribution $\Psi * w$ is analytic function outside of $K$. Moreover, the support of $\Psi * w$ is certainly contained in $U$, because if $x \not \in U$, then the function $u(y) = \Psi(x-y)$ satisfies $Lu = 0$, and therefore by assumption on $w$, $(\Psi * w)(x) = 0$. Applying analyticity, it follows that $\Psi * w$ vanishes in every component of $K^c$ containing a point in $U^c$. We claim this is sufficient to prove the result. If $W$ is a bounded connected component of $K^c$ contained in $U$, then the set $W \cap V^c$ is a compact connected component of $U - V$. This contradicts the hypothesis of the Lemma, and therefore $W$ cannot exist. Because $K^c$ has at most one unbounded connected component, we conclude that the theorem is proved, except in the case where $U$ contains the unbounded connected component of $K^c$. We will address this case in two paragraphs. For now, note that this proves the theorem when $U$ is a open ball.

    Next, we address the case where $U = \RR^d$, and $V$ is a ball $B$, without loss of generality, centred at the origin. This is because if $v \in C^\infty(B)$ solves $Lv = 0$, then for each $k$, we can recursively find a sequence $u_{k,i} \in C^\infty(k B)$, such that $Lu_{k,i} = 0$, and such that $u_{1,i}$ converges to $v$ in $C^\infty(B)$ as $i \to \infty$, such that $\| u_{k+1,i} - u_{k,i} \|_{L^\infty(k B)} \leq 1/2^{k+i}$ for any $|\alpha| \leq k + i$. It follows that we can define $u_i \in C^\infty(\RR^d)$ as the pointwise limit of the functions $u_{k,i}$ (smooth because of analyticity). Then $Lu_i = 0$, and $u_i \to u$ in $C^\infty(B)$.

    Now returning to the general case of the proof, if $K$ is contained in a ball $B$ of radius $R$, then for $|x| > R$, the function $u_x(y) = \Phi(y-x)$ solves the equation $Lu = 0$ in $B$, and thus is the limit in $C^\infty(B)$ of functions $u_i$ solving $Lu_i = 0$ in $C^\infty(\RR^n)$. But then
    %
    \[ (\Phi * w)(x) = \int w(x) u(x)\; dx = \lim_{i \to \infty} \int w(x) u_i(x)\; dx = 0, \]
    %
    which completes the proof.
\end{proof}

\begin{remark}
    This result is \emph{only} possible given the topological hypothesis. Suppose the result is true, and $K$ is a compact connected component of $U - V$. If $u_i \in C^\infty(U)$ is a sequence of solutions to the equation $Lu_i = 0$ such that $u_i$ converges to a function $u \in C^\infty(V)$, then we claim that $u_i$ converges to some $u \in C^\infty(V \cup K)$. In particular, we conclude every solution on $C^\infty(V)$ extends to a solution on $C^\infty(V \cup K)$. This causes a contradiction, since if $x_0 \in K$, then the function $u(y) = \Phi(y - x_0)$ solves the equation on $V$, but cannot be extended to a solution on $V \cup K$ (e.g. because any such solution would be analytic).

    Let us now prove that $u$ can be extended under our assumptions. If we consider $\phi \in C_c^\infty(V \cup K)$ equal to one on a neighborhood $W$ of $K$, then $L(\phi u_i)$ vanishes on $W$, and hence is supported in $V$. Since $u_i$ converges to $u$ in $V$, so $L(\phi u_i)$ converges to $Lu$ in $V \cup K$, and this means that $u_i = \Phi * L(\phi u_i)$ converges in $C^\infty(V \cup K)$ to some function $u$ in $C^\infty(V \cup K)$, which completes the proof of our claim.
\end{remark}

Using Runge's approximation theorem, we can now finally prove our first major existence theorem for partial differential equations on proper subsets $U$ of $\RR^n$, assuming the existence of a fundamental solution (i.e. the existence of solutions to the equation $Lu = f$ for compactly supported distributions $f$ on $\RR^n$. To obtain the idea of the proof of the existence of solutions to the equation $Lu = f$, for a distribution $f$ on $U$ (not necessarily compactly supported), imagine that such a solution $u$ existed. For any $\phi \in C_c^\infty(U)$ equal to one on some open set $W$, we can find a distribution $u_W$ such that $L(u_W) = \phi f$. Then $L(u - u_W) = 0$ on $W$, which implies that $u - u_W$ is analytic on $W$. If $u_V - u_W = 0$ on $V \cap W$ for any $V,W \subset U$, these solutions would combine to give us a choice of $u$ on the whole domain. Instead, we only have $u_V - u_W$ \emph{analytic} on $V \cap W$. The Runge approximation theorem will enable us to adjust these functions so that $u_V - u_W$ is \emph{almost} equal to zero, and then we can take limits.

\begin{theorem}
    Suppose $\Phi$ is a fundamental solution to a constant coefficient partial differential operator $L$ on $\RR^n$, and suppose that $\Phi$ is real analytic away from the origin. Then for any open set $U$ in $\RR^n$, and any distribution $f \in \DD(U)^*$, then there exists $u \in \DD(U)^*$ such that $Lu = f$.
\end{theorem}
\begin{proof}
    Let $U_R = \{ x \in U: |x| < R\ \text{and}\ d(x,U^c) > 1/R \}$. Then we can apply Runge's approximation theorem for $U_R \subset U$. We leave this proof of this to the end for it is fairly technical and unenlightening. Now if $\phi_i \in C_c^\infty(U)$ equals one on $U_i$, we set $u_i = \Phi * (\phi_i f)$. Then $Lu_i = \phi_i f$, in particular, $Lu_i = f$ on $U_i$. It suffices to modify $u_i$ so that it converges distributionally to some function $u$, since it will then follow that $Lu = f$ on $U$. we note that $L(u_{i+1} - u_i) = 0$ in $U_i$. Thus Runge's theorem implies that there exists an analytic function $w_i$ defined on $U$ such that $\| (u_{i+1} - u_i) - w_i \|_{L^\infty(U_i)} \leq 1/2^i$. But then if we define $v_i = u_i - w_1 - \dots - w_{i-1}$, then $Lv_i = \phi_i f$ on $U$, and
    %
    \[ \| v_{i+1} - v_i \|_{L^\infty(U_i)} = \| (u_{i+1} - u_i) - w_i \|_{L^\infty(U_i)} \leq 1/2^i, \]
    %
    which implies the required convergence property.

    To show that $U - U_R$ has no compact connected components, consider a potential compact connected component $K$ of $U - U_R$. If $B_R$ is the ball of radius $R$ centred at the origin, $K \cap B_R^c$ is compact. It is also open in $B_R^c$, because we can write $K = V \cap U \cap U_R^c$ for some open set $V$, and then $K \cap B_R^c = V \cap U \cap U_R^c \cap B_R^c = V \cap U \cap B_R^c$ since $U_R \subset B_R$, and $U$ and $V$ are both open. But this means that $K \cap B_R^c = \emptyset$, i.e. $K \subset B_R$. Next, we claim $d(x,y) > 1/R$ for any $y \in U^c$. Otherwise, take $y$ with $d(x,y) \leq 1/R$, and consider the line segment $L$ between $x$ and $y$. Since $U^c$ is closed, we may assume without loss of generality (by picking the closest point in $U^c$ to $x$ on the line and replacing $y$ with it), that $L \cap U^c = \{ y \}$. Since $x \not \in U_R$, and $d(x_1,y) < 1/R$ for any other point $x_1$ on the line, $L \cap U_R = \emptyset$. Thus $L - \{ y \} \subset U - U_R$. But $L - \{ y \}$ is connected and contains $x \in K$, so $L - \{ y \} \subset K$. But this is impossible for it implies that $\partial K$ contains $y$, which is not an element of $K$, so $K$ cannot be closed. Put together, this means that for any $x \in K$, $d(x,U^c) = 1/R$. But then it is impossible for $K$ to be an open subset of $U - U_R$, so $K$ cannot exist.
\end{proof}








\chapter{Symbol Classes}

In various settings in harmonic analysis, especially generalizations of settings where \emph{homogeneous functions} are prime examples under study, it is useful to study various \emph{symbol classes}. For instance, pseudodifferential operators historically dealt with operators $a(x,D)$, where $a$ is a function defined by a sum of homogeneous functions of various orders in the frequency variables. If the highest degree of the terms in the sum was $\alpha$, then for any $N$ and $M$, $\nabla^N_x \nabla^M_\theta a(x,\theta)$ is a sum of homogeneous functions, with highest degree $\alpha - M$. Thus we have bounds of the form
%
\[ | \nabla^N_x \nabla^M_\theta a(x,\theta) | \lesssim \langle \theta \rangle^{\alpha - M}. \]
%
Given $d$, $p$, and an open subset $U$ of $\RR^d$, we define the symbol class $\mathcal{S}^\alpha(U \times \RR^p)$ \emph{of order $\alpha$} as consisting of all functions $a \in C^\infty(U \times \RR^p)$ such that
%
\[ |\nabla^N_x \nabla^M_\theta a(x,\theta)| \lesssim_{N,M} \langle \theta \rangle^{\alpha - M} \]
%
holds \emph{uniformly} in $x$. We take the optimal constants in these inequalities as a family of seminorms which gives $\mathcal{S}^\alpha(U \times \RR^p)$ the structure of a Frech\'{e}t space. The family of functions for which these bounds hold \emph{locally uniformly} in $x$ form the family of symbols $\mathcal{S}^\alpha_{\text{loc}}(U \times \RR^p)$.

The classes $\mathcal{S}^\alpha(U \times \RR^p)$ are decreasing as $\alpha \to -\infty$, and we define $\mathcal{S}^{-\infty}(U \times \RR^p)$ to be the intersection of all these classes of symbols. Operators defined by such functions are often highly regular. For instance, a pseudodifferential operator defined by such a symbol is called a \emph{smoothing operator}, and maps any compactly supported distribution to a smooth function. The class $\mathcal{S}^{-\infty}(U \times \RR^p)$ is dense in any of the classes $\mathcal{S}^\alpha(U \times \RR^p)$, since it contains any symbol compactly supported in $\theta$, and we can take cutoffs as $\theta \to \infty$.

A useful strategy to understand a symbol is to break it down into an asymptotic series of simpler symbols. Suppose $\{ a_n \}$ is a sequence of symbols, then we write
%
\[ a \sim \sum_{n = 0}^\infty a_n \]
%
for some symbol $a$, if for any $\alpha \in \RR$, there exists $N_0$ such that for $N \geq N_0$, $a - \sum_{n = 0}^N a_n$ is a symbol of order $\alpha$. If $a_n$ is a symbol of order $\alpha_n$, and $\lim_{n \to \infty} \alpha_n = -\infty$, then a symbol $a$ always exists satisfying these asymptotics.

\begin{theorem}
    Consider a sequence of symbols $\{ a_n \}$, with $a_n \in \mathcal{S}^{\alpha_n}(U \times \RR^p)$, where $\lim_{n \to \infty} a_n = -\infty$, and let $\alpha = \max \alpha_n$. Then there exists a symbol $a \in \mathcal{S}^\alpha(U \times \RR^p)$ such that $a \sim \sum a_n$.
\end{theorem}
\begin{proof}
    Fix a bump function $\phi \in \DD(\RR^p)$ equal to 0 when $|x| \leq 1/2$, and equal to one when $|x| \geq 1$. Find a rapidly increasing sequence $\{ r_n \}$ such that
    %
    \[ | \nabla_x^j \nabla_\lambda^k \{ \phi( \theta / r_n ) a_n(x,\theta) \} | \leq 2^{-n} \langle \theta \rangle^{\alpha_n + 1 - k} \]
    %
    for $x \in U$, where $i,j \leq n$. We define
    %
    \[ a(x,\theta) = \sum_{n = 0}^\infty \phi(\theta / r_n) \cdot a_n(x,\theta), \]
    %
    which is smooth, since it is a locally finite sum. For any $N$, if we set
    %
    \[ R_N(x,\theta) = \sum_{n = N}^\infty \phi(\theta / r_n) \cdot a_n(x,\theta), \]
    %
    then
    %
    \[ a - \sum_{n = 0}^{N-1} a_n = \sum_{n = 0}^{N-1} (\phi(\theta/r_n) - 1) a_n(x,\theta) + R_N(x,\theta) \]
    %
    If $x \in U$, we find that
    %
    \[ | \nabla_x^j \nabla_\lambda^k R_N(x,\theta) | \lesssim_{N,i,j} \langle \theta \rangle^{\max_{n \geq N} \alpha_n + 1 - k}. \]
    %
    Thus $R_N \in \mathcal{S}^{\beta_N}(U \times \RR^p)$, where $\beta_N = \max_{n \geq N} \alpha_n + 1$. On the other hand,
    %
    \[ E_N(x,\theta) = \sum_{n = 0}^{N-1} (\phi(\theta/r_n) - 1) a_n(x,\theta) \]
    %
    vanishes for $|\theta| \geq r_n$, and is thus compactly supported in $\theta$, which implies that $E_N \in \mathcal{S}^{-\infty}(U \times \RR^p)$.
\end{proof}

\begin{remark}
    A similar formula holds for local families of symbols.
\end{remark}

To verify asymptotic formulae, the following Lemma is often helpful.

\begin{lemma}
    Suppose $a \in C^\infty(U \times \RR^p)$, and for any $n,m > 0$, there exists $\alpha_{nm}$ such that
    %
    \[ |\nabla^n_x \nabla^m_\theta a(x,\theta)| \lesssim_{n,m} \langle \theta \rangle^{\alpha_{nm}}. \]
    %
    If, for any $\alpha \in \RR$,
    %
    \[ |a(x,\theta)| \lesssim_\alpha \langle \theta \rangle^\alpha, \]
    %
    then $a \in \mathcal{S}^{-\infty}(U \times \RR^p)$.
\end{lemma}
\begin{proof}
    We begin by showing that if $f \in C^2(\RR)$, $\| f \|_{L^\infty(\RR)} \leq A$, and $\| f'' \|_{L^\infty(\RR)} \leq B$, then $\| f' \|_{L^\infty(\RR)} \leq \sqrt{2AB}$. this follows because for any $x$, and $\varepsilon > 0$, there exists $\theta_1$ lying between $x$ and $x - \varepsilon$ such that
    %
    \[ f(x) - f(x-\varepsilon) = \varepsilon f'(x) + \varepsilon^2 f''(\theta_1) / 2 \]
    %
    and $\theta_2$ lying between $x$ and $x + \varepsilon$ such that
    %
    \[ f(x + \varepsilon) - f(x) = \varepsilon f'(x) + \varepsilon^2 f''(\theta_2)/2. \]
    %
    Thus
    %
    \[ f(x+\varepsilon) - f(x-\varepsilon) = 2 \varepsilon f'(x) + \varepsilon^2 / 2 (f''(\theta_1) + f''(\theta_2)). \]
    %
    Rearranging gives
    %
    \[ f'(x) = (f(x+\varepsilon) - f(x-\varepsilon))/2 \varepsilon - (\varepsilon / 4)(f''(\theta_1) + f''(\theta_2)), \]
    %
    and thus
    %
    \[ |f'(x)| \leq A/\varepsilon + B \varepsilon / 2. \]
    %
    Taking $\varepsilon = \sqrt{2A/B}$ completes the proof.

    It follows from this that if $K$ and $K'$ are compact sets, with $K$ contained in the interior of $K'$, then
    %
    \[ \| \nabla_\theta \phi \|_{L^\infty(K)} \lesssim_K \sqrt{\| \phi \|_{L^\infty(K')} \| \nabla_\theta^2 \phi \|_{L^\infty(K'')} }. \]
    %
    The theorem then follows by successively differentiating in $\theta$.
\end{proof}

\begin{corollary}
    Suppose $\{ a_n \}$ are a family of symbols, with $a_n \in \mathcal{S}^{\alpha_n}(U \times \RR^p)$ for each $n$, and $\lim_{n \to \infty} \alpha_n = -\infty$. Then if $a \in C^\infty(U \times \RR^p)$, and for each $N$ and $M$, there exists $\alpha_{NM}$ such that
    %
    \[ |\nabla^N_x \nabla^M_\theta a(x,\theta)| \lesssim \langle \theta \rangle^{\alpha_{NM}}. \]
    %
    If for each $n$, there exists $\beta_n$ such that
    %
    \[ |a(x,\theta) - \sum_{k = 0}^n a_n(x,\theta)| \lesssim_n \langle \theta \rangle^{\beta_n}, \]
    %
    and $\lim_{n \to \infty} \beta_n = -\infty$, then $a \sim \sum a_n$.
\end{corollary}

Sometimes one has to use more powerful notions of homogeneity than the simple decay estimates above. In this case, it is useful to focus on \emph{classical symbols}, i.e. symbols which satisfy an asymptotic formula of the form
%
\[ a(x,\theta) \sim \sum_{n = 0}^\infty a_{t-n}(x,\theta), \]
%
where $a_{t-n} \in S^{\text{Re}(t) - n}(U \times \RR^p)$ is homogeneous of degree $t-n$ in the $\theta$ variables for suitably large $\theta$ (the symbol must be smooth, and so cannot be homogeneous for small $\theta$ unless it is a polynomial). We denote the class of such symbols of order $\alpha$ by $\mathcal{S}^t_{\text{cl}}(U \times \RR^p)$. Sometimes this class is also called the class of \emph{polyhomogeneous symbols}, and denoted $\mathcal{S}^t_{\text{phg}(U \times \RR^p)}$. We can also consider polyhomogeneous symbols with non integer step sizes, i.e. the class $\mathcal{S}^{t,h}_{\text{phg}}(U \times \RR^p)$, i.e. those symbols that satisfy an asymptotic expansion of the form
%
\[ a(x,\theta) \sim \sum_{n = 0}^\infty a_{t - hn}(x,\theta) \]
%
where $a_{t-hn} \in S^{\text{Re}(t) - hn}(U \times \RR^p)$ is homogeneous of degree $t-hn$.

\begin{remark}
    Let $M$ be a manifold, and let $E$ be a vector bundle over $M$. We can define the space $\mathcal{S}^t_{\text{loc}}(E)$ of symbols of order $t$ on $E$ to be the family of all scalar functions $a$ on $E$ which are symbols of order $t$ in local coordinates. These have a very similar theory of the theory we have expounded above. In particular, one can consider asymptotic developments of symbols.
\end{remark}












\chapter{Pseudodifferential Operators}

The goal of this chapter is to define the calculus of pseudodifferential operators, a general family of operators which allows us to \emph{locally} manipulate the spatial and frequential properties of functions simultaneously. It is impossible to do this completely locally because of the uncertainty principle, but one can do things \emph{pseudolocally}, i.e. the position of the support in time and space is approximately preserved, up to a rapidly decaying error. Roughly speaking, we will define a family of operators $a(x,D)$, associated with functions $a(x,\xi)$, such that if the support of a function $f$ is concentrated near a point $x_0$, and the support of $\widehat{a}$ is concentrated near $\xi_0$, then we will find $a(x,D) f \approx a(x_0,\xi_0) f$. Before we begin, let us consider some basic examples that allow us to control space or time exclusively, to get an idea of what we want out of such a theory.

The most basic spatial multipliers in analysis are the \emph{position operators}, which are the family of unbounded operators $X^\alpha: \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$, defined by setting
%
\[ X^\alpha f(x) = x^\alpha f(x), \]
%
and the most basic Fourier multipliers are the \emph{momentum operators} $D^\alpha: \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$, defined by setting
%
\[ D^\alpha f(x) = \frac{1}{(2\pi i)^{|\alpha|}} \cdot \partial^\alpha f(x). \]
%
For each $m \in C^\infty(\RR^d)$ such that all of it's derivatives are slowly increasing, we can define a bounded operator $m(X): \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$ by setting
%
\[ m(X) f(x) = m(x) f(x). \]
%
Under the same conditions as for $m(X)$, we can define an operator $m(D): \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)$ by setting
%
\[ \widehat{m(D) f}(\xi) = m(\xi) \widehat{f}(\xi). \]
%
Thus we have found two homomorphisms from a ring of smooth functions on $\RR^d$ to the ring of bounded operators on the space of Schwartz functions.

The family of such operators is very useful in analysis, since families of functions are more amenable to intuition than families of operators, and we ask questions such as what features of the functions $m$ imply about the resulting operators $m(D)$. Any \emph{constant coefficient} linear differential operator can be represented as $m(D)$ for a suitable polynomial $m(x)$, which allows us to use these results in the regularity theory of partial differential equations. As a quick example of the utility of the calculus, given an \emph{elliptic} order $k$ differential operator $L = \sum c_\alpha D^\alpha$, i.e. an operator such that the homogeneous polynomial $\sum_{|\alpha| = k} c_\alpha \xi^\alpha$ has no zeroes except when $\xi = 0$, there exists $R > 0$ such that the associated multiplier $m(\xi) = \sum c_\alpha \xi^\alpha$ satisfies a bound $|m(\xi)| \gtrsim |\xi|^k$ for $|\xi| \geq R$. If $\eta(\xi)$ is a smooth cutoff supported on $|\xi| \geq R$ and equal to one for $|\xi| \geq 2R$, and if we consider the operator $S = (\eta / m)(D)$, then the symbolic calculus of multiplier operators tells us that $S \circ L - 1$ is a multiplier with a smooth, compactly supported symbol $\eta(\xi) - 1$. This means we have found a \emph{parametrix} for the operator $L$, i.e. an operator $S$ which gives an \emph{approximate inverse} for $L$, such that for any tempered distribution $u$,
%
\[ (S \circ L) u(x) = u(x) + (\psi * u)(x), \]
%
where $\psi$ is a Schwartz distribution. One can imagine this is very useful in the analysis of the PDE $L$. For instance, this construction implies that for any elliptic operator $L$, and any compactly supported distribution $u \in \mathcal{E}^*(\RR^d)$, $\text{WF}(Lu) = \text{WF}(u)$. One motivation for constructing a symbolic calculus for both families of operators simultaneously is to construct parametrices for elliptic differential operators with \emph{non constant coefficients}.

From a more general perspective, the process above is just a special case of the \emph{spectral calculus}, whose goal, for a suitable family of normal operators $A$, produces an isomorphism of $A$ with an algebra of functions on some space $X$, called the \emph{spectrum} of $A$. A natural question is whether we can obtain such a calculus for the family of all operators formed from combinations of the multiplication \emph{and} differentiation operators. This would, in particular, enable us to analyze arbitrary \emph{non constant coefficient} linear differential operators. However, we quickly see that such a theory would not quite work in as standard a way as the spectral calculus provides, because the families of operators $\{ X^\alpha \}$ and $\{ D^\alpha \}$ do \emph{not} commute with one another, i.e. the chain rule implies that $[D^i,X^j] = D^iX^j - X^iD^j = \delta_{ij} \cdot I$. The key thing to notice, that will enable us to obtain a partial spectral theory of such operators, is that these operators commute 'up to lower order terms'. In particular, if we think of $X^\alpha$ and $D^\alpha$ as being operators of \emph{order $|\alpha|$}, then $[D^\alpha,X^\beta]$ is equal to zero, modulo \emph{modulo terms of order $|\alpha| + |\beta| - 1$}. The fact that these operators commute 'up to lower order terms' is what will enable us to obtain a well defined functional calculus combining these two families, the \emph{calculus of pseudodifferential operators}. We will associate, with each suitably regular function $a(x,\xi)$, an operator $a(x,D)$, which is a homomorphism 'modulo lower order terms'.

This association will have the property that if $a(x,\xi) = \sum c_\alpha(x) \xi^\alpha$, then $a(x,D)$ will be the differential operator $\sum c_\alpha(x) D^\alpha$ (this is where the notation $a(x,D)$ comes from). The association will also generalize the two families of multiplier operators; if $a(x,\xi) = m(x)$, then $a(x,D)$ is equal to $m(X)$, and if $a(x,\xi) = m(\xi)$, then $a(x,D)$ is equal to $m(D)$. To get an idea for what this operator should look like, we calculate that if $a(x,\xi) = \sum_\alpha c_\alpha(x) \xi^\alpha$ is the symbol of a differential operator with nonconstant coefficients, then the corresponding differential operator satisfies
%
\begin{align*}
    a(x,D) f &= \sum c_\alpha(x) D^\alpha f(x)\\
    &= \int_{\RR^d} \sum_\alpha c_\alpha(x) \xi^\alpha \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi\\
    &= \int_{\RR^d} a(x,\xi) e^{2 \pi i \xi \cdot x} \widehat{f}(\xi)\; d\xi.
\end{align*}
%
We use this integral formula to define the general operators $a(x,D)$. In the most general setting, for any distribution $a \in \mathcal{D}(\RR^d \times \RR^d)^*$, and any $f \in \mathcal{S}(\RR^d)$ such that $\widehat{f} \in C_c^\infty(\RR^d)$, we can define $a(x,D) f$ to be the distribution such that for $g \in C_c^\infty(\RR^d)$,
%
\[ \langle a(x,D) f, g \rangle = \langle a, \widehat{f} \otimes g \rangle = \int a(x,\xi) \widehat{f}(\xi) g(x)\; d\xi\; dx. \]
%
We call any operator $T$ which can be given in the form $a(x,D)$ a \emph{pseudodifferential operator}. The symbol $a$ is unique, which essentially follows because $\DD(\RR^d) \otimes \DD(\RR^d)$ is dense in $\DD(\RR^d \times \RR^d)$. For any set $S$ of distributions on $\RR^d \times \RR^d$, the notation $\text{Op}(S)$ is often used to denote the family of all pseudodifferential operators defined by an element of $S$.

\begin{example}
    Consider the Laplacian $\Delta$ on $\RR^n$. Then $\Delta$ is the pseudodifferential operator on $\RR^n$ of order two, corresponding to the symbol $a(x,\xi) = - 4\pi^2 |\xi|^2$. Since $\Delta$ is a constant coefficient operator, it just acts as a Fourier multiplier. If $\Delta u = f$, then, modulo a harmonic function, which is arbitrarily smooth, $u = \Phi * f$, where $\Phi$ is a fundamental solution to the Laplacian. The operator $f \mapsto \Phi * f$ is a pseudodifferential operator with symbol $b(x,\xi) = \text{f.p}(1/4\pi^2 |\xi|^2)$. 
\end{example}

Any pseudodifferential operator is continuous from $\DD(\RR^d)^\ft$ to $\DD(\RR^d)^*$, and has kernel
%
\[ K_a(x,y) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi, \]
%
where in general the oscillatory integral must be interpreted formally. It is also useful to write this kernel in the form $k_a(x,z) = K_a(x,x-z)$, because we then have
%
\[ Tf(x) = \int k_a(x,z) f(x-z)\; dz, \]
%
which reflects the fact that when $a(x,\xi)$ is independant of $x$, $k_a$ is a function of $z$, and then $Tf = k_a * f$ is a convolution operator. As we increase the regularity of $a$, we no longer need to treat this integral quite as formally, and can define the operator for a more general family of functions. Here are some non-comprehensive examples of this phenomenon:
%
\begin{itemize}
    \item If $a$ is a tempered distribution, then $a(x,D)$ extends to a continuous linear operator from $\mathcal{S}(\RR^d)$ to $\mathcal{S}(\RR^d)^*$. The Schwartz kernel theorem implies that any continuous linear operator from $\mathcal{S}(\RR^d)$ to $\mathcal{S}(\RR^d)^*$ is of this form.

    \item If $a$ is a local symbol of order $t$ on $\RR^d \times \RR^d$, i.e. $a \in \mathcal{S}^t_{\text{loc}}(\RR^d \times \RR^d)$, then $a(x,D)$ extends to a continuous operator from $\mathcal{E}(\RR^d)^*$ to $\DD(\RR^d)^*$.

    \item If $a$ is a symbol of order $t$ on $\RR^d \times \RR^d$ for some $t$, i.e. $a \in \mathcal{S}^t(\RR^d \times \RR^d)$, then $a(x,D)$ extends to a continuous operator from $C_c^\infty(\RR^d)$ to $\mathcal{S}(\RR^d)$.

    \item If $a \in \mathcal{S}^{-\infty}_{\text{loc}}(\RR^d \times \RR^d) = \lim_{t \to -\infty} \mathcal{S}^t_{\text{loc}}(\RR^d \times \RR^d)$, then we will see later in this chapter that $a(x,D)$ has a kernel in $C^\infty(\RR^d \times \RR^d)$, and extends uniquely to a continuous operator from $\mathcal{E}(\RR^d)^*$ to $C^\infty_{\text{loc}}(\RR^d)$. We call these operators \emph{smoothing operators}.
\end{itemize}
%
We will mostly focus on pseudodifferential operators defined by various symbol classes, which will give us a more sophisticated calculus.

\section{Basic Definitions}

Consider any symbol $a \in \mathcal{S}^t(\RR^d \times \RR^d)$, i.e. a smooth function $a \in C^\infty(\RR^d \times \RR^d)$ such that for any $n_1,n_2,m \geq 0$,
%
\[ |\nabla_x^{n_1} \nabla_y^{n_2} \nabla_\xi^m a(x,\xi)| \lesssim_{n,m} \langle \xi \rangle^{t - m}, \]
%
where the implicit constant is \emph{uniform} in $x$. We call such a function a \emph{symbol} of order $t$, and denote the family of such symbols by $\mathcal{S}^t(\RR^d \times \RR^d)$. From this function, we can define a continuous operator $T_a: \mathcal{S}(\RR^d) \to C^\infty_{\text{loc}}(\RR^d)$ by setting
%
\[ T_a f(x) = \int a(x,\xi) e^{2 \pi i \xi \cdot x} \widehat{f}(\xi)\; d\xi, \]
%
which is a function lying in $C^\infty_{\text{loc}}(\RR^d)$ because $\widehat{f}$ is rapidly decaying, and we can interpret the integral above as the usual Riemann / Lebesgue integral.

To actually recover the symbol from an operator, we have several methods. Formally, we can calculate that
%
\[ a(x,\xi) = e^{-2 \pi i \xi \cdot x} T_a(e^{2 \pi i \xi \cdot y}). \]
%
Equivalently, but less formally, if $\psi \in \DD(\RR^d)$, $\widehat{\psi}(0) = 1$, then the Fourier inversion formula implies that
%
\[ a(x,\xi) = \lim_{R \to \infty} \text{Mod}_{-\xi} T_a(\text{Mod}_{\xi} \text{Dil}_R \psi) (x). \]
%
We may write the formula above as
%
\[ a(x,\xi) = \int K_a(x,y) e^{2 \pi i \xi \cdot (y-x)}\; dy = \int k_a(x,z) e^{-2 \pi i \xi \cdot z}, \]
%
which is sometimes useful, because it reduces the calculation of the symbol $a(x,\xi)$ to the calculation of the Fourier transform of $k_a(x,z)$ in the $z$ variable.

The kernel of a pseudodifferential operator given by a symbol $a(x,\xi)$ of the class above is given by
%
\[ K_a(x,y) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi \]
%
defined by an oscillatory integral distribution of the form we have discussed previously. In particular, we know from that discussion that
%
\[ \text{WF}(K_a) \subset \{ (x,x;\xi,\xi) : x, \xi \in \RR^d \}. \]
%
This means that we can actually define $T_a u$ for \emph{any} compactly supported distribution $u$, and we will find that $\text{WF}(T_a u) \subset \text{WF}(u)$. This is the first instance of the \emph{pseudolocal nature} of pseudodifferential operators; these operators roughly preserve the location of the mass and frequency support of a function, but with some additional `fuzz' that is usually neglible to the problem, but must be managed. Here is a quantitative estimate on the kernel showing the pseudolocal nature, which implies that $T_a f$ is a \emph{Schwartz function} whenever $f$ is Schwartz.

The wavefront set calculation implies that $K_a$ agrees with a $C^\infty$ function away from the line $x = y$, and so $k_a$ agrees with a $C^\infty$ function away from the line $z = 0$. Thus if $f \in C_c^\infty(\RR^d)$, and $x \not \in \text{supp}(f)$, then the multiplication formula for tempered distributions implies that
%
\[ T_af(x) = \int a(x,\xi) \widehat{f}(\xi) e^{2 \pi i \xi \cdot x}\; d\xi = \int k_a(x,z) f(x-z)\; dz, \]
%
where, since the integral on the right hand side vanishes in a neighborhood of $z = 0$, we can actually interpret the right hand integral as a Lebesgue integral against a smooth function rather than a formal integral. Moreover, we have even better estimates for the behaviour of $k_a$ away from the origin, which reflects the pseudolocal behaviour of the operator.

\begin{theorem}
    Let $K$ be the kernel given by a pseudodifferential operator of order $t$. Then for any non-negative integers $n_1$, $n_2$, and $N$, $K$ is a smooth function away from $z = 0$, and
    %
    \[ |\nabla^{n_1}_x \nabla^{n_2}_z k_a(x,z)| \lesssim_{n_1,n_2,N} \frac{1}{|z|^{t + d + n_2 + N}}, \]
    %
    provided $t + d + n_2 + N \geq 0$.
\end{theorem}
\begin{proof}
    If $\text{supp}_\xi(a)$ is compact, then because $k_a$ is the Fourier transform of $a$ in the $\xi$ variable, we conclude that for any $N \geq 0$,
    %
    \[ |\nabla^{n_1}_x \nabla^{n_2}_z k_a(x,z)| \lesssim_N 1 / |z|^N, \]
    %
    so the case is easy. Thus, without loss of generality, in the remainder of the proof we may assume $a(x,\xi) = 0$ for $|\xi| \leq 1$. We can then perform a Littlewood-Paley decomposition, i.e. writing
    %
    \[ a(x,\xi) = \sum_{n = 0}^\infty a_n(x,y,\xi), \]
    %
    where $a_n$ is supported on $|\xi| \sim 2^n$. If $K_n$ is the kernel of the pseudodifferential operator corresponding to $a_n$, then
    %
    \[ k(x,z) = \sum_{n = -\infty}^\infty k_n(x,z). \]
    %
    We claim that
    %
    \[ |\nabla^{n_1}_x \nabla^{n_2}_z k_n(x,z)| \lesssim_{n,n_1,n_2,N} |z|^{-N} 2^{n(t + d + n_2 - N)}. \]
    %
    This follows from a simple integration by parts, applied to the integral
    %
    \[ k_n(x,z) = \int \rho(\xi / 2^n) a(x,\xi) e^{2 \pi i \xi \cdot z}\; d\xi. \]
    %
    Summing up these bounds for sufficiently large $N$ gives the result for $|z| \geq 1$ (since for these values of $x$ and $y$ bounds for large $N$ imply bounds for small $N$). For $0 < |z| \leq 1$, we break the sum into two parts, i.e. writing
    %
    \[ k(x,z) = \sum_{2^n \leq 1/|x-y|} k_n(x,z) + \sum_{2^n > 1/|x-y|} k_n(x,z). \]
    %
    For the first sum, we take $N = 0$, and for the second sum, we take $N > t + d + n_2$, which gives the required bounds.
\end{proof}

For $t < 0$, this bound characterizes those kernels $k_a$ of pseudodifferential operators of order $t$.

\begin{lemma}
    Let $T: \mathcal{S}(\RR^d) \to \mathcal{S}(\RR^d)^*$ be an operator with Schwartz convolution kernel $k \in \mathcal{S}(\RR^d \times \RR^d)^*$, which agrees with a $C^\infty$ function away from the plane $\{ z = 0 \}$, such that for some $t < 0$, and any indices $n_1,n_2,N \geq 0$, the kernel $k$ satisfies the growth condition
    %
    \[ \sup \left\{ |z|^{t + d + n_2 + N} |\nabla^{n_1}_x \nabla^{n_2}_z k(x,z)| : x \in \RR^d, z \in \RR^d - \{ 0 \} \right\} < \infty. \]
    %
    This implies that for each $\phi \in C_c^\infty(\RR^d)$, the limit
    %
    \[ \lim_{\varepsilon \to 0^+} \int_{|z| > \varepsilon} k(x,z) \phi(z)\; dz \]
    %
    exists, and we assume that this is equal to

    Then $k$ is the kernel of some pseudodifferential operator of order $t$. If $t \geq 0$, and $k$ satisfies the inequalities above, and in addition, for any bounded subset $\mathcal{B}$ of $C_c^\infty(\RR^d)$, satisfies the \emph{cancellation conditions}
    %
    \[ \sup \left\{ R^{-t} \left| \int D^\alpha_x k(x,z) \cdot \phi(z/R)\; dz \right| : x \in \RR^d, z \in \RR^d - \{ 0 \}, \phi \in \mathcal{B} \right\} < \infty, \]
    %
    where the implicit constant is a continuous seminorm on $C_c^\infty(\RR^d)$ for each multi-index $\alpha$, then $k$ is the kernel of some pseudodifferential operator of order $t$.
\end{lemma}
\begin{proof}
    For $t < 0$, we make the family of all such kernels above into a Fr\'{e}chet space $X_t$ by taking the optimal implicit constants in the growth condition inequalities above as seminorms. For $t \geq 0$, we make $X_t$ into a locally convex space by taking those implicit constants as seminorms, as well as taking, for each bounded set $\mathcal{B}$, the implicit constants in the cancellation condition as a seminorm. For $t < 0$, the growth conditions on elements of $X_t$ imply we have a continuous inclusion $X_t \to L^\infty_x(\RR^d) L^1_z(\RR^d) \to \mathcal{S}(\RR^d \times \RR^d)^*$. For $t \geq 0$,

    Let $k \in X_t$ be a kernel, and let $a(x,\xi)$ be the Fourier transform of the kernel in the $z$-variable. If we split up $k = k_0 + k_\infty$ and thus write $a = a_0 + a_\infty$, where $k_0$ is supported on $|z| \leq 2$, and $k_\infty$ on $|z| \geq 1$, then we see that, because $k_0$ is compactly supported, $a_0$ is smooth, and because $k_\infty$ is rapidly decaying away from the origin, $a_\infty$ is smooth. Thus $a \in C^\infty(\RR^d \times \RR^d)$ for any $k \in X_t$.

    Now set $k_R(x,z) = k(x,z/R)$ for each $R > 0$. The family
    %
    \[ \{ R^{-t-d} k_R : R > 0 \} \]
    %
    is then a bounded set in $X_t$, since, for instance,
    %
    \[ \sup \{ |z|^{t+d+n_2+N} |\nabla_x^{n_1} \nabla_z^{n_2} k_R(x,z)| \} = R^{t + d + N} \sup \{ |z|^{t + d + n_2 + N} |\nabla_x^{n_1} \nabla_z^{n_2} k(x,z)| \} \]


    Suppose we can prove that $|a(x,\xi)| \leq C(a)$ for all $x \in \RR^d$, and $1/2 \leq |\xi| \leq 2$, where $a \mapsto C(a)$ is a continuous seminorm on $X$. If we set
    %
    \[ a_R(x,\xi) = \int k_R(x,z) e^{-2 \pi i \xi \cdot z}, \]
    %
    then we will then have actually proved that $|a_R(x,\xi)| \leq C(a) R^{t+d}$ for all $R > 0$ and $1/2 \leq |\xi| \leq 2$. Since $a_R(x,\xi) = R^d a(x,R \xi)$, this implies that
    %
    \[ |a(x,\xi)| \lesssim_t C(a) |\xi|^t \]
    %
    for all $\xi$. Since $k \mapsto D^\alpha_x D^\beta_z k$ is a continuous operator on $X_t$ to $X_{t - |\beta|}$, this means we will have actually proved that
    %
    \[ |\nabla^{n_1}_x \nabla^{n_2}_z a(x,\xi)| \lesssim_t C_{n_1,n_2}(a) |\xi|^{t-n_2}. \]
    %
    Thus we have proved that $a \in \mathcal{S}^t(\RR^d \times \RR^d)$. For $t < 0$, to show that the bounds on $1/2 \leq |\xi| \leq 2$ hold, we just note that we can take $C(a) = \| k \|_{L^\infty_x L^1_z}$, which is a continuous seminorm on $X_t$ because
    %
    \[ \int |k(x,z)|\; dz \leq \sup_{x \in \RR^d, |z| \leq 1} |k(x,z)| |z|^{t + d} + \sup_{x \in \RR^d, |z| \geq 1} |k(x,z)| |z|^{d+1}. \]
    %

    TODO: Ask Andreas about this.
\end{proof}

If $T$ is a pseudodifferential operator of order $t < 0$ with kernel $K$, the growth condition on $k(x,z)$ implies that, $k(x,z)$ is locally integrable in $z$, and thus for any $f \in C_c^\infty(\RR^d)$,
%
\[ Tf(x) = \lim_{\varepsilon \to 0^+} \int_{|z| > \varepsilon} k(x,z) f(x-z)\; dz. \]
%
More precisely, the integrability bounds imply the right hand side defines a distribution of order zero agreeing with $K$ everywhere but the origin. But since $K$ is a distribution of order


$k(x,z)$ is locally integrable in $z$. Thus for $f \in C_c^\infty(\RR^d)$,
%
\[  \lim_{\varepsilon \to 0^+} \int_{|z| > \varepsilon} k(x,z) f(x-z)\; dz \]
%
gives a well defined distribution of order zero differing from $k(x,z)$ only at the origin. But 


Indeed, $K$ is smooth on $|z| > \varepsilon$, and an integration by parts shows that
%
\[ \int_{\varepsilon_1 < |z| < \varepsilon_2} k(x,z) f(x-z) = \int_{\varepsilon_1 < |z| < \varepsilon_2} k(x,z) [f(x) - z \cdot \nabla f(x) + O(|z|^2)] \]
% = K(x,\varepsilon S) f(x-\varepsilon S)


Here is a condition, that for a psuedodifferential operator of order $t \geq 0$ gives a \emph{cancellation condition} on it's behaviour, and for $t < 0$, a bound on how singular the operator is.

\begin{theorem}
    Suppose $T$ is a pseudodifferential operator of order $t \geq 0$. Then for every multi-index $\alpha$,
    %
    \[ D^\alpha \{ T (\text{Dil}_\delta \phi) \} (x) \lesssim \delta^{-t}. \]
\end{theorem}

TODO: Add discussion from Brian Street's textbook on characterizations of $\Psi DOs$ without the Fourier transform.

In addition to studying the behaviour of $\Psi$DOs away from the diagonal, which reflects the pseudolocal behaviour of the distribution, it is also of interest to determine the behaviour of the operator under highly oscillatory, but non-stationary, phenomena. Consider a symbol $a(x,\xi)$, a smooth function $f(y)$, and a smooth phase $\phi(y)$ with $\nabla \phi(y)$ nonvanishing on $\text{supp}_x(a)$. Our goal is to try to determine the asymptotic behaviour of the function $T_a(f e^{2 \pi i \lambda \phi})$ as $\lambda \to \infty$. Since $T_a$ is pseudolocal, the value at a point $x$ should be determined to a large degree by the behaviour of $f e^{2 \pi i \lambda \phi}$ near $x$, which, roughly speaking, oscillates near the frequency $\lambda \nabla \phi(x)$. Thus we might expect that
%
\[ T_a \{ f e^{2 \pi i \lambda \phi} \} (x) \approx a(x,\lambda \nabla \phi(x)) f(x) e^{2 \pi i \lambda \phi(x)}. \]
%
This is correct, and in fact, we can obtain a complete asymptotic development as $\lambda \to \infty$. For simplicity, we assume $\text{supp}(a)$ is compact.

\begin{theorem}
    Fix a symbol $a(x,\xi)$ of order $t$, compactly supported in $x$, a smooth function $f \in C^\infty(\RR^d)$, and a smooth, real-valued function $\phi$ with $\nabla \phi$ nonvanishing on $\text{supp}_x(a)$. Let $\phi_2(x,y) = \nabla \phi(x) \cdot (x - y) - (\phi(x) - \phi(y))$. Then for any $N$, we can write
    %
    \begin{align*}
        & e^{-2 \pi i \lambda \phi(x)} T_a \{ f e^{2 \pi i \lambda \phi} \}(x)\\
        &= \sum_{|\beta| < N} \frac{1}{\beta! \cdot (2 \pi i)^{\beta}} \cdot D_\xi^\beta a(x,\lambda \nabla \phi(x)) \cdot \left. D^\beta_y \{ e^{2 \pi i \lambda \phi_2(x,y)} f \} \right|_{y = x} + R_N(x,\lambda),
    \end{align*}
    %
    where $\lambda^{t - \lceil N/2 \rceil} R_N \in L^\infty(\RR^d \times (0,\infty))$. In particular, for $N = 3$, %if we set
    %
%    \[ c(x,y,\xi) = -2\pi^2 \lambda^2 \sum_{|\beta| = 2} D_\xi^\beta a(x,\lambda \nabla \phi(x,y,\xi)) D^\beta_x \phi(x), \]
    %
    we find that
    %
    \begin{align*}
        e^{-2 \pi i \lambda \phi(x)} T_a \{ f e^{2 \pi i \lambda \phi} \}(x) = \sum_{|\beta| < 2} &\frac{1}{\beta! \cdot (2 \pi i)^\beta} D_\xi^\beta a(x, \lambda \nabla \phi(x)) D^\beta_x f(x)\\
        &- (i \lambda/\pi) \sum_{|\beta| = 2} D^\beta_\xi a(x, \lambda \nabla \phi(x)) D^\beta_y \phi_2(x,x) f(x)\\
        &+ O(\lambda^{t - 2}).
    \end{align*}
\end{theorem}
\begin{proof}
    We write
    %
    \[ e^{-2 \pi i \lambda \phi(x)} T_a \{ f e^{2 \pi i \lambda \phi } \}(x) = \lambda^d \int e^{2 \pi i \lambda ( (\xi - \nabla \phi(x)) \cdot (x - y) - \phi_2(x,y))} a(x, \lambda \xi) f(y)\; d\xi dy. \]
    %
    Since $|\phi_2(x,y)| \lesssim |x - y|^2$, the principal contributions to this integral occurs when $y \approx x$ and $\xi \approx \nabla \phi(x)$. Without loss of generality, we may therefore assume that $a(x,\xi) = 0$ whenever it is not true that $|\xi| \sim \lambda$. We rewrite our integral as
    %
    \[ \lambda^d \int e^{2 \pi i \lambda ( \xi \cdot (x - y) - \phi_2(x,y) )} a(x, \lambda \nabla \phi(x) + \lambda \xi) f(y)\; d\xi\; dy. \]
    %
    Using Taylors formula, we write
    %
    \[ a(x, \lambda \nabla \phi(x) + \lambda \xi) = \sum_{|\beta| < N} \frac{\lambda^\beta}{\beta !} D_\xi^\beta a(x, \lambda \nabla \phi(x)) \xi^\beta + R_{N,\lambda}(x,\xi). \]
    %
    We know that $D_\xi^\beta R_{N,\lambda}(x,0) = 0$ for $|\beta| < N$. For any $\beta > 0$, we have $D_\xi^\beta a(x,\xi) \lesssim \lambda^{t - |\beta|}$, and the remainder formula for the Taylor expansion can therefore be used to show that $|D_\xi^\beta R_{N,\lambda}(x,\xi)| \lesssim \lambda^{t - |\beta|}$. Stationary phase thus implies that
    %
    \[ \left| \lambda^d \int \int e^{2 \pi i \lambda ((x - y) \cdot \xi + \phi_2(x,y))} R_{N,\lambda}(x,\xi) f(y)\; d\xi\; dy \right| \lesssim \lambda^{t - \lceil N/2 \rceil}. \]
    %
    Finally, we note that via an integration by parts,
    %
    \begin{align*}
        \int & e^{2 \pi i \lambda (\xi \cdot (x - y) - \phi_2(x,y))} \xi^\beta f(y)\; d\xi\; dy\\
        &= (1/\lambda)^{d + \beta} (2 \pi i)^{-\beta} \left. D_y^\beta \{ e^{- 2 \pi i \lambda \phi_2(x,y)} f(y) \} \right|_{y = x}
    \end{align*}
    %
    and substituting them into the formula completes the proof.
\end{proof}

As the order of the symbol $a$ decreases, we expect the behaviour of the corresponding pseudodifferential operator to become more and more regular. In particular, for $t < - d$, we get a distribution which is actually \emph{locally integrable}. If $a$ has order $t$, we say $T_a$ is an operator of order $t$. When we write
%
\[ a \sim \sum_{k = 0}^\infty a_k \]
%
we mean that the order of the Pseudodifferential operator with symbols $a - \sum_{k = 0}^N a_k$ tends to $-\infty$ as $N \to \infty$. This agrees with the asymptotic notation for symbols introduced in the previous chapter.

A $\Psi$DO of order $-\infty$ has a kernel $K$ lying in $C^\infty(\RR^d \times \RR^d)$, and satisfying estimates of the form
%
\[ | \nabla^{n_1}_x \nabla^{n_2}_y K(x,y)| \lesssim_{n,N} \frac{1}{\langle x - y \rangle^N} \]
%
for any $N \geq 0$. We will call such an operator of this form a \emph{smoothing operator}. Any smoothing operator is a $\Psi$DO of order $-\infty$, since if $K$ satisfies these estimates, it is the $\Psi$DO corresponding to the symbol
%
\[ a(x,\xi) = e^{- 2 \pi i \xi \cdot x} \int K(x,y) e^{2 \pi i \xi \cdot y}\; dy, \]
%
which is a symbol of order $-\infty$. Any smoothing operator has the property that $Tu \in \mathcal{C}_c^\infty(\RR^d)$ for any $u \in \mathcal{E}(\RR^d)^*$. For most purposes, it is convenient to work with pseudodifferential operators \emph{modulo smoothing operators}, since in harmonic analysis most techniques we use work with estimates of localized functions, and when localized, smoothing operators often satisfy all the estimates we are interested in.

One might wish to study a more general family of operators with a \emph{compound symbol} of the form $a(x,y,\xi)$, i.e. an operator of the form
%
\[ T_a f(x) = \int a(x,y,\xi) e^{2 \pi i \xi \cdot (x - y)} f(y)\; d\xi\; dy. \]
%
However, any such operator is already a pseudodifferential operator, and we can calculate an explicit asymptotic expansion.

\begin{lemma}
    Given a symbol $a(x,y,\xi)$, the operator $T_a$ is a pseudodifferential operator, whose symbol has an asymptotic expansion
    %
    \[ \sum_\beta \frac{1}{\beta!} \frac{1}{(2 \pi i)^{|\beta|}} D^\beta_\xi D^\beta_y a(x,x,\xi). \]
\end{lemma}
\begin{proof}
    Suppose $a$ has order $t$. We perform a Taylor expansion, writing
    %
    \[ a(x,y,\xi) = \sum_{|\beta| \leq N} \frac{1}{\beta !} D^\beta_y a(x,x,\xi) \cdot (y - x)^\beta + R_N(x,y,\xi), \]
    %
    where $D^\beta_y R_N(x,x,\xi) = 0$ for all $|\beta| \leq N$. This means we can find $C^\infty$ functions $b_\beta(x,y,\xi)$, for $|\beta| = N+1$, such that
    %
    \[ R_N(x,y,\xi) = \sum_{|\beta| = N+1} (2\pi i)^{N+1} (y - x)^\beta b_\beta(x,y,\xi). \]
    %
    Now integration by parts shows that
    %
    \begin{align*}
        \int & R_N(x,y,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi\\
        &= (-1)^{N+1} \sum_{|\alpha| = N+1} \int (D_\xi^\alpha b_\alpha)(x,y,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi.
    \end{align*}
    %
    The functions $b_\beta$ are symbols of order $t$, so $D_\xi^\alpha b_\beta$ are symbols of order $t - (N+1)$. Thus the Pseudodifferential operator corresponding to $R_N$ has order at most $t - (N+1)$. On the other hand, another integration by parts again shows that
    %
    \begin{align*}
        \int &D^\beta_y a(x,x,\xi) \cdot (y - x)^\beta \cdot e^{2 \pi i \xi \cdot (x - y)}\; d\xi\\
        &= \frac{1}{(2 \pi i)^{|\beta|}} \int D^\beta_\xi D^\beta_y a(x,x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi.
    \end{align*}
    %
    Thus the pseudodifferential operator corresponding to $D^\beta_y a(x,x,\xi) \cdot (y - x)^\beta$ also corresponds to the symbol $1 / (2 \pi i)^{|\beta|} \cdot D^\beta_\xi D^\beta_y a(x,x,\xi)$, which completes the proof.
\end{proof}

\begin{remark}
    More formally, if $b(x,\xi) = a(x,x,\xi)$, then the formula above can be written formally as $a(x,y,\xi) \sim e^{2 \pi i D_x \cdot D_\xi} b$, where $D_x$ and $D_\xi$ are the normalized derivative operators defined above. This makes sense, since if $K$ is the kernel of $T_a$, and $T_a$ corresponds to a pseudodifferential operator, then it's symbol would correspond precisely to
    %
    \begin{align*}
        a(x,\xi) &= \int K(x, x - y) e^{-2 \pi i \xi \cdot y}\; dy\\
        &= \int \int a(x,x-y,\xi-\eta) e^{- 2 \pi i \eta \cdot y}\; d\eta\; dy.
    \end{align*}
    %
    If we define $a_x(y,\xi) = a(x,y,\xi)$, and $b(x,\xi) = e^{-2 \pi i \eta \cdot y}$, then $a(x,\xi) = (a_x * b)(x,\xi)$. But $b$ is a Gaussian, and thus if $(\widehat{x}, \widehat{\xi})$ are the dual variables to $(x,\xi)$, then $\widehat{b}(\widehat{x}, \widehat{\xi}) = e^{2 \pi i \widehat{\xi} \cdot \widehat{x}}$. Thus if $D_x$ and $D_\xi$ are the differential operators normalized by $2\pi i$ introduced at the beginning of the section (the Fourier multiplier operators corresponding to multiplication by $\widehat{x}$ and $\widehat{\xi}$ respectively), then we can write
    %
    \[ a(x,\xi) = e^{2 \pi i D_x \cdot D_\xi} a_x(x,\xi). \]
    %
    Taking the power series expansion of the exponential gives the expansion above.
\end{remark}

Because any pseudodifferential operator is a closed unbounded operator on $L^2(\RR^d)$, well defined for test functions, we can consider it's adjoint. We now use the calculation above to show the adjoint of a pseudodifferential operator $a(x,\xi)$; it is simple to calculate that the adjoint of any $\Psi DO$ $a(x,D)$ is a pseudodifferential operator with compound symbol $(x,y,\xi) \mapsto \overline{a(y,\xi)}$. Nonetheless, the above theorem implies that the adjoint can be given by a symbol $a^*(x,\xi)$ where $a^*(x,\xi) = e^{2 \pi i D_x \cdot D_\xi} \overline{a}(x,\xi)$, which we can write explicitly as an asymptotic expansion as
%
\[ a^*(x,\xi) \sim \sum_\beta \frac{1}{\beta!} \frac{1}{(2 \pi i)^{|\beta|}} \overline{D^\beta_\xi D^\beta_x a(x,\xi)}. \]
%
In particular, if $a$ is a symbol of order $t$, then $a^*(x,\xi) - \overline{a(x,\xi)}$ is a symbol of order $t - 1$, which we might write as saying that $a^* \approx \overline{a}$, up to lower order terms. In particular, if $a$ is a symbol correspond to a \emph{self adjoint} pseudodifferential operator, then $a \approx \text{Re}(a)$, up to lower order terms.

The choice of $(x,\xi)$ variables is common, but certainly not standard. The association of the pseudodifferential operator with any symbol $a$ in two variables is called the \emph{Kohn-Niremberg quantization}. We could also use the \emph{adjoint Kohn-Niremberg quantization} to associate an operator with every symbol $a$ in two variables, using the $(y,\xi)$ variables instead of the $(x,\xi)$ variables. We find, using the expansion above, that modulo smoothing operators, any symbol in the $(y,\xi)$ variables can be written in the $(x,\xi)$ variables, and moreover,
%
\[ a(y,\xi) \sim \sum_\beta \frac{1}{\beta!} \frac{1}{(2 \pi i)^{|\beta|}} D^\beta_\xi D^\beta_x a(x,\xi). \]
%
In particular, $a(y,\xi) - a(x,\xi)$ corresponds to a pseudodifferential operator of order $t - 1$. Thus the operator we get using either approach only matters up to lower order terms.

The family of operators one can describe via the adjoint Kohn-Niremberg quantization is the same as the Kohn-Niernberg quantization. Thus, in the sequel, there is no harm in sticking with the Kohn-Nirenberg quantization. On the other hand, the symbols representing various operators change. For instance, we previously found that under the Kohn-Nirenberg quantization, the symbol $a(x,\xi) = \sum c_\alpha(x) \xi^\alpha$ corresponded to the differential operator $Lf = \sum c_\alpha D^\alpha f$. Under the adjoint Kohn-Nirenberg quantization, the symbol $a(y,\xi) = \sum c_\alpha(y) \xi^\alpha$ corresponds to the differential operator $Lf = \sum D^\alpha( c_\alpha f)$. If $t$ is the order of these operators, then the difference of these operators is a differential operator of order $t-1$, which reflects the equivalence described above.

Thus we see that, roughly speaking, the operators differ in the order in which they apply spatial and frequency modulation. It is sometimes useful to deal with a quantization that does both in a `symmetric' manner. To do this, we introduce the \emph{Weyl quantization}, which associates with each symbol $a$ gives the Pseudodifferential operator $T$ with compound symbol $(x,y,\xi) \mapsto a((x + y)/2, \xi)$. This approach has the advantage that if $a$ is real-valued, then the associated Pseudodifferential operator $T$ will be self-adjoint, rather than just self-adjoint up to lower order terms, as in the Kohn-Nirenberg quantizations. The Weyl quantization is the approach that works best in a generalization of a functional calculus for any finite family of noncommuting operators (there are notes by Tao which describes this process in detail, but it is beyond the scope of these notes).

\begin{remark}
    Here, we have worked with symbols satisfying uniform estimates in $x$. But often one can only work with symbols which \emph{locally} satisfy these estimates in $x$, i.e. working in the symbol classes $\mathcal{S}^t_{\text{loc}}(\RR^d \times \RR^d)$. The kernels of operators formed from these symbols satisfy bounds of the form
    %
    \[ | \nabla^{n_1}_x \nabla^{n_2}_z K(x,y)| \lesssim_{n_1,n_2,N} \frac{1}{|x-y|^{t + d + n_2 + N}}, \]
    %
    where the implicit constant is \emph{locally uniform} in $x$, and uniform in $y$. On a related note, such operators can be applied to any compactly supported distribution, and satisfy the microlocalization statement $\text{WF}(Tu) \subset \text{WF}(u)$. On the other hand, unless one has a bound such as
    %
    \[ |\nabla_x^{n_1} \nabla_y^{n_2} \nabla_\xi^m a(x,\xi)| \lesssim_{n,m} (\langle x \rangle^{k_{1n}} + \langle y \rangle^{k_{2n}}) \cdot \langle \xi \rangle^{k_{nm}}, \]
    %
    for all $n$ and $m$, it is not necessarily possible to apply the operator to Schwartz functions, and tempered distributions. One can consider asymptotics, as long as we work modulo a weaker family of smoothing operators, i.e. those whose kernels lie in $C^\infty(\RR^d \times \RR^d)$ and are locally bounded in $x$.
\end{remark}

\section{Compositions of $\Psi$DOs, and Parametrices}

The composition of a $\Psi$DO of order $t$ and a $\Psi$DO of order $s$ is a $\Psi$DO of order $t + s$, and we have an asymptotic formula for the symbol of such an expansion, reflecting the lack of commutivity between the spatial and frequential variables. In particular, the symbol of the composition is, to first order, the product of the symbols of the two operators.

\begin{theorem}
    Let $a(x,\xi)$ and $b(x,\xi)$ be symbols of order $t$ and $s$, corresponds to operators $T_a$ and $T_b$. Then $T_a \circ T_b$ is a $\Psi$DO of order $t + s$, and has symbol
    %
    \[ (a \circ b)(x, \xi) = \left. e^{2 \pi i D_\xi \cdot D_y} \{ a(x,\xi) b(y,\eta) \} \right|_{y = x, \eta = \xi}. \]
    %
    In particular, we have the asymptotic expansion
    %
    \[ (a \circ b)(x,\xi) \sim \sum_\alpha \frac{1}{\alpha!} \frac{1}{(2 \pi i)^{|\alpha|}} D^\alpha_\xi a(x,\xi) \cdot D^\alpha_x b(x,\xi). \]
    %
    Thus $(a \circ b)(x,\xi) - a(x,\xi) b(x,\xi)$ is a symbol of order $t + s - 1$. If $\omega = dx \wedge d \xi - d\xi \wedge dx$ is the two form on $T^* \RR^n$, we introduce the \emph{Poisson bracket}
    %
    \[ \{ a, b \} = \omega ( \nabla a, \nabla b ) = \sum_{i = 1}^d \frac{\partial a}{\partial \xi^i} \frac{\partial b}{\partial x^i} - \frac{\partial a}{\partial x^i} \frac{\partial b}{\partial \xi^i}, \]
    %
    then the commutator $[a(x,D), b(x,D)]$ of the two operators is a pseudodifferential operator of order $t + s$ with some symbol $[a,b]$, such that the symbol $[a,b] - (4 \pi i)^{-1} \{ a, b \}$ has order $t + s - 2$.
\end{theorem}
\begin{proof}
    We can write
    %
    \begin{align*}
        (T_a \circ T_b) f(x) &= \int a(x,\eta) e^{2 \pi i \eta \cdot (x - z)} T_b f(z)\; dz\; d\eta\\
        &= \int a(x,\eta) b(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)} e^{2 \pi i \xi \cdot (x - y)} f(y)\; dy\; dz\; d\xi\; d\eta.
    \end{align*}
    %
    Thus we see that we can view the composition as a $\Psi$DO with kernel
    %
    \[ c(x,\xi) = \int \int a(x,\eta) b(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz. \]
    %
    This is an oscillatory integral, with stationary point when $z = x$ and $\eta = \xi$. Thus we expand power series near this point, i.e. writing
    %
    \[ a(x,\eta) = \sum_\alpha \frac{1}{\alpha!} D^\alpha_\xi a(x,\xi) (\eta - \xi)^\alpha \]
    %
    and
    %
    \[ b(z,\xi) = \sum_\beta \frac{1}{\beta!} D^\beta_x b(x,\xi) (z - x)^\beta. \]
    %
    Using the Fourier inversion formula, we calculate that
    %
    \begin{align*}
        \int &(\eta - \xi)^\alpha (z - x)^\beta e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz\\
        &= \int \tau^\alpha y^\beta e^{-2 \pi i \tau \cdot y}\; d\tau\; dy\\
        &= \begin{cases} 0 & \alpha \neq \beta, \\ \alpha! / (2 \pi i)^\alpha & \alpha = \beta. \end{cases}
    \end{align*}
    %
    Working like in our analysis of compound symbols, it suffices to show that if $g_1$ and $g_2$ are symbols of order $t$ and $s$, then
    %
    \[ f(x,\xi) = \int \int (\eta - \xi)^\alpha (z - x)^\beta g_1(x,\eta) g_2(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz \]
    %
    is a symbol of order $t + s - M - 1$. Applying sufficiently many integration by parts, it actually suffices to show integrals of the form
    %
    \[ f(x,\xi) = \int \int g_1(x,\eta) g_2(z,\xi) e^{2 \pi i (\eta - \xi) \cdot (x - z)}\; d\eta\; dz, \]
    %
    have order $t + s$, where $g_1$ has order $t$, and $g_2$ has order $s$. We write $\lambda = |\xi|$, and $\xi = \lambda \tilde{\xi}$, and write
    %
    \[ f(x,\xi) = \lambda^d \int \int g_1(x, \lambda \eta) g_2(z, \xi) e^{2 \pi i \lambda (\eta - \tilde{\xi}) \cdot (x - z)}\; d\eta \]
    %
    We can decompose the domain dyadically. For $|\eta| \leq 1/2$ and $|x - z| \leq 1$, an integration by parts in $z$ gives rapid decay in $t$. Similarily, we can dyadically sum over the regions where $|\eta| \leq 1/2$ and $|x - z| \sim 2^k$ by first integrating in $\eta$ using integration by parts, then integration in parts in $z$. This also gives rapid decay in $t$. Similar arguments give rapid decay in $\xi$ for $|\eta| \sim 2^l$, in fact giving estimates which are summable in $l$. Thus we are left with giving decay for an integral of the form
    %
    \[ t^d \int \int g_1(x, t \eta) g_2(z,\xi) \rho(|x - z|) \rho(|\eta| - 1) e^{2 \pi i t (\eta - \tilde{\xi}) \cdot (x - z)}\; d\eta\; dz. \]
    %
    This domain has a stationary point when $\eta = \xi$ and $z = x$. However, the stationary point is nondegenerate. Thus the integral is $O(\lambda^{t + s} \lambda^{-d})$ and so $|f(x,\xi)| \lesssim \langle \xi \rangle^{t + s}$. Replacing $g_1$ and $g_2$ with appropriate derivatives gives a full argument that $f$ is a symbol of order $t + s$.
\end{proof}

A \emph{parametrix} for a pseudodifferential operator $T$ is a pseudodifferential operator $S$ such that $S \circ T$ is the identity operator, modulo smoothing. One useful result of our calculations is that we can easily construct \emph{parametrices} for suitable pseudodifferential. Suppose $a$ is a symbol of order $t$ such that there exists $R > 0$ such that for $|\xi| \geq R$,
%
\[ C_1 (1 + |\xi|)^t \leq |a(x,\xi)| \leq C_2 (1 + |\xi|)^t. \]
%
We call the operator corresponding to such a symbol \emph{elliptic}. Then there exists a smooth cutoff function $\psi(\xi)$ equal to one for $|\xi| \leq R$ such that
%
\[ b_0(x,\xi) = \left( 1 - \psi(\xi) \right) \cdot \frac{1}{a(x,\xi)} \]
%
is well defined. It is simple to verify this is a symbol of order $-t$. We note that $a(x,\xi)$ agrees with $(1 - \psi(\xi)) a(x,\xi)$ up to a smoothing operator. By our composition formula, we conclude that there exists a symbol $c_1(x,\xi)$ of order $-1$ such that $(b_0 \circ a)(x,\xi) = 1 + c_1(x,\xi)$. If we set $b_1(x,\xi) = - (1 - \psi(\xi)) \cdot c_1(x,\xi) / a(x,\xi)$, then $b_1$ is a symbol order order $-t - 1$, and $((b_0 + b_1) \circ a)(x,\xi) = 1 + c_2(x,\xi)$, where $c_2$ is a symbol of order $-2$. Continuing this development, we obtain a sequence of operators $\{ b_k \}$, where $b_k$ is a symbol of order $-t - k$. Choosing a symbol
%
\[ b \sim \sum_{k = 0}^\infty b_k, \]
%
we conclude that
%
\[ (b \circ a)(x,\xi) \sim 1, \]
%
which means that, $b$ is a parametrix for $a$. Similarily, we can construct a symbol $c$ such that $(a \circ c)(x,\xi) \sim 1$. But then
%
\[ b = b \circ (a \circ c) = (b \circ a) \circ c = c \]
%
so $b = c$, up to a smoothing operator. Thus a left parameterix is automatically a right parameterix.

\begin{remark}
    The condition that $|a(x,\xi)| \sim \langle \xi \rangle^t$ for large $\xi$ is necessary in order to construct a parametrix of order $-t$. Without loss of generality, this is true since we can replace $a(x,\xi)$ with $a(x,\xi) (1 + |\xi|^2)^{-t/2}$ and $b(x,\xi)$ with $b(x,\xi) (1 + |\xi|^2)^{t/2}$ and still have parametrices. Indeed, if a parameterix $b(x,\xi)$ for $a(x,\xi)$ exists, then, the composition formula implies that $a(x,\xi) b(x,\xi) - 1$ is a symbol of order $-1$. Thus for large $\xi$, we know that $|a(x,\xi) b(x,\xi) - 1| \leq 1/2$ and $|b(x,\xi)| \lesssim \langle \xi \rangle^{-t}$. But this implies that for large $\xi$, $|a(x,\xi)| \geq 1/2 |b(x,\xi)| \gtrsim \langle \xi \rangle^t$.
\end{remark}

%\begin{theorem}
%    $T_a$ maps $\mathcal{S}(\RR^d)$ to $\mathcal{S}(\RR^d)$ continuously.
%\end{theorem}
%\begin{proof}
%    Integration by parts shows that 
%    Since $f \mapsto \widehat{f}$ is an isomorphism of $\mathcal{S}(\RR^d)$, it suffices to prove the operator
    %
%    \[ Sg(x) = \int a(x,\xi) g(\xi) e^{2 \pi i \xi \cdot x}\; d\xi. \]
    %
%    is continuous. Fix a multi-index $\alpha$ with $|\alpha| = m$. Now using the fact that $g$ is Schwartz, one finds
    %
%    \[ D^\alpha_x(Sg)(x) = \int D^\alpha_x a(x,\xi) g(\xi) e^{2 \pi i \xi \cdot x}\; d\xi. \]
    %
%    If we write $a_x(\xi) = a(x,\xi)$, then $D^\alpha_x(Sg)(x) = ((D^\alpha_x a_x) g)^\vee(x)$. Now
    %
%    \[ \nabla^n_\xi ( (D^\alpha_x a_x) \cdot g)(\xi) \lesssim_{n,m} \langle x \rangle^{k_m} \langle \xi \rangle^{l_{nm} - k} \| f \|_{\mathcal{S}^{n,k}(\RR^d)}. \]
    %
%    If $k$ is chosen larger than $l_{nm} + d$, then integration by parts implies that
    %
%    \[ |D^\alpha(Sg)(x)| = |((D^\alpha_x a_x) g)^\vee(x)| \lesssim_{n,m} \langle x \rangle^{k_m - n} \| f \|_{\mathcal{S}^{n,k}(\RR^d)}. \]
    %
%    Thus for any fixed $k_1$, there exists $k_2$ such that
    %
%    \[ \| Sg \|_{\mathcal{S}^{m,k_1}(\RR^n)} \lesssim_{m,k_1} \| g \|_{\mathcal{S}^{k_m + k_1, k_2}(\RR^d)}. \]
    %
%    This gives the required continuity of the operator.
%\end{proof}

\section{Regularity Theory}

Let us now discuss the boundedness of certain pseudodifferential operators with respect to various norm spaces. We first note that a differential operator of degree $m$ given by
%
\[ L = \sum c_\alpha(x) D^\alpha, \]
%
where $c_\alpha$ is bounded, maps $H^s(\RR^d)$ to $H^{s-m}(\RR^d)$ for each $s$. Thus we might expect the same to be true for pseudodifferential operators of order $m$. To begin with, we restrict ourselves to pseudodifferential operators of order $0$. The kernel of a $\Psi$DO of order zero satisfies estimates of the form
%
\[ |K(x,y)| \lesssim \frac{1}{|x - y|^d}. \]
%
Thus we focus on obtaining $L^2 \to L^2$ estimates, so that the standard theory of singular integrals gives $L^p \to L^p$ estimates for all $1 < p < \infty$.

\begin{theorem}
    Let $T_a$ be a pseudodifferential operator specified by a symbol $a$ of order zero. Then for any $f \in \mathcal{S}$,
    %
    \[ \| T_af \|_{L^2(\RR^d)} \lesssim \| f \|_{L^2(\RR^d)}. \]
\end{theorem}
\begin{proof}
    Let us begin by assuming that $\text{supp}_x(a)$ is compact. Then we can apply the Fourier inversion formula, writing
    %
    \[ a(x,\xi) = \int_{\RR^d} \widehat{a}(\lambda,\xi) e^{2 \pi i \lambda \cdot x}\; d\lambda \]
    %
    where
    %
    \[ \widehat{a}(\lambda,\xi) = \int_{\RR^d} a(x,\xi) e^{- 2 \pi i \lambda \cdot x}\; dx. \]
    %
    Since $\| \nabla^n_x a(x,\xi) \|_{L^\infty(\RR^d)} \lesssim_n 1$ for all $n \geq 0$ and has uniform compact support in $x$, we find that
    %
    \[ |\widehat{a}(\lambda,\xi)| \lesssim_n \langle \lambda \rangle^{-n} \]
    %
    for all $n > 0$. For $f \in \mathcal{S}(\RR^d)$, we now write
    %
    \begin{align*}
        T_af(y) &= \int_{\RR^d} a(y,\xi) \widehat{f}(\xi) e^{2 \pi i \xi \cdot y}\; d\xi\\
        &= \int_{\RR^d} \int_{\RR^d} \widehat{a}(\lambda,\xi) \widehat{f}(\xi) e^{2 \pi i (\xi + \lambda) \cdot y}\; d\xi\; d\lambda\\
        &= \int_{\RR^d} T_a^\lambda f(y)\; d\lambda,
    \end{align*}
    %
    where
    %
    \[ T_a^\lambda f(y) = \int_{\RR^d} \widehat{a}(\lambda,\xi) \widehat{f}(\xi) e^{2 \pi i (\xi + \lambda) \cdot y}\; d\xi. \]
    %
    This is just a Fourier multiplier operator with symbol $m_\lambda(\xi) = \widehat{a}(\lambda,\xi) e^{2 \pi i \lambda \cdot y}$. Since $\| m_\lambda \|_{L^\infty(\RR^d)} \lesssim_n \langle \lambda \rangle^{-n}$, if $n > d$ we conclude that
    %
    \[ \| T_af \|_{L^2(\RR^d)} \leq \int_{\RR^d} \| T_a^\lambda f \|_{L^2(\RR^d)}\; d\lambda \lesssim_n \| f \|_{L^2(\RR^d)} \int_{\RR^d} \langle \lambda \rangle^{-n}\; d\lambda \lesssim \| f \|_{L^2(\RR^d)}. \]
    %
    Thus the theorem is proved, at least in the case of symbols compactly supported in the spatial domain.

    To prove the result for more general symbols, we work with a kernel representation of $T_a$. Thus we write
    %
    \[ T_af(x) = \int_{\RR^d} K(x,y) f(x)\; dx, \]
    %
    where
    %
    \[ K(x,y) = \int_{\RR^d} a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi. \]
    %
    We have already shown that the kernel $K$ is $C^\infty$ away from the diagonal, and decays rapidly away from the diagonal. This is one instance of the pseudolocal nature of these operators. Another quantitative result reflecting this nature is that for each $N > 0$ and $x_0 \in \RR^d$,
    %
    \[ \int_{|x - x_0| \leq 1} |T_af(x)|^2\; dx \lesssim_N \int_{\RR^d} \frac{|f(x)|^2}{\langle x - x_0 \rangle^N}\; dx. \]
    %
    Thus we can `almost' bound the magnitude of $T_af$ in a neighbourhood of $x_0$ by the magnitude of $f$ in a neighbourhood of $x_0$. We focus on the case $x_0 = 0$, the other cases treated in much the same way. Write $f = f_1 + f_2$, where $f_1$ is supported on $|x| \leq 3$, $f_2$ is supported on $|x| \geq 2$, and $|f_1|, |f_2| \leq |f|$. If $\eta(x)$ is a smooth cuttoff supported on $|x| \leq 3$, then the symbol $\eta(x) a(x,\xi)$ is compactly supported, and so
    %
    \begin{align*}
        \int_{|x| \leq 1} |T_a f_1(x)|^2\; dx &= \int_{|x| \leq 1} |T_{\eta a} f_1(x)|^2 \lesssim \| f_1 \|_{L^2(\RR^d)}^2\\
        &\lesssim_N \int_{\RR^d} \frac{|f_1(x)|^2}{\langle x \rangle^N}\; dx \leq \int_{\RR^d} \frac{|f(x)|^2}{\langle x \rangle^N}\; dx.
    \end{align*}
    %
    On the other hand, since $f_2(x)$ is supported on $|x| \geq 2$, we find that
    %
    \begin{align*}
        \int_{|x| \leq 1} |T_a f_2(x)|^2\; dx &= \int_{|x| \leq 1} \left| \int K(x,y) f_2(y)\; dy \right|^2\; dx\\
        &\leq \int \int_{|x| \leq 1} |K(x,y)|^2 |f_2(y)|^2\; dy\; dx\\
        &\lesssim_N \int \int_{|x| \leq 1} \frac{|f_2(y)|^2}{|x - y|^N}\; dy\; dx\\
        &\lesssim \int \int_{|x| \leq 1} \frac{|f_2(y)|^2}{\langle y \rangle^N}\; dy\\
        &\lesssim \int \frac{|f_2(y)|^2}{\langle y \rangle^N}\; dy.
    \end{align*}
    %
    But we now find that if $N > d$, then
    %
    \begin{align*}
        \int |T_af(x)|^2\; dx &\lesssim \int \int_{|x - y| \leq 1} |T_af(y)|^2\; dy\; dx\\
        &\lesssim_N \int \int \frac{|f(y)|^2}{\langle x - y \rangle^N}\; dy\; dx\\
        &\lesssim \int |f(y)|^2\; dy,
    \end{align*}
    %
    which gives $L^2$ boundedness.
\end{proof}

Sobolev norms follow simply from these bounds. Namely, it follows simply from this that if $a(x,\xi)$ is a symbol of order $t$, then for $1 < p < \infty$, and any $s$, we have bounds of the form
%
\[ \| T_a f \|_{L^p_s(\RR^d)} \lesssim_{p,s} \| f \|_{L^p_{t + s}(\RR^d)}. \]
%
If $T_a$ is an elliptic pseudodifferential operator of order $t$, then it has a parametrix $S$ of order $-t$, and so for any $r > 0$
%
\begin{align*}
    \| f \|_{L^p_{t + s}(\RR^d)} &= \| ST_a f + (I - ST_a) f \|_{L^p_{t+s}(\RR^d)}\\
    &\leq \| ST_a f \|_{L^p_{t+s}(\RR^d)} + \| (I - ST_a) f \|_{L^p_{t+s}(\RR^d)}\\
    &\lesssim_{p,s,r} \| T_a f \|_{L^p_s(\RR^d)} + \| f \|_{L^p_{-r}(\RR^d)} 
\end{align*}
%
Thus $T$ is \emph{almost} invertible as a map from $L^p_{t+s}(\RR^d)$ to $L^p_t(\RR^d)$, except that we cannot quite obtain the bound $\| T f \|_{L^p_s(\RR^d)} \sim_{p,s} \| f \|_{L^p_{t + s}(\RR^d)}$. But we can obtain a less quantitative result.

\begin{theorem}
    Let $T$ be an elliptic pseudodifferential operator of order $t$. If $f \in \mathcal{E}(\RR^d)^*$, and $Tf$ lies in $L^p_s(\RR^d)$, then $f$ lies in $L^p_{s + t}(\RR^d)$.
\end{theorem}
\begin{proof}
    Since $T$ is elliptic, we can find a parametrix $S$, which is a pseudodifferential operator of order $-t$. Thus there exists a smoothing operator $U$ such that $1 = ST + U$. Since $Tf \in L^p_s(\RR^d)$, $STf \in L^p_{s + t}(\RR^d)$. Since $f$ is compactly supported, $Uf \in C^\infty(\RR^d)$, and thus in $L^p_{s+t,\text{loc}}(\RR^d)$. This means $f \in L^p_{s+t,\text{loc}}(\RR^d)$, and since $f$ is compactly supported, this means $f \in L^p_{s+t}(\RR^d)$.
\end{proof}















\section{Pseudodifferential Operators on Manifolds}

It is an important fact that the class of pseudodifferential operators whose kernels are compactly supported is invariant under a change of coordinates, modulo smoothing operators. By an analysis of how these pseudodifferential operators change under a change of coordinates, we will be able to obtain a theory of pseudodifferential operators on manifolds.

Let $\kappa: U \to V$ be a diffeomorphism, where $U$ and $V$ are open sets in $\RR^n$, and suppose $T = a(x,D)$ is a pseudodifferential operator of order $t$ on $U$. We can then define an operator $S$ for $f \in C_c^\infty(V)$ by setting
%
\[ Sf(\kappa(x)) = T(f \circ \kappa)(x) = \int a(x,\xi) e^{2 \pi i \xi \cdot (x - y)} f(\kappa(y))\; dy\; d\xi, \]
%
i.e. $S$ is defined such that $\kappa_* \circ S = T \circ \kappa_*$. One can verify that the kernel $K$ of $S$ satisfies pseudolocal estimates of the form
%
\[ |K(x,y)| \lesssim_N \frac{1}{|x - y|^{d+N}} \]
%
so we might expect $S$ to be a pseudodifferential operator. By localizing, we may assume that $\text{supp}_x(a)$ is compact, so that $T$ extends to a continuous operator from $\mathcal{D}(U)^*$ to $\mathcal{D}(U)^*$, and $S$ to a continuous operator from $\mathcal{D}(V)^*$ to $\mathcal{D}(V)^*$. If a symbol $b(y,\eta)$ existed such that $S = b(y,D)$, then we would find
%
\[ b(\kappa(x_0),\eta) = \left\{ S e^{2 \pi i \eta \cdot z} \right\}(\kappa(x_0)) = \int a(x_0,\xi) e^{2 \pi i [\xi \cdot (x_0 - x) + \eta \cdot \kappa(x)]}\; dx\; d\xi \]
%
Provided we show that $b \in S^t(V)$, then $b(x_0,D)$ will be a continuous operator whose kernel is compactly supported in $V \times V$, and the fact that $S e^{2 \pi i \eta \cdot z} = b(y,D) e^{2 \pi i \eta \cdot z}$ for all $\eta$ implies, by continuinty and the fact that linear combinations of exponentials are dense in $\mathcal{D}(V)^*$, that $S = b(y,D)$. Thus our analysis would be completed by an analysis of the function $b(y,\eta)$. If $\phi \in C_c^\infty(V)$ is chosen such that $\phi(y_1) = \phi(y_2) = 1$ for $(y_1,y_2)$ in the kernel of $S$, then
%
\[ b(\kappa(x_0),\eta) = \left\{ \phi S \left\{ \phi \cdot e^{2 \pi i \eta \cdot z} \right\} \right\}(\kappa(x_0)), \]
%
which implies that $b \in C^\infty(T^* V)$. If we set
%
\[ \Phi(\xi,\eta) = \int \phi(x) e^{2 \pi i [ \eta \cdot \kappa(x) - \xi \cdot x ]}\; dx, \]
%
then
%
\[ b(\kappa(x_0), \eta) = \int a(x_0,\xi) \Phi(\xi,\eta) e^{2 \pi i \xi \cdot x_0}\; d\xi. \]
%
Now $\Phi$ is a standard oscillatory integral, whose phase $\phi(x) = \eta \cdot \kappa(x) - \xi \cdot x$ has a stationary point for values of $x$ such that $D\kappa(x)^T \eta = \xi$. Since $D\kappa(x)^T$ is invertible, this can only happen when $|\eta| \sim |\xi|$. More precisely, suppose $|D\kappa(x)|, |D\kappa(x)^{-1}| \leq C$. Then $|D\kappa(x)^T \eta - \xi| \geq |\xi|/2 \gtrsim_C |\xi| + |\eta|$, and $|D\kappa(x)^T \eta - \xi| \geq |\eta|/2 \gtrsim_C |\xi| + |\eta|$ for $|\xi| \leq |\eta|/2C$. Thus unless $2C|\eta| \geq |\xi| \geq |\eta|/2C$, we conclude by the principle of nonstationary phase that for each $N > 0$,
%
\[ |\Phi(\xi,\eta)| \lesssim_N [1 + |\xi| + |\eta|]^{-N}, \]
%
where the implicit constant will be uniformly bounded over a family of diffeomorphisms $\kappa$ and a family of pseudodifferential operators $T$ if the kernels of the resulting operators $S$ are uniformly supported on a common compact subset of $V \times V$, and if we have uniform upper and lower bounds on the derivative of $\kappa$ on the support of these kernels. If we write $1 = \chi_1 + \chi_2$, for $\chi_1,\chi_2 \in C^\infty(\RR^d)$ with $\chi_1(\alpha)$ supported on $1/2C \leq |\alpha| \leq 2C$ and equal to one when $1/C \leq |\alpha| \leq C$, then this induces a decomposition $b(\kappa(x_0),\eta) = b_1(\kappa(x_0),\eta) + b_2(\kappa(x_0),\eta)$, where
%
\[ b_i(\kappa(x_0),\eta) = \int \chi_i(\xi/|\eta|) a(x_0,\xi) \Phi(\xi,\eta) e^{2 \pi i \xi \cdot x_0}\; d\xi. \]
%
The bound on $\Phi(\xi,\eta)$ above implies that $b_1 \in S^{-\infty}$. To analyze $b_2$, we apply the method of stationary phase. To simplify our formulas, let us assume without loss of generality that $x_0 = \kappa(x_0) = 0$ and that $B = D\kappa(x_0)$. If we fix $|\eta| = 1$, consider $\lambda > 1$, and do a change of variables, replacing $\xi$ with $\lambda (\xi + B^T \eta)$, we find that
%
\[ b_2(\kappa(x_0),\lambda \eta) = \lambda^d \int \psi(x,\xi) a(x,\lambda B^T \eta + \xi)) e^{2 \pi i \lambda \phi(x,\xi)}\; d\xi\; dx, \]
%
where $\psi(\xi,x) = \chi_2(\xi + B^T \eta) \phi(x_0 + x)$ and $\phi(x,\xi) = \eta \cdot (\kappa(x) - Bx) - \xi \cdot x$. This is a continuous family of non-degenerate stationary phase integrals, each with a unique stationary point when $(x,\xi) = (0,0)$. Since $\psi$ is equal to one in a neighborhood of this point, it will not show up in the corresponding asymptotics. The Hessian at the origin is precisely $A + B$, where
%
\[ A = \begin{pmatrix} 0 & -I \\ -I & 0 \end{pmatrix} \]
%
and
%
\[ C = \begin{pmatrix} \tilde{C} & 0 \\ 0 & 0 \end{pmatrix} \]
%
where $\tilde{C} = \tilde{C}(\eta)$ is the Hessian of the map $x \mapsto \eta \cdot \kappa(x)$ at the origin. If we set
%
\[ r(x) = \eta \cdot (\kappa(x) - Bx) - (1/2)(x^T A x) \]
% - 0.5 Dkappa(x)^T eta + D kappa(x)^T eta
%
which satisfies $D^\alpha r(0) = 0$ for all $|\alpha| \leq 2$, then it follows that if $a_\lambda(x_0,\xi) = a(x_0,\lambda \xi)$, then
% A -I    0  -I
% -I 0    -I -A
% - D_\xi^T D_x
% -D_x^T D_xi - D_xi^T A^T D_xi
\[ b_2(\kappa(x_0),\lambda \eta) \sim \sum_{2 \nu \geq 3 \mu} \frac{1}{(-2)^\nu} \frac{1}{\mu! \nu!} \frac{1}{(2\pi i \lambda)^{\nu - \mu}} \langle (A + B)^{-1} D, D \rangle^\nu \{ r^\mu a_\lambda \}(x, D\kappa(x)^T). \]
%
The next Lemma implies that we can write this asymptotic development as
%
\[ b_2(\kappa(x_0),\lambda \eta) \sim \sum_{\nu = 0}^\infty \langle i D_x / 2\pi, D_\xi / \lambda \rangle^\nu \left\{ e^{2 \pi i \lambda r(x)} a_\lambda(0,\xi) \right\}_{x = 0, \xi = B^T \eta} \]
%
where if we sum over $\nu \leq N$, then the error term will be $O(\lambda^{(d-N)/2})$.

\begin{lemma}
    Let $A$ be a symmetric, invertible matrix, let $B$ be a symmetric matrix, and suppose $\det(A + tB)$ is independent of $t$. Then there exists $k$ such that $(A^{-1}B)^k = 0$ for some $k$. For this $k$, and for any $N > 0$,
    %
    \[ \sum_{j < N} \frac{1}{j!} (2 i \lambda)^{-j} \langle (A + B)^{-1} D, D \rangle^j u(0) = \sum_{j < N} \frac{1}{j!} (2 i \lambda)^{-j} \langle A^{-1}D, D \rangle^j \left\{ e^{2 \pi i \lambda x^T B x / 2} u \right\}(0) + O(\lambda^{-N/k}). \]
\end{lemma}
\begin{proof}
    See Hormander, 7.7.
\end{proof}

Thus we have proved the following representation formula for pseudodifferential operators under changes of coordinates.

\begin{theorem}
    Let $\kappa: U \to V$ be a diffeomorphism, where $U$ and $V$ are open sets in $\RR^n$, and suppose $T = a(x,D)$ is a pseudodifferential operator of order $t$ on $U$. If $S$ is an operator defined on $V$ defined such that $\kappa_* \circ S = T \circ \kappa_*$, then $S$ is a psedodifferential operator of order $t$, whose symbol $a_\kappa$ has the asymptotic development
    %
    \[ a_\kappa(\kappa(x),\eta) \sim \sum \frac{1}{\alpha!} D^\alpha_\xi a(x,D\kappa(x)^T \eta) D^\alpha_y e^{2\pi i \eta \cdot r_x(y)}, \]
    %
    where $r_x(y) = \kappa(y) - \kappa(x) - D\kappa(x)(y-x)$. Each term in this sum corresponding to $\alpha$ lies in $S^{m-|\alpha|/2}$.
\end{theorem}

\emph{Compactly supported} pseudodifferential operators are therefore invariant under a change of coordinates, modulo smoothing operators. More precisely, if $T$ is a pseudodifferential operator on an open set $U \subset \RR^n$, of order $t$, compactly supported in $x$, and $\kappa: U \to V$ is a diffeomorphism, then there is a pseudodifferential operator $S$ of order $t$, compactly supported on $V$ such that, modulo smoothing operators,
%
\[ S \circ \kappa_* = \kappa_* \circ T. \]
%
Moreover, if $a(x,\xi)$ is a symbol representing $T$, and $b(y,\xi)$ is a symbol representing $S$, then
%
\[ b(y,\eta) - a(\kappa^{-1}(y), D\kappa(x)^{-T} \cdot \eta) \]
%
is a pseudodifferential operator of order $t - 1$.

\begin{theorem}
    Let $U$ and $V$ be open subsets of Euclidean space together with a diffeomorphism $\kappa: U \to V$ be a diffeomorphism. If $a(x,\xi)$ is a symbol of order $m$, and $\text{supp}_x(a)$ forms a compact subset of $U$, then
    %
    \[ a_\kappa(y,\eta) = e^{-2 \pi i \kappa^{-1}(y) \cdot \eta} a(x,D) e^{2 \pi i y \cdot \eta}. \]
    %
    TODO (H\"{o}rmander's book seems to have the most readable discussion)
\end{theorem}

In light of this, given a manifold $M$, a continuous operator $T: C_c^\infty(M) \to C^\infty(M)$ is called a \emph{pseudodifferential operator of order $t$} if whenever $(x,U)$ is a coordinate chart on $M$, $\psi_0, \psi_1 \in C_c^\infty(U)$, and $\psi_1 = 1$ on a neighborhood of the support of $\psi_0$, then the operator `in coordinates', i.e. the operator $T_x: C_c^\infty(x(U)) \to C^\infty(x(U))$ given by
%
\[ T_x f = \left( \psi_0 \cdot T(\psi_1 \cdot (f \circ x)) \right) \circ x^{-1} \]
%
is a pseudodifferential operator of order $t$ on $x(U)$. We let $\Psi_{\text{loc}}^t(M)$ denote the family of operators of this form. The next Lemma shows that when $M = U$ is an open subset of $\RR^n$, this really is the family of pseudodifferential operators defined by symbols in $\mathcal{S}^t_{\text{loc}}(T^* U)$.

\begin{lemma}
    Suppose $T: C_c^\infty(U) \to C^\infty(U)$ is a pseudodifferential operator as above. Then we can find a symbol $a(x,\xi) \in \mathcal{S}^t_{\text{loc}}(U \times \RR^d)$ such that the kernel of $T = T_a + S$, where $S$ has a kernel in $C^\infty(U \times U)$. The symbol $a$ is uniquely determined up to a symbol in $\mathcal{S}^{-\infty}(\RR^d \times \RR^d)$.
\end{lemma}
\begin{proof}
    The idea is to work on a partition of unity, which we can sum up appropriately to get a sum over local estimates. The complete proof is supplied in Hormander, Proposition 18.1.19.
\end{proof}

\begin{remark}
    It suffices to verify the condition defining a pseudodifferential operator for $\{ \psi_i \}$ ranging over an atlas of the manifold $M$. If we assume that the operator has a kernel smooth away from the diagonal, it suffices to only verify it for maps $\psi_1 = \psi_2$ ranging over an atlas.
\end{remark}

It is often to discuss operators that can be asymptotically expanded in terms of homogeneous symbols. That is, a symbol $a$ of order $t$ is classical if there exist a sequence of symbols $\{ a_k \}$, where $a_k(x,\xi)$ is homogeneous of order $t - k$ for suitably large $\xi$, and
%
\[ a \sim \sum_{k = 0}^\infty a_k. \]
%
We call such operators \emph{classical pseudodifferential operators}, since this was the context first studied by Kohn and Nirenberg. In particular, given a manifold $M$, we write $\Psi_{\text{cl}}^t(M)$, or $\text{Op}(\mathcal{S}^t_{\text{cl}}(M))$ for the subset of all operators $T$ in $\Psi$ such that $T_x$ is classical for every coordinate system $(x,U)$ on $M$. The homogeneous function which agrees with the leading term in the expansion is invariant under coordinate changes, so for a classical pseudodifferential operator $T$ in $\Psi_{\text{cl}}^t(M)$, we can define the \emph{principal symbol} $a \in C^\infty(T^* M - 0)$ to be that homogeneous function of order $t$ which agrees with the leading term in the asymptotic expansions above. For nonclassical operators, there is no canonical choice of a principal symbol, though one can consider the principal symbol as an element of $\mathcal{S}^t_{\text{loc}}(M) / \mathcal{S}^{t-1}_{\text{loc}}(M)$. A classical pseudodifferential operator is called \emph{elliptic} if it's principal symbol is nonvanishing away from the origin, and a general pseudodifferential operator of order $t$ is called elliptic if one can choose a representative principal symbol $a(x,\xi)$ such that we have an estimates $|a(x,\xi)| \sim |\xi|^t$ for large $t$, where the estimate holds locally uniformly in $x$.

\begin{example}
    On a compact Riemannian manifold $M$, the operator $- \Delta$ is a positive-semidefinite differential operator of order two with symbol given in local coordinates as
    %
    \[ a(x,\xi) = \sum g^{i,j}(x) \xi_i \xi_j. \]
    %
    The spectral theory of this operator decomposes it as a sum $\sum \lambda_i^2 E_i$, where $E_i$ is an orthogonal projection onto a one dimensional eigenspace, and $\lambda_0 \leq \lambda_1 \leq \dots$ are ordered by multiplicity. Then we can define the operator $\sqrt{-\Delta}$ to be the operator $\sum \lambda_i E_i$. Let us argue that $\sqrt{-\Delta}$ is a classical pseudodifferential operator of order one on $M$. More precisely, we will construct a positive definite pseudodifferential operator $Q$ of order one such that $Q - \sqrt{-\Delta}$ is smoothing.

    To construct $Q$, we first consider the modified Laplacian $Lu = E_0u + \sum_{i \geq 1} \lambda_i^2 E_i$. Then $L$ is invertible since it is positive definite, and differs from $- \Delta$ by the smoothing operator
    %
    \[ E_0 u = \frac{1}{\text{Vol}(M)} \int_M u(x) dV(x). \]
    %
    We will not exploit the fact that $L$ is invertible until the end of the argument, but keep this invertibility in mind for later.

    To begin with, we construct a positive definite $Q \in \Psi_{\text{cl}}^1(M)$ such that $L - Q^2$ is a smoothing operator. To do this we may assume without loss of generality that we are working in a small coordinate patch in local coordinates, and that we are patching these locally defined parts of the operator globally using a partition of unity. We then define
    %
    \[ \tilde{b}_1(x,\xi) = \chi_1(\xi) \left( \sum g^{i,j}(x) \xi_i \xi_j \right)^{1/2} \]
    %
    where $\chi_1$ is smooth and vanishes for $|\xi| \leq 1$. Now define $Q_1 = b_1(x,D)$ to be equal to the pseudodifferential operator $\text{Re}(\tilde{b}_1(x,D)) = (1/2)(\tilde{b}_1(x,D) + \tilde{b}_1(x,D)^*)$. The calculus of pseudodifferential operators tells us that $b_1$ is a classical symbol of order one, and the principal part of $b_1$ agrees with the principal part of $\tilde{b}_1$. We therefore conclude that $R_1 = L - Q_1^2$ is a classical pseudodifferential operator of order one with principal symbol $r_1(x,\xi)$.

    We now proceed inductively, assuming that we have found classical symbols $b_i$ of order $2 - i$ for each $1 \leq i \leq n$, such that if $Q_i = b_i(x,D)$, then $Q_i$ is self-adjoint, and $R_n = L - (Q_1 + \dots + Q_n)^2$ is a classical pseudodifferential operator of order $2 - n$ with some principal symbol $r_n(x,\xi)$ of order $2 - n$. Our goal is now to find a non-negative symbol $\tilde{b}_{n+1}(x,\xi)$, homogeneous of order $1 - n$ for large $\xi$, defining a self-adjoint pseudodifferential operator $Q_{n+1}$ such that $L - (Q_1 + \dots + Q_{n+1})^2$ is a classical pseudodifferential operator of order $1 - n$. Expanding out the order $2 - n$ part of $L - (Q_1 + \dots + Q_{n+1})^2$, this is possible provided that for large $\xi$,
    %
    \[ r_n(x,\xi) = 2 b_1(x,\xi) b_{n+1}(x,\xi) \]
    %
    Thus we define
    %
    \[ \tilde{b}_{n+1}(x,\xi) = \chi_{n+1}(\xi) \left( \frac{r_n(x,\xi)}{2 b_1(x,\xi)} \right) \]
    %
    where $\chi_{n+1}$ is smooth, equal to one for large $\xi$, and vanishes for values of $\xi$ such that $b_1(x,\xi) = 0$, and then set $b_{n+1}$ to be the classical symbol of order $1 - n$ such that $Q_{n+1} b_{n+1}(x,D) = \text{Re}(\tilde{b}_{n+1}(x,D))$. Then $R_{n+1} = L - (Q_1 + \dots + Q_{n+1})^2$ is a classical pseudodifferential operator of order $1 - n$, allowing us to continue our induction.

    Thus we find now that we have constructed an infinite sequence of classical pseudodifferential operators $b_1, b_2, \dots$, where $b_i$ is order $2 - i$. Using symbol asymptotics, we can therefore pick any representative symbol $\tilde{b}$, such that
    %
    \[ \tilde{b} \sim \sum_{i = 1}^\infty b_i, \]
    %
    and then $\tilde{b}$ will be a classical symbol of order 1. The fact that each of the operators $Q_i$ is self-adjoint implies that the difference between $\tilde{b}(x,D)$ and $\text{Re}(\tilde{b}(x,D))$ is a smoothing operator. Thus if we let $b$ be the symbol of $\text{Re}(\tilde{b}(x,D))$, then we find
    %
    \[ b \sim \sum_{i = 1}^\infty b_i, \]
    %
    the operator $Q = b(x,D)$ is self-adjoint, and $L - Q^2$ is a smoothing operator.

    We claim that $\sqrt{L} - Q$ is also a smoothing operator. To see this, we employ heuristics from the holomorphic functional calculus. Since the spectrum of $L$ is contained in $(\varepsilon,\infty)$ for some $\varepsilon > 0$, and the function $\sqrt{z}$ is holomorphic in a neighborhood of this region, if we consider the rectifiable curve $\gamma(t) = |t| + i \text{sgn}(t) \cdot t$, then we should expect to have
    %
    \[ L^{-1/2} = \frac{1}{2 \pi i} \int_\gamma z^{-1/2} (z - L)^{-1}\; dz. \]
    %
    The operator $(z - L)^{-1}$ is bounded, with operator norm $O(1/z)$ for large $z$, and operator norm $O(1)$ for small $z$, which implies that the operator-valued integral is absolutely convergent. Thus the left hand and right hand side of this equation both define bounded operators on $L^2(M)$. And for each of the eigenvectors $e_i$ for $L^{-1}$,
    %
    \[ \frac{1}{2 \pi i} \int_\gamma z^{-1/2} (z - L)^{-1} e_i\; dz = \left( \frac{1}{2 \pi i} \int_\gamma z^{-1/2} (z - \lambda_i)^{-1} \right) e_i = \lambda_i^{-1/2} e_i, \]
    %
    so $L^{-1/2}$ and the integral formula have the same eigenvectors and eigenvalues, and are therefore equal. Similarily,
    %
    \[ Q^{-1} = \frac{1}{2 \pi i} \int_\gamma z^{-1/2} (z - Q^2)^{-1}, \]
    %
    since $Q^{-2}$ is bounded and positive definite, hence diagonalizable, and so one can apply analogous arguments to those above. If we set $R = L - Q^2$, then
    %
    \begin{align*}
        L^{-1/2} - Q^{-1} &= \frac{1}{2 \pi i} \int_\gamma z^{-1/2} \left( (z - L)^{-1} - (z - Q^2)^{-1} \right)\\
        &= \frac{1}{2 \pi i} \int_\gamma z^{-1/2} \left( (z - L)^{-1} - (z - L + R))^{-1} \right)\\
        &= \frac{1}{2 \pi i} \int_\gamma z^{-1/2} (z - (L + R))^{-1} R (z - L)^{-1}.
    \end{align*}
    %
    Because the operator norm of $(z - (L + R))^{-1}$ and $(z - L)^{-1}$ are each individually $O(1/z)$, and $R$ is a smoothing operator, if we let $T_z$ be the integrand of this operator, then for any $k > 0$,
    %
    \[ \| T_z u \|_{L^2_k(M)} \lesssim_k \frac{1}{1 + z^2} \cdot \| u \|_{L^2(M)}, \]
    %
    and from this we see that $L^{-1/2} - Q^{-1}$ is a smoothing operator. But now we can write
    %
    \[ Q - L^{1/2} = Q(L^{-1/2} - Q^{-1}) L^{-1/2}, \]
    %
    and so we see that $Q - L^{1/2}$ is a smoothing operator. But this means that $Q - \sqrt{-\Delta}$ is smoothing.
\end{example}











\section{Self-Adjoint Elliptic Pseudo-Differential Operators on Compact Manifolds}

Given a scalar density $d\omega$ on a manifold $M$, we can consider $L^2(M)$ as a Hilbert space induced by the inner product
%
\[ \langle u, v \rangle = \int u(x) \overline{v(x)}\; d\omega. \]
%
Thus given a scalar density we can consider the adjoint of a pseudodifferential operator on $M$ by considering the operator as an unbounded operator on $L^2(M)$, and in particular, we can consider self-adjoint operators on $M$. If $T$ is a classical self-adjoint pseudodifferential operator of order $t$, then it follows from the calculus of pseudodifferential operators that it's principal symbol is real-valued. If $T$ is self-adjoint and also \emph{elliptic}, and $M$ has dimension bigger than one, it also follows that the principal symbol is either positive everywhere, or negative everywhere for large $\xi$.

If the principal symbol of this elliptic, self-adjoint classical operator $T$ is positive away from the origin, one might expect $T$ to be `positive semidefinite'. For simplicity, in what follows let us assume $T$ has order one, with principal symbol $a(x,\xi)$. The techniques here will extend to general elliptic, self-adjoint pseudodifferential operators of any order by \emph{H\"{o}rmander's Square Root Trick}.

\begin{lemma}
    There exists a self-adjoint classical pseudodifferential operator $S$ of order $1/2$ such that $T - S^* S$ is a smoothing operator. Thus $T$ differs from a positive-semidefinite operator by a smoothing operator.
\end{lemma}
\begin{proof}
    We proceed as in the proof that $\sqrt{-\Delta}$ is a classical pseudodifferential operator. Let $S_0$ be a classical self-adjoint pseudodifferential operator of order $1/2$ with principal symbol $b_0(x,\xi) = a(x,\xi)^{1/2}$, then $S_0^* S_0$ is positive-semidefinite, and $T - S_0^* S_0$ is a classical pseudodifferential operator of order zero. Let $r_1$ denote the principal symbol of this operator. More generally, let us suppose that $T - (S_0 + \dots + S_n)^* (S_0 + \dots + S_n)$ is a classical pseudodifferential operator of order $-n$, with principal symbol $r_n$. If we consider a classical psuedodifferential operator $S_{n+1}$ of order $1/2 - (n+1)$ with principal symbol $b_{n+1}(x,\xi) = r_n(x,\xi) / 2 b_0(x,\xi)$, then $T - (S_0 + \dots + S_{n+1})^* (S_0 + \dots + S_{n+1})$ is a classical pseudodifferential operator of order $-(n+1)$. Thus if we choose a self-adjoint pseudodifferential operator $S$ of order $1/2$ such that $S \sim \sum_{i = 0}^\infty S_i$, then $T - S^* S$ is smoothing. 
\end{proof}

\begin{lemma}
    There exists $\lambda > 0$ such that for $u \in L^2_{1,\text{comp}}(M)$,
    %
    \[ \int (T + \lambda) u(x) \overline{u}(x)\; dx \sim \| u \|_{L^2_{1/2}(M)}^2, \]
    %
    where the implicit constants are locally uniform over $u$ supported on a common compact subset of $M$. If $M$ is compact, then we can choose $\lambda$ such that $T + \lambda$ is an isomorphism from $L^2_1(M)$ to $L^2(M)$.
\end{lemma}
\begin{proof}
    Choose a self-adjoint pseudodifferential operator $S$ of order $1/2$ such that $T - S^* S$ is smoothing. Then for $u \in L^2_{1,\text{comp}}(M)$,
    %
    \begin{align*}
        \left| \int_M Tu(x) \overline{u}(x)\; dx - \| Su \|_{L^2(M)}^2 \right| &= \left| \int_M (T - S^* S) u(x) \overline{u}(x)\; dx \right| \lesssim \| u \|_{L^2(M)}^2.
    \end{align*}
    %
    Since $S$ has principal symbol $a(x,\xi)^{1/2}$, it is elliptic, so we can find a parametrix $L$ for $S$, which has order $-1/2$, and so for $u \in L^2_{1/2}(M)$,
    %
    \begin{align*}
        \| u \|_{L^2_{1/2}(M)}^2 &= \| LSu + (I - LS)u \|_{L^2_{1/2}(M)}\\
        &\leq \| LSu \|_{L^2_{1/2}(M)}^2 + \| u \|_{L^2(M)}^2\\
        &\lesssim \| Su \|_{L^2(M)}^2 + \| u \|_{L^2(M)}^2.
    \end{align*}
    %
    Thus
    %
    \begin{align*}
        \| u \|_{L^2_{1/2}(M)}^2 &\leq C \| S u \|_{L^2(M)}^2 + C \| u \|_{L^2(M)}^2\\
        &\leq C_1 \int_M Tu(x) \overline{u}(x)\; dx + C_2 \| u \|_{L^2(M)}^2\\
        &= C_1 \int_M (T + C_2/C_1) u(x) \overline{u}(x)\; dx.
    \end{align*}
    %
    Thus if $\lambda = C_2 / C_1$, then
    %
    \[ \int_M (T + \lambda) u(x) \overline{u}(x)\; dx \gtrsim \| u \|_{L^2_{1/2}(M)}^2 \gtrsim \| u \|_{L^2(M)}^2, \]
    %
    which gives the first inequality. On the other hand, we know that
    %
    \[ \int_M (T + \lambda) u(x) \overline{u}(x)\; dx \lesssim \| Su \|_{L^2(M)}^2 + \| u \|_{L^2(M)}^2 \lesssim \| u \|_{L^2_{1/2}(M)}^2, \]
    %
    so we conclude that
    %
    \[ \int_M (T + \lambda) u(x) \overline{u}(x)\; dx \sim \| u \|_{L^2_{1/2}(M)}. \]
    %
    Now let us assume $M$ is compact. Certainly $T + \lambda$ is bounded from $L^2_1(M)$ to $L^2(M)$. But we therefore calculate that for $f \in L^2_1(M)$,
    %
    \[ \| (T + \lambda) f \|_{L^2(M)}^2 \geq \lambda^2 \| f \|_{L^2(M)}^2 - 2 \lambda \langle Tf, f \rangle \geq (\lambda^2 - 2C \lambda) \| f \|_{L^2_1(M)}^2, \]
    %
    which implies that for suitably large $\lambda$, $T + \lambda$ is an isomorphism since we have an estimate of the form
    %
    \[ \| (T + \lambda) f \|_{L^2(M)} \gtrsim \| f \|_{L^2_1(M)} \]
    %
    and we can then apply the open mapping theorem.
\end{proof}

Let us now deal with a compact manifold $M$, and $\lambda$ chosen as above. The calculation above shows that $(T + \lambda)^{-1}$ acts as a continuous, positive definite linear map from $L^2(M)$ to itself. This map is compact because of the Rellich-Kondrachov theorem. Thus we can apply spectral theory, i.e. we can find an orthogonal basis $\{ e_i \}$ for $L^2(M)$ and a family of positive, decreasing family of eigenvalues $0 < \lambda_1 \geq \lambda_2 \geq \dots$ such that if $E_i$ is orthogonal projection onto the span of $e_i$, then $(T + \lambda)^{-1} = \sum_i \lambda_i^{-1} E_i$. But this means that $T = \sum_i (\lambda_i - \lambda) E_i$. Thus we have found a way to diagonalize any self-adjoint elliptic operator of order one on a compact manifold.

Applying elliptic regularity, since $e_i \in L^2(M)$, $(T + \lambda) e_i = \lambda_i e_i$ lies in $L^2_1(M)$, and thus $e_i \in L^2_1(M)$. Iterating this argument gives that $e_i \in L^2_N(M)$ for any $N > 0$. Applying Sobolev regularity thus shows that $e_i$ is a smooth function on $M$ for each $i$. Moreover, if $f \in L^2_1(M)$, then because $T + \lambda$ is an isomorphism from $L^2_1(M)$ to $L^2(M)$, we conclude that
%
\[ \| f \|_{L^2_1(M)}^2 \sim \| (T + \lambda) f \|_{L^2(M)}^2 = \sum (\lambda_i + \lambda)^2 \| E_i f \|_{L^2(M)}^2, \]
%
from which we conclude that $\| E_i f \|_{L^2(M)}^2 \lesssim \| f \|_{L^2_1(M)} / |\lambda_i + \lambda|$ and thus for $\lambda_i \geq 2\lambda$, $|\langle f, e_i \rangle| \lesssim \| f \|_{L^2_1(M)} / \lambda_i$. More generally, the argument above can be repeated to show that for each $m > 0$, there is $\lambda_m$ such that $(T + \lambda_m)^m$ is an isomorphism from $L^2_m(M)$ to $L^2(M)$. We conclude from this that for $\lambda_i \geq 2 \lambda_m$, $\| E_i f \|_{L^2(M)} \lesssim_m \| f \|_{L^2_m(M)} / \lambda_i^m$. In particular, if $f \in C^\infty(M)$, then the $L^2$ norms of it's projections vanish quickly near infinity.

Now let us introduce H\"{o}rmander's square root trick. Suppose $T$ is a formally positive self-adjoint elliptic classical pseudodifferential operator of order $m > 0$. Then we can use the spectral theory of unbounded operators to define a self-adjoint operator $T^{1/m}$. As with the proof that $\sqrt{-\Delta}$ is a classical pseudodifferential operator of order one, we can consider a positive semidefinite, elliptic, classical pseudodifferential operator $Q$ of order $1$ such that $T - Q^m$ is smoothing, and using the same techniques as for the Laplacian, conclude that $T^{1/m} - Q$ is smoothing, from which the fact that $T^{1/m}$ is an elliptic, self-adjoint classical pseudodifferential operator of order one. Thus we can reduce the study of operators $T$ as above to the study of the operator $T^{1/m}$, especially since they diagonalize in the same way.

\section{The Half Wave Operator}

Given a pseudodifferential operator $T$, we consider the \emph{half-wave equation}
%
\[ \partial / \partial t + (2 \pi i) T = 0. \]
%
Studying this equation is useful to understanding the operator $T$.
%In particular, it helps us understand the Fourier transform of $T$, i.e. the family of operators $e^{-2 \pi i t T}$, since this family of operators forms a fundamental solution to the half-wave equation.

We will focus on the case where $T$ is self-adjoint, elliptic of order one, and formally positive. In this case, in the last section we have a diagonalization $T = \sum \lambda_i E_i$. If we consider a solution to the half-wave equation given as an $L^2$ expansion
%
\[ u_t(x) = \sum a_i(t) e_i(x) \]
%
for some appropriately smooth $a_i$ with $c_i = a_i(0)$, then we conclude that $a_i(t) = c_i e^{-2 \pi i \lambda_i t}$. Thus thus propogation operators for the half-wave equation are precisely the unitary operators
%
\[ e^{-2 \pi i t T} = \sum e^{-2 \pi i t \lambda_i} E_i. \]
%
Our goal is to better understand the half-wave equation by finding an integral formula for $e^{-2 \pi i t T}$, at least modulo smoothing operators. In fact, if $a_1$ is the principal symbol of $T$, we will find that we can consider an integral operator
%
\[ S(t) f(x) = \int s(t,x,y,\xi) e^{2 \pi i [\phi(x,y,\xi) - t a_1(y,\xi)]} f(y)\; dy\; d\xi, \]
%
such that for $|t| \lesssim 1$, $S(t) - e^{-2 \pi i t T}$ is a smoothing operator, where $s$ is a symbol of order zero, $\phi$ is a symbol of order one, $\phi(x,y,\xi) \approx (x - y) \cdot \xi$ in the sense that for any multi-index $\beta$,
%
\[ D^\beta_\xi \{ \phi(x,y,\xi) - (x - y) \cdot \xi \} \lesssim_\beta |x - y|^2 |\xi|^{1 - \beta}, \]
%
and $s$ is supported on $|x - y| \lesssim 1$ in such a way that $\nabla_\xi \phi(x,y,\xi) \gtrsim |x - y|$ for $x$ and $y$ in the support of $s$. Our goal is now to determine what properties we need $s$ and $\phi$ to satisfy in order for $S(t)$ to approximate $e^{-2 \pi i t T}$.

If $S(t)$ is meant to be approximate $e^{-2 \pi i t T}$, then we would hope that
%
\[ (\partial / \partial t + 2 \pi i T) \circ S(t) \]
%
is a smoothing operator. In local coordinates, if $T$ has symbol $a(x,\xi)$, then
%
\begin{align*}
    K(t,x,y) &= \int \frac{d}{dt} \left\{ s(t,x,y,\xi) e^{2 \pi i (\phi(x,y,\xi) + t a_1(x,\xi))} \right\}\; d\xi\\
    &\quad + 2 \pi i \int \int a(x,\xi) s(t,z,y,\eta) e^{2 \pi i ( \xi \cdot (x - z) + \phi(z,y,\eta) + t a_1(z,\eta))}\; dz\; d\xi\; d\eta.
\end{align*}
%
If $\Phi(t,z,y,\eta) = \phi(z,y,\eta) + t a_1(y,\eta)$, then we can write the set term in the definition of the kernel as
%
\[ K(t,x,y) = \int (\partial / \partial t + 2 \pi i T) \{ s(t,\cdot,y,\eta) e^{2 \pi i \Phi(t,\cdot, y, \eta)} \}(x)\; d\eta. \]
%
At the beginning of our notes on pseudodifferential operators, we were able to build up asymptotics for applications of pseudodifferential operators to oscillating quantities. In fact, these asymptotics imply that
%
\begin{align*}
    e^{-2 \pi i \Phi(t,x,y,\eta)} (2 \pi i T) & \{ s(t,\cdot,y,\eta) e^{2 \pi i \Phi(t,\cdot, y, \eta)} \}(x)\\
    &= 2 \pi i a_1(x, \nabla_x \Phi(t,x,y,\eta)) \cdot s(t,x,y,\eta)\\
    &= 2 \pi i a_1(x, \nabla_x \phi(x,y,\eta)) \cdot s(t,x,y,\eta),
\end{align*}
%
modulo symbols of order $-1$ in $\eta$. Thus we can write the kernel of $(\partial / \partial t + 2 \pi i T) S(t)$ as
%
\[ (x,y) \mapsto 2 \pi i \int e^{2 \pi i \Phi(t,x,y,\eta)} \Bigg\{ \Big( a_1(y,\eta) - a_1(x, \nabla_x \phi(t,x,y,\eta) \Big) s(t,x,y,\eta) + R \Bigg\} \; d\eta, \]
%
where $R$ is a symbol of order $0$. In order for this to be smoothing, it is thus natural to apriori assume that $a_1(y,\eta) = a_1(x,\nabla_x \phi(x,y,\eta))$ for all triples $(x,y,\eta)$. The theory of Hamilton-Jacobi equations shows that there exists a \emph{unique} $\phi(x,y,\eta)$ with this property such that $\phi(x,y,\eta) = 0$ when $|x - y| \lesssim 1$ and $(x - y) \cdot \eta = 0$, and $\nabla_x \phi(x,y,\eta) = \eta$ when $x = y$. This implies that for $|x - y| \lesssim 1$,
%
\[ \phi(x,y,\eta) = (x - y) \cdot \eta + O( |x - y|^2 |\eta| ) \]
%
Thus we have specified our phase function $\phi$ completely. There is a small inconvenience that $\phi$ might not be differentiable at the origin. However, this does not cause us a problem, because an operator with kernel
%
\[ \int \rho(\eta) e{2 \pi i \Phi(t,x,y,\eta)} s(t,x,y,\eta)\; d\eta, \]
%
where $\rho$ is a smooth cutoff, is a smoothing operator. The next Lemma will allow us to obtain a specification of the amplitude defining the operator.

\begin{comment}
\begin{lemma}
    Consider an operator of the form
    %
    \[ Sf(x) = \int a(x,y,\xi) e^{2 \pi i \phi(x,y,\xi)} f(y)\; dy\; d\xi, \]
    %
    where $a \in S^r$ and vanishes for $|x - y| \gtrsim 1$, $\phi \in S^1$, and is homogeneous of degree one in $\xi$, $|\nabla_\xi \phi(x,y,\xi)| \gtrsim |x - y|$ on the support of $a$, and for all $r > 0$,
    %
    \[ D^\beta_\xi \{ \phi(x,y,\xi) - (x - y) \cdot \xi \} \lesssim_\beta |x - y|^2 |\xi|^{1-|\beta|}. \]
    %
    Then $S$ is well defined, and is actually a pseudodifferential operator of order $r$. If $T$ is the pseudodifferential operator with symbol $(x,\xi) \mapsto a(x,x,\xi)$, then $T - S$ is a pseudodifferential operator of order $r-1$.

    Conversely, for \emph{any} $\Psi DO$ $T$ of order $r$, there exists a symbol $a$ of order $r$ such that for the resulting operator $S$ of order $r$, $S - T$ is a smoothing operator.
\end{lemma}
\begin{proof}
    Let us first define the operator $S$. Let $\phi_0(x,y,\xi) = (x - y) \cdot \xi$, $\phi_1(x,y,\xi) = \phi(x,y,\xi)$, $\phi_t = t \phi_1 + (1 - t) \phi_0$, and define $S_t$ with the phase function $\phi_t$ and symbol $a$. Note that $|\nabla_\xi \phi_t| \gtrsim |x - y|$, uniformly in $t$. This enables us to compute the kernel $K_t(x,y)$ for $0 \leq t \leq 1$. For $t = 0$ we have a pseudodifferential operator, and for $t = 1$, we get the kernel $K(x,y)$ we get to compute. It is also simple to see that, since $|\nabla_\xi \phi_t| \gtrsim |x - y|$, that for large $N$,
    %
    \[ K(x,y)| \lesssim_N \frac{1}{|x - y|^N}, \]
    %
    so we already see that $S$ is somewhat pseudolocal.

    We have
    %
    \[ \frac{\partial^N K_t(x,y)}{\partial t^N} = (2 \pi i)^N \int (\phi_1(x,y,\xi) - \phi_0(x,y,\xi))^N a(x,y,\xi) e^{2 \pi i \phi_t(x,y,\xi)}\; d\xi. \]
    %
    Now $(\phi_1 - \phi_0)^N \cdot a$ is a symbol of order $r + N$. But on the other hand, using the fact that $(\phi_1 - \phi_0)^N \lesssim |x - y|^{2N} |\xi|^N$, and thus vanishes to order $2N$ on the diagonal, then combined with the fact that $|\nabla_\xi \phi(x,y,\xi)| \gtrsim |x - y|$, we actually see via an integration by parts $2N$ times in $\xi$ that we can rewrite the integral in terms of a symbol of order $r - N$ and the same phase $\phi_t$. Applying Taylor's theorem, we write
    %
    \[ K(x,y) = K_1(x,y) = \sum_{k = 0}^{N-1} \frac{1}{k!} \left. \frac{\partial^k K_t(x,y)}{\partial t^k} \right|_{t = 1} + \frac{1}{N!} \int_0^1 t^{N-1} \frac{d^NK_t(x,y)}{dt^N}\; dt. \]
    %
    This integral gives an arbitrarily smooth kernel as $N \to \infty$. Thus if we let $T$ be a pseudodifferential operator of order $r$ such that
    %
    \[ T \sim \sum_{k = 0}^\infty \frac{1}{k!} \left. \frac{\partial^k K_t(x,y)}{\partial t^k} \right|_{t = 1}, \]
    %
    then $T - S$ is a smoothing operator. Now if $\tilde{T}$ is the pseudodifferential operator corresponding to the symbol $a(x,x,\xi)$, then $T - \tilde{T}$, and thus $S - \tilde{T}$, is a pseudodifferential operator of order $r-1$. The converse is similar, working in the opposite direction, i.e. from $t = 1$ to $t = 0$, and is left as an exercise.
\end{proof}
\end{comment}

%Since $I$ is a $\Psi DO$ of order zero, we can find a symbol $a$ of order zero such that if $T$ is the operator with kernel
%
%\[ \int a(x,y,\xi) e^{2 \pi i \phi(x,y,\xi)}\; d\xi, \]
%
%then $T - I$ is a smoothing operator. To ensure that $S(0) - I$ is a smoothing operator, it is natural to insist that $s(0,x,y,\xi) = a(x,y,\xi)$. We note in particular that since $I$ is a $\Psi DO$ with $1$ as a symbol, this implies $s(0,x,x,\xi) - 1$ is a symbol of order $-1$.

Next, we consider constraints must be placed on the appropriate parameters in order for $S(0) - I$ to be a smoothing operator. Certainly $S(0)$ will be a pseudodifferential operator since the wave front set of it's kernel is constrained to the diagonal. The equivalence of phases theorem guarantees that we can choose a symbol $s(0,x,y,\xi)$ of order zero such that $S(0) - I$ will be a smoothing operator, and moreover, $s(0,x,y,\xi) - 1$ is a symbol of order $-1$. Without loss of generality, we may assume the constraint conditions we assumed above on the support of $s$, since this only modifies $S(0)$ by a smoothing operator.

Next, we note that, if $b(t,x,y,\eta)$ is a symbol of order $k$, then modulo symbols of order $k-1$, we have
%
\begin{align*}
    e^{-2 \pi i \Phi(t,x,y,\eta)} (2 \pi i T) & \{ s(t,\cdot,y,\eta) e^{2 \pi i \Phi(t,\cdot, y, \eta)} \}(x)\\
    &= 2 \pi i \cdot a(x, \nabla_x \phi(x,y,\eta)) \cdot b(t,x,y,\eta)\\
    &\quad + \nabla_\eta a(x, \nabla_x \Phi(t,x,y,\eta)) \cdot \nabla_x b(t,x,y,\eta),
\end{align*}
%
modulo symbols of order $k-1$. Thus if $U(t)$ is the operator with kernel
%
\[ \int b(t,x,y,\xi) e^{2 \pi i \Phi(t,x,y,\xi)}\; d\xi, \]
%
then modulo symbols of order $k-1$ in the integrand, we have
%
\begin{align*}
    (\partial / \partial t + 2 \pi i T) \circ U(t)\\
    = \int e^{2 \pi i \Phi(t,x,y,\eta)} & \Bigg\{ \frac{\partial b}{\partial t}(t,x,y,\eta) + 2 \pi i a_0(y,\eta) b(t,x,y,\eta)\\
    &\quad + \nabla_\xi a(x, \nabla_x \Phi(t,x,y,\eta)) \cdot \nabla_x b(t,x,y,\eta) \Bigg\}
\end{align*}

\newpage
%
\begin{align*}
    e^{-2 \pi i \Phi(t,x,y,\eta)} (2 \pi i T) & \{ b(t,\cdot,y,\eta) e^{2 \pi i \Phi(t,\cdot, y, \eta)} \}(x)\\
    &= a(x, \nabla_x \Phi(t,x,y,\eta)) b(t,x,y,\eta)\\
    &\quad + \frac{1}{2 \pi i} \sum_{j = 1}^d D^j_\xi a(x, \nabla_x \Phi(t,x,y,\eta)) D^j_x b(t,x,y,\eta)
\end{align*}


\begin{align*}
    e^{-2 \pi i \Phi(t,x,y,\eta)} (2 \pi i T) & \{ b(t,\cdot,y,\eta) e^{2 \pi i \Phi(t,\cdot, y, \eta)} \}(x)\\
    &= \sum_{|\beta| < 2} \frac{1}{\beta! (2 \pi i)^{|\beta|}} D^\beta_\xi a(x, \nabla_x \Phi(t,x,y,\eta)) D^\beta_x b(t,x,y,\eta)\\
    &\quad - (i/\pi) \sum_{|\beta| = 2} D^\beta_\xi a(x,\nabla_x \Phi(t,x,y,\eta)) D^\beta_y \rho(Z) b(t,x,y,\eta)\\
    &\quad + R(t,x,y,\eta),
\end{align*}
%
where $R$ is a symbol of order $k-2$.
















\chapter{Fourier Integral Operators}

Pseudodifferential operators formalize the family of all operators that modulate the amplitude of wave packets. The theory of Fourier integral operators extends this theory by not only modulating the amplitude of wave packets, but also moving them around in phase space in a \emph{symplectic manner}, i.e. in a way which, roughly speaking, obeys the uncertainty principle, in the sense that the area where a function is supported in phase space is preserved. Basic examples of Fourier integral operators will include the translation operators
%
\[ \text{Trans}_{x_0} f(x) = f(x - x_0), \]
%
modulation operators
%
\[ \text{Mod}_{\xi_0} f(x) = e^{2 \pi i \xi_0 \cdot x} f(x), \]
%
the change of variables operator $T_A$ associated with an invertible linear transformation $A: \RR^n \to \RR^n$, i.e. such that
%
\[ T_A f(x) =  |\det(A)|^{-1/2} f(A^{-1} x), \]
%
and the Fourier transform
%
\[ \mathcal{F}f(\xi) = \widehat{f}(\xi). \]
%
These four operators are all unitary, so might be thought of as preserving the amplitude of wave packets. The translation operators move wave packets in phase space according to the diffeomorphism $\Phi(x,\xi) = (x + x_0, \xi)$. The modulation operators move packets in phase space according to the diffeomorphism $\Phi(x,\xi) = (x,\xi + \xi_0)$. The change of variables move packets in phase space according to the diffeomorphism $\Phi(x,\xi) = (Ax, (A^T)^{-1} \xi)$. And the Fourier transform corresponds to the diffeomorphism $\Phi(x,\xi) = (\xi,-x)$.

All four of the diffeomorphisms $\Phi$ are \emph{symplectomorphisms}, a fact very important to the tractability of the study of the associated operators, because of the uncertainty principle. Let us assume that with a diffeomorphism $\Phi: T^* \RR^n \to T^* \RR^n$, we can associate a resulting unitary operator $T_\Phi$ from $L^2(\RR^n)$ to itself, which roughly speaking, has the property that it maps a wave packet localized at a point $(x_0,\xi_0)$ to a wave packet localized near $\Phi(x_0,\xi_0)$. If we consider an pseudodifferential operator $S_a$ which maps amplifies a wave packet localized at $(x_0,\xi_0)$ by a quantity $a(x,\xi)$, then morally speaking, we should expect the operator $T_\Phi^{-1} \circ S \circ T_\Phi$ to fix the location of wave packets, and amplify wave packets localized at $(x_0,\xi_0)$ by the quantity $a \circ \Phi$. We hope this at least holds up to first order, in some symbolic calculus we hope to develop later. If we have another operator $S_b$, then the symbolic calculus would say that the principal parts of  $[(S_a \circ \Phi), (S_b \circ \Phi)]$ and $T_\Phi^{-1} \circ [S_a, S_b] \circ T_\Phi$ agree with one another, which means that, in terms of the Poisson bracket, we must have $\{ a \circ \Phi, b \circ \Phi \} = \{ a, b \} \circ \Phi$. Since $\{ f,g \} = \omega( \nabla f, \nabla g )$, where $\omega = dx \wedge d\xi - d\xi \wedge dx$ is the standard symplectic form, this can only be true if $\Phi^* \omega = \omega$, i.e. $\Phi$ is a symplectomorphism. In this case, the graph of $\Phi$, namely the set
%
\[ \Lambda_\Phi = \{ (x,y;\xi,\eta) : (x,\xi) = \Phi(y,\eta) \} \subset T^*(\RR^n \times \RR^n) \]
%
will be a \emph{Lagrangian submanifold} of $T^* \RR^n \times T^* \RR^n$ with respect to the symplectic form $\omega \oplus (- \omega)$.
%since, once we identify each of the tangent spaces $T_p(T^* \RR^n \times T^* \RR^n)$ with $\RR^n \times \RR^n \times \RR^n \times \RR^n$ via the coordinate system $(dx, d\xi, dy, d\eta)$, then the tangent space to $\Lambda_\Phi$ at each point $(p,q) \in T^* \RR^n \times T^* \RR^n$ is the set of all pairs $(v_x, v_\xi, w_y, w_\eta)$ such that $(w_y, w_\eta) = D\Phi(q) (v_x,v_\xi)$, and then
%
%\[ \omega(v_x,v_\xi) - \omega(w_y,w_\eta) = \omega(v_x, v_\xi) - \omega(D\Phi(q)(v_x, v_\xi)) \]
%since the tangent space at each point is $(dx, d\xi) = D \Phi \cdot (dy, d\eta)$
% Phi^* omega (v,w) = omega( DPhi(v), DPhi(w)  ) = v^T DPhi^T M DPhi w = v^T M w
% so omega oplus -omega

The fact that we are reducing ourselves to the study of symplectomorphisms $\Phi$ gives us a hint as to how to define the resulting operator $T_\Phi$, at least microlocally. Intuitively speaking, our discussion above shows that the wave front set of the kernel of $\Phi$ must be contained in $\Lambda_\Phi$, because spectral singularities at a point $(y,\eta)$ will be moved to singularities at a point $(x,\xi)$, so we should expect that $\text{WF}(T_\Phi f) = \Lambda_\Phi \circ \text{WF}(f)$. We previously discussed the oscillatory integral distributions
%
\[ \int a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta. \]
%
The wave-front set contained in $\Lambda_\phi = \{ (x,\nabla_x \phi(x,\theta)) : \nabla_\xi \phi(x) = 0 \}$, and, provided $\phi$ is non-degenerate, $\Lambda_\phi$ is a Lagrangian manifold. Thus, given a symplectomorphism $\Phi: T^* \RR^n \to T^* \RR^n$, we can find a phase $\phi: \RR^n \times \RR^n \to \RR^n$ such that $\Lambda_\Phi = \Lambda_\phi$, then, modulo $C^\infty$ kernels, we would expect to find a symbol $a$ such that
%
\[ T_\Phi f(x) = \int a(x,y,\theta) e^{2 \pi i \phi(x,\theta)} f(y)\; d\theta\; dy. \]
%
More generally, we might not be able to find a phase $\phi$ that works globally for $\Phi$, but we can localize, and such $\phi$ will \emph{always} exist locally. Thus we might wish to consider the families of operators formed from finite sums of integral operators given by the right hand side of this equation. We have now reached the study of general Fourier integral operators.

\section{Local Theory}

Let us recall the theory of oscillatory integral distributions. Let $U \subset \RR^n$ be open. Consider a real-valued phase function $\phi \in C^\infty(U_x \times \RR^p_\theta)$, homogeneous in the $\theta$ variable, and such that $\nabla_{x,\theta} \phi$ is non-vanishing on the support of a symbol $a \in S^m(U \times \RR^p)$. Then we can define a distribution $u$, formally speaking, by the equation
%
\[ u(x) = \int_{\RR^p} a(x,\theta) e^{2 \pi i \phi(x,\theta)}\; d\theta. \]
%
If we consider the conic set
%
\[ \Sigma_\theta = \{ (x,\theta) \in U \times \RR^p : \nabla_\theta \phi(x,\theta) = 0 \}, \]
%
then $\text{WF}(u) \subset \Sigma_\theta$. Let us now assume the phase is \emph{nondegenerate}, in the sense that whenever $\nabla_\theta \phi = 0$, $D_{x,\theta} (\nabla_\theta \phi)$ is an invertible matrix. Then $\Sigma_\theta$ will be an $n$ dimensional manifold in $U \times \RR^p$, and the map $\Sigma_\theta \to T^* U$ given by $(x,\theta) \mapsto \nabla_x \phi(x,\theta)$ will be an immersion, which we will denote by $\Lambda_\theta$. This immersed manifold will be a \emph{Lagrangian submanifold} of $T^* U$, in the sense that the Tangent spaces $W$ at each point of $\Lambda_\theta$ will satisfy $W^\perp = W$ with respect to the symplectic form $d\xi \wedge dx$.

Let us now get to the new theory. A distribution $u$ of the form above will be called a \emph{Lagrangian distribution} of order $m + p/2 - n/4$ associated to the Lagrangian manifold $\Lambda_\theta$. This definition of order seems odd, but we note that if we consider the Lagrangian distribution
%
\[ K(x,y) = \int_{\RR^n} a(x,\xi) e^{2 \pi i \xi \cdot (x - y)}\; d\xi, \]
%
which is the kernel of a pseudodifferential operator, then this distribution will have the same order as the associated pseudodifferential operator.














