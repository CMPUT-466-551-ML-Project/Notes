%% The following is a directive for TeXShop to indicate the main file
%%!TEX root = HarmonicAnalysis.tex

\part{Restriction and Decoupling}

Decoupling Theory is an in depth study of how `interference patterns' can show up when combined waves with frequency supports in disjoint regions of space. The geometry of these regions effects how much constructive interference can happen. Of course decoupling theory is essential to studying many dispersive partial differential equations, but also has surprising applications in number theory as well, as well as other areas of harmonic analysis, such as restriction theory.

\chapter{Restriction Theory}

If a function $f$ lies in $L^p(\RR^d)$, there does not exist a numerically meaningful way to restrict $f$ to a set of measure zero, since $f$ is only defined up to measure zero. 

\begin{theorem}
  Fix $0 < p < \infty$ and $0 < q \leq \infty$. If $S$ has measure zero, and $\sigma$ is a non-zero measure supported on $S$, then there does not exist a bounded operator $P: L^p(\RR^d) \to L^q(S,\sigma)$ such that for each function $f \in C_c(\RR^d) \cap L^p(\RR^d)$, $P(f)$ is the usual restriction of $f$ to $S$.
\end{theorem}
\begin{proof}
  For each $\varepsilon > 0$, we can find an open set $U$ containing $S$ with $|U| < \varepsilon$. If we find an Urysohn function $f \in C_c(\RR^d)$ supported on $U$ with $\| f \|_{L^\infty(\RR^d)} \leq 1$, and with $f(x) = 1$ for all $x \in S$, then
  %
  \[ \| f \|_{L^p(\RR^d)} \leq |U|^{1/p} \| f \|_{L^\infty(\RR^d)} < \varepsilon^{1/p}, \]
  %
  yet for $q < \infty$, $\| Pf \|_{L^q(S,\sigma)} = \| 1 \|_{L^q(S,\sigma)} = \sigma(S)^{1/q} \gtrsim 1$, and for $q = \infty$, $\| Pf \|_{L^q(S,\sigma)} = 1$. Taking $\varepsilon \to 0$ shows that there cannot exist a bound
  %
  \[ \| Pf \|_{L^q(S,\sigma)} \lesssim \| f \|_{L^p(\RR^d)} \]
  %
  for all $f \in C_c(\RR^d)$.
\end{proof}

\begin{remark}
  If $S$ has finite, positive measure, and $\sigma$ is the Lebesgue measure restricted to $S$, then a restriction is meaningful, and for each $f \in C_c(\RR^d)$,
  %
  \[ \| Pf \|_{L^q(S)} \leq |S|^{1/q} \cdot \| f \|_{L^\infty(\RR^d)} \]
  %
  and
  %
  \[ \| Pf \|_{L^q(S)} \leq \| f \|_{L^q(\RR^d)}, \]
  %
  so we can interpolate to conclude that for all $p \geq q$,
  %
  \[ \| Pf \|_{L^q(S)} \leq |S|^{1/q - 1/p}  \| f \|_{L^p(S)}. \]
  %
  Thus we can restrict functions to sets of positive measure meaningfully.
\end{remark}

The idea of restriction theory is to determine whether it is possible to meaningfully restrict the \emph{Fourier transforms} of functions in some $L^p(\RR^d)$ to some set $S$ of measure zero. In particular, given some set $S$ and measure $\sigma$, we want to determine whether it is possible to find a map $R: L^p(\RR^d) \to L^q(S,\sigma)$ such that for any Schwartz function $f$, $R(f)$ is the restriction of the Fourier transform of $f$ to the set $S$. Such a map will be called a \emph{restriction operator}, and by the density of smooth functions is unique if it exists. We shall focus on the case $1 \leq p \leq 2$ so that the Fourier transforms remain functions rather than measures. If such a function exists, then this is a clear indication that the Fourier transforms of elements of $L^p(\RR^d)$ have more structure than an arbitrary element of $L^p(\RR^d)$.

\begin{example}
  If $f \in L^1(\RR^d)$, then $\widehat{f}$ is a continuous function on $\RR^d$ which vanishes at $\infty$, and most importantly,
  %
  \[ \| \widehat{f} \|_{L^\infty(\RR^d)} \leq \| f \|_{L^1(\RR^d)}. \]
  %
  Because of this, for any set $S$ and measure $\sigma$, there exists a bound
  %
  \[ \| \widehat{f} \|_{L^\infty(S,\sigma)} \leq \| f \|_{L^1(\RR^d)}, \]
  %
  and so there does exist a unique bounded restriction operator $R: L^1(\RR^d) \to L^\infty(S,\sigma)$. If $\sigma(S) < \infty$, then this automatically induces a bounded restriction operator $R: L^1(\RR^d) \to L^q(S,\sigma)$ for all $0 < q \leq \infty$. Thus the restriction of the Fourier transforms of integrable functions is as simple as can be.
\end{example}

Thus restriction theory is very nice on the domain $L^1(\RR^d)$. On the other hand, since the Fourier transform in an isometry between $L^2(\RR^d) \to L^2(\RR^d)$, there exists a Fourier restriction operator from $L^2(\RR^d)$ to $L^q(S)$ if and only if there exists a projection operator from $L^2(\RR^d)$ to $L^q(S)$. In particular, if $S$ has measure zero then for any non-zero measure $\sigma$ we cannot obtain a restriction operator from $L^2(\RR^d)$ to $L^q(S,\sigma)$ for any $0 < q \leq \infty$. Of course, quantitatively, this means precisely that we need to show that for any Schwartz function $f$,
%
\[ \left( \int_S |\widehat{f}(\xi)|^q\; d\xi \right)^{1/q} \lesssim \left( \int_{\RR^d} |f(x)|^p\; dx \right)^{1/p} \]
%
And so we are studying the boundedness of a particular Fourier multiplier operator.

Often in restriction theory, we fix a set $S$ and measure $\sigma$, and then study for which values of $1 \leq p < 2$ and $0 < q \leq \infty$ we have a restriction operator from $L^p(\RR^d)$ to $L^q(S,\sigma)$. Classically, it is of most interest to study sets $S$ which are smooth surfaces, and measures $\sigma$ which are absolutely continuous with respect to the natural surface measure of $S$. We shall find that in this setting there is a rich theory relating the existence of restriction maps to the curvature of the surface $S$.

\section{$L^2$ Restriction Techniques}

s








\chapter{The General Framework}

In any norm space $X$, given $x_1, \dots, x_N \in X$, one can apply the Cauchy-Schwartz inequality to obtain the estimate
%
\[ \| x_1 + \dots + x_N \|_X \leq \| x_1 \|_X + \dots + \| x_N \|_X \leq N^{1/2} \left( \| x_1 \|_X^2 + \dots + \| x_N \|_X^2 \right)^{1/2}. \]
%
Such a result is often sharp for general $x_1, \dots, x_N$. For instance, when $X = L^1(\RR^d)$, and the $x_1, \dots, x_N$ are functions with disjoint supports, but with equal $L^1$ norm. However, if the $x_1, \dots, x_n$ are `uncorrelated', then one can often expect this result to be substantially improved. For instance, if $X$ is a Hilbert space, and if $x_1, \dots, x_N$ are pairwise orthogonal, Bessel's inequality allows us to conclude that
%
\[ \| x_1 + \dots + x_N \|_X \leq \left( \| x_1 \|_X^2 + \dots + \| x_N \|_X^2 \right)^{1/2}. \]
%
Thus we obtain a significant `square root cancellation' in $N$. For instance, in $L^2(\RR^d)$, this occurs if $x_1, \dots, x_N$ have disjoint supports, or more interestingly, if their Fourier transforms have disjoint supports.

We are interested in determining what causes `square root cancellation' in general norm spaces. The theory of \emph{almost orthogonality} studies this phenomena in Hilbert spaces, but we are interested in this phenomenon in other norm spaces. Informally, we say $x_1, \dots, x_N$ satisfies a \emph{decoupling inequality} in a norm space $X$ if for all $\varepsilon > 0$, we have
%
\[ \| x_1 + \dots + x_N \|_X \lesssim_\varepsilon N^\varepsilon \left( \| x_1 \|_X^2 + \dots + \| x_N \|_X^2 \right)^{1/2}. \]
%
Thus decoupling theory is the study of when correlation occurs in various norm spaces. Of particular importance in harmonic analysis will be to determine what properties of the Fourier transform of a function enable us to obtain decoupling phenomena.

\begin{remark}
  We are interested in studying decoupling in $L^p(\Omega)$. However, the fact that we are obtaining estimates on the $l^2$ sum implies that we can only obtain such results when $p \geq 2$. To see why, note that if $p < 2$ and $f_1, \dots, f_N \in L^p(\Omega)$ have no interference, i.e. they have disjoint support, then
  %
  \[ \| f_1 + \dots + f_N \|_{L^p(\Omega)} = \left( \| f_1 \|_{L^p(\Omega)}^p + \dots + \| f_N \|_{L^p(\Omega)}^p  \right)^{1/p}, \]
  %
  This $l^p$ sum can exceed the $l^2$ sum by a factor of $N^{1/p - 1/2}$.
\end{remark}

There are certain cases where we can obtain decoupling in $L^p(\Omega)$ for $p > 2$. For instance, we say $f_1, \dots, f_N \in L^4(\Omega)$ are \emph{biorthogonal} if $\{ f_i f_j : i < j \}$ forms an orthogonal family in $L^2(\Omega)$.

\begin{theorem}
  If $f_1, \dots, f_N$ are biorthogonal, then
  %
  \[ \| f_1 + \dots + f_N \|_{L^4(\Omega)} \lesssim \left( \| f_1 \|_{L^4(\Omega)}^2 + \dots + \| f_N \|_{L^4(\Omega)}^2 \right)^{1/2}. \]
\end{theorem}
\begin{proof}
  First, we rearrange
  %
  \begin{align*}
    \left\| f_1 + \dots + f_N \right\|_{L^4(\Omega)}^2 &= \left\| (f_1 + \dots + f_N)^2 \right\|_{L^2(\Omega)}\\
    &= \left\| \sum_{1 \leq i,j \leq N} f_i f_j \right\|_{L^2(\Omega)} \lesssim \sum_{i = 1}^N \| f_i^2 \|_{L^2(\Omega)} + \left\| \sum_{1 \leq i < j \leq N} f_i f_j \right\|_{L^2(\Omega)}
  \end{align*}
  %
  Applying Bessel's inequality, we conclude that
  %
  \begin{align*}
    \left\| \sum_{1 \leq i < j \leq N} f_i f_j \right\|_{L^2(\Omega)} &= \left( \sum_{1 \leq i < j \leq N} \| f_i f_j \|_{L^2(\Omega)}^2 \right)^{1/2}\\
    &= \left\| \sum_{i = 1}^N |f_i|^2 \right\|_{L^2(\Omega)} \lesssim \sum_{i = 1}^N \| f_i^2 \|_{L^2(\Omega)}.
  \end{align*}
  %
  Combining these calculations, noticing that $\| f_i^2 \|_{L^2(\Omega)} = \| f_i \|_{L^4(\Omega)}^2$, and taking square roots completes the claim.
\end{proof}

\begin{remark}
  If $\{ x_1, \dots, x_N \}$ are elements of a Hilbert space $X$, and each $x_i$ is orthogonal to all but at most $M \geq 1$ vectors $x_j$, then one can establish an `almost Bessel inequality'
  %
  \[ \| x_1 + \dots + x_N \|_X^2 \lesssim M \left( \| x_1 \|_X^2 + \dots + \| x_N \|_X^2 \right). \]
  %
  The idea is to reduce to rearrange the vectors such that $\| x_1 \|_X \geq \dots \geq \| x_N \|_X$, upper bound $\| x_1 + \dots + x_N \|_X^2$ by $\sum_{i \leq j} (x_i,x_j)$, and then apply Cauchy-Schwartz. In particular, this implies that if each element of $\{ f_i f_j : i < j \}$ is orthogonal to all but at most $O_\varepsilon(N^\varepsilon)$ elements of the family, then we still have a decoupling inequality.
\end{remark}

\begin{remark}
  Similarily, if $f_1, \dots, f_N \in L^6(\Omega)$ are chosen to be \emph{triorthogonal}, in the sense that $\{ f_i f_j f_k \}$ are mostly orthogonal to one another, one can obtain a decoupling inequality in the $L^6$ norm.
\end{remark}

We will be most interested in studying families of functions with disjoint Fourier supports in $L^p(\RR^d)$, where $p \geq 2$. Just because functions have disjoint Fourier supports does not mean that decoupling automatically happens however; constructive interference can still occur. In general, the best result we can obtain in the $L^p$ norm for $p > 2$ involves a polynomial dependence on $N$, and we require additional geometric features like that in the corollary to guarantee a genuine decoupling inequality.

\begin{theorem}
  If $f_1, \dots, f_N$ are Schwartz functions on $\RR^d$ with disjoint Fourier support, and $2 \leq p \leq \infty$, then
  %
  \[ \| f_1 + \dots + f_N \|_{L^p(\RR^d)} \leq N^{1/2 - 1/p} \left( \| f_1 \|_{L^p(\RR^d)}^2 + \dots + \| f_N \|_{L^p(\RR^d)}^2 \right)^{1/2}. \]
\end{theorem}
\begin{proof}
  If $f_1, \dots, f_N$ have disjoint Fourier support, then by orthogonality, we have
  %
  \[ \| f_1 + \dots + f_N \|_{L^2(\RR^d)} \leq \left( \| f_1 \|_{L^2(\RR^d)}^2 + \dots + \| f_N \|_{L^2(\RR^d)}^2 \right)^{1/2}. \]
  %
  We also have the trivial inequality
  %
  \begin{align*}
    \| f_1 + \dots + f_N \|_{L^\infty(\RR^d)} &\leq \| f_1 \|_{L^\infty(\RR^d)} + \dots + \| f_N \|_{L^\infty(\RR^d)}\\
    &\leq N^{1/2} \left( \| f_1 \|_{L^\infty(\RR^d)}^2 + \dots + \| f_N \|_{L^\infty(\RR^d)}^2 \right)^{1/2}.
  \end{align*}
  %
  Interpolation then gives the result.
\end{proof}

In general, this result is optimal.

\begin{example}
  Let $u$ be a Schwartz function on $\RR$ with $u(0) = 1$, and with Fourier support in $[0,1]$. For each $k \in \{ 1, \dots, N \}$, define $f_k = e^{4 \pi k i x} u$. Then $f_k$ has Fourier support in $[2k,2k+1]$. If $|x| \lesssim 1/N$, we have $|f_k(x) - 1| \leq c < 1$ for each $k$, where $c$ is independant of $N$. But this means that the values $f_1(x), \dots, f_N(x)$ have positive real part bounded below by a universal constant, and so if $|x| \lesssim 1/N$, we find $|f_1(x) + \dots + f_N(x)| \gtrsim N$. Thus
  %
  \[ \| f_1 + \dots + f_N \|_{L^p(\RR)} \gtrsim N^{1 - 1/p}. \]
  %
  On the other hand, we have
  %
  \[ \left( \| f_1 \|_{L^p(\RR)}^2 + \dots + \| f_N \|_{L^p(\RR)}^2 \right)^{1/2} \lesssim N^{1/2}, \]
  %
  where the implicit constant here depends only on the $L^p$ norm of $u$. Thus
  %
  \[ \| f_1 + \dots + f_N \|_{L^p(\RR)} \gtrsim N^{1/2 - 1/p} \left( \| f_1 \|_{L^p(\RR)}^2 + \dots + \| f_N \|_{L^p(\RR)}^2 \right)^{1/2}, \]
  %
  which shows our result is tight up to constants.
\end{example}

To restate our desire, we are interested in knowing, for a given family $\mathcal{S}$ of disjoint sets in $\RR^d$, whether it is true that if $f_1, \dots, f_N$ have Fourier support on distinct regions $S_1, \dots, S_N \in \mathcal{S}$, we have
%
\[ \| f_1 + \dots + f_N \|_{L^p(\RR^d)} \lesssim_\varepsilon N^\varepsilon \left( \| f_1 \|_{L^p(\RR^d)}^2 + \dots + \| f_N \|_{L^p(\RR^d)}^2 \right)^{1/2}. \]
%
Such a result depends significantly on the geometric structure of the regions in $\mathcal{S}$. The techniques we will use (e.g. induction on scales) imply the need for the `$\varepsilon$ loss' given by the $N^\varepsilon$ factor. Below is a positive result for a particular family $\mathcal{S}$, easily proved using the biorthogonality arguments established above.

\begin{theorem}
  If $\mathcal{S}$ is a family of sets in $\RR^d$ such that for $S_1,S_2,S_3,S_4 \in \mathcal{S}$, then $S_1 + S_2$ is disjoint from $S_3 + S_4$ except in trivial circumstances. Then if distinct sets $S_1, \dots, S_N \in \mathcal{S}$ are selected from $\mathcal{S}$, and $f_1, \dots, f_N$ are a family of Schwartz functions in $\RR^d$ such that $f_i$ has Fourier support in $S_i$ for each $i$, then
  %
  \[ \| f_1 + \dots + f_N \|_{L^4(\Omega)} \lesssim \left( \| f_1 \|_{L^4(\Omega)}^2 + \dots + \| f_N \|_{L^4(\Omega)}^2 \right)^{1/2}. \]
\end{theorem}

\begin{remark}
  We say a set of integers $A \subset \{ 0, \dots N-1 \}$ is a \emph{Sidon set} if there does not exist a nontrivial solution to the equation $a_1 + a_2 = a_3 + a_4$. If $A$ is Sidon, then $\mathcal{S} = \{ [2k,2k+1]: k \in A \}$ satisfies the constraints of the corollary, and so we can obtain a decoupling result that if $\{ f_k: k \in A \}$ are a family of Schwartz functions such that $f_k$ has Fourier support in $[2k,2k+1]$, then
  %
  \[ \| \sum_{k \in A} f_k \|_{L^4(\RR)} \lesssim \left( \sum_{k \in A} \| f_k \|_{L_4(\RR)}^2 \right)^{1/2}. \]
  %
  On the other hand, a variant of the example above shows that for any Sidon set $A$, there is a family of functions $\{ f_k : k \in A \}$ with $f_k$ having Fourier support on $[2k,2k+1]$, and with
  %
  \[ \left\| \sum_{k \in A} f_k \right\|_{L^4(\RR)} \gtrsim \frac{\#(A)^{1/2}}{N^{1/4}} \left( \sum_{k \in A} \| f_k \|_{L^4(\RR)}^2 \right)^{1/2}. \]
  %
  Combining this inequality with the decoupling inequality, we obtain the surprising number theoretic result that any Sidon set $A$ must satisfy $\#(A) \lesssim N^{1/2}$. We can extend this result to show that any set $A \subset \{ 0, \dots, N-1 \}$ having no nontrivial solutions to the equation $a_1 + \dots + a_m = a_1' + \dots + a_m'$ should satisfy $\#(A) \lesssim N^{1/m}$.
\end{remark}

Another example is obtained using Littlewood-Paley theory.

\begin{theorem}
  Let $\mathcal{S}$ be the collection of all boxes in $\RR^d$ of the form $I_1 \times \dots \times I_d$, such that there are integers $(k_1, \dots, k_d) \in \mathbf{Z}^d$ such that $I_i = [2^{k_i}, 2^{k_i+1}]$ or $I_i = [-2^{k_i}, -2^{k_i+1}]$. Littlewood-Paley theory implies that if $S_1, \dots, S_N \in \mathcal{S}$ and $f_1, \dots, f_N$ are Schwartz functions with $f_i$ having Fourier support on $S_i$ for each $i$, then for each $1 < p < \infty$,
  %
  \[ \| f_1 + \dots + f_N \|_{L^p(\RR^d)} \sim_{p,d} \left\|(|f_1|^2 + \dots + |f_N|^2)^{1/2} \right\|_{L^p(\RR^d)}. \]
  %
  A norm interchange then implies that if $p \geq 2$,
  %
  \[ \left\|(|f_1|^2 + \dots + |f_N|^2)^{1/2} \right\|_{L^p(\RR^d)} \leq \left( \| f_1 \|_{L^p(\RR^d)}^2 + \dots + \| f_N \|_{L^p(\RR^d)}^2 \right)^{1/2}. \]
  %
  Thus we get a decoupling inequality.
\end{theorem}



\begin{comment}
\begin{example}
  TODO: Move this. When $p < 2$, one does not usually expect to find decoupling inequalities in $L^p(\Omega)$. For instance, for any family of disjoint measurable sets $E_1, \dots, E_N \in \Omega$, each with non-negative measure, one can find $f_1, \dots, f_N \in L^p(\Omega)$, with $f_i$ supported on $E_i$ for each $i$ such that
  %
  \begin{align*}
    \| f_1 + \dots + f_N \|_{L^p(\Omega)} &= \left( \| f_1 \|_{L^p(\Omega)}^p + \dots + \| f_N \|_{L^p(\Omega)}^p \right)^{1/p}\\
    &\geq N^{1/p - 1/2} \left( \| f_1 \|_{L^p(\Omega)}^2 + \dots + \| f_N \|_{L^p(\Omega)}^2 \right)^{1/2}.
  \end{align*}
  %
  The idea of this is simple; we just choose a family of scalars $A_1, \dots, A_N$ such that
  %
  \[ (A_1^p + \dots + A_N^p)^{1/p} = N^{1/p - 1/2} (A_1^2 + \dots + A_N^2)^{1/2}. \]
  %
  Given functions $f_1, \dots, f_N$ such that $f_i$ is supported in $E_i$ for each $i$, we need only rescale each function such that $\| f_i \|_{L^p(\Omega)} = A_i$ for each $i$. Similarily, if $U_1, \dots, U_N$ are disjoint open sets in $\RR^d$, we can find Schwartz functions $f_1, \dots, f_N$, such that $f_i$ has Fourier support in $U_i$ for each $i$, such that
  %
  \[ \| f_1 + \dots + f_N \|_{L^p(\Omega)} \gtrsim N^{1/p - 1/2} \left( \| f_1 \|_{L^p(\Omega)}^2 + \dots + \| f_N \|_{L^p(\Omega)}^2 \right)^{1/2}, \]
  %
  where the implict constant is independant of $N$, and $U_1, \dots, U_N$. The idea here is to begin with Schwarz functions $f_1, \dots, f_N$ such that $f_i$ has Fourier suppport in $U_i$, and then replace these Schwarz functions with translations such that the masses of the $f_i$ are essentially disjoint from one another, which only modulates the Fourier transform and so does not affect the Fourier support of the functions. Rescaling then gives the result.
\end{example}
\end{comment}

\section{Localized Estimates}

Suppose $f_1, \dots, f_N$ are Schwartz functions in $\RR^d$ with disjoint Fourier supports, and $\Omega \subset \RR^d$. A natural question to ask is when one should expect
%
\[ \| f_1 + \dots + f_N \|_{L^2(\Omega)}^2 \lesssim \| f_1 \|_{L^2(\Omega)}^2 + \dots + \| f_N \|_{L^2(\Omega)}^2. \]
%
If we consider the bump function counterexample constructed from earlier, and let $\Omega = \{ x \in \RR: |x| \lesssim 1/N \}$, then $\| f_1 + \dots + f_N \|_{L^2(\Omega)} \gtrsim N$, whereas $\| f_k \|_{L^2(\Omega)}^2 \lesssim 1/N$ so $\| f_1 \|_{L^2(\Omega)}^2 + \dots + \| f_N \|_{L^2(\Omega)}^2 \lesssim 1$, which means such a result cannot be obtained. However, we shall find that such a result holds if $\Omega$ is large enough, depending on the supports of $f_1, \dots, f_N$, and if we allow weighted estimates.

Let us begin with the case in one dimension. Given an interval $I$ with centre $x_0$, and length $R$, we consider the weight function
%
\[ w_I(x) = \left( 1 + \frac{|x - x_0|}{R} \right)^{-M} \]
%
It is a useful heuristic that if $f$ has Fourier support in $I$, then $f$ is `locally constant' on intervals of length $1/|I|$.

In $\RR^d$, given a ball $B$ with centre $x_0$ and radius $R$, we consider the weight function
%
\[ w_B(x) = \left( 1 + \frac{|x - x_0|}{R} \right)^{-M}, \]
%
where $M$ is a large integer. Then
%
\[ \int w_B(x)\; dx \]

TODO FINISH THIS

\section{Local Orthogonality}

