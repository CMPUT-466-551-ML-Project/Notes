\documentclass[12pt,reqno]{article}

%\documentclass[dvipsnames,letterpaper,12pt]{article}

%\usepackage[margin = 1.5in]{geometry}
\usepackage{amsmath,amssymb,graphicx,mathabx,accents}
\usepackage{enumerate,mdwlist}

%\setlist[enumerate]{label*={\normalfont(\Alph*)},ref=(\Alph*)}

%\numberwithin{equation}{section}

\usepackage{amsthm}
\usepackage{verbatim}

\usepackage{nag}

\DeclareMathOperator{\minkdim}{\dim_{\mathbf{M}}}
\DeclareMathOperator{\hausdim}{\dim_{\mathbf{H}}}
\DeclareMathOperator{\lowminkdim}{\underline{\dim}_{\mathbf{M}}}
\DeclareMathOperator{\upminkdim}{\overline{\dim}_{\mathbf{M}}}
\DeclareMathOperator{\fordim}{\dim_{\mathbf{F}}}

\DeclareMathOperator{\lhdim}{\underline{\dim}_{\mathbf{M}}}
\DeclareMathOperator{\lmbdim}{\underline{\dim}_{\mathbf{MB}}}

\DeclareMathOperator{\RR}{\mathbf{R}}
\DeclareMathOperator{\ZZ}{\mathbf{Z}}
\DeclareMathOperator{\QQ}{\mathbf{Q}}
\DeclareMathOperator{\TT}{\mathbf{T}}

\DeclareMathOperator{\B}{\mathcal{B}}

\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem{remark}[theorem]{Remark}

\DeclareMathOperator{\EE}{\mathbf{E}}
\DeclareMathOperator{\PP}{\mathbf{P}}

\DeclareMathOperator{\DQ}{\mathcal{Q}}
\DeclareMathOperator{\DR}{\mathcal{R}}

\newcommand{\psitwo}[1]{\| {#1} \|_{\psi_2(L)}}
\newcommand{\TV}[2]{\| {#1} \|_{\text{TV}({#2})}}








\title{Salem Sets Avoiding Rough Configurations}
\author{Jacob Denson}

\begin{document}

\maketitle

Geometric measure theory explores the relationship between the geometry of a subset of Euclidean space, and regularity properties of the family of Borel measures supported on that set. From the perspective of harmonic analysis, it is often popular to explore what structural information can be gathered from the Fourier analytic properties of measures supported on a set. In this paper, we study the relationship between the Fourier analytic properties of a set and the existence of patterns on the set. In particular, given a `rough pattern', in the sense of \cite{OurPaper}, we construct a family of sets which generically avoids this pattern, and which supports measures with fast Fourier decay.

A useful statistic associated with any finite Borel measure $\mu$ on $\RR^d$ is it's \emph{Fourier dimension} $\fordim(\mu)$, defined as the supremum of all $0 \leq s \leq d$ such that
%
\begin{equation} \label{fordim}
    \sup \left\{ |\widehat{\mu}(\xi)| |\xi|^{s/2} : \xi \in \RR^d \right\} < \infty.
\end{equation}
%
The Fourier dimension of a Borel set $E \subset \RR^d$, denoted $\fordim(E)$, is then the supremum of $\fordim(\mu)$, over all Borel measures $\mu$ supported on $E$. This definition is analogous to the definition of the Hausdorff dimension; For $x \in \RR^d$ and $\varepsilon > 0$, we let $B_\varepsilon(x)$ denote the open ball of radius $\varepsilon$ centered at $x$. Then $\hausdim(\mu)$ is the supremum of all $0 \leq s \leq d$ such that
%
\begin{equation} \label{hausdim}
    \sup \left\{ \mu(B_\varepsilon(x)) \cdot \varepsilon^{-\alpha} : x \in \RR^d, \varepsilon > 0 \right\} < \infty,
\end{equation}
%
and then define $\hausdim(E)$ to be the supremum of $\hausdim(\mu)$ over all Borel measure $\mu$ supported on $E$. A particularly tractable family of sets in this scheme are \emph{Salem sets}, those sets whose Fourier dimension agrees with their Hausdorff dimension. Most classical constructions of sets with fractional Hausdorff dimension are not Salem sets, often having Fourier dimension zero. Nonetheless, the sets we construct in this paper are Salem.

\begin{theorem} \label{maintheorem}
    Let $0 \leq \alpha < dn$, and let $Z \subset \RR^{dn}$ be a countable union of compact sets, each with lower Minkowski dimension at most $\alpha$. Then there exists a compact Salem set $X \subset [0,1]^d$ with dimension
    %
    \[ \beta = \min \left( \frac{nd - \alpha}{n-1}, d \right) \]
    %
    such that for any distinct points $x_1, \dots, x_n \in X$, $(x_1, \dots, x_n) \not \in Z$. Moreover, there is a measure $\mu$ supported on $X$ such that for each $\xi \in \ZZ^d$,
    %
    \[ |\widehat{\mu}(\xi)| \leq \log(1 + |\xi|)^{1/2} |\xi|^{-\beta}. \]
\end{theorem}

\begin{remark}
    Theorem \ref{maintheorem} strengthens the main result of \cite{OurPaper}. Unlike in \cite{OurPaper}, the case of the problem $0 \leq \alpha < d$ is still interesting, since the trivial construction $X - \pi(Z)$ is not necessarily a Salem set.
\end{remark}

A well-known result in this pattern avoidance setting is that sets with large Fourier dimension satisfy many algebraic relations. More precisely, if integer coefficients $m_1, \dots, m_n \in \ZZ$ are fixed, and we consider a compact set $E \subset \RR$ with $\fordim(E) > 2/n$, then the sum set $m_1 E + \dots + m_n E$ contains an open interval. It follows by a slight modification of these coefficients that if $E \subset \RR$ and $\fordim(E) > 2/n$, then there exists $m_1, \dots, m_n \in \ZZ$, distinct points $x_1, \dots, x_n \in E$, and an additional integer $a \in \ZZ$, such that
%
\begin{equation} \label{intequation}
    m_1 x_1 + \dots + m_n x_n = a.
\end{equation}
%
It is an interesting to determine how tight this result is. In \cite{Korner2}, T.W. K\"{o}rner constructs a set $E$ with Fourier dimension $1/(n-1)$ such that for non-zero $m \in \ZZ^n$, and $a \in \ZZ$, $E$ does not contain distinct points $x_1, \dots, x_n$ solving \eqref{intequation}. If, for each nonzero $m \in \ZZ^n$ and $a \in \ZZ$, we consider the set
%
\[ Z_{m,a} = \left\{ (x_1, \dots, x_n) \in [0,1]^n : m_1x_1 + \dots + m_n x_n = a \right\}, \]
%
then $Z_{m,a}$ is a subset of an $n-1$ dimensional hyperplane, and thus can be easily seen to have Minkowski dimension $n-1$. It follows that we can apply \ref{maintheorem} to $Z = \bigcup \{ Z_{m,a} : m \neq 0, a \in \ZZ \}$ to obtain a Salem set $X \subset [0,1)$ of dimension
%
\[ \frac{n - (n-1)}{n - 1} = \frac{1}{n-1}, \]
%
such that $(x_1, \dots, x_n) \not \in Z$ for each distinct $x_1, \dots, x_n \in X$. Thus $X$ avoids solutions to $\eqref{intequation}$ for all nonzero $m \in \ZZ^n$ and $a \in \ZZ$. Thus we see Theorem \ref{maintheorem} generalizes K\"{o}rner's result, and thus shows the result depends little on the arithmetic properties of the pattern K\"{o}rner avoids, but rather, depends only on the `thickness' of the family of tuples $(x_1, \dots, x_n)$ satisfying the pattern.

Since we are working with compactly supported sets, working in $\RR^d$ is not significantly different from working in a periodic domain $\TT^d = \RR^d / \ZZ^d$, which has the advantage of being compact. For a finite measure $\mu$ on $\TT^d$, we can define it's Fourier dimension $\fordim(\mu)$ as the supremum of all $0 \leq s \leq d$ such that
%
\begin{equation} \label{fordimtorus}
    \sup_{k \in \RR^d} |\widehat{\mu}(k)| |k|^{s/2} < \infty.
\end{equation}
%
We can then define the Fourier dimension of any Borel set $E \subset \TT^d$ as the supremum of $\fordim(\mu)$, over all Borel measures $\mu$ supported on $E$. Similarily, $\TT^d$ has a natural quotient metric induced from $\RR^d$, so we can consider open balls $B_\varepsilon(x + \ZZ^d)$, and thus define the Hausdorff dimension of finite Borel measures and sets on $\TT^d$. It is a simple consequence of either the Poisson summation formula or the uncertainty principle that if $\mu$ is a compactly supported measure on $\RR^d$, then \eqref{fordim} is equivalent to the more discrete condition
%
\begin{equation} \label{discretefordim}
    \sup_{k \in \ZZ^d} |\widehat{\mu}(k)| |k|^{s/2} < \infty.
\end{equation}
%
A proof is given in \cite[Lemma 39]{myThesis}. In particular, if $\mu^*$ is the \emph{periodization} of $\mu$, i.e. the measure on $\TT^d$ such that for any $f \in C(\TT^d)$,
%
\[ \int_{\TT^d} f(x)\; d\mu^*(x) = \int_{\RR^d} f(x + \ZZ^d)\; d\mu(x), \]
%
Another application of the uncertainty principle or Poisson summation thus shows that $\fordim(\mu^*) = \fordim(\mu)$. Since $\mu$ is compactly supported, it is also simple to see that $\hausdim(\mu^*) = \hausdim(\mu)$. Thus Theorem \ref{maintheorem} is clearly equivalent to it's periodic variant.

\begin{theorem} \label{periodictheorem}
    Let $0 \leq \alpha < dn$, and let $Z \subset \TT^{dn}$ be a countable union of compact sets, each with lower Minkowski dimension at most $\alpha$. Then there exists a compact Salem set $X \subset \TT^d$ with dimension
    %
    \[ \beta = \min \left( \frac{nd - \alpha}{n-1}, d \right) \]
    %
    such that for any distinct points $x_1, \dots, x_n \in X$, $(x_1, \dots, x_n) \not \in Z$. Moreover, there is a measure $\mu$ supported on $X$ such that for each $\xi \in \ZZ^d$,
    %
    \[ |\widehat{\mu}(\xi)| \leq \log(1 + |\xi|)^{1/2} |\xi|^{-\beta}. \]
\end{theorem}

To construct our set, we rely on a Baire-category argument for the purpose of our construction. Thus we consider a complete metric space $X$, whose elements consist of pairs $(E,\mu)$, where $E$ is a subset of $\TT^d$, and $\mu$ is a probability measure supported on $E$. We then show that for \emph{quasi-all} elements $(E,\mu) \in X$, the set $E$ satisfies the conclusions of Theorem \ref{periodictheorem}, in the sense that the set of pairs $(E,\mu) \in X$ failing to satisfy the conclusions of Theorem \ref{periodictheorem} form a set of first category in $X$. It follows that Theorem \ref{periodictheorem} holds in a `generic' sense for elements of $X$.

Once we have setup the appropriate metric space $X$, our approach is quite similar to our construction in \cite{OurPaper}, relying on a random selection procedure, which is now exploited in this paper to give high probability bounds on the Fourier transform of the measures we study. The use of the Baire category approach in this paper, rather than an algorithmic, `nested set' approach, is mostly of an aesthetic nature, avoiding the complex queuing method and dyadic decomposition strategy required in the nested set approach; our approach can, with some care, be converted into a queuing procedure like in \cite{OurPaper}. But the Baire category argument makes our proof simpler to read, and has the advantage that it indicates that Salem sets of a specified dimension `generically' avoid a given rough pattern.

\section{Notation}

\begin{itemize}
%    \item Quasi-all

%    \item $C^\infty[0,1]^d$.

    \item Given a metric space $X$, $x \in X$, and $\varepsilon > 0$, we shall let $B_\varepsilon(x)$ denote the open ball of radius $\varepsilon$ around $x$. For a given set $E \subset X$ and $\varepsilon > 0$, we let
    %
    \[ E_\varepsilon = \bigcup_{x \in E} B_\varepsilon(x). \]

    \item We let $\TT^d = \RR^d/\ZZ^d$. Given $x \in \TT$, we let
    %
    \[ |x| = \min \{ |x + n| : n \in \ZZ \}, \]
    %
    and for $x \in \TT^d$, we let $|x| = \sqrt{|x_1|^2 + \dots + |x_d|^2}$. The standard metric on $\TT^d$ then takes the distance between $x,y \in \TT^d$ is $|x - y|$.

    \item For a positive integer $N$, we let $[N] = \{ 1, \dots, N \}$

    \item We will need to consider a standard mollifier. Throughout the paper, we fix a smooth probability density $\phi \in C^\infty(\TT^d)$ such that $\phi(x) = 0$ for $|x| \geq 2/5$, and such that for each $x \in \TT^d$
    %
    \[ \sum_{k \in \{ 0, 1 \}^d} \phi(x + k/2) = 2^d. \]
    %
    For each $\varepsilon \in (0,1)$, we can then define $\phi_\varepsilon \in C^\infty(\TT^d)$ by writing
    %
    \[ \phi_\varepsilon(x) = \begin{cases} \varepsilon^{-d} \phi(x/\varepsilon) &: |x| < \varepsilon, \\ 0 &: \text{otherwise}. \end{cases} \]
    %
    Then $\phi_\varepsilon$ is a smooth probability density, $\phi_\varepsilon(x) = 0$ for $|x| \geq \varepsilon$, and if $\varepsilon = 1/N$, and $x \in \TT^d$,
    %
    \begin{equation} \label{equation5550002352124124512}
        \sum_{k \in [2N]^d} \phi_{1/N}(x + k/2N) = (2N)^d.
    \end{equation}
    %
    As $\varepsilon \to 0$, $\phi_\varepsilon$ converges weakly to the Dirac delta function at the origin, so that for each $k \in \ZZ^d$,
    %
    \begin{equation} \label{approximationtoidentitypointwiseconvergence}
        \lim_{\varepsilon \to 0} \widehat{\phi_\varepsilon}(k) = 1.
    \end{equation}
    %
    Moreover, for each $\alpha > 0$, there exists $C_\alpha > 0$ such that for all $\varepsilon > 0$ and non-zero $k \in \ZZ^d$,
    %
    \begin{equation} \label{molificationdecaybound}
        |\widehat{\phi_\varepsilon}(k)| \leq \frac{C_\alpha}{\varepsilon^\alpha |k|^\alpha},
    \end{equation}
    %
    which can be proven by using the rescaling symmetries of the Fourier transform on $\RR^d$.

    \item Our random construction involves a probabilistic concentration of measure argument. Define a convex function $\psi_2: [0,\infty) \to [0,\infty)$ by setting
    %
    \[ \psi_2(t) = e^{t^2} - 1, \]
    %
    The function $\psi_2$ induces an Orlicz norm on the family of scalar valued random variables over a probability space by setting, for each random variable $X$,
    %
    \[ \psitwo{X} = \inf \left\{ A \in (0,\infty) : \EE(\psi_2(|X|/A)) \leq 1 \right\}. \]
    %
    The family of random variables with $\psitwo{X} < \infty$ are known as \emph{subgaussian random variables}. Here are the important properties of subgaussian random variables which we use in this paper:
    %
    \begin{itemize}
        \item If $\psitwo{X} \leq A$, then for each $t \geq 0$,
        %
        \[ \PP \left( |X| \geq t \right) \leq 10 \exp \left( -t^2/10A^2 \right). \]
        %
        Thus Subgaussian random variables have Gaussian tails.

        \item If $|X| \leq A$ almost surely, then $\psitwo{X} \leq 10 A$. Thus bounded random variables are subgaussian.

    %\item (Centering) For any random variable $X$,
    %
    %\[ \psitwo{X - \EE(X)} \lesssim \psitwo{X}. \]
    
    %\item (Union Bound) If $X_1, \dots, X_N$ are random variables, then
    %
    %\[ \psitwo{X_1 + \dots + X_N} \leq \psitwo{X_1} + \dots + \psitwo{X_N}. \]
    
        \item If $X_1, \dots, X_N$ are \emph{independent}, then
        %
        \[ \psitwo{X_1 + \dots + X_N} \leq 10 \left( \psitwo{X_1}^2 + \dots + \psitwo{X_N}^2 \right)^{1/2}. \]
        %
        This is an equivalent way to state \emph{Hoeffding's Inequality}, and we refer to an application of this inequality as an application of Hoeffding's inequality.
    \end{itemize}
    %
    Roughly speaking, if $X$ is a random variable with $\psitwo{X} \leq A$, we can think of $X$ as being sharply concentrated in the region $[-A,A]$. The Orlicz norm thus provides a convenient way to quantify concentration phenomena.
    %
    \begin{remark}
        The constants involved in these statements are suboptimal, but will suffice for our purposes. Proofs can be found in Chapter 2 of \cite{Vershynin}.
    \end{remark}
\end{itemize}

\section{A Complete Metric Space}

Let us construct a metric space appropriate for our task. We proceed analogously to (TODO: KORNER CITE) We begin with two simple metric spaces:
%
\begin{itemize}
    \item We let $\mathcal{E}$ denote the family of all compact subsets of $\TT^d$. If, for two compact sets $E,F \in \mathcal{E}$, we consider their Hausdorff distance
    %     
    \[ d_H(E,F) = \inf \{ \varepsilon > 0 : E \subset F_\varepsilon\ \text{and}\ F \subset E_\varepsilon \}, \]
    %
    then $(\mathcal{E},d_H)$ forms a complete metric space.

    \item Given any positive sequence of real numbers $\{ A(k) \}$, we let $M(A)$ consist of the class of all finite Borel measures $\mu$ supported on $\TT^d$ such that the quantity
    %
    \[ \| \mu \|_A = \sup_{k \neq 0} \frac{|\widehat{\mu}(k)|}{|A(k)|} \]
    %
    is finite. Then $\| \cdot \|_A$ is a norm, and $(M(A), \| \cdot \|_A)$ is a Banach space. It is important to note that if there is a sequence of measures $\mu_k \in M(A)$ and $\mu \in M(A)$ such that
    %
    \[ \lim_{k \to \infty} \| \mu_k - \mu \|_A = 0, \]
    %
    then the sequence $\{ \mu_k \}$ converges weakly to $\mu$. We will assume that the choice of $\{ A(k) \}$ is such that for each $\varepsilon > 0$ there exists $C_\varepsilon > 0$ such that for each $k \neq 0$,
    %
    \begin{equation} \label{dimensionbetasequencecondition}
        \frac{1}{C_\varepsilon} \frac{1}{|k|^{\beta - \varepsilon}} \leq A(k) \leq C_\varepsilon \frac{1}{|k|^{\beta + \varepsilon}}.
    \end{equation}
    %
    In particular, \eqref{dimensionbetasequencecondition} implies that $C^\infty(\TT^d) \subset M(A)$, where $C^\infty(\TT^d)$ is the space of smooth functions with support contained in $\TT^d$.
\end{itemize}
%
From these spaces, we let $X$ be the collection of all pairs $(E,\mu) \in \mathcal{E} \times M(A)$, where $\mu$ is a probability measure with $\text{supp}(\mu) \subset E$, and
%
\[ \lim_{|k| \to \infty} \frac{|\widehat{\mu}(k)|}{A(k)} = 0. \]
%
It is easy to see $X$ is a closed subset of $\mathcal{E} \times M(A)$ under the product topology, and thus if we consider the product metric
%
\[ d_X((E,\mu),(F,\nu)) = \max \left( d_H(E,F), \| \mu - \nu \|_A \right), \]
%
then $(X,d_X)$ is a complete metric space. The main reason we enforced that $\widehat{\mu}(k) = o(A(k))$ is so that smooth functions are dense in this space.

\begin{lemma}
    The set of all $(E,\mu)$ with $\mu \in C^\infty(\TT^d)$ is dense in $X$.
\end{lemma}
\begin{proof}
    We just apply a mollification strategy. Given $(E,\mu) \in X$ and consider $\varepsilon > 0$. For each $\delta > 0$, consider $\mu_\delta = \mu * \phi_\delta$. Then $\mu_\delta \in C^\infty(\TT^d)$, and if $\delta \leq \varepsilon$, then $\mu_\delta$ is supported on $\overline{E_\varepsilon}$, and
    %
    \begin{equation} \label{equation9019412094192041}
        d_H(E,\overline{E_\varepsilon}) \leq \varepsilon.
    \end{equation}
    %
    Since $(E,\mu) \in X$, there is $N$ depending on $\mu$ such that for $|k| \geq N$, $|\widehat{\mu}(k)| \leq \varepsilon A(k)$. For $|k| \geq N$, we thus find that
    %
    \begin{equation} \label{equation12}
        |\widehat{\mu_\delta}(k) - \widehat{\mu}(k)| = |\widehat{\mu}(k)||\widehat{\phi_\delta}(k) - 1| \leq 2 |\widehat{\mu}(k)| \leq 2\varepsilon A(k).
    \end{equation}
    %
    On the other hand, for suitably small $\delta$, \eqref{approximationtoidentitypointwiseconvergence} implies that for $|k| \leq N$,
    %
    \[ |\widehat{\phi_\delta}(k) - 1| \leq \varepsilon A(k). \]
    %
    But this implies that for $|k| \leq N$,
    %
    \begin{equation} \label{equation124}
        |\widehat{\mu_\delta}(k) - \widehat{\mu}(k)| = |\widehat{\mu}(k)| |\widehat{\phi_\delta}(k) - 1| \leq \varepsilon A(k).
    \end{equation}
    %
    Thus we conclude that for suitably small $\delta$, $\| \widehat{\mu_\delta} - \widehat{\mu} \|_A \leq 2 \varepsilon$. But combining \eqref{equation9019412094192041}, \eqref{equation12}, and \eqref{equation124}, we conclude
    %
    \[ d_X((E,\mu), (\overline{E_\varepsilon}), \mu_\delta) \leq 2 \varepsilon. \]
    %
    Since $\varepsilon > 0$ was arbitrary, this completes the proof.
\end{proof}

\begin{lemma}
    For quasi-all $(E,\mu) \in X$, $\text{supp}(\mu) = E$.
\end{lemma}
\begin{proof}
    For each closed set $K \subset \TT^d$ with nonempty interior, let $A(K)$ be the family of all $(E,\mu) \in X$ such that $E \cap K \neq \emptyset$ and $\mu(K) = 0$. The set $A(K)$ is clearly closed in $X$. Moreover, this set is nowhere dense; Fix $(E,\mu) \in A(K)$ and $\varepsilon > 0$. Then we can find a smooth probability density $\psi \in C^\infty(\TT^d)$ supported on $K^\circ \cap E_\varepsilon$. We then define $\mu_\varepsilon = (1 - \varepsilon) \mu + \varepsilon \psi$. Now
    %
    \[ \| \mu - \mu_\varepsilon \|_A \leq \varepsilon \left( \| \mu \|_A + \| \psi \|_A \right) \lesssim \varepsilon. \]
    %
    Moreover, $\mu_\varepsilon$ is supported on $\overline{E_\varepsilon}$, so
    %
    \[ d_X((E,\mu), (\overline{E_\varepsilon}, \mu_\varepsilon)) \lesssim \varepsilon. \]
    %
    If we let $A = \bigcup_{n = 1}^\infty A(K_n)$, where $\{ K_n \}$ is the family of all closed cubes in $\TT^d$ whose corners have rational coordinates, then quasi-all $(E,\mu) \in X$ belong to $A^c$. But $A^c$ is precisely the family of pairs $(E,\mu)$ with $\text{supp}(\mu) = E$.
\end{proof}

It is a general heuristic that quasi-all elements of a metric space are as `thin as possible'. In particular, we should expect the Hausdorff dimension and Fourier dimension of a generic element of $X$ to be as low as possible. For each $(E,\mu) \in X$, the condition that $\mu \in M(A)$, combined with \eqref{dimensionbetasequencecondition} implies that $\fordim(\mu) \geq \beta$, so we might expect the quasi-all $\mu \in M(A)$ have Fourier dimension \emph{equal to} $\beta$. Since the Hausdorff dimension of a measure is an upper bound for the Fourier dimension, it suffices to show that quasi-all $\mu \in M(A)$ have Hausdorff dimension $\beta$.

\begin{lemma}
    For quasi-all $(E,\mu) \in X$, $E$ is a Salem set of dimension $\beta$.
\end{lemma}
\begin{proof}
    For each $\alpha > \beta$, let $A(\alpha,\varepsilon) = \{ (E,\mu) \in \mathcal{G}: H^\alpha(E) < \varepsilon \}$, where $H^\alpha$ is the Hausdorff measure of dimension $\alpha$ on $\TT^d$, i.e.
    %
    \[ H^\alpha(E) = \lim_{\delta \to 0} \inf \left\{ \sum_{k = 1}^\infty \varepsilon_k^\alpha : E \subset \bigcup_{k = 1}^\infty B_{\varepsilon_k}(x_k)\ \text{and $\varepsilon_k \leq \delta$ for all $k$} \right\}. \]
    %
    Then $A(\alpha,\varepsilon)$ is an open set, and
    %
    \[ \bigcap_{n = 1}^\infty \bigcap_{m = 1}^\infty A(\beta + 1/n, 1/m) \]
    %
    is precisely the family of $(E,\mu) \in X$ such that $E$ has Hausdorff dimension $\beta$. Thus it suffices to show that $A(\alpha,\varepsilon)$ is dense in $X$ for $\alpha > \beta$ and $\varepsilon > 0$.

    So fix $(E,\mu) \in X$ and $\varepsilon > 0$. Without loss of generality, we may assume $\mu \in C^\infty(\TT^d)$. Consider large integers $N$ and $M$, and then construct a family of independant, uniformly distributed random variables $X(k) \in [M]^d$ for each $k \in [2N]^d$. Define a measure $\nu$ such that for each $x \in \TT^d$,
    %
    \[ d\nu(x) = \left( \sum_{k \in [2N]^d} \phi_{1/NM}(x - k/2N - X(k)/2NM) \right) \cdot \mu(x)\; dx_1 \dots dx_d. \]
    %
    Adding a discrete number of points to the support of $\nu$ if necessary to cover the set $E$ by a $\varepsilon$ net, $\nu$ is supported on a set $F$ with $d_H(E,F) \leq \varepsilon$ which also satisfies
    %
    \[ H^\alpha(F) \leq (2N)^d / (NM)^\alpha = 2^d N^{d-\alpha} M^{-\alpha}. \]
    %
    We note that
    %
    \[ \widehat{\nu}(k) = \sum_{l \in [2N]^d} B_l(k), \]
    %
    where
    %
    \[ B_l(k) = \sum_{r \in \ZZ^d} \widehat{\mu}(r) e^{2 \pi i (k-r) ()} \widehat{\phi_{1/NM}}(k-r)  \]

    % R(x) = sum a_k e^{2 \pi i k x}
    % R(x + k/2N + X(k)/2NM)
\end{proof}

\section{BLAH}

\section{s}

Fix $W \subset \TT^d$ with $\lowminkdim(W) \leq \alpha$. Then
%
\[ \liminf_{\varepsilon \to 0} \log_\varepsilon |W(\varepsilon)| \leq \alpha. \]
%
Thus there exists arbitrarily small $\varepsilon > 0$ and arbitrarily small $\delta > 0$ such that
%
\[ |W_\varepsilon| \leq \varepsilon^{nd - \alpha - \delta}. \]

\begin{proof}
    Let $X_1, \dots, X_N$ be uniformly distributed on $\TT^d$. For each $i \in \{ 1, \dots, N \}^n$ such that $i_1, \dots, i_n$ are distinct, consider the random vector $X_i = (X_{i_1}, \dots, X_{i_n})$. Then $X_i$ is uniformly distributed on $\TT^{nd}$, and so
    %
    \[ \PP(d(X_i,W) \leq \varepsilon) \leq \varepsilon^{nd - \alpha - \delta}. \]
    %
    If $M$ denotes the number of indices $i$ such that $d(X_i,W) \leq \varepsilon$, then by linearity of expectation we conclude that $\EE(M) \leq N^n \varepsilon^{nd - \alpha - \delta}$. Applying Markov's inequality, we conclude that
    %
    \[ \PP(M \geq 4 N^n \varepsilon^{nd - \alpha - \delta}) \leq 1/4. \]
    %
    Now consider the measure $\nu = \delta_{X_1} + \dots + \delta_{X_N}$. For each $k \in \ZZ^d$,
    %
    \[ \widehat{\nu}(k) = e^{2 \pi i k \cdot X_1} + \dots + e^{2 \pi i k \cdot X_N}. \] 
    %
    Thus $\widehat{\nu}(k)$ is the sum of $N$ bounded independent random variables, so we can apply Hoeffding's inequality to conclude that for each $t \geq 0$
    %
    \[ \PP(|\widehat{\nu}(k)| \geq t) \leq 2 \exp ( - 2 t^2 / N). \]
    %
    A union bound allows us to conclude that
    %
    \[ \PP \left( \text{for all $|k| \leq R$, $|\widehat{\nu}(k)| \leq t$} \right) \geq 1 - 2^{d+1} R^d \exp ( - 2 t^2 / N). \]
    %
    Thus provided
    %
    \begin{equation} \label{probabilitybound}
        2^{d+1} R^d \exp(-2t^2/N) \leq 1/4,
    \end{equation}
    %
    we conclude that there exists a choice of $X_1, \dots, X_N \in \TT^d$ such that if
    %
    \[ I = \{ i \in \{ 1, \dots, N \}^n : i_1, \dots, i_n\ \text{are distinct and}\ d(X_i,W) \leq \varepsilon \}, \]
    %
    then $\#(I) \leq 4 N^n \varepsilon^{nd - \alpha - \delta}$, and for all $|k| \leq R$, $|\widehat{\nu}(k)| \leq t$. In particular, if we choose
    %
    \[ N = \lfloor \varepsilon^{-\frac{nd - \alpha - \delta}{n - 1/2}} \rfloor, \]
    %
    choose $R = \varepsilon^{-10}$, and choose
    %
    \[ t = 5d^{1/2} \cdot \varepsilon^{- \frac{nd - \alpha - \delta}{2n - 1}} \log(1/\varepsilon)^{1/2}, \]
    %
    then using the fact that $\varepsilon \leq 1/2$, we conclude that \eqref{probabilitybound} is satisfied. The standard $(L^1,L^\infty)$ bound for the Fourier transform then implies that for each $k \in \ZZ^d$,
    %
    \[ \left\| \sum_{i \in I} \widehat{\delta_{X_{i_1}}} \right\|_{L^\infty(\ZZ^d)} \leq \#(I) \leq 4 N^n \varepsilon^{nd - \alpha - \delta} \leq 4 N^{1/2} \leq 4 \varepsilon^{- \frac{nd - \alpha - \delta}{2n - 1}}. \]
    %
    Define a probability measure
    %
    \[ \mu = \frac{1}{N - \#(I)} \left( \nu - \sum_{i \in I} \delta_{X_{i_1}} \right), \]
    %
    If $\varepsilon$ is sufficiently small, so that $N$ is sufficiently large, then for each $k \in \ZZ^d$ with $|k| \leq R = \varepsilon^{-10}$,
    %
    \begin{align*}
        |\widehat{\mu}(k)| &\leq \frac{1}{N - 4N^{1/2}} \left( 5d^{1/2} \varepsilon^{- \frac{nd - \alpha - \delta}{2n - 1}} \log(1/\varepsilon)^{1/2} +  4 \varepsilon^{- \frac{nd - \alpha - \delta}{2n - 1}} \right)\\
        &\leq 9.5 d^{1/2} N^{-1} \varepsilon^{- \frac{nd - \alpha - \delta}{2n - 1}} \log(1/\varepsilon)^{1/2} \leq 10 d^{1/2} \varepsilon^{\frac{nd - \alpha - \delta}{2n - 1}} \log(1/\varepsilon)^{1/2}. \qedhere
    \end{align*}
\end{proof}

Following through with the proof leads to a set with Fourier dimension
%
\[ \frac{nd - \alpha}{n - 1/2} \]
%
Which isn't quite enough for what we want.

\section{A Family of Cubes}

Fix two integer-valued sequences $\{ K_m : m \geq 1 \}$ and $\{ M_m : m \geq 1 \}$. For convenience, we also define $N_m = K_m M_m$ for $m \geq 1$. We then define two sequences of real numbers $\{ l_m : m \geq 0 \}$ and $\{ r_m : m \geq 0 \}$, by
%
\[ l_m = \frac{1}{N_1 \dots N_m} \quad\text{and}\quad r_m = \frac{1}{N_1 \dots N_{m-1} M_m}. \]
%
For each $m, d \geq 0$, we define two collections of strings
%
\[ \Sigma_m^d = \ZZ^d \times [M_1]^d \times [K_1]^d \times \dots \times [M_m]^d \times [K_m]^d \]
%
and
%
\[ \Pi_m^d = \ZZ^d \times [M_1]^d \times [K_1]^d \times \dots \times [K_{m-1}]^d \times [M_m]^d. \]
%
For each string $\sigma = \sigma_0 \sigma_1 \dots \sigma_{2k} \in \Sigma_m^d$, we define a vector $a(\sigma) \in (l_m \ZZ)^d$ by setting
%
\[ a(\sigma) = \sigma_0 + \sum_{k = 1}^m \sigma_{2k-1} \cdot r_k + \sigma_{2k} \cdot l_k \]
%
Then each string $\sigma \in \Sigma_m^d$ can be identified with the sidelength $l_m$ cube $Q(\sigma)$ with left-hand corner lies at $a(\sigma)$, i.e. the cube
%
\[ Q(\sigma) = \prod_{i = 1}^d \left[ a(\sigma)_i, a(\sigma)_i + l_m \right]. \]
%
Similarily, for each string $\sigma = \sigma_0 \dots \sigma_{2m-1} \in \Pi_m^d$, we define a vector $a(\sigma) \in (r_m \ZZ)^d$ by setting, for each $1 \leq j \leq d$,
%
\[ a(\sigma) = \sigma_0 + \left( \sum_{k = 1}^{m-1} \sigma_{2k-1} \cdot r_k + \sigma_{2k} \cdot l_k \right) + \sigma_{2m-1} \cdot r_m, \]
%
and then define a sidelength $r_m$ cube
%
\[ R(\sigma) = \prod_{i = 1}^d \left[ a(\sigma)_i, a(\sigma)_i + r_m \right]. \]
%
We let $\DQ_m^d = \{ Q(\sigma) : \sigma \in \Sigma_m^d \}$, and $\DR_m^d = \{ R(\sigma) : \sigma \in \Pi_m^d \}$. We now list some important properties of this collection of cubes:
%
\begin{itemize}
	\item For each $m$, the two collections $\DQ_m^d$ and $\DR_m^d$ form covers of $\RR^d$.

	\item If $Q_1,Q_2 \in \bigcup_{m = 0}^\infty \DQ_m^d$, then either $Q_1$ and $Q_2$ have disjoint interiors, or one cube is contained in the other. Similarily, if $R_1,R_2 \in \bigcup_{m = 1}^\infty \DR_m^d$, then either $R_1$ and $R_2$ have disjoint interiors, or one cube is contained in the other.

	\item For each cube $Q \in \DQ_m$, there is a unique cube $Q^* \in \DR_m$ with $Q \subset Q^*$. We refer to $Q^*$ as the \emph{parent cube} of $Q$. Similarily, if $R \in \DR_m$, there is a unique cube in $R^* \in \DQ_{m-1}$ with $R \subset R^*$, and we refer to $R^*$ as the \emph{parent cube} of $R$.
\end{itemize}

We say a set $E \subset \RR^d$ is $\DQ_m$ discretized if it is a union of cubes in $\DQ_m^d$, and we then let $\DQ_m(E) = \{ Q \in \DQ_m^d : Q \subset E \}$. Similarily, we say a set $E \subset \RR^d$ is $\DR_m$ discretized if it is a union of cubes in $\DR_m^d$, and we then let $\DR_m(E) = \{ R \in \DR_m^d : R \subset E \}$. We set $\Sigma_m(E) = \{ \sigma \in \Sigma_m^d : Q(\sigma) \in \DQ_m(E) \}$, and $\Pi_m(E) = \{ \sigma \in \Pi_m^d : R(\sigma) \in \DR_m(E) \}$. We say a cube $Q_1 \times \dots \times Q_n \in \DQ_m^{dn}$ is \emph{strongly non diagonal} if there does not exist two distinct indices $i,j$, and a third index $\sigma \in \Pi_m^d$, such that $R_\sigma \cap Q_i, R_\sigma \cap Q_j \neq \emptyset$.

\section{A Family of Mollifiers}

It will be useful to consider a family of $C^\infty$ mollifiers, which we will use to ensure the Fourier transform of the measures we study have appropriate decay.

\begin{lemma} \label{lemma19020941290}
    There exists a non-negative, $C^\infty$ function $\psi$ supported on $[-1,1]^d$ such that
    %
    \begin{equation} \label{equation1249015901590190}
        \int_{\RR^d} \psi = 1,
    \end{equation}
    %
    and for each $x \in \RR^d$,
    %
    \begin{equation} \label{equation50914902149012}
        \sum_{n \in \ZZ^d} \psi(x + n) = 1.
    \end{equation}
\end{lemma}
\begin{proof}
    Let $\alpha$ be a non-negative, $C^\infty$ function compactly supported on $[0,1]$, such that $\alpha(1/2 + x) = \alpha(1/2 - x)$ for all $x \in \RR$, $\alpha(x) = 1$ for $x \in [1/3,2/3]$, and $0 \leq \alpha(x) \leq 1$ for all $x \in \RR$. Then define $\beta$ to be the non-negative, $C^\infty$ function supported on $[-1/3,1/3]$ defined for $x \in [-1/3,1/3]$ by
    %
    \[ \beta(x) = 1 - \alpha(|x|) = 1 - \alpha(1 - |x|). \]
    %
    Symmetry considerations imply that $\int_{\RR} \alpha + \beta = 1$, and for each $x \in \RR$,
    %
    \begin{equation} \label{equation129410294910}
        \sum_{m \in \ZZ} \alpha(x + m) + \beta(x + m) = 1.
    \end{equation}
    %
    If we set
    %
    \[ \psi_0(x) = \alpha(x) + \beta(x), \]
    %
    The function $\psi(x_1, \dots, x_d) = \psi_0(x_1) \dots \psi_0(x_d)$ then satisfies the constraints of the lemma.
\end{proof}

Fix some choice of $\psi$ given by Lemma \ref{lemma19020941290}. Since $\psi$ is $C^\infty$ and compactly supported, then for each $t \in [0,\infty)$, we conclude
%
\begin{equation} \label{equation682928418931289}
	\sup_{\xi \in \RR^d} |\xi|^t |\widehat{\psi}(\xi)| < \infty.
\end{equation}
%
Now we rescale the mollifier. For each integer $m \geq 1$, we let
%
\[ \psi_m(x) = l_m^{-d} \cdot \psi(l_m \cdot x). \]
%
Then $\psi_m$ is supported on $[-l_m,l_m]^d$. Equation \eqref{equation1249015901590190} implies that for each $x \in \RR^d$,
%
\begin{equation} \label{equation19204910490190190}
	\int_{\RR^d} \psi_m = 1.
\end{equation}
%
Equation \eqref{equation50914902149012} implies
%
\begin{equation} \label{equation990249012409129041290} \sum_{n \in \ZZ^d} \psi(x + l_m \cdot n) = l_m^{-d}. \end{equation}
%
An important property of the rescaling in the frequency domain is that for each $\xi \in \RR^d$,
%
\begin{equation} \label{equation12901902419209012}
    \widehat{\psi_m}(\xi) = \widehat{\psi}(l_m \cdot \xi),
\end{equation}
%
In particular, \eqref{equation12901902419209012} implies that for each $t \geq 0$,
%
\begin{equation}
    \sup_{|\xi| \in \RR^d} |\widehat{\psi_m}(\xi)| |\xi|^t = l_m^{-t} \sup_{|\xi| \in \RR^d} |\widehat{\psi}(\xi)| |\xi|^t.
\end{equation}
%
Intuitively, $\{ \psi_m \}$ is a `uniform' family of wave packets, with $\psi_m$ supported in phase space on $[-l_m,l_m]^d$, and in frequency space, essentially supported on $[-l_m^{-1}, l_m^{-1}]^d$.

\section{Comparison to Previous Paper}

As in our previous paper, our proof of Theorem \ref{maintheorem} will involve constructing a configuration avoiding set $X$ by considering a nested decreasing family of sets $\{ X_m : m \geq 0 \}$, where $X_m \subset [0,1]^d$ is a $\DQ_m$ discretized set, and then setting $X = \bigcap_{m \geq 0} X_m$. We find a strong cover of $Z$ by sets $\{ B_m \}$, where $B_m$ is $\DQ_m$ discretized. Provided $X_m^d$ is disjoint from strongly non-diagonal cubes in $B_m$, we conclude that for any $n$ distinct elements $x_1, \dots, x_n \in X$, $(x_1,\dots,x_n) \not \in Z$. We now show that the technique of our last paper as stated fails to produce Salem sets.

Let us recap the approach of our last paper. To form $X_{m+1}$, we chose a cube $Q_R \in \DQ_{m+1}(R)$ uniformly at random, for each $R \in \DR_{m+1}(X_m)$. We then let $Y_{m+1} = \bigcup Q_R$. If $s \geq d$, and
%
\begin{equation} \label{equation12904190249102}
    K_{m+1} \approx M_{m+1}^{\frac{s - d}{dn - s}},
\end{equation}
%
then with non-zero probability, we proved there is $X_{m+1} \subset Y_{m+1}$ such that $X_{m+1}^d$ avoids strongly non-diagonal cubes in $B_{m+1}$, and $X_{m+1}$ contains at least half of the cubes in $\DQ_{m+1}(Y_{m+1})$. Then $X_{m+1}$ will be the union of at least $M_{m+1}^{-d}$ cubes with sidelength $l_{m+1}$. Provided that $K_{m+1}, M_{m+1} \gg K_1, M_1, \dots, K_m, M_m$, we have
%
\[ M_{m+1}^{-d} \approx r_{m+1}^{-d} \approx l_{m+1}^{-\frac{dn - s}{n-1}}. \]
%
Thus $X$ has lower Minkowski dimension at most $(dn - s)/(n-1)$, and a more involved analysis shows the set has Hausdorff dimension exactly equal to $(dn - s)/(n-1)$.

The approach detailed in the last paragraph is \emph{not} guaranteed to produce a set with Fourier dimension $t$. Because $X_{m+1}$ is random, it exhibits psuedorandomness properties with high probability. In particular, it supports probability measures whose Fourier transform has sharp decay. However, since the choice of the set $Y_{m+1}$ is \emph{not} chosen randomly from $X_{m+1}$, depending heavily on the set $Z$ and the discretized set $B_{m+1}$, the set $Y_{m+1}$ will in general not possess psuedorandomness properties. For instance, if $\mu$ is the probability measure induced by normalizing Lebesgue measure restricted to $X_{m+1}$, then with high probability,
%
\[ \| \widehat{\mu} \|_{L^\infty(\RR^d)} \approx l_m^t. \]
%
If $\nu$ is the probability measure induced by normalizing Lebesgue measure restricted to $Y_{m+1}$, then it is still possible for us to have
%
\[ \| \widehat{\nu} \|_{L^\infty(\RR^d)} \gtrsim 1. \]
%
For instance, this will be true if $\DQ_{m+1}(X_{m+1}) - \DQ_{m+1}(Y_{m+1})$ is a thickening of a subset of an arithmetic progression. Thus the method of our previous paper is not able to reliably produce Salem sets without further analysis on the psuedorandom properties of the sets $\{ B_m \}$ we have to avoid.

In this paper, we take a different approach which avoids us having to analyze the psuedorandomness of the sets $B_m$. Instead of \eqref{equation12904190249102}, we choose
%
\[ K_{m+1} \approx M_{m+1}^{\frac{s}{dn - s}}. \]
%
Notice that $M_{m+1}^{\frac{s}{dn - s}} \geq M_{m+1}^{\frac{s-d}{dn - s}}$, so the set $Y_{m+1}$ we will obtain will be a thinner set than $X_m$. In particular, $Y_{m+1}$ will be covered by at most $M_{m+1}^{-d}$ sidelength $l_{m+1}$ cubes, and if $K_{m+1}, M_{m+1} \gg K_1,M_1,\dots,K_m,M_m$< 
%
\[ r_{m+1}^{-d} \approx l_{m+1}^{-t} \]
%
sidelength $l_{m+1}$ cubes, which implies $X$ will have upper Minkowski dimension at most $t$. However, as a result, because the set $Y_{m+1}$ is thinner, we find that $Y_{m+1}^d$ is disjoint from the cubes in $B_{m+1}$ with high probability. In particular, we can set $X_{m+1} = Y_{m+1}$. This means that $X_{m+1}$ will be pseudorandom, and we should therefore expect $X$ to be a Salem set of dimension $t$. The remainder of this paper is devoted to showing that these heuristics are correct.

\section{Discrete Lemma}

We now proceed to solve a discretized version of Theorem \ref{maintheorem}.

\begin{prop} \label{discreteLemma}
    Fix $s \in [1,dn)$ and $\varepsilon \in [0,(dn-s)/2)$. Let $T \subset [0,1]^d$ be a non-empty, $\DQ_m$ discretized set, and let $\mu_T$ be a smooth measure compactly supported on $T$. Let $B \subset \RR^{dn}$ be a non-empty, $\DQ_{m+1}$ discretized set such that
    %
    \begin{equation} \label{equation1290419204912090120912}
       \#(\DQ_{m+1}(B)) \leq (1/l_{m+1})^{s + \varepsilon}.
    \end{equation}
    %
    Then there exists a large constant $C(\mu_T,l_m,n,d,s,\varepsilon)$, such that if
    %
    % Must depend on d and \mu
    \begin{equation} \label{equation1095121284102}
        K_{m+1}, M_{m+1} \geq C(\mu_T,l_m,n,d,s,\varepsilon),
    \end{equation}
    %
    and
    %
    % Must depend on l_m, d, n, and s
    \begin{equation} \label{equation5890129048128941891}
        M_{m+1}^{\frac{s}{dn-s} + c\varepsilon} \leq K_{m+1} \leq 2 M_{m+1}^{\frac{s}{dn-s} + c \varepsilon},
    \end{equation}
    %
    where
    %
    \[ c = \frac{6dn}{(dn - s)^2}, \]
    %
    then there exists a $\DQ_{m+1}$ discretized set $S \subset T$ together with a smooth probability measure supported on $S$ such that
    %
    \begin{enumerate}
        \item[(A)] For any strongly non-diagonal cube
        %
        \[ Q = Q_1 \times \dots \times Q_n \in \DQ_{m+1}(B), \]
        %
        there exists $i$ such that $Q_i \not \in \DQ_{m+1}(S)$.

        \item[(B)] $\mu_S(\RR^d) \geq \mu_T(\RR^d) - M_{m+1}^{-1/2}$.

        \item[(C)] If $|k| \leq 10 l_{m+1}^{-d}$, $|\widehat{\mu_T}(k) - \widehat{\mu_S}(k)| \leq r_{m+1}^{d/2} \log(M_{m+1})$.

        \item[(D)] If $|k| \geq 10 l_{m+1}^{-d}$, $|\widehat{\mu_S}(k)| \leq |k|^{-d/2}$.
    \end{enumerate}
\end{prop}

\begin{remark}
    To make the statement of Proposition \eqref{discreteLemma} more clean, we have hidden the explicit choice of constant $C(\mu_T,l_m,n,d,s,\varepsilon)$. But this constant can certainly be made explicit; such a choice can be made by ensuring that \eqref{equation1095121284102} implies \eqref{equation10491249012}, \eqref{equation194012904129009}, \eqref{equation1940129041}, \eqref{equation129041902412901290129}, \eqref{equation190512919204912901}, and \eqref{equation68943893493849} all hold.%\eqref{equation1290412904129049102}, and \eqref{equation129301923109}.
\end{remark}

\begin{proof}[Proof of Proposition \ref{discreteLemma}]
    \renewcommand{\qedsymbol}{}
    First, we describe the construction of the set $S$, and the measure $\mu_S$. For each string $\sigma \in \Pi_{m+1}^d$, let $j_\sigma$ be a random integer vector chosen from $\{ 0, \dots, K_{m+1} - 1 \}^d$, such that the family $\{ j_\sigma : \sigma \in \Pi_{m+1}^d \}$ is an independent family of random variables. Then it is certainly true that for any $j \in [K_{m+1}]^d$,
    %
    \begin{equation} \label{equation129412904912090}
        \PP(j_\sigma = j) = K_{m+1}^{-d}.
    \end{equation}
    %
    Then $\sigma j_\sigma \in \Sigma_{m+1}^d$. We can thus define a measure $\mu_S$ such that, for each $x \in \RR^d$,
    %
    \[ d\mu_S(x) = r_{m+1}^d \sum\nolimits_{\sigma \in \Pi_{m+1}^d} \psi_{m+1}(x - a(\sigma j_\sigma)) \cdot d\mu_T(x). \]
    %
    If we set
    %
    \[ S = \bigcup \{ Q \in \DQ_{m+1}^d : \mu_S(Q) > 0 \}, \]
    %
    then $S$ is $\DQ_{m+1}$ discretized, $\mu_S$ is supported on $S$, and $S \subset T$. Our goal is to show that, with non-zero probability, some choice of the family of indices $\{ j_\sigma : \sigma \in \Pi_{m+1}^d \}$ yields a set $S$ and a measure $\mu_S$ satisfying Properties (A) and (B) of Proposition \ref{discreteLemma}. In our calculations, it will help us to decompose the measure $\mu_S$ into components roughly supported on sidelength $r_{m+1}^d$ cubes. For each $\sigma \in \Pi_{m+1}(T)$, define a measure $\mu_\sigma$ such that for each $x \in \RR^d$,
    %
    \[ d\mu_\sigma(x) = r_{m+1}^d \psi_{m+1}(x - a(\sigma j_\sigma)) \cdot d\mu_T(x). \]
    %
    Then $\mu_S = \sum_{\sigma \in \Pi_{m+1}^d(T)} \mu_\sigma$. We shall split the proof of Properties (A), (B), and (C) into several more managable lemmas.
\end{proof}

\begin{lemma} \label{nuNormalizationLemma}
    If
    %
    \begin{equation} \label{equation10491249012}
        M_{m+1} \geq \left( 3^d \sqrt{d} \cdot l_m \| \nabla \mu \|_{L^\infty(\RR^d)} \right)^2,
    \end{equation}
    %
    then $\mu_S(\RR^d) \geq \mu_T(\RR^d) - M_{m+1}^{-1/2}$.
\end{lemma}
\begin{proof}
    Fix $\sigma \in \Pi_{m+1}^d$. If $j_0, j_1 \in \{ 0, \dots, K_{m+1} - 1 \}^d$, then
    %
    \begin{equation} \label{equation99210391920}
        |a(\sigma j_0) - a(\sigma j_1)| = |j_0 - j_1| \cdot l_{m+1} \leq (\sqrt{d} \cdot K_{m+1}) \cdot l_{m+1} = \sqrt{d} \cdot r_{m+1}.
    \end{equation}
    %
    Together with \eqref{equation19204910490190190}, \eqref{equation99210391920} implies
    %
    \begin{equation} \label{equation92941294129412919}
    \begin{split}
        &\left| r_{m+1}^d \int_{\RR^d} \psi_{m+1}(x - a(\sigma j_0)) \mu_T(x) - r_{m+1}^d \int_{\RR^d} \psi_{m+1}(x - a(\sigma j_1)) \mu_T(x) \right|\\
        &\ \ \ \ \ \ \ \ \leq r_{m+1}^d \int_{\RR^d} \psi_{m+1}(x) \left| \mu_T(x + a(\sigma j_0)) - \mu_T(x + a(\sigma j_1)) \right|\\
        &\ \ \ \ \ \ \ \ \leq \sqrt{d} \cdot r_{m+1}^{d+1} \cdot \| \nabla \mu_T \|_{L^\infty(\RR^d)} \int_{\RR^d} \psi_{m+1}\\
        &\ \ \ \ \ \ \ \ = \sqrt{d} \cdot r_{m+1}^{d+1} \cdot \| \nabla \mu_T \|_{L^\infty(\RR^d)}.
    \end{split}
    \end{equation}
    %
    %For each $i \in \Sigma_{m+1}^d$, if we set
    %
    %\[ A_i = \EE(\nu_i(\RR^d)) = \frac{1}{N_{n+1}^d} \sum_{j \in [N_{n+1}]^d} \int_{\RR^d} \psi_{m+1}(x - a_{ij}) \mu_T(x)\; dx, \]
    %
    Thus $\eqref{equation92941294129412919}$ implies that for each $\sigma$,
    %
    \begin{equation} \label{equation491040912491}
        |\mu_\sigma(\RR^d) - \EE(\mu_\sigma(\RR^d))| \leq \sqrt{d} \cdot r_{m+1}^{d+1} \| \nabla \mu \|_{L^\infty(\RR^d)}.
    \end{equation}
    %
    Furthermore, \eqref{equation990249012409129041290} implies
    %
    \begin{equation} \label{9921490124912}
    \begin{split}
        &\sum\nolimits_{\sigma \in \Pi_{m+1}^d} \EE(\mu_\sigma(\RR^d))\\
        &\ \ \ \ \ = r_{m+1}^d \sum\nolimits_{(\sigma,j) \in \Sigma_{m+1}^d} \PP(j_\sigma = j) \int_{\RR^d} \psi_{m+1}(x - a(\sigma j_\sigma)) d\mu_T(x)\\
        &\ \ \ \ \ = \frac{r_{m+1}^d}{K_{m+1}^d} \int_{\RR^d} \left( \sum\nolimits_{(\sigma,j) \in \Sigma_{m+1}^d} \psi_{m+1}(x - a(\sigma j)) \right) d\mu_T(x)\\
        &\ \ \ \ \ = \frac{r_{m+1}^d l_{m+1}^{-d}}{K_{m+1}^d} \mu_T(\RR^d) = \mu_T(\RR^d).
    \end{split}
    \end{equation}
    %
    For all but at most $3^d r_{m+1}^{-d}$ indices $\sigma \in \Pi_{m+1}^d$, $\mu_\sigma = 0$ almost surely. Thus we can apply the triangle inequality together with \eqref{equation491040912491} and \eqref{9921490124912} to conclude that
    %
    \begin{equation} \label{equation42214124124102412}
    \begin{split}
        |\mu_S(\RR^d) - \mu_T(\RR^d)| &= \left| \sum\nolimits_{\sigma \in \Pi_{m+1}^d} \left[ \mu_\sigma(\RR^d) - \EE(\mu_\sigma(\RR^d)) \right] \right| \\
        &\leq \sum\nolimits_{\sigma \in \Pi_{m+1}^d} \left| \mu_\sigma(\RR^d) - \EE(\mu_\sigma(\RR^d)) \right|\\
        &\leq (3^d r_{m+1}^{-d}) \left( \sqrt{d} \cdot r_{m+1}^{d+1} \| \nabla \mu \|_{L^\infty(\RR^d)} \right)\\
        &= \left( 3^d \sqrt{d} \| \nabla \mu \|_{L^\infty(\RR^d)} \right) \cdot r_{m+1}\\
        &= \frac{3^d \sqrt{d} \cdot l_m \| \nabla \mu \|_{L^\infty(\RR^d)}}{M_{m+1}}.
    \end{split}
    \end{equation}  
    %
    Thus \eqref{equation10491249012} and \eqref{equation42214124124102412} imply that, $|\mu_S(\RR^d) - \mu_T(\RR^d)| \leq M_{m+1}^{-1/2}$.
\end{proof}

\begin{lemma} \label{propertyALemma}
    If
    %
    \begin{equation} \label{equation194012904129009}
        M_{m+1} \geq \left( 10 \cdot 3^{dn} \cdot l_m^{-(s + \varepsilon)} \right)^{1/\varepsilon},
    \end{equation}
    %
    then
    %
    \[ \PP \left(S\ \text{\normalfont{does not satisfy Property (A)}} \right) \leq 1/10. \]
\end{lemma}
\begin{proof}
    For any cube $Q \in \Sigma_{m+1}^d$, there are at most $3^d$ indices $\sigma j \in \Sigma_{m+1}^d$ such that $Q_{\sigma j} \cap Q \neq \emptyset$, and so a union bound together with \eqref{equation129412904912090} gives
    %
    \begin{equation} \label{equation5901490129129012409}
        \PP(Q \in \DQ_{m+1}(S)) \leq \sum\nolimits_{Q_{\sigma j} \cap Q \neq \emptyset} \PP(j_\sigma = j) \leq 3^d K_{m+1}^{-d}.
    \end{equation}
    %
    Without loss of generality, removing cubes from $B$ if necessary, we may assume all cubes in $B$ are strongly non-diagonal. Let $Q = Q_1 \times \dots \times Q_n \in \DQ_{m+1}(B)$ be such a cube. Since $Q$ is strongly diagonal, the events $\{ Q_k \in S \}$ are independent from one another for $k \in \{ 1, \dots, n \}$, which together with \eqref{equation5901490129129012409} implies that
    %
    \begin{equation} \label{equation190589012590812892189}
       \PP(Q \in \DQ_{m+1}(S^n)) = \PP(Q_1 \in S) \dots \PP(Q_n \in S) \leq 3^{dn} K_{m+1}^{-dn}.
    \end{equation}
    %
    Taking expectations over all cubes in $B$, and applying \eqref{equation1290419204912090120912} and \eqref{equation190589012590812892189} gives
    %
    \begin{equation} \label{equation129041289589128921891289}
    \begin{split}
        \EE(\#(\DQ_{m+1}(B) \cap \DQ_{m+1}(S^n))) &\leq \#(\DQ_{m+1}(B)) \cdot (3^{dn} K_{m+1}^{-dn})\\
        &\leq l_{m+1}^{-(s + \varepsilon)} (3^{dn} K_{m+1}^{- dn})\\
        &= \frac{3^{dn} l_m^{-(s + \varepsilon)} M_{m+1}^{s + \varepsilon}}{K_{m+1}^{dn - s - \varepsilon}}.
    \end{split}
    \end{equation}
    % M^{(s + e)/(dn - s - e)} <= K
    % (s + e)/(dn - s - e) \leq (s + e[s + 3])/(dn - s)
    %
    Since $\varepsilon \leq (dn - s)/2$, we conclude
    %
    \begin{align*}
        \left( dn - s - \varepsilon \right) \left( \frac{s}{dn - s} + c\varepsilon \right) &= s + \varepsilon \left( c(dn - s - \varepsilon) - \frac{s}{dn - s} \right)\\
        &\geq s + \varepsilon \left( \frac{c(dn - s)}{2} - \frac{s}{dn - s} \right)\\
        &= s + \varepsilon \frac{3dn - s}{dn - s} \geq s + 2\varepsilon.
    \end{align*}
    %
    Applying \eqref{equation5890129048128941891}, we therefore conclude that
    %
    \begin{align*}
        K_{m+1}^{dn - s - \varepsilon} &\geq M_{m+1}^{(dn - s - \varepsilon) \left( \frac{s}{dn - s} + c\varepsilon \right)} \geq M_{m+1}^{s + 2 \varepsilon}.
    \end{align*}
    %
    Combined with \eqref{equation194012904129009}, we conclude that
    %
    \begin{equation} \label{equation1290419024190}
        \frac{3^{dn} l_m^{-(s + \varepsilon)} M_{m+1}^{s + \varepsilon}}{K_{m+1}^{dn - s - \varepsilon}} \leq \frac{3^{dn} l_m^{-(s + \varepsilon)}}{M_{m+1}^\varepsilon} \leq 1/10.
    \end{equation}
    %
    We can then apply Markov's inequality with \eqref{equation129041289589128921891289} and \eqref{equation1290419024190} to conclude
    %
    \begin{equation} \label{fourierdim2}
    \begin{split}
        \PP(\DQ_{k+1}(B) \cap \DQ_{k+1}(S^n) \neq \emptyset) &= \PP(\# (\DQ_{k+1}(B) \cap \DQ_{k+1}(S^n)) \geq 1)\\
        &\leq \EE(\#(\DQ_{m+1}(B) \cap \DQ_{m+1}(S^n)))\\
        &\leq 1/10. \qedhere
    \end{split}
    \end{equation}
    %
%    Thus $\DQ_{k+1}(S^n)$ is disjoint from $\DQ_{k+1}(B)$ with high probability.
\end{proof}

\begin{lemma} \label{deviationLemma}
    Set $D = \{ k \in \ZZ^d: |k| \leq 10l_{m+1}^{-1} \}$. Then if
    %
    \begin{equation} \label{equation109519029012}
        K_{m+1} \leq M_{m+1}^{\frac{2dn}{dn - s}},
    \end{equation}
    %
    and
    %
    \begin{equation} \label{equation1940129041}
        M_{m+1} \geq \exp \left( \frac{10^7 (3dn - s) d^2}{dn - s} \right),
    \end{equation}
    %
    then
    %
    \begin{equation} \label{equation12901904192090129102}
        \PP \left( \| \widehat{\mu_S} - \widehat{\mu_T} \|_{L^\infty(D)} \geq r_{m+1}^{d/2} \log(M_{m+1}) \right) \leq 1/10
    \end{equation}
\end{lemma}
\begin{proof}
    For each $\sigma \in \Pi_{m+1}^d$, and $k \in \ZZ$, define $X_{\sigma k} = \widehat{\mu_\sigma}(k) - \widehat{\EE(\mu_\sigma)}(k)$. Applying \eqref{equation50914902149012} gives 
    %
    \begin{equation} \label{equation891248921894128942189}
    \begin{split}
        \sum_{\sigma \in \Pi_{m+1}^d} \widehat{\EE(\mu_\sigma)}(k) &= \sum_{\sigma \in \Pi_{m+1}^d} l_{m+1}^d \sum_{j \in [K_{m+1}]^d} \int_{\RR^d} e^{- 2 \pi i k \cdot x} \psi_{m+1}(x - a(\sigma j)) d\mu_T(x)\\
        &= \int_{\RR^d} e^{-2 \pi i k \cdot x} d\mu_T(x) = \widehat{\mu_T}(k).
    \end{split}
    \end{equation}
    %
    For each $\sigma$ and $k$, the standard $(L^1,L^\infty)$ bound on the Fourier transform, combined with \eqref{equation491040912491}, shows
    %
    \begin{equation} \label{equation12904912049012}
    \begin{split}
        \psitwo{X_{\sigma k}} &\leq 10 | X_{\sigma k} |\\
        &\leq 10[| \mu_\sigma(\RR^d) | + \EE(\mu_\sigma)(\RR^d)]\\
        &\leq 10^2 \left( \EE(\mu_\sigma)(\RR^d) + \sqrt{d} \cdot r_{m+1}^{d+1} \| \nabla \mu_T \|_{L^\infty(\RR^d)} \right).
    \end{split}
    \end{equation}
    %
    For a fixed $k$, the family of random variables $\{ X_{\sigma k} : \sigma \in \Pi_{m+1}^d \}$ are independent. Furthermore, $\sum X_{\sigma k} = \widehat{\mu_S}(k) - \widehat{\EE(\mu_S)}(k)$. Equations \eqref{equation990249012409129041290} and \eqref{equation129412904912090} imply that
    %
    \begin{equation} \label{equation19241902490129021}
    \begin{split}
        \EE(\widehat{\mu_S}(k)) &= \frac{r_{m+1}^d}{K_{m+1}^d} \int_{\RR^d} e^{-2 \pi i k \cdot x} \left( \sum_{(\sigma ,j) \in \Sigma_{m+1}^d} \psi_{m+1}(x - a(\sigma j)) \right) d\mu_T(x)\\
        &= \frac{r_{m+1}^d l_{m+1}^{-d}}{K_{m+1}^d} \int_{\RR^d} e^{-2 \pi i k \cdot x} d\mu_T(x)\\
        &= \frac{r_{m+1}^d l_{m+1}^{-d}}{K_{m+1}^d} \widehat{\mu_T}(k) = \widehat{\mu_T}(k).
    \end{split}
    \end{equation}
    %
    Hoeffding's inequality, together with \eqref{equation12904912049012} and \eqref{equation19241902490129021}, imply that
    %
    \begin{equation} \label{equation190219024901290129041}
    \begin{split}
        & \psitwo{\widehat{\mu}(k) - \widehat{\mu_T}(k)}\\
        &\ \ \ \ \ \ \ \ \ \ \leq 10^3 \sqrt{d} \left( \left( \sum \EE(\mu_\sigma)(\RR^d)^2 \right)^{1/2} + r_{m+1}^{d/2+1} \| \nabla \mu_T \|_{L^\infty(\RR^d)} \right).
    \end{split}
    \end{equation}
    %
    Equation \eqref{equation19204910490190190} shows
    %
    \begin{equation} \label{equation129401924901290412}
    \begin{split}
        \EE(\mu_\sigma)(\RR^d) &= l_{m+1}^d \sum_{j \in [K_{m+1}]^d} \int \psi_{m+1}(x - a(ij)) d\mu_T(x)\\
        &\leq r_{m+1}^d \| \mu_T \|_{L^\infty(\RR^d)}.
    \end{split}
    \end{equation}
    %
    Combining \eqref{equation190219024901290129041} and \eqref{equation129401924901290412} gives
    %
    \begin{equation} \label{equation10491204901290}
        \psitwo{\widehat{\mu}(k) - \widehat{\mu_T}(k)} \leq 10^3 \sqrt{d} \left[ \| \mu_T \|_{L^\infty(\RR^d)} + \| \nabla \mu_T \|_{L^\infty(\RR^d)} \right] r_{m+1}^{d/2}.
    \end{equation}
    %
    We can then apply a union bound over the set $D$, which has cardinality at most $10^{d+1} l_{m+1}^{-d}$, together with \eqref{equation10491204901290} to conclude that
    %
    \begin{equation} \label{equation1290421941021290}
    \begin{split}
        \PP& \left(\| \widehat{\mu_S} - \widehat{\mu_T} \|_{L^\infty(D)} \geq r_{m+1}^{d/2} \log(M_{m+1}) \right)\\
        &\ \ \ \ \ \leq 10^{d+2} \cdot l_{m+1}^{-d} \exp \left( - \frac{\log(M_{m+1})^2}{10^7 d} \right)\\
        &\ \ \ \ \ = 10^{d+2} l_m^{-d} \exp \left( d \log(M_{m+1} K_{m+1}) - \frac{\log(M_{m+1})^2}{10^7 d} \right).
    \end{split}
    \end{equation}
    %
    Combined with \eqref{equation109519029012} and \eqref{equation1940129041}, \eqref{equation1290421941021290} implies
    %
    \begin{equation} \label{equation0148912489128}
        \PP \left(\| \widehat{\mu_S} - \widehat{\mu_T} \|_{L^\infty(D)} \geq r_{m+1}^{d/2} \log(M_{m+1}) \right) \leq 1/10.
    \end{equation}
    %
    Thus $\widehat{\mu_S}$ and $\widehat{\mu_T}$ are highly likely to differ only by a negligible amount over small frequencies.
\end{proof}

Since $\mu_T$ is compactly supported, we can define, for each $t > 0$,
%
\[ A(t) = \sup_{\xi \in \RR^d} |\widehat{\mu_T}(\xi)| |\xi|^t < \infty. \]
%
In light of \eqref{equation12901902419209012}, if we define, for each $t > 0$,
%
\[ B(t) = \sup_{\xi \in \RR^d} |\widehat{\psi}(\xi)| |\xi|^t, \]
%
then
%
\[ \sup_{\xi \in \RR^d} |\widehat{\psi_{m+1}}(\xi)| |\xi|^t = l_{m+1}^{-t} B(t). \]

\begin{lemma} \label{largeFrequencyLemma}
    Suppose that
    %
    \begin{equation} \label{equation129041902412901290129}
        N_{m+1}^d \geq 10 \cdot 2^{3d/2+1} A(3d/2 + 1),
    \end{equation}
    %
    \begin{equation} \label{equation190512919204912901}
    \begin{split}
        N_{m+1}^d \geq \frac{10 \cdot 2^{3d}}{1 + d/2} A(3d/2 + 1),
    \end{split}
    \end{equation}
    %
    and
    %
    \begin{equation} \label{equation68943893493849}
        N_{m+1}^d \geq 10 \cdot 2^{7d/2 + 1} B(3d/2 + 1).
    \end{equation}
    %
    then if $|\eta| \geq 10l_{m+1}^{-1}$,
    %
    \begin{equation} \label{equation66123142190}
        |\widehat{\mu_S}(\eta)| \leq \frac{1}{|\eta|^{d/2}}.
    \end{equation}
\end{lemma}
\begin{proof}
    Define a random measure
    %
    \[ \alpha = r_{m+1}^d \sum\nolimits_{\substack{\sigma \in \Pi_{m+1}^d\\d(a(\sigma),T) \leq 2 r_{m+1}^{-1}}} \delta_{a(ij_i)}. \]
    %
    Then $\mu_S = (\alpha * \psi_{m+1}) \mu_T$.
    %Since $\mu_T$ is supported on $T$, we can really truncate the sum defining $\eta$ to $O_d(r_{m+1}^{-d})$ terms such that the convolution identity remains valid.
    Thus we have $\widehat{\mu_S} = (\widehat{\alpha} \cdot \widehat{\psi_{m+1}}) * \widehat{\mu_T}$. The measure $\alpha$ is the sum of at most $2^d r_{m+1}^{-d}$ delta functions, scaled by $r_{m+1}^d$, so $\| \widehat{\alpha} \|_{L^\infty(\RR^d)} \leq \alpha(\RR^d) \leq 2^d$. Thus
    %
    \begin{equation} \label{equation9942941924912912}
        |\widehat{\mu_S}(\eta)| \leq 2^d \int |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi.
    \end{equation}
    %
    If $|\xi| \leq |\eta|/2$, $|\eta - \xi| \geq |\eta|/2$, and since \eqref{equation19204910490190190} implies $\| \widehat{\psi_{m+1}} \|_{L^\infty(\RR^d)} \leq 1$, we find that for all $t > 0$,
    %
    \begin{equation} \label{equation999941204192049012}
        \int_{0 \leq |\xi| \leq |\eta|/2} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi \leq \frac{A(t) 2^{t-d}}{|\eta|^{t-d}}.
    \end{equation}
    %
    Set $t = 3d/2 + 1$. Equation \eqref{equation999941204192049012}, together with \eqref{equation129041902412901290129}, implies
    %
    \begin{equation} \label{equation1111902491209012}
    \begin{split}
        &\int_{0 \leq |\xi| \leq |\eta|/2} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi\\
        &\ \ \ \ \ \ \ \leq \frac{A(3d/2 + 1) 2^{1 + d/2} |\eta|^{-1}}{|\eta|^{d/2}}\\
        &\ \ \ \ \ \ \ \leq \frac{A(3d/2 + 1) 2^{1 + d/2} l_{m+1}}{|\eta|^{d/2}}\\
        &\ \ \ \ \ \ \ \leq \frac{1}{10 \cdot 2^d \cdot |\eta|^{d/2}}.
    \end{split}
    \end{equation}
    %
    Conversely, if $|\xi| \geq 2|\eta|$, then $|\eta - \xi| \geq |\xi|/2$, so for each $t > d$,
    %
    \begin{equation} \label{equation5551092491022109}
    \begin{split}
        \int_{|\xi| \geq 2|\eta|} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi}_{m+1}(\xi)|\; d\xi &\leq \int_{|\xi| \geq 2|\eta|} \frac{A(t) 2^t}{|\xi|^t}\\
        &\leq 2^d \int_{2|\eta|}^\infty r^{d-1 - t} A(t) 2^t\\
        &\leq \frac{4^d A(t)}{t - d} |\eta|^{d-t}.
    \end{split}
    \end{equation}
    %
    Set $t = 3d/2 + 1$. Equation \eqref{equation190512919204912901}, applied to \eqref{equation5551092491022109}, allows us to conclude
    %
    \begin{equation} \label{equation123123123}
        \int_{|\xi| \geq 2|\eta|} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi}_{m+1}(\xi)|\; d\xi \leq \frac{1}{10 \cdot 2^d \cdot |\eta|^{s/2}}.
    \end{equation}
    %
    Finally, if $t > 0$, we use the fact that $\| \widehat{\mu_T} \|_{L^\infty(\RR^d)} \leq 1$ to conclude that
    %
    \begin{equation} \label{equation59010491092}
    \begin{split}
        \int_{|\eta|/2 \leq |\xi| \leq 2|\eta|} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi &\leq \frac{2^{d+t} B(t)}{|\eta|^{t-d}}.
    \end{split}
    \end{equation}
    %
    Set $t = 3d/2 + 1$. Then \eqref{equation59010491092} and \eqref{equation68943893493849} imply
    %
    \begin{equation} \label{equation2194129}
        \int_{|\eta|/2 \leq |\xi| \leq 2|\eta} |\widehat{\mu_T}(\eta - \xi)| |\widehat{\psi_{m+1}}(\xi)|\; d\xi \leq \frac{1}{10 \cdot 2^d \cdot |\eta|^{d/2}}.
    \end{equation}
    %
    It then suffices to sum up \eqref{equation1111902491209012}, \eqref{equation123123123}, and \eqref{equation2194129}, and apply \eqref{equation9942941924912912}.
\end{proof}

\begin{proof}[Proof of Proposition \ref{discreteLemma}, Continued]
    Let us now put all our calculations together. In light of Lemma \ref{propertyALemma} and Lemma \ref{deviationLemma}, there exists some choice of $j_\sigma$ for each $\sigma$, and a resultant non-random pair $(\mu_S, S)$ such that $S$ satisfies Property (A) of the Lemma, and $\mu_S$ satisfies \eqref{equation12901904192090129102}, implying that $\mu_S$ satisfies Property (C) of the Lemma. But Lemma \ref{nuNormalizationLemma} shows that $\mu_S$ always satisfies Property (B), and Lemma \eqref{largeFrequencyLemma} shows Property (D) is also always satisfied. This completes the proof.
    \begin{comment}

    %
    Now
    %
    \begin{align*}
        r_{m+1}^{d/2} \log(M_{m+1}) &= \left( l_{m+1}^{a\varepsilon - \frac{dn-s}{2n}} \cdot r_{m+1}^{d/2} \log(M_{m+1}) \right) l_{m+1}^{\frac{dn - s}{2n} - a \varepsilon}.
    \end{align*}
    %
    Equation \eqref{equation5890129048128941891} implies
    %
    \begin{align*}
        &l_{m+1}^{a\varepsilon - \frac{dn-s}{2n}} \cdot r_{m+1}^{d/2} \log(M_{m+1})\\
        &\ \ \ \ \ = \frac{l_m^{a\varepsilon - \frac{dn-s}{2n} + d/2} \log(M_{m+1}) K_{m+1}^{\frac{dn-s}{2n} - a\varepsilon}}{M_{m+1}^{a\varepsilon + \frac{s}{2n}}}\\
        &\ \ \ \ \ \leq \left[ l_m^{a\varepsilon - \frac{dn-s}{2n} + d/2} 2^{\frac{dn-s}{2n} - a \varepsilon} \right] \log(M_{m+1}) M_{m+1}^{\left( \frac{s}{dn-s} + c\varepsilon \right)\left(\frac{dn-s}{2n} - a\varepsilon\right) - a\varepsilon - \frac{s}{2n}}.
    \end{align*}
    %
    Now
    %
    \begin{align*}
        \left( \frac{s}{dn - s} + c\varepsilon \right) \left( \frac{dn - s}{2n} - a\varepsilon \right) - a\varepsilon &\leq \left[ \frac{(dn-s)c}{2n} - \left( \frac{s}{dn-s}+1 \right)a \right] \varepsilon\\
        &= \left[ \frac{d(3 - na)}{(dn - s)} \right] \varepsilon\\
        &\leq -2 \varepsilon.
    \end{align*}
    %
    Since $\log(M_{m+1}) \leq (2/\varepsilon) M_{m+1}^{\varepsilon/2}$, if we assume that
    %
    \begin{equation} \label{equation1290412904129049102}
        M_{m+1} \geq \left( l_m^{a\varepsilon - \frac{dn-s}{2n} + d/2} 2^{\frac{dn-s}{2n} - a\varepsilon} (2/\varepsilon) \right)^{2/\varepsilon},
    \end{equation}
    %
    then we conclude
    %
    \begin{align*}
        r_{m+1}^{d/2} \log(M_{m+1}) &\leq \left[ l_m^{a\varepsilon - \frac{dn-s}{2n} + d/2} 2^{\frac{dn-s}{2n} - a \varepsilon} \log(M_{m+1}) M_{m+1}^{-\varepsilon} \right] M_{m+1}^{-\varepsilon} l_{m+1}^{\frac{dn-s}{2n} - a\varepsilon}\\
        &\leq M_{m+1}^{-\varepsilon} l_{m+1}^{\frac{dn-s}{2n} - a \varepsilon}
    \end{align*}
    %
    Applying Lemma \ref{deviationLemma}, we conclude that if $|k| \leq 10 l_{m+1}^{-1}$,
    %
    \begin{align*}
        |\widehat{\nu_{S}}(k)| &\leq |\widehat{\nu_{S}}(k) - \widehat{\mu_T}(k)| + |\widehat{\mu_T}(k)|\\
        &\leq r_{m+1}^{d/2} \log(M_{m+1}) + L |k|^{c\varepsilon - \frac{dn-s}{2n}}\\
        &\leq l_{m+1}^{-\frac{dn-s}{2n}-c\varepsilon + \varepsilon} + L |k|^{c\varepsilon - \frac{dn-s}{2n}}\\
        &\leq \left[ L + 10^d M_{m+1}^{-\varepsilon} \right] |k|^{c\varepsilon - \frac{dn-s}{2n}}.
    \end{align*}
    %
    Applying Lemma \ref{largeFrequencyLemma} with $r = 2c\varepsilon - (dn - s)/n$ implies that for $|k| \geq 10l_{m+1}^{-1}$,
    %
    \[ |\widehat{\nu_{S}}(k)| \leq L |k|^{c\varepsilon-\frac{dn-s}{2n}} \leq [L + 10^d M_{M+1}^{-\varepsilon}]|k|^{c\varepsilon - \frac{dn-s}{2n}}, \]
    %
    Thus we conclude that for all $k \in \ZZ^d$,
    %
    \[ |\widehat{\nu_S}(k)| \leq (L + 10^d M_{m+1}^{-\varepsilon}) |k|^{c\varepsilon - \frac{dn-s}{2n}}. \]
    %
    Applying Lemma \ref{nuNormalizationLemma}, as well as a valid assumption that
    %
    \begin{equation} \label{equation129301923109}
        M_{m+1} \geq 10^{d/\varepsilon} \cdot 4^{m/\varepsilon},
    \end{equation}
    %
    we conclude that for all $k \in \ZZ^d$,
    %
    \begin{align*}
        |\widehat{\mu_S}(k)| &\leq \frac{L + 10^d M_{m+1}^{-\varepsilon}}{1 - M_{m+1}^{-1/2}} |m|^{c\varepsilon - \frac{dn-s}{2n}}\\
        &\leq (1 + M_{m+1}^{-1/2}) [L + 10^d M_{m+1}^{-\varepsilon}] |k|^{c\varepsilon - \frac{dn-s}{2n}}\\
        &\leq (1 + 1/2^m) [L + 10^d M_{m+1}^{-\varepsilon}] |k|^{c\varepsilon - \frac{dn-s}{2n}}\\
        &\leq (1 + 1/2^m) [L + 1/2^m] |k|^{c\varepsilon - \frac{dn-s}{2n}}. \qedhere
    \end{align*}
    \end{comment}
\end{proof}

\section{Construction of the Salem Set}

Let us now choose the parameters to construct our configuration avoiding set. First, we fix some preliminary parameters. Write $Z \subset \bigcup_{i = 1}^\infty Z_i$, where $Z_i$ has lower Minkowski dimension at most $s$ for each $i$. Then choose an infinite sequence $\{ i_m : m \geq 1 \}$ which repeats every positive integer infinitely many times. Also, choose an arbitrary, decreasing sequence of positive numbers $\{ \varepsilon_m : m \geq 1 \}$, with $\varepsilon_m < (dn - s)/2$ for each $m$. We choose our parameters $\{ M_m \}$ and $\{ K_k \}$ inductively. First, set $X_0 = [0,1]^d$, and $\mu_0$ an arbitrary smooth probability measure supported on $X_0$. At the $m$th step of our construction, we have already found a set $X_{m-1}$ and a measure $\mu_{m-1}$. We then choose $K_m$ and $M_m$ such that
%
\[ K_m, M_m \geq C(\mu_{m-1}, n, d, s, \varepsilon_m), \]
%
such that
%
\[ M_m^{\frac{s}{dn-s} + c\varepsilon_m} \leq K_m \leq 2 M_m^{\frac{s}{dn-s} + c\varepsilon}, \]
%
and such that the set $Z_{i_m}$ is covered by at most $l_m^{-(s + \varepsilon_m)}$ cubes in $\DQ_m$, the union of which, we define to be equal to $B_m$. We can then apply Proposition \ref{discreteLemma} with $\varepsilon = \varepsilon_m$, $T = X_{m-1}$, $\mu_T = \mu_{m-1}$, and $B = B_m$. This produces a $\DQ_{m+1}$ discretized set $S \subset T$, and a measure $\mu_S$ supported on $S$. We define $X_m = S$, and $\mu_m = \mu_S$.

The last paragraph recursively generates an infinite sequence $\{ X_m \}$. We set $X = \bigcap X_m$. Just as in our previous paper, it is easy to see $X$ must be a configuration avoiding set. Given any $(x_1, \dots, x_n) \in Z$, there are infinitely many integers $m_k$ such that $(x_1, \dots, x_n) \in B_{m_k}$. If $|x_i - x_j| \geq \varepsilon$ for each $i \neq j$, and $r_{m_k} \leq \varepsilon/2$, then $(x_1, \dots, x_n)$ is contained in a strongly non-diagonal cube in $\DQ_{m_k}(B_k)$, and as such $X^n \subset X_k^n$ does not contain $(x_1, \dots, x_n)$.

\section{Proof that $X$ is Salem}

We now show $X$ is Salem, completing the proof of Theorem \ref{maintheorem}. Since the masses of the sequence of measures $\{ \mu_m \}$ is uniformly bounded, there is some subsequence $\mu_{m_i}$ which converges weakly to some measure $\mu$. Repeated applications of Property (B) of Proposition \ref{discreteLemma} imply
%
\[ \mu(\RR^d) = \lim_{i \to \infty} \mu_{m_i}(\RR^d) \geq 1 - \sum_{m=1}^\infty M_m^{-1/2}. \]
%
In particular, $\mu$ is a non-zero measure if the sequence $\{ M_m \}$ is rapidly increasing. Moreover, for each $k \in \ZZ^d$,
%
\[ \widehat{\mu}(k) = \lim_{i \to \infty} \widehat{\mu_{m_i}}(k). \]
%
Thus
%
\[ |\widehat{\mu}(k)| \leq |\widehat{\mu_0}(k)| + \sum_{m = 0}^\infty |\widehat{\mu_{m+1}}(k) - \widehat{\mu_m}(k)|. \]
%
Fix $\varepsilon > 0$. Since $l_m \leq 2^{-m}/10$, we find that for $m \geq \log(k)$, $|k| \leq 10 l_{m+1}^{-1}$. Thus we can apply Property (C) and (D) of Proposition \ref{discreteLemma} to conclude
%
\begin{align*}
    &\sum_{m = 0}^\infty |\widehat{\mu_{m+1}}(k) - \widehat{\mu_m}(k)|\\
    &\ \ \ \ \ \leq 2 \log(k) |k|^{-d/2} + \sum_{m = \log(k)}^\infty r_{m+1}^{d/2} \log(M_{m+1})\\
    &\ \ \ \ \ \lesssim_\varepsilon |k|^{\varepsilon- t/2} \left( 1 + \sum_{m = \log(k)}^\infty |k|^{t/2-\varepsilon} r_{m+1}^{d/2} \log(M_{m+1}) \right)\\
    &\ \ \ \ \ \leq |k|^{\varepsilon - t/2} \left( 1 + 10^{t/2 - \varepsilon} \sum_{m = \log(k)}^\infty l_{m+1}^{\varepsilon - t/2} r_{m+1}^{d/2} \log(M_{m+1}) \right)\\
    &\ \ \ \ \ \lesssim_\varepsilon |k|^{\varepsilon - t/2} \left( 1 + \sum_{m = \log(k)}^\infty \frac{1}{K_{m+1}^{\varepsilon}} \frac{K_{m+1}^{t/2}}{M_{m+1}^{d/2 - t/2}} \right)\\
    &\ \ \ \ \ \lesssim |k|^{\varepsilon - t/2} \left( 1 + \sum_{m = \log(k)}^\infty \frac{M_{m+1}^{c\varepsilon_m (t/2)}}{K_{m+1}^\varepsilon} \frac{M_{m+1}^{(t/2) \left( \frac{s}{dn-s} \right)}}{M_{m+1}^{d/2 - t/2}} \right)\\
    &\ \ \ \ \ = |k|^{\varepsilon - t/2} \left( 1 + \sum_{m = \log(k)}^\infty \frac{M_{m+1}^{c\varepsilon_m (t/2)}}{K_{m+1}^{\varepsilon}} \right) \lesssim_\varepsilon |k|^{\varepsilon - t/2}.
\end{align*}
%
The last inequality follows because $\varepsilon_m \to 0$, and so the series is summable if the sequence $\{ K_m \}$ increases rapidly enough. Since $\mu_0$ is smooth and compactly supported, we find
%
\[ \sup_{k \in \ZZ^d} |k|^{t/2 - \varepsilon} |\widehat{\mu}(k)| \lesssim_\varepsilon 1 + \sup_{k \in \ZZ} |k|^{t/2 - \varepsilon} |\widehat{\mu_0}(k)| < \infty. \]
%
Since $\varepsilon > 0$ was arbitrary, this shows that the Fourier dimension of $X$ is at least $t$. Because $X_m$ is the union of $(M_1 \dots M_m)^d$ sidelength $l_m$ cubes, one can easily show using \eqref{equation5890129048128941891} that the lower Minkowski dimension of $X$ is upper bounded by $t$. But these two bounds imply that the Hausdorff dimension, Fourier dimension, and Minkowski dimension are all equal to $t$. Thus $X$ is Salem of dimension $t$.

\begin{comment}
It is easy to see from our proof that for each $m$,
%
\[ \#(\DQ_m(X_m)) = \frac{1}{(M_1 \dots M_m)^d}. \]
%
Thus
%
\begin{align*}
    \log_{1/l_m}(\#(\DQ_m(X_m))) &= \frac{d \log(M_1 \dots M_m)}{\log(N_1 \dots N_m)}\\
    &\sim \frac{d \log(M_m)}{\log(N_m)}\\
    &= \frac{d \log(M_m)}{\log(M_m) + \log(K_m)}\\
    &= \frac{d}{1 + \log_{M_m}(K_m)}\\
    &\sim \frac{d}{1 + \left(\frac{s}{dn - s} + c\varepsilon \right)}\\
    &= \frac{d}{\frac{dn}{dn - s} + c\varepsilon_m}.
\end{align*}
%
Thus
%
\[ \lim_{m \to \infty} \log_{1/l_m}(\#(\DQ_m(X_m))) \leq \frac{dn - s}{n}. \]
%
In particular, this means $X$ has lower Minkowski dimension at most $(dn - s)/n$, which, together with the Fourier dimension bound, implies that $X$ is Salem.
\end{comment}

\begin{comment}
\section{K\"{o}rner's Work}

The last sections gives a first, positive result finding Salem sets avoiding rough configurations. However, as we showed in our last paper, given the same assumptions, one can find a set $X$ with \emph{Hausdorff dimension} $(dn - s)/(n-1)$ avoiding configurations. Improving the dimension to obtain this result requires a deeper knowledge of the stochastic behaviour of the set $\DQ_{m+1}(B) \cap \DQ_{m+1}(S^n)$, when $N_{m+1}$ is chosen significantly smaller relative to $M_{m+1}$. In the next section, we provide a summary of an argument due to K\"{o}rner, which deals with a very similar situation.
\end{comment}

\begin{thebibliography}{9}

\bibitem{Korner1}
    T.W. K\"{o}rner,
    \textit{Measures on Independent Sets, A Quantitative Version of Rudin's Theorem}.

\bibitem{Korner2}
    T.W. K\"{o}rner,
    \textit{Fourier Transforms of Measures and Algebraic Relations on Their Supports}.

\bibitem{OurPaper}
    Jacob Denson, Malabika Pramanik, Joshua Zahl,
    \textit{Large Sets Avoiding Rough Patterns}.

\bibitem{myThesis}
    Jacob Denson,
    \textit{Cartesian Products Avoiding Patterns}.

\bibitem{Vershynin}
    Roman Vershynin,
    \textit{High Dimensional Probability},
    Cambridge Series in Statistical and Probabilistic Mathematics,
    2018.

\end{thebibliography}

\end{document}